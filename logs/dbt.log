[0m23:14:40.799094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757fd1f50fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757fd1bee600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757fd1f51100>]}


============================== 23:14:40.802866 | 050f4808-1c86-4413-807c-4a93066d2698 ==============================
[0m23:14:40.802866 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:14:40.803382 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'target_path': 'None', 'write_json': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'profiles_dir': '/home/murilo/.dbt', 'debug': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'logs', 'log_format': 'default', 'printer_width': '80', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'static_parser': 'True', 'empty': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run'}
[0m23:14:40.803868 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /home/murilo/UFPE/BD/Grupo7-BancoDeDados/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m23:14:40.805037 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.050776374, "process_in_blocks": "4744", "process_kernel_time": 0.242953, "process_mem_max_rss": "99204", "process_out_blocks": "16", "process_user_time": 1.100789}
[0m23:14:40.805513 [debug] [MainThread]: Command `dbt run` failed at 23:14:40.805439 after 0.05 seconds
[0m23:14:40.805890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757fd0eef9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757fd14052e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757fd369ba40>]}
[0m23:14:40.806274 [debug] [MainThread]: Flushing usage events
[0m23:14:41.607385 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:15:04.830972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf917721010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf91708e870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf9176a2cf0>]}


============================== 23:15:04.833938 | 3aaf9613-2e04-41a4-a799-d1b2e07fe7b1 ==============================
[0m23:15:04.833938 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:15:04.834502 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'write_json': 'True', 'no_print': 'None', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'partial_parse': 'True', 'introspect': 'True', 'log_format': 'default', 'empty': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'static_parser': 'True', 'profiles_dir': '/home/murilo/.dbt', 'use_experimental_parser': 'False', 'use_colors': 'True', 'fail_fast': 'False'}
[0m23:15:04.836726 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'transformacao_matricula'
[0m23:15:04.837792 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.051900674, "process_in_blocks": "0", "process_kernel_time": 0.173532, "process_mem_max_rss": "99144", "process_out_blocks": "0", "process_user_time": 1.086076}
[0m23:15:04.838353 [debug] [MainThread]: Command `dbt run` failed at 23:15:04.838274 after 0.05 seconds
[0m23:15:04.838755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf916ead160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf918af8620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf916cbfb90>]}
[0m23:15:04.839249 [debug] [MainThread]: Flushing usage events
[0m23:15:05.298530 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:18:14.954946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff143dcc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff13e273b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff15980680>]}


============================== 23:18:14.958733 | aaea608f-59bc-42e2-9c13-42f5f9282c94 ==============================
[0m23:18:14.958733 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:18:14.959366 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'introspect': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'partial_parse': 'True', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'target_path': 'None', 'profiles_dir': '/home/murilo/.dbt', 'fail_fast': 'False', 'static_parser': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'log_format': 'default'}
[0m23:18:14.961588 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'transformacao_matricula'
[0m23:18:14.962675 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.053001545, "process_in_blocks": "0", "process_kernel_time": 0.198511, "process_mem_max_rss": "99108", "process_out_blocks": "8", "process_user_time": 1.06139}
[0m23:18:14.963248 [debug] [MainThread]: Command `dbt run` failed at 23:18:14.963166 after 0.05 seconds
[0m23:18:14.963614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff12e17b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff131855e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ff12e48e30>]}
[0m23:18:14.964010 [debug] [MainThread]: Flushing usage events
[0m23:18:15.515691 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:18:40.619368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0db8f89010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0db916ab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0db8be2c30>]}


============================== 23:18:40.622710 | 1efff515-f07e-402e-a98b-331367db6110 ==============================
[0m23:18:40.622710 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:18:40.623246 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'profiles_dir': '/home/murilo/.dbt', 'fail_fast': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'static_parser': 'True', 'write_json': 'True', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'partial_parse': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'printer_width': '80', 'version_check': 'True'}
[0m23:18:40.625409 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'transformacao_matricula'
[0m23:18:40.626550 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.05185267, "process_in_blocks": "0", "process_kernel_time": 0.18305, "process_mem_max_rss": "99092", "process_out_blocks": "8", "process_user_time": 1.056518}
[0m23:18:40.627074 [debug] [MainThread]: Command `dbt run` failed at 23:18:40.626997 after 0.05 seconds
[0m23:18:40.627439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0db7f277a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0db86d8200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0db8326e40>]}
[0m23:18:40.627820 [debug] [MainThread]: Flushing usage events
[0m23:18:41.081915 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:19:11.027223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b29a30ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b29860e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b291271a0>]}


============================== 23:19:11.030276 | e80fed02-a8be-40f3-950f-25da1cccfd48 ==============================
[0m23:19:11.030276 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:19:11.030795 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'version_check': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'target_path': 'None', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'static_parser': 'True', 'fail_fast': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'debug': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'profiles_dir': '/home/murilo/.dbt', 'no_print': 'None', 'write_json': 'True', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'quiet': 'False'}
[0m23:19:11.032899 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'transformacao_matricula'
[0m23:19:11.033799 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.05098707, "process_in_blocks": "0", "process_kernel_time": 0.189721, "process_mem_max_rss": "99080", "process_out_blocks": "8", "process_user_time": 1.065119}
[0m23:19:11.034291 [debug] [MainThread]: Command `dbt run` failed at 23:19:11.034216 after 0.05 seconds
[0m23:19:11.034652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b2cf74200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b28dbf4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b28fcfec0>]}
[0m23:19:11.035043 [debug] [MainThread]: Flushing usage events
[0m23:19:11.491226 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:20:21.653178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7627406dc860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762741d39340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76273fb21100>]}


============================== 23:20:21.656993 | a91fbe4a-db53-4222-842d-8e4f1cf0b889 ==============================
[0m23:20:21.656993 [info ] [MainThread]: Running with dbt=1.10.15
[0m23:20:21.657613 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'use_experimental_parser': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'log_format': 'default', 'version_check': 'True', 'write_json': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'profiles_dir': '/home/murilo/.dbt', 'target_path': 'None', 'debug': 'False', 'warn_error': 'None'}
[0m23:20:21.708196 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "transformacao_matricula", target "transformacao_matricula_db" invalid: 'schema' is a required property
[0m23:20:21.709306 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.0998737, "process_in_blocks": "576", "process_kernel_time": 0.187678, "process_mem_max_rss": "103664", "process_out_blocks": "8", "process_user_time": 1.110098}
[0m23:20:21.709817 [debug] [MainThread]: Command `dbt run` failed at 23:20:21.709736 after 0.10 seconds
[0m23:20:21.710219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76273f64a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76273f648e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76273f617aa0>]}
[0m23:20:21.710629 [debug] [MainThread]: Flushing usage events
[0m23:20:22.248730 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:23:20.240407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da144834fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da1446b7ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da1446b7f20>]}


============================== 00:23:20.244469 | 22183c12-19a3-4b15-8532-de7b3034c6db ==============================
[0m00:23:20.244469 [info ] [MainThread]: Running with dbt=1.10.15
[0m00:23:20.245076 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'version_check': 'True', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'quiet': 'False', 'target_path': 'None', 'partial_parse': 'True', 'debug': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'profiles_dir': '/home/murilo/.dbt', 'write_json': 'True', 'empty': 'False', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'log_cache_events': 'False', 'printer_width': '80', 'cache_selected_only': 'False'}
[0m00:23:20.294769 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "transformacao_matricula", target "transformacao_matricula_db" invalid: 'schema' is a required property
[0m00:23:20.297248 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.10169054, "process_in_blocks": "15016", "process_kernel_time": 0.230235, "process_mem_max_rss": "103460", "process_out_blocks": "8", "process_user_time": 1.120414}
[0m00:23:20.298105 [debug] [MainThread]: Command `dbt run` failed at 00:23:20.297964 after 0.10 seconds
[0m00:23:20.298566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da144297f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da1437a0980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7da1434c9fd0>]}
[0m00:23:20.299082 [debug] [MainThread]: Flushing usage events
[0m00:23:20.869131 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:24:16.931341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e1c925ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e1ccf3ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e1e4dab70>]}


============================== 00:24:16.935771 | 3b56ee71-1eb7-4b77-842c-8aa778a14225 ==============================
[0m00:24:16.935771 [info ] [MainThread]: Running with dbt=1.10.15
[0m00:24:16.936476 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'empty': 'False', 'write_json': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'no_print': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'use_colors': 'True', 'static_parser': 'True', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'printer_width': '80', 'version_check': 'True', 'profiles_dir': '/home/murilo/.dbt'}
[0m00:24:17.097264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b56ee71-1eb7-4b77-842c-8aa778a14225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e1b359670>]}
[0m00:24:17.146118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b56ee71-1eb7-4b77-842c-8aa778a14225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e1c54be60>]}
[0m00:24:17.146943 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:24:17.264302 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m00:24:17.264973 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:24:17.265355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3b56ee71-1eb7-4b77-842c-8aa778a14225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e1af1a030>]}
[0m00:24:17.925283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b56ee71-1eb7-4b77-842c-8aa778a14225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e1a74a9c0>]}
[0m00:24:17.954757 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m00:24:17.956451 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m00:24:17.969422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b56ee71-1eb7-4b77-842c-8aa778a14225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e1a76fb00>]}
[0m00:24:17.969976 [info ] [MainThread]: Found 459 macros
[0m00:24:17.970371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b56ee71-1eb7-4b77-842c-8aa778a14225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e1abc7440>]}
[0m00:24:17.971749 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:24:17.972444 [debug] [MainThread]: Command end result
[0m00:24:17.988657 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m00:24:17.990766 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m00:24:17.994428 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m00:24:17.995680 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.109719, "process_in_blocks": "18880", "process_kernel_time": 0.31732, "process_mem_max_rss": "111012", "process_out_blocks": "2640", "process_user_time": 2.015384}
[0m00:24:17.996393 [debug] [MainThread]: Command `dbt run` succeeded at 00:24:17.996282 after 1.11 seconds
[0m00:24:17.996954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e1e8772f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e1b305c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e1c44ae40>]}
[0m00:24:17.997501 [debug] [MainThread]: Flushing usage events
[0m00:24:18.557746 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:24:53.781934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdc57d850d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdc57bc1820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdc57bc2420>]}


============================== 00:24:53.785590 | 2ebd563c-ab01-464a-8eeb-beeba175be71 ==============================
[0m00:24:53.785590 [info ] [MainThread]: Running with dbt=1.10.15
[0m00:24:53.786141 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'cache_selected_only': 'False', 'static_parser': 'True', 'use_colors': 'True', 'printer_width': '80', 'version_check': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/home/murilo/.dbt', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'partial_parse': 'True', 'quiet': 'False', 'target_path': 'None', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt test', 'log_format': 'default', 'empty': 'None', 'introspect': 'True'}
[0m00:24:53.940118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ebd563c-ab01-464a-8eeb-beeba175be71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdc562f3c80>]}
[0m00:24:53.987708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ebd563c-ab01-464a-8eeb-beeba175be71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdc59432990>]}
[0m00:24:53.988545 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:24:54.114527 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m00:24:54.157322 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:24:54.157752 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:24:54.161972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ebd563c-ab01-464a-8eeb-beeba175be71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdc56c20170>]}
[0m00:24:54.192575 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m00:24:54.194145 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m00:24:54.212101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ebd563c-ab01-464a-8eeb-beeba175be71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdc553d5ee0>]}
[0m00:24:54.212613 [info ] [MainThread]: Found 459 macros
[0m00:24:54.212999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ebd563c-ab01-464a-8eeb-beeba175be71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdc55f13020>]}
[0m00:24:54.215194 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:24:54.216906 [debug] [MainThread]: Command end result
[0m00:24:54.231529 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m00:24:54.233637 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m00:24:54.242837 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m00:24:54.244210 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.50866127, "process_in_blocks": "752", "process_kernel_time": 0.277981, "process_mem_max_rss": "112988", "process_out_blocks": "1768", "process_user_time": 1.449688}
[0m00:24:54.244947 [debug] [MainThread]: Command `dbt test` succeeded at 00:24:54.244821 after 0.51 seconds
[0m00:24:54.245552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdc57272c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdc589c2720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdc57b3b410>]}
[0m00:24:54.246206 [debug] [MainThread]: Flushing usage events
[0m00:24:54.831830 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:27:22.012474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c6a53ed970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c6a558a420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c6a7526690>]}


============================== 00:27:22.015735 | c399c436-2d0e-4182-b2a2-8e363ca28b0f ==============================
[0m00:27:22.015735 [info ] [MainThread]: Running with dbt=1.10.15
[0m00:27:22.016293 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'target_path': 'None', 'partial_parse': 'True', 'empty': 'None', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'quiet': 'False', 'version_check': 'True', 'debug': 'False', 'profiles_dir': '/home/murilo/.dbt', 'cache_selected_only': 'False', 'write_json': 'True', 'invocation_command': 'dbt init', 'no_print': 'None', 'warn_error': 'None', 'use_experimental_parser': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'log_format': 'default', 'static_parser': 'True'}
[0m00:27:22.024365 [info ] [MainThread]: Setting up your profile.
[0m00:27:40.713705 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 18.746302, "process_in_blocks": "16", "process_kernel_time": 0.207584, "process_mem_max_rss": "99384", "process_out_blocks": "16", "process_user_time": 1.072415}
[0m00:27:40.714626 [debug] [MainThread]: Command `dbt init` succeeded at 00:27:40.714463 after 18.75 seconds
[0m00:27:40.715293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c6a4d75df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c6a517b260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c6a49b1550>]}
[0m00:27:40.715927 [debug] [MainThread]: Flushing usage events
[0m00:27:41.269738 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:37:31.273445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729446e92c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72944732b4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7294479abec0>]}


============================== 00:37:31.276996 | 6f4f371b-b24f-4122-a6db-898c5bcca6f7 ==============================
[0m00:37:31.276996 [info ] [MainThread]: Running with dbt=1.10.15
[0m00:37:31.277547 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'target_path': 'None', 'write_json': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'empty': 'None', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'version_check': 'True', 'debug': 'False', 'introspect': 'True', 'no_print': 'None', 'log_format': 'default', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'fail_fast': 'False', 'profiles_dir': '/home/murilo/.dbt'}
[0m00:37:31.290899 [info ] [MainThread]: dbt version: 1.10.15
[0m00:37:31.291453 [info ] [MainThread]: python version: 3.12.3
[0m00:37:31.291902 [info ] [MainThread]: python path: /home/murilo/UFPE/BD/Grupo7-BancoDeDados/.venv/bin/python
[0m00:37:31.292367 [info ] [MainThread]: os info: Linux-6.14.0-36-generic-x86_64-with-glibc2.39
[0m00:37:31.353307 [info ] [MainThread]: Using profiles dir at /home/murilo/.dbt
[0m00:37:31.359145 [info ] [MainThread]: Using profiles.yml file at /home/murilo/.dbt/profiles.yml
[0m00:37:31.359995 [info ] [MainThread]: Using dbt_project.yml file at /home/murilo/UFPE/BD/Grupo7-BancoDeDados/dbt_project.yml
[0m00:37:31.360996 [info ] [MainThread]: adapter type: postgres
[0m00:37:31.361435 [info ] [MainThread]: adapter version: 1.9.1
[0m00:37:31.480138 [info ] [MainThread]: Configuration:
[0m00:37:31.480691 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:37:31.481121 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:37:31.481481 [info ] [MainThread]: Required dependencies:
[0m00:37:31.481875 [debug] [MainThread]: Executing "git --help"
[0m00:37:31.485450 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:37:31.485985 [debug] [MainThread]: STDERR: "b''"
[0m00:37:31.486389 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:37:31.486750 [info ] [MainThread]: Connection:
[0m00:37:31.487098 [info ] [MainThread]:   host: localhost
[0m00:37:31.487404 [info ] [MainThread]:   port: 5436
[0m00:37:31.487728 [info ] [MainThread]:   user: postgres
[0m00:37:31.488132 [info ] [MainThread]:   database: transformacao_matricula
[0m00:37:31.488458 [info ] [MainThread]:   schema: staging
[0m00:37:31.488761 [info ] [MainThread]:   connect_timeout: 10
[0m00:37:31.489080 [info ] [MainThread]:   role: None
[0m00:37:31.489383 [info ] [MainThread]:   search_path: None
[0m00:37:31.489691 [info ] [MainThread]:   keepalives_idle: 0
[0m00:37:31.490004 [info ] [MainThread]:   sslmode: None
[0m00:37:31.490305 [info ] [MainThread]:   sslcert: None
[0m00:37:31.490608 [info ] [MainThread]:   sslkey: None
[0m00:37:31.490936 [info ] [MainThread]:   sslrootcert: None
[0m00:37:31.491243 [info ] [MainThread]:   application_name: dbt
[0m00:37:31.491547 [info ] [MainThread]:   retries: 1
[0m00:37:31.492004 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:37:31.617573 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m00:37:31.666832 [debug] [MainThread]: Using postgres connection "debug"
[0m00:37:31.667593 [debug] [MainThread]: On debug: select 1 as id
[0m00:37:31.667977 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:37:31.693589 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (127.0.0.1), port 5436 failed: FATAL:  database "transformacao_matricula" does not exist

[0m00:37:31.702500 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m00:37:31.703061 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m00:37:31.703460 [debug] [MainThread]: On debug: No close available on handle
[0m00:37:31.703820 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m00:37:31.704215 [info ] [MainThread]: [31m1 check failed:[0m
[0m00:37:31.704563 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (127.0.0.1), port 5436 failed: FATAL:  database "transformacao_matricula" does not exist
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m00:37:31.705909 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.47789094, "process_in_blocks": "57240", "process_kernel_time": 0.33536, "process_mem_max_rss": "114464", "process_out_blocks": "24", "process_user_time": 1.399679}
[0m00:37:31.706495 [debug] [MainThread]: Command `dbt debug` failed at 00:37:31.706406 after 0.48 seconds
[0m00:37:31.706928 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:37:31.707331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729446eb2ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729447984a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72944ade0200>]}
[0m00:37:31.707770 [debug] [MainThread]: Flushing usage events
[0m00:37:32.262999 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:39:02.377244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72363c8d95e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72363e8a7bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72363c2513a0>]}


============================== 00:39:02.381224 | 0fa236bf-ae79-4fed-a385-6e19546b8285 ==============================
[0m00:39:02.381224 [info ] [MainThread]: Running with dbt=1.10.15
[0m00:39:02.381802 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'version_check': 'True', 'target_path': 'None', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/murilo/.dbt', 'empty': 'None', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'fail_fast': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'quiet': 'False', 'introspect': 'True', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'use_colors': 'True'}
[0m00:39:02.394466 [info ] [MainThread]: dbt version: 1.10.15
[0m00:39:02.395048 [info ] [MainThread]: python version: 3.12.3
[0m00:39:02.395469 [info ] [MainThread]: python path: /home/murilo/UFPE/BD/Grupo7-BancoDeDados/.venv/bin/python
[0m00:39:02.395947 [info ] [MainThread]: os info: Linux-6.14.0-36-generic-x86_64-with-glibc2.39
[0m00:39:02.469596 [info ] [MainThread]: Using profiles dir at /home/murilo/.dbt
[0m00:39:02.470146 [info ] [MainThread]: Using profiles.yml file at /home/murilo/.dbt/profiles.yml
[0m00:39:02.470504 [info ] [MainThread]: Using dbt_project.yml file at /home/murilo/UFPE/BD/Grupo7-BancoDeDados/dbt_project.yml
[0m00:39:02.471233 [info ] [MainThread]: adapter type: postgres
[0m00:39:02.471666 [info ] [MainThread]: adapter version: 1.9.1
[0m00:39:02.584644 [info ] [MainThread]: Configuration:
[0m00:39:02.585157 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:39:02.585509 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:39:02.585874 [info ] [MainThread]: Required dependencies:
[0m00:39:02.586237 [debug] [MainThread]: Executing "git --help"
[0m00:39:02.589716 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:39:02.590495 [debug] [MainThread]: STDERR: "b''"
[0m00:39:02.590830 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:39:02.591316 [info ] [MainThread]: Connection:
[0m00:39:02.591787 [info ] [MainThread]:   host: localhost
[0m00:39:02.592235 [info ] [MainThread]:   port: 5436
[0m00:39:02.592625 [info ] [MainThread]:   user: postgres
[0m00:39:02.593015 [info ] [MainThread]:   database: transformacao_matricula
[0m00:39:02.593388 [info ] [MainThread]:   schema: staging
[0m00:39:02.593805 [info ] [MainThread]:   connect_timeout: 10
[0m00:39:02.594177 [info ] [MainThread]:   role: None
[0m00:39:02.594517 [info ] [MainThread]:   search_path: None
[0m00:39:02.594875 [info ] [MainThread]:   keepalives_idle: 0
[0m00:39:02.595232 [info ] [MainThread]:   sslmode: None
[0m00:39:02.595596 [info ] [MainThread]:   sslcert: None
[0m00:39:02.595989 [info ] [MainThread]:   sslkey: None
[0m00:39:02.596428 [info ] [MainThread]:   sslrootcert: None
[0m00:39:02.596825 [info ] [MainThread]:   application_name: dbt
[0m00:39:02.597220 [info ] [MainThread]:   retries: 1
[0m00:39:02.597675 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:39:02.727692 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m00:39:02.755430 [debug] [MainThread]: Using postgres connection "debug"
[0m00:39:02.755894 [debug] [MainThread]: On debug: select 1 as id
[0m00:39:02.756202 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:39:02.772741 [debug] [MainThread]: SQL status: SELECT 1 in 0.016 seconds
[0m00:39:02.773708 [debug] [MainThread]: On debug: Close
[0m00:39:02.774166 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:39:02.774537 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:39:02.775545 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.4438691, "process_in_blocks": "52104", "process_kernel_time": 0.322272, "process_mem_max_rss": "114716", "process_out_blocks": "16", "process_user_time": 1.380452}
[0m00:39:02.776090 [debug] [MainThread]: Command `dbt debug` succeeded at 00:39:02.776011 after 0.44 seconds
[0m00:39:02.776443 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:39:02.776784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72363bf9ee40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72363cb8a810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72363c6806b0>]}
[0m00:39:02.777203 [debug] [MainThread]: Flushing usage events
[0m00:39:03.323361 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:39:57.396092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7015d4dd9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7015d3314980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7015d54e2f00>]}


============================== 00:39:57.400219 | 65b75b6d-6418-4b72-88e5-57dbf792cfb8 ==============================
[0m00:39:57.400219 [info ] [MainThread]: Running with dbt=1.10.15
[0m00:39:57.400833 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'target_path': 'None', 'quiet': 'False', 'invocation_command': 'dbt debug', 'indirect_selection': 'eager', 'introspect': 'True', 'version_check': 'True', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'cache_selected_only': 'False', 'printer_width': '80', 'fail_fast': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'empty': 'None', 'log_format': 'default', 'debug': 'False', 'profiles_dir': '/home/murilo/.dbt', 'static_parser': 'True', 'no_print': 'None', 'partial_parse': 'True'}
[0m00:39:57.414001 [info ] [MainThread]: dbt version: 1.10.15
[0m00:39:57.414621 [info ] [MainThread]: python version: 3.12.3
[0m00:39:57.415275 [info ] [MainThread]: python path: /home/murilo/UFPE/BD/Grupo7-BancoDeDados/.venv/bin/python
[0m00:39:57.416011 [info ] [MainThread]: os info: Linux-6.14.0-36-generic-x86_64-with-glibc2.39
[0m00:39:57.488639 [info ] [MainThread]: Using profiles dir at /home/murilo/.dbt
[0m00:39:57.489898 [info ] [MainThread]: Using profiles.yml file at /home/murilo/.dbt/profiles.yml
[0m00:39:57.490439 [info ] [MainThread]: Using dbt_project.yml file at /home/murilo/UFPE/BD/Grupo7-BancoDeDados/dbt_project.yml
[0m00:39:57.491936 [info ] [MainThread]: adapter type: postgres
[0m00:39:57.492646 [info ] [MainThread]: adapter version: 1.9.1
[0m00:39:57.613308 [info ] [MainThread]: Configuration:
[0m00:39:57.613834 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:39:57.614235 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:39:57.614593 [info ] [MainThread]: Required dependencies:
[0m00:39:57.614987 [debug] [MainThread]: Executing "git --help"
[0m00:39:57.617420 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:39:57.618599 [debug] [MainThread]: STDERR: "b''"
[0m00:39:57.619140 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:39:57.619553 [info ] [MainThread]: Connection:
[0m00:39:57.619988 [info ] [MainThread]:   host: localhost
[0m00:39:57.620436 [info ] [MainThread]:   port: 5436
[0m00:39:57.620895 [info ] [MainThread]:   user: postgres
[0m00:39:57.621263 [info ] [MainThread]:   database: transformacao_matricula
[0m00:39:57.621599 [info ] [MainThread]:   schema: staging
[0m00:39:57.621943 [info ] [MainThread]:   connect_timeout: 10
[0m00:39:57.622276 [info ] [MainThread]:   role: None
[0m00:39:57.622607 [info ] [MainThread]:   search_path: None
[0m00:39:57.622954 [info ] [MainThread]:   keepalives_idle: 0
[0m00:39:57.623268 [info ] [MainThread]:   sslmode: None
[0m00:39:57.623680 [info ] [MainThread]:   sslcert: None
[0m00:39:57.624069 [info ] [MainThread]:   sslkey: None
[0m00:39:57.624416 [info ] [MainThread]:   sslrootcert: None
[0m00:39:57.624740 [info ] [MainThread]:   application_name: dbt
[0m00:39:57.625105 [info ] [MainThread]:   retries: 1
[0m00:39:57.625563 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:39:57.746397 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m00:39:57.774798 [debug] [MainThread]: Using postgres connection "debug"
[0m00:39:57.775261 [debug] [MainThread]: On debug: select 1 as id
[0m00:39:57.775566 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:39:57.786090 [debug] [MainThread]: SQL status: SELECT 1 in 0.010 seconds
[0m00:39:57.787031 [debug] [MainThread]: On debug: Close
[0m00:39:57.787488 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:39:57.788124 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:39:57.789225 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.43732268, "process_in_blocks": "41440", "process_kernel_time": 0.329371, "process_mem_max_rss": "114852", "process_out_blocks": "16", "process_user_time": 1.378107}
[0m00:39:57.789806 [debug] [MainThread]: Command `dbt debug` succeeded at 00:39:57.789691 after 0.44 seconds
[0m00:39:57.790216 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:39:57.790580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7015d2af04d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7015d2a8a240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7015d2a4bf80>]}
[0m00:39:57.791014 [debug] [MainThread]: Flushing usage events
[0m00:39:58.307195 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:40:41.484415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2ea8784f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2ea860fef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2ea860fe60>]}


============================== 00:40:41.488322 | 79de773d-7d93-47e9-9498-73842892dce9 ==============================
[0m00:40:41.488322 [info ] [MainThread]: Running with dbt=1.10.15
[0m00:40:41.489004 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/murilo/.dbt', 'introspect': 'True', 'warn_error': 'None', 'invocation_command': 'dbt run', 'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'use_colors': 'True', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'quiet': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'debug': 'False', 'fail_fast': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'printer_width': '80', 'empty': 'False', 'partial_parse': 'True'}
[0m00:40:41.644857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79de773d-7d93-47e9-9498-73842892dce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2ea85e4a10>]}
[0m00:40:41.694894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79de773d-7d93-47e9-9498-73842892dce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2ea761c260>]}
[0m00:40:41.695871 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:40:41.815789 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m00:40:41.850523 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:40:41.851054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '79de773d-7d93-47e9-9498-73842892dce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2ea615d670>]}
[0m00:40:42.770208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79de773d-7d93-47e9-9498-73842892dce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2ea75f4a70>]}
[0m00:40:42.811492 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m00:40:42.813531 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m00:40:42.838504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79de773d-7d93-47e9-9498-73842892dce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2ea6d44470>]}
[0m00:40:42.839590 [info ] [MainThread]: Found 459 macros
[0m00:40:42.840390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79de773d-7d93-47e9-9498-73842892dce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2ea6568530>]}
[0m00:40:42.842281 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:40:42.842997 [debug] [MainThread]: Command end result
[0m00:40:42.865363 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m00:40:42.867912 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m00:40:42.871275 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m00:40:42.872817 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4344516, "process_in_blocks": "41360", "process_kernel_time": 0.319283, "process_mem_max_rss": "111676", "process_out_blocks": "2640", "process_user_time": 2.367932}
[0m00:40:42.873771 [debug] [MainThread]: Command `dbt run` succeeded at 00:40:42.873599 after 1.44 seconds
[0m00:40:42.875008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2ea7a92570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2ea76bf590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2ea7e08560>]}
[0m00:40:42.875734 [debug] [MainThread]: Flushing usage events
[0m00:40:43.453700 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:44:27.926509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5a6c61ce30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5a6bdf9130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5a6c480fe0>]}


============================== 00:44:27.930926 | cd40d7c9-86a7-4518-88dd-8510997de61e ==============================
[0m00:44:27.930926 [info ] [MainThread]: Running with dbt=1.10.15
[0m00:44:27.931539 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'printer_width': '80', 'static_parser': 'True', 'quiet': 'False', 'use_colors': 'True', 'debug': 'False', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'empty': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/home/murilo/.dbt', 'use_experimental_parser': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'log_format': 'default', 'log_cache_events': 'False', 'version_check': 'True', 'introspect': 'True', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'partial_parse': 'True'}
[0m00:44:28.089402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd40d7c9-86a7-4518-88dd-8510997de61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5a6cbaf650>]}
[0m00:44:28.138869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd40d7c9-86a7-4518-88dd-8510997de61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5a6c215e80>]}
[0m00:44:28.139857 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:44:28.263657 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m00:44:28.321438 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:44:28.321885 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:44:28.325932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd40d7c9-86a7-4518-88dd-8510997de61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5a6c441fa0>]}
[0m00:44:28.357860 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m00:44:28.359729 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m00:44:28.375299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd40d7c9-86a7-4518-88dd-8510997de61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5a6a7c9460>]}
[0m00:44:28.375810 [info ] [MainThread]: Found 459 macros
[0m00:44:28.376222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd40d7c9-86a7-4518-88dd-8510997de61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5a6ab97350>]}
[0m00:44:28.377496 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:44:28.379211 [debug] [MainThread]: Command end result
[0m00:44:28.395540 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m00:44:28.397496 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m00:44:28.401122 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m00:44:28.402696 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5226208, "process_in_blocks": "43040", "process_kernel_time": 0.32397, "process_mem_max_rss": "111676", "process_out_blocks": "1768", "process_user_time": 1.471953}
[0m00:44:28.403488 [debug] [MainThread]: Command `dbt run` succeeded at 00:44:28.403375 after 0.52 seconds
[0m00:44:28.404064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5a6bc14860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5a6cbfb290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5a6cbfbf50>]}
[0m00:44:28.404604 [debug] [MainThread]: Flushing usage events
[0m00:44:28.973765 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:44:37.936638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d82572e870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d8271863c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d8252473b0>]}


============================== 00:44:37.940443 | d67cd48a-8605-41f7-88bb-66dbafa1d40c ==============================
[0m00:44:37.940443 [info ] [MainThread]: Running with dbt=1.10.15
[0m00:44:37.941002 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/murilo/.dbt', 'empty': 'None', 'printer_width': '80', 'target_path': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'fail_fast': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_format': 'default', 'partial_parse': 'True', 'invocation_command': 'dbt debug', 'no_print': 'None', 'version_check': 'True', 'write_json': 'True'}
[0m00:44:37.955773 [info ] [MainThread]: dbt version: 1.10.15
[0m00:44:37.956409 [info ] [MainThread]: python version: 3.12.3
[0m00:44:37.956998 [info ] [MainThread]: python path: /home/murilo/UFPE/BD/Grupo7-BancoDeDados/.venv/bin/python
[0m00:44:37.957524 [info ] [MainThread]: os info: Linux-6.14.0-36-generic-x86_64-with-glibc2.39
[0m00:44:38.018863 [info ] [MainThread]: Using profiles dir at /home/murilo/.dbt
[0m00:44:38.020135 [info ] [MainThread]: Using profiles.yml file at /home/murilo/.dbt/profiles.yml
[0m00:44:38.020978 [info ] [MainThread]: Using dbt_project.yml file at /home/murilo/UFPE/BD/Grupo7-BancoDeDados/dbt_project.yml
[0m00:44:38.021893 [info ] [MainThread]: adapter type: postgres
[0m00:44:38.022377 [info ] [MainThread]: adapter version: 1.9.1
[0m00:44:38.156143 [info ] [MainThread]: Configuration:
[0m00:44:38.156689 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:44:38.157038 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:44:38.157369 [info ] [MainThread]: Required dependencies:
[0m00:44:38.157722 [debug] [MainThread]: Executing "git --help"
[0m00:44:38.160225 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:44:38.160739 [debug] [MainThread]: STDERR: "b''"
[0m00:44:38.161118 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:44:38.161533 [info ] [MainThread]: Connection:
[0m00:44:38.161975 [info ] [MainThread]:   host: localhost
[0m00:44:38.162357 [info ] [MainThread]:   port: 5436
[0m00:44:38.162741 [info ] [MainThread]:   user: postgres
[0m00:44:38.163144 [info ] [MainThread]:   database: transformacao_matricula
[0m00:44:38.163512 [info ] [MainThread]:   schema: staging
[0m00:44:38.163830 [info ] [MainThread]:   connect_timeout: 10
[0m00:44:38.164177 [info ] [MainThread]:   role: None
[0m00:44:38.164487 [info ] [MainThread]:   search_path: None
[0m00:44:38.164813 [info ] [MainThread]:   keepalives_idle: 0
[0m00:44:38.165152 [info ] [MainThread]:   sslmode: None
[0m00:44:38.165568 [info ] [MainThread]:   sslcert: None
[0m00:44:38.165990 [info ] [MainThread]:   sslkey: None
[0m00:44:38.166388 [info ] [MainThread]:   sslrootcert: None
[0m00:44:38.166758 [info ] [MainThread]:   application_name: dbt
[0m00:44:38.167161 [info ] [MainThread]:   retries: 1
[0m00:44:38.167716 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m00:44:38.320767 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m00:44:38.361019 [debug] [MainThread]: Using postgres connection "debug"
[0m00:44:38.361558 [debug] [MainThread]: On debug: select 1 as id
[0m00:44:38.361915 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:44:38.382537 [debug] [MainThread]: SQL status: SELECT 1 in 0.021 seconds
[0m00:44:38.383587 [debug] [MainThread]: On debug: Close
[0m00:44:38.384181 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:44:38.384630 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:44:38.385801 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.49455544, "process_in_blocks": "1792", "process_kernel_time": 0.307466, "process_mem_max_rss": "114672", "process_out_blocks": "16", "process_user_time": 1.367624}
[0m00:44:38.386594 [debug] [MainThread]: Command `dbt debug` succeeded at 00:44:38.386448 after 0.50 seconds
[0m00:44:38.387077 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:44:38.387494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d824aaed20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d824ecf860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d8246e9f40>]}
[0m00:44:38.388056 [debug] [MainThread]: Flushing usage events
[0m00:44:38.887768 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:26:27.575999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df6dddac830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df6dd00c260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df6dccba4b0>]}


============================== 01:26:27.579798 | a9fbb043-b5d5-4278-acfb-d62645482c46 ==============================
[0m01:26:27.579798 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:26:27.580437 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'printer_width': '80', 'empty': 'None', 'profiles_dir': '/home/murilo/.dbt', 'use_colors': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug', 'no_print': 'None', 'use_experimental_parser': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'debug': 'False'}
[0m01:26:27.594027 [info ] [MainThread]: dbt version: 1.10.15
[0m01:26:27.594618 [info ] [MainThread]: python version: 3.12.3
[0m01:26:27.595125 [info ] [MainThread]: python path: /home/murilo/UFPE/BD/Grupo7-BancoDeDados/.venv/bin/python
[0m01:26:27.595564 [info ] [MainThread]: os info: Linux-6.14.0-36-generic-x86_64-with-glibc2.39
[0m01:26:27.659492 [info ] [MainThread]: Using profiles dir at /home/murilo/.dbt
[0m01:26:27.660251 [info ] [MainThread]: Using profiles.yml file at /home/murilo/.dbt/profiles.yml
[0m01:26:27.660989 [info ] [MainThread]: Using dbt_project.yml file at /home/murilo/UFPE/BD/Grupo7-BancoDeDados/dbt_project.yml
[0m01:26:27.662084 [info ] [MainThread]: adapter type: postgres
[0m01:26:27.662674 [info ] [MainThread]: adapter version: 1.9.1
[0m01:26:27.752590 [info ] [MainThread]: Configuration:
[0m01:26:27.753116 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:26:27.753482 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:26:27.753826 [info ] [MainThread]: Required dependencies:
[0m01:26:27.754334 [debug] [MainThread]: Executing "git --help"
[0m01:26:27.757054 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:26:27.757787 [debug] [MainThread]: STDERR: "b''"
[0m01:26:27.758436 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:26:27.758855 [info ] [MainThread]: Connection:
[0m01:26:27.759298 [info ] [MainThread]:   host: localhost
[0m01:26:27.759657 [info ] [MainThread]:   port: 5436
[0m01:26:27.759999 [info ] [MainThread]:   user: postgres
[0m01:26:27.760331 [info ] [MainThread]:   database: transformacao_matricula
[0m01:26:27.760650 [info ] [MainThread]:   schema: staging
[0m01:26:27.761095 [info ] [MainThread]:   connect_timeout: 10
[0m01:26:27.761469 [info ] [MainThread]:   role: None
[0m01:26:27.761789 [info ] [MainThread]:   search_path: None
[0m01:26:27.762153 [info ] [MainThread]:   keepalives_idle: 0
[0m01:26:27.762484 [info ] [MainThread]:   sslmode: None
[0m01:26:27.762802 [info ] [MainThread]:   sslcert: None
[0m01:26:27.763142 [info ] [MainThread]:   sslkey: None
[0m01:26:27.763466 [info ] [MainThread]:   sslrootcert: None
[0m01:26:27.763780 [info ] [MainThread]:   application_name: dbt
[0m01:26:27.764109 [info ] [MainThread]:   retries: 1
[0m01:26:27.764603 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:26:27.871051 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m01:26:27.905139 [debug] [MainThread]: Using postgres connection "debug"
[0m01:26:27.905586 [debug] [MainThread]: On debug: select 1 as id
[0m01:26:27.905905 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:26:27.929738 [debug] [MainThread]: SQL status: SELECT 1 in 0.024 seconds
[0m01:26:27.931141 [debug] [MainThread]: On debug: Close
[0m01:26:27.931617 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m01:26:27.932298 [info ] [MainThread]: [32mAll checks passed![0m
[0m01:26:27.934053 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.40710756, "process_in_blocks": "98928", "process_kernel_time": 0.362276, "process_mem_max_rss": "114524", "process_out_blocks": "16", "process_user_time": 1.343147}
[0m01:26:27.934703 [debug] [MainThread]: Command `dbt debug` succeeded at 01:26:27.934606 after 0.41 seconds
[0m01:26:27.935170 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:26:27.935583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df6dc91cef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df6dccba4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df6dc0d18b0>]}
[0m01:26:27.936041 [debug] [MainThread]: Flushing usage events
[0m01:26:28.762226 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:26:37.608331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e28d8a310d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e28d85ff5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e28d844f0b0>]}


============================== 01:26:37.611703 | 5de2e173-9e24-439f-93fc-ba1d470ae1f2 ==============================
[0m01:26:37.611703 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:26:37.612354 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'target_path': 'None', 'no_print': 'None', 'warn_error': 'None', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'partial_parse': 'True', 'debug': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'empty': 'False', 'use_colors': 'True', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'printer_width': '80', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'profiles_dir': '/home/murilo/.dbt', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'indirect_selection': 'eager'}
[0m01:26:37.756419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5de2e173-9e24-439f-93fc-ba1d470ae1f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e28d776bf50>]}
[0m01:26:37.805232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5de2e173-9e24-439f-93fc-ba1d470ae1f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e28d7724920>]}
[0m01:26:37.806129 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:26:37.915359 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m01:26:37.975971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:26:37.976393 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:26:37.980534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5de2e173-9e24-439f-93fc-ba1d470ae1f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e28d6714740>]}
[0m01:26:38.011831 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m01:26:38.013729 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m01:26:38.025290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5de2e173-9e24-439f-93fc-ba1d470ae1f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e28d63993d0>]}
[0m01:26:38.025796 [info ] [MainThread]: Found 459 macros
[0m01:26:38.026193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5de2e173-9e24-439f-93fc-ba1d470ae1f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e28d6f86810>]}
[0m01:26:38.027456 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:26:38.029184 [debug] [MainThread]: Command end result
[0m01:26:38.045266 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m01:26:38.047180 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m01:26:38.050428 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m01:26:38.051518 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.48891246, "process_in_blocks": "3520", "process_kernel_time": 0.282395, "process_mem_max_rss": "111708", "process_out_blocks": "1760", "process_user_time": 1.394014}
[0m01:26:38.052385 [debug] [MainThread]: Command `dbt run` succeeded at 01:26:38.052199 after 0.49 seconds
[0m01:26:38.053135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e28d7df4fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e28d842a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e28d6771df0>]}
[0m01:26:38.053799 [debug] [MainThread]: Flushing usage events
[0m01:26:38.518430 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:35:33.996321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7730c92a38f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7730c9096cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7730c8d17bc0>]}


============================== 01:35:33.999331 | 08ca6d9e-d142-4678-a730-01ef6ec6e9fe ==============================
[0m01:35:33.999331 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:35:33.999917 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'empty': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/home/murilo/.dbt', 'use_colors': 'True', 'fail_fast': 'False', 'no_print': 'None', 'debug': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'static_parser': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'quiet': 'False', 'write_json': 'True', 'target_path': 'None', 'partial_parse': 'True', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'log_format': 'default', 'warn_error': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt debug'}
[0m01:35:34.008167 [info ] [MainThread]: dbt version: 1.10.15
[0m01:35:34.008726 [info ] [MainThread]: python version: 3.12.3
[0m01:35:34.009252 [info ] [MainThread]: python path: /home/murilo/UFPE/BD/Grupo7-BancoDeDados/.venv/bin/python
[0m01:35:34.009680 [info ] [MainThread]: os info: Linux-6.14.0-36-generic-x86_64-with-glibc2.39
[0m01:35:34.062572 [info ] [MainThread]: Using profiles dir at /home/murilo/.dbt
[0m01:35:34.063400 [info ] [MainThread]: Using profiles.yml file at /home/murilo/.dbt/profiles.yml
[0m01:35:34.064173 [info ] [MainThread]: Using dbt_project.yml file at /home/murilo/UFPE/BD/Grupo7-BancoDeDados/dbt_project.yml
[0m01:35:34.065293 [info ] [MainThread]: adapter type: postgres
[0m01:35:34.065980 [info ] [MainThread]: adapter version: 1.9.1
[0m01:35:34.171877 [info ] [MainThread]: Configuration:
[0m01:35:34.172502 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:35:34.172862 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:35:34.173198 [info ] [MainThread]: Required dependencies:
[0m01:35:34.173555 [debug] [MainThread]: Executing "git --help"
[0m01:35:34.175825 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:35:34.176651 [debug] [MainThread]: STDERR: "b''"
[0m01:35:34.177174 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:35:34.177524 [info ] [MainThread]: Connection:
[0m01:35:34.177901 [info ] [MainThread]:   host: localhost
[0m01:35:34.178528 [info ] [MainThread]:   port: 5436
[0m01:35:34.179224 [info ] [MainThread]:   user: postgres
[0m01:35:34.179829 [info ] [MainThread]:   database: transformacao_matricula
[0m01:35:34.180370 [info ] [MainThread]:   schema: staging
[0m01:35:34.180832 [info ] [MainThread]:   connect_timeout: 10
[0m01:35:34.181370 [info ] [MainThread]:   role: None
[0m01:35:34.181898 [info ] [MainThread]:   search_path: None
[0m01:35:34.182482 [info ] [MainThread]:   keepalives_idle: 0
[0m01:35:34.183162 [info ] [MainThread]:   sslmode: None
[0m01:35:34.183752 [info ] [MainThread]:   sslcert: None
[0m01:35:34.184281 [info ] [MainThread]:   sslkey: None
[0m01:35:34.184833 [info ] [MainThread]:   sslrootcert: None
[0m01:35:34.185310 [info ] [MainThread]:   application_name: dbt
[0m01:35:34.185783 [info ] [MainThread]:   retries: 1
[0m01:35:34.186433 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:35:34.296817 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m01:35:34.326298 [debug] [MainThread]: Using postgres connection "debug"
[0m01:35:34.326867 [debug] [MainThread]: On debug: select 1 as id
[0m01:35:34.327466 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:35:34.341510 [debug] [MainThread]: SQL status: SELECT 1 in 0.014 seconds
[0m01:35:34.342746 [debug] [MainThread]: On debug: Close
[0m01:35:34.343332 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m01:35:34.343743 [info ] [MainThread]: [32mAll checks passed![0m
[0m01:35:34.344654 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.39523712, "process_in_blocks": "0", "process_kernel_time": 0.282695, "process_mem_max_rss": "114916", "process_out_blocks": "16", "process_user_time": 1.314582}
[0m01:35:34.345214 [debug] [MainThread]: Command `dbt debug` succeeded at 01:35:34.345130 after 0.40 seconds
[0m01:35:34.345562 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:35:34.345927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7730c8b7b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7730c7957350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7730c84b3710>]}
[0m01:35:34.346351 [debug] [MainThread]: Flushing usage events
[0m01:35:34.890060 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:35:40.848563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f9d00e4140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f9cf38dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f9d0bfc5c0>]}


============================== 01:35:40.851804 | 7c8092ef-6fd5-4154-abd7-dc363138f217 ==============================
[0m01:35:40.851804 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:35:40.852392 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'no_print': 'None', 'warn_error': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'version_check': 'True', 'profiles_dir': '/home/murilo/.dbt', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'use_colors': 'True', 'empty': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'target_path': 'None'}
[0m01:35:40.994205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c8092ef-6fd5-4154-abd7-dc363138f217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f9d1867bf0>]}
[0m01:35:41.044583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c8092ef-6fd5-4154-abd7-dc363138f217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f9ce51ca10>]}
[0m01:35:41.045623 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:35:41.153726 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m01:35:41.186210 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:35:41.186715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7c8092ef-6fd5-4154-abd7-dc363138f217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f9cd951be0>]}
[0m01:35:41.882159 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.transformacao_matricula.dimensions
- models.transformacao_matricula.intermediate
- models.transformacao_matricula.facts
- models.transformacao_matricula.marts
- models.transformacao_matricula.staging
[0m01:35:41.886447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c8092ef-6fd5-4154-abd7-dc363138f217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f9cd9de3c0>]}
[0m01:35:41.921756 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m01:35:41.923628 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m01:35:41.937618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c8092ef-6fd5-4154-abd7-dc363138f217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f9ce548bc0>]}
[0m01:35:41.938206 [info ] [MainThread]: Found 459 macros
[0m01:35:41.938580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c8092ef-6fd5-4154-abd7-dc363138f217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f9cefc8f50>]}
[0m01:35:41.940071 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:35:41.940768 [debug] [MainThread]: Command end result
[0m01:35:41.958731 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m01:35:41.961468 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m01:35:41.967174 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m01:35:41.968578 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1660614, "process_in_blocks": "0", "process_kernel_time": 0.278222, "process_mem_max_rss": "111616", "process_out_blocks": "2632", "process_user_time": 2.097676}
[0m01:35:41.969640 [debug] [MainThread]: Command `dbt run` succeeded at 01:35:41.969480 after 1.17 seconds
[0m01:35:41.970312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f9d002e6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f9ce51fda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77f9cdd50290>]}
[0m01:35:41.970949 [debug] [MainThread]: Flushing usage events
[0m01:35:42.571419 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:36:29.915775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711dfda45100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711dfd9c6c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711dfd87b5f0>]}


============================== 01:36:29.919499 | 38aa251a-51c3-471f-a777-335fbf031c8e ==============================
[0m01:36:29.919499 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:36:29.920097 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/murilo/.dbt', 'quiet': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'log_format': 'default', 'empty': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'write_json': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'debug': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'cache_selected_only': 'False', 'invocation_command': 'dbt test', 'version_check': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'static_parser': 'True'}
[0m01:36:30.070613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38aa251a-51c3-471f-a777-335fbf031c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711dfc9e2390>]}
[0m01:36:30.120148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38aa251a-51c3-471f-a777-335fbf031c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711dfc79ce60>]}
[0m01:36:30.120980 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:36:30.233688 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m01:36:30.283120 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:36:30.283569 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:36:30.284190 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.transformacao_matricula.intermediate
- models.transformacao_matricula.marts
- models.transformacao_matricula.dimensions
- models.transformacao_matricula.facts
- models.transformacao_matricula.staging
[0m01:36:30.288285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38aa251a-51c3-471f-a777-335fbf031c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711dfbf41e50>]}
[0m01:36:30.333804 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m01:36:30.336886 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m01:36:30.361826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38aa251a-51c3-471f-a777-335fbf031c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711dfafa2060>]}
[0m01:36:30.362840 [info ] [MainThread]: Found 459 macros
[0m01:36:30.363271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38aa251a-51c3-471f-a777-335fbf031c8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711dfb743da0>]}
[0m01:36:30.364894 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:36:30.366633 [debug] [MainThread]: Command end result
[0m01:36:30.381994 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m01:36:30.384165 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m01:36:30.389113 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m01:36:30.390892 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5374569, "process_in_blocks": "1128", "process_kernel_time": 0.271137, "process_mem_max_rss": "112980", "process_out_blocks": "1768", "process_user_time": 1.469324}
[0m01:36:30.391934 [debug] [MainThread]: Command `dbt test` succeeded at 01:36:30.391750 after 0.54 seconds
[0m01:36:30.392508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711dfc9abaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711dfd9ef320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x711dff560fb0>]}
[0m01:36:30.393060 [debug] [MainThread]: Flushing usage events
[0m01:36:30.863769 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:37:27.233314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd040edc650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd040cb0380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd040727980>]}


============================== 01:37:27.236202 | 272316e4-aa29-4e6a-846d-c53f0cddf0bc ==============================
[0m01:37:27.236202 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:37:27.236749 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'version_check': 'True', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'write_json': 'True', 'introspect': 'True', 'quiet': 'False', 'fail_fast': 'False', 'profiles_dir': '/home/murilo/.dbt', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'debug': 'False', 'printer_width': '80', 'empty': 'False', 'partial_parse': 'True', 'target_path': 'None', 'warn_error': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'static_parser': 'True'}
[0m01:37:27.387539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '272316e4-aa29-4e6a-846d-c53f0cddf0bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd03faba1e0>]}
[0m01:37:27.463142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '272316e4-aa29-4e6a-846d-c53f0cddf0bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd040366a20>]}
[0m01:37:27.464793 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:37:27.615093 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m01:37:27.681300 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:37:27.681996 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:37:27.682901 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 5 unused configuration paths:
- models.transformacao_matricula.marts
- models.transformacao_matricula.intermediate
- models.transformacao_matricula.dimensions
- models.transformacao_matricula.staging
- models.transformacao_matricula.facts
[0m01:37:27.689922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '272316e4-aa29-4e6a-846d-c53f0cddf0bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd03f32fdd0>]}
[0m01:37:27.746357 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m01:37:27.748930 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m01:37:27.764479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '272316e4-aa29-4e6a-846d-c53f0cddf0bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd03ebe1b80>]}
[0m01:37:27.765287 [info ] [MainThread]: Found 459 macros
[0m01:37:27.765735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '272316e4-aa29-4e6a-846d-c53f0cddf0bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd03ef4a3f0>]}
[0m01:37:27.767686 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:37:27.769697 [debug] [MainThread]: Command end result
[0m01:37:27.792213 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m01:37:27.795442 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m01:37:27.801081 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m01:37:27.803331 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6304527, "process_in_blocks": "0", "process_kernel_time": 0.338215, "process_mem_max_rss": "111704", "process_out_blocks": "1768", "process_user_time": 1.901346}
[0m01:37:27.804607 [debug] [MainThread]: Command `dbt run` succeeded at 01:37:27.804379 after 0.63 seconds
[0m01:37:27.805431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd04031d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd03eb43cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd03eb426c0>]}
[0m01:37:27.806256 [debug] [MainThread]: Flushing usage events
[0m01:37:28.374713 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:40:22.234815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763057068e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7630572fff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763058a429f0>]}


============================== 01:40:22.238382 | 7df7d115-96cd-4f71-9192-f409d68f3cbd ==============================
[0m01:40:22.238382 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:40:22.238970 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'partial_parse': 'True', 'profiles_dir': '/home/murilo/.dbt', 'printer_width': '80', 'version_check': 'True', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'cache_selected_only': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'no_print': 'None', 'use_colors': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt run'}
[0m01:40:22.378522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7df7d115-96cd-4f71-9192-f409d68f3cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76305555b560>]}
[0m01:40:22.429524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7df7d115-96cd-4f71-9192-f409d68f3cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7630560f1100>]}
[0m01:40:22.430374 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:40:22.539455 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m01:40:22.571902 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:40:22.572406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7df7d115-96cd-4f71-9192-f409d68f3cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763054939e20>]}
[0m01:40:23.788354 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.transformacao_matricula.intermediate
- models.transformacao_matricula.dimensions
- models.transformacao_matricula.facts
[0m01:40:23.796396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7df7d115-96cd-4f71-9192-f409d68f3cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7630549fc140>]}
[0m01:40:23.872695 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m01:40:23.874830 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m01:40:23.886989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7df7d115-96cd-4f71-9192-f409d68f3cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763055589c40>]}
[0m01:40:23.887519 [info ] [MainThread]: Found 13 models, 2 data tests, 1 source, 459 macros
[0m01:40:23.887909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7df7d115-96cd-4f71-9192-f409d68f3cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763055edeb40>]}
[0m01:40:23.892281 [info ] [MainThread]: 
[0m01:40:23.892917 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m01:40:23.893400 [info ] [MainThread]: 
[0m01:40:23.894094 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:40:23.899418 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula'
[0m01:40:23.951215 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m01:40:23.952424 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m01:40:23.953683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:23.976185 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.022 seconds
[0m01:40:23.979406 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m01:40:23.984126 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m01:40:23.985241 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m01:40:23.986162 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:40:24.002732 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.016 seconds
[0m01:40:24.005162 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m01:40:24.007749 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula, now create_transformacao_matricula_staging_marts)
[0m01:40:24.009146 [debug] [ThreadPool]: Creating schema "database: "transformacao_matricula"
schema: "staging_marts"
"
[0m01:40:24.016505 [debug] [ThreadPool]: Using postgres connection "create_transformacao_matricula_staging_marts"
[0m01:40:24.017496 [debug] [ThreadPool]: On create_transformacao_matricula_staging_marts: BEGIN
[0m01:40:24.018346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:40:24.029018 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m01:40:24.029562 [debug] [ThreadPool]: Using postgres connection "create_transformacao_matricula_staging_marts"
[0m01:40:24.029988 [debug] [ThreadPool]: On create_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "create_transformacao_matricula_staging_marts"} */
create schema if not exists "staging_marts"
[0m01:40:24.032041 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m01:40:24.033260 [debug] [ThreadPool]: On create_transformacao_matricula_staging_marts: COMMIT
[0m01:40:24.033706 [debug] [ThreadPool]: Using postgres connection "create_transformacao_matricula_staging_marts"
[0m01:40:24.034093 [debug] [ThreadPool]: On create_transformacao_matricula_staging_marts: COMMIT
[0m01:40:24.036016 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m01:40:24.036727 [debug] [ThreadPool]: On create_transformacao_matricula_staging_marts: Close
[0m01:40:24.038102 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_transformacao_matricula_staging_marts, now create_transformacao_matricula_staging_staging)
[0m01:40:24.039690 [debug] [ThreadPool]: Creating schema "database: "transformacao_matricula"
schema: "staging_staging"
"
[0m01:40:24.043825 [debug] [ThreadPool]: Using postgres connection "create_transformacao_matricula_staging_staging"
[0m01:40:24.044529 [debug] [ThreadPool]: On create_transformacao_matricula_staging_staging: BEGIN
[0m01:40:24.044997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:40:24.055311 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m01:40:24.055812 [debug] [ThreadPool]: Using postgres connection "create_transformacao_matricula_staging_staging"
[0m01:40:24.056199 [debug] [ThreadPool]: On create_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "create_transformacao_matricula_staging_staging"} */
create schema if not exists "staging_staging"
[0m01:40:24.057720 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m01:40:24.058722 [debug] [ThreadPool]: On create_transformacao_matricula_staging_staging: COMMIT
[0m01:40:24.059135 [debug] [ThreadPool]: Using postgres connection "create_transformacao_matricula_staging_staging"
[0m01:40:24.059527 [debug] [ThreadPool]: On create_transformacao_matricula_staging_staging: COMMIT
[0m01:40:24.061149 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m01:40:24.061564 [debug] [ThreadPool]: On create_transformacao_matricula_staging_staging: Close
[0m01:40:24.063399 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_transformacao_matricula_staging_staging, now list_transformacao_matricula_staging_marts)
[0m01:40:24.068536 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m01:40:24.069005 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: BEGIN
[0m01:40:24.069314 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:40:24.077616 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m01:40:24.078227 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m01:40:24.078737 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_marts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m01:40:24.083612 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m01:40:24.084734 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: ROLLBACK
[0m01:40:24.085416 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: Close
[0m01:40:24.086007 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_marts, now list_transformacao_matricula_staging_staging)
[0m01:40:24.087902 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m01:40:24.088371 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: BEGIN
[0m01:40:24.088671 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:40:24.097443 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m01:40:24.098296 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m01:40:24.098632 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_staging"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m01:40:24.101732 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m01:40:24.102972 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: ROLLBACK
[0m01:40:24.103703 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: Close
[0m01:40:24.108110 [debug] [MainThread]: Using postgres connection "master"
[0m01:40:24.108566 [debug] [MainThread]: On master: BEGIN
[0m01:40:24.108910 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:40:24.118062 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m01:40:24.118629 [debug] [MainThread]: Using postgres connection "master"
[0m01:40:24.119014 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:40:24.122743 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m01:40:24.124247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7df7d115-96cd-4f71-9192-f409d68f3cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763055fd87d0>]}
[0m01:40:24.124810 [debug] [MainThread]: On master: ROLLBACK
[0m01:40:24.125516 [debug] [MainThread]: Using postgres connection "master"
[0m01:40:24.125900 [debug] [MainThread]: On master: BEGIN
[0m01:40:24.126811 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:40:24.127226 [debug] [MainThread]: On master: COMMIT
[0m01:40:24.127543 [debug] [MainThread]: Using postgres connection "master"
[0m01:40:24.127855 [debug] [MainThread]: On master: COMMIT
[0m01:40:24.128451 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:40:24.128943 [debug] [MainThread]: On master: Close
[0m01:40:24.132224 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.staging_situacao_alunos
[0m01:40:24.133580 [info ] [Thread-1 (]: 1 of 13 START sql table model staging_staging.staging_situacao_alunos .......... [RUN]
[0m01:40:24.134718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_staging, now model.transformacao_matricula.staging_situacao_alunos)
[0m01:40:24.135359 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.staging_situacao_alunos
[0m01:40:24.141639 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.staging_situacao_alunos"
[0m01:40:24.142504 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.staging_situacao_alunos
[0m01:40:24.183197 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.staging_situacao_alunos"
[0m01:40:24.184132 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m01:40:24.184538 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: BEGIN
[0m01:40:24.184911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:40:24.195188 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:40:24.195703 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m01:40:24.196174 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */

  
    

  create  table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp"
  
  
    as
  
  (
    WITH source AS (
	SELECT * FROM "transformacao_matricula"."staging"."staging_alunos_raw"
),

cleaning_renaming AS (
	SELECT
		ano,
		codigo_escola,
		matricula,
		escola AS nome_escola,
		endereco_logradouro AS endereco_logra,
	 	endereco_bairro,
		endereco_numero,
		rpa,
		modalidade_ensino_codigo AS mod_ens_codigo,
		-- Transformação da SÉRIE
		CASE
		    -- Ensino Fundamental (1º ao 9º)
		    WHEN serie LIKE '%1 ANO%' OR serie LIKE '%1º ANO%' THEN '1º ANO'
		    WHEN serie LIKE '%2 ANO%' OR serie LIKE '%2º ANO%' THEN '2º ANO'
		    WHEN serie LIKE '%3 ANO%' OR serie LIKE '%3º ANO%' THEN '3º ANO'
		    WHEN serie LIKE '%4 ANO%' OR serie LIKE '%4º ANO%' THEN '4º ANO'
		    WHEN serie LIKE '%5 ANO%' OR serie LIKE '%5º ANO%' THEN '5º ANO'
		    WHEN serie LIKE '%6 ANO%' OR serie LIKE '%6º ANO%' THEN '6º ANO'
		    WHEN serie LIKE '%7 ANO%' OR serie LIKE '%7º ANO%' THEN '7º ANO'
		    WHEN serie LIKE '%8 ANO%' OR serie LIKE '%8º ANO%' THEN '8º ANO'
		    WHEN serie LIKE '%9 ANO%' OR serie LIKE '%9º ANO%' THEN '9º ANO'

		    -- Educação Infantil (Berçário e Grupos)
		    WHEN serie LIKE '%BER%' THEN 'BERÇARIO' -- Pega BERÇARIO e BERRIO
		    WHEN serie LIKE '%GRUPO I%' OR serie LIKE '%GRUPO 1%' THEN 'GRUPO I'
		    WHEN serie LIKE '%GRUPO II%' THEN 'GRUPO II'
		    WHEN serie LIKE '%GRUPO III%' THEN 'GRUPO III'
		    WHEN serie LIKE '%GRUPO IV%' THEN 'GRUPO IV'
		    WHEN serie LIKE '%GRUPO V%' THEN 'GRUPO V'

		    -- EJA (Módulos 1 ao 5) 
		    WHEN serie LIKE '%1%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 1'
		    WHEN serie LIKE '%2%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 2'
		    WHEN serie LIKE '%3%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 3'
		    WHEN serie LIKE '%4%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 4'
		    WHEN serie LIKE '%5%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 5'

		    WHEN serie LIKE '%TRAVESSIA%' THEN 'TRAVESSIA RECIFE'
		    WHEN serie LIKE '%CORRECAO%1%' THEN 'CORREÇÃO DE FLUXO 1 - ALFABETIZACAO'
		    WHEN serie LIKE '%CORRECAO%2%' THEN 'CORREÇÃO DE FLUXO 2 - ACELERACAO'

		    ELSE 'OUTROS'
		END AS serie,
		turma,
		turno,
		matricula,
		idade,

		-- transformação do SEXO
		CASE
		    WHEN sexo = 1 THEN 'Masculino',
	 	    WHEN sexo = 2 THEN 'Feminino',
		    WHEN sexo = 3 THEN 'Outros',				
		    ELSE 'Não informado' -- Para cobrir valores inesperados
		END AS sexo,

		idade,
		-- transformação de situacao
		CASE 
		    WHEN situacao_nome LIKE '%APROV%' THEN 'Aprovado',
		    WHEN situacao_nome LIKE '%RET%' OR situacao_nome LIKE '%REPRO%' THEN 'Reprovado',
		    WHEN situacao_nome LIKE '%TR%' OR situacao_nome LIKE '%REMAN%' THEN 'Transferido',
		    WHEN situacao_nome LIKE '%DESIST%' THEN 'Desistente'
		END AS sit_nome,

		-- Transformação da MODALIDADE
		CASE
		    WHEN modalidade_ensino LIKE '%EDUCACAO INFANTIL%' THEN 'EDUCAÇÃO INFANTIL'
		    WHEN modalidade_ensino LIKE '%ENSINO FUNDAMENTAL%' THEN 'ENSINO FUNDAMENTAL'
		    WHEN modalidade_ensino LIKE '%EDUCACAO JOVENS E ADULTOS%' THEN 'EJA'
		    WHEN modalidade_ensino LIKE '%CORRE%' THEN 'CORREÇÃO DE FLUXO' -- Pega "CORREÇÃO" e "CORREO"
		    ELSE 'OUTROS'
		END AS modalidade_ens,

		
	FROM source
)

SELECT * FROM cleaning_renaming
  );
  
[0m01:40:24.197824 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 68:       WHEN sexo = 1 THEN 'Masculino',
                                             ^

[0m01:40:24.198721 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: ROLLBACK
[0m01:40:24.199900 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: Close
[0m01:40:24.206055 [debug] [Thread-1 (]: Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  syntax error at or near ","
  LINE 68:       WHEN sexo = 1 THEN 'Masculino',
                                               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m01:40:24.208186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df7d115-96cd-4f71-9192-f409d68f3cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763056e809b0>]}
[0m01:40:24.209071 [error] [Thread-1 (]: 1 of 13 ERROR creating sql table model staging_staging.staging_situacao_alunos . [[31mERROR[0m in 0.07s]
[0m01:40:24.209837 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.staging_situacao_alunos
[0m01:40:24.210325 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_count_aluno_idade
[0m01:40:24.210977 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.staging_situacao_alunos' to be skipped because of status 'error'.  Reason: Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  syntax error at or near ","
  LINE 68:       WHEN sexo = 1 THEN 'Masculino',
                                               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql.
[0m01:40:24.211570 [info ] [Thread-1 (]: 2 of 13 START sql view model staging_marts.view_count_aluno_idade .............. [RUN]
[0m01:40:24.213138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.staging_situacao_alunos, now model.transformacao_matricula.view_count_aluno_idade)
[0m01:40:24.213635 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_count_aluno_idade
[0m01:40:24.216711 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_count_aluno_idade"
[0m01:40:24.217660 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_count_aluno_idade
[0m01:40:24.244170 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_count_aluno_idade"
[0m01:40:24.245275 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m01:40:24.245896 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: BEGIN
[0m01:40:24.246430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:40:24.258557 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m01:40:24.260928 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m01:40:24.262118 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_count_aluno_idade"} */

  create view "transformacao_matricula"."staging_marts"."view_count_aluno_idade__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dl.desc_rpa,
    da.faixa_etaria,
    COUNT(fm.matricula) AS total_alunos
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
ORDER BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria;
  );
[0m01:40:24.263557 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 24:     dtemp.ano, dl.desc_rpa, da.faixa_etaria;
                                                    ^

[0m01:40:24.264201 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: ROLLBACK
[0m01:40:24.265210 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: Close
[0m01:40:24.267904 [debug] [Thread-1 (]: Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  syntax error at or near ";"
  LINE 24:     dtemp.ano, dl.desc_rpa, da.faixa_etaria;
                                                      ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m01:40:24.268836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df7d115-96cd-4f71-9192-f409d68f3cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763050c8ffe0>]}
[0m01:40:24.269773 [error] [Thread-1 (]: 2 of 13 ERROR creating sql view model staging_marts.view_count_aluno_idade ..... [[31mERROR[0m in 0.06s]
[0m01:40:24.270625 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_count_aluno_idade
[0m01:40:24.271213 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m01:40:24.271823 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_count_aluno_idade' to be skipped because of status 'error'.  Reason: Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  syntax error at or near ";"
  LINE 24:     dtemp.ano, dl.desc_rpa, da.faixa_etaria;
                                                      ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql.
[0m01:40:24.272548 [info ] [Thread-1 (]: 3 of 13 START sql view model staging_marts.view_frequencia_situacao_escola ..... [RUN]
[0m01:40:24.273603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_count_aluno_idade, now model.transformacao_matricula.view_frequencia_situacao_escola)
[0m01:40:24.274284 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_frequencia_situacao_escola
[0m01:40:24.277841 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m01:40:24.278700 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_frequencia_situacao_escola
[0m01:40:24.282346 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m01:40:24.283212 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m01:40:24.283707 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: BEGIN
[0m01:40:24.284163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:40:24.296360 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m01:40:24.297416 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m01:40:24.298402 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_frequencia_situacao_escola"} */

  create view "transformacao_matricula"."staging_marts"."view_frequencia_situacao_escola__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    de.nome_escola,
    de.codigo_escola,
    ds.situacao_nome,
    COUNT(fm.matricula) AS contagem_situacao
FROM
    fato_matricula fm
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, de.nome_escola, de.codigo_escola, ds.situacao_nome
ORDER BY
    dtemp.ano, de.nome_escola, contagem_situacao DESC;
  );
[0m01:40:24.300570 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 25:     dtemp.ano, de.nome_escola, contagem_situacao DESC;
                                                              ^

[0m01:40:24.301380 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: ROLLBACK
[0m01:40:24.302595 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: Close
[0m01:40:24.306726 [debug] [Thread-1 (]: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  syntax error at or near ";"
  LINE 25:     dtemp.ano, de.nome_escola, contagem_situacao DESC;
                                                                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m01:40:24.308167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df7d115-96cd-4f71-9192-f409d68f3cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763050cacce0>]}
[0m01:40:24.309469 [error] [Thread-1 (]: 3 of 13 ERROR creating sql view model staging_marts.view_frequencia_situacao_escola  [[31mERROR[0m in 0.03s]
[0m01:40:24.311068 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m01:40:24.311938 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_matricula_detalhada
[0m01:40:24.312870 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_frequencia_situacao_escola' to be skipped because of status 'error'.  Reason: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  syntax error at or near ";"
  LINE 25:     dtemp.ano, de.nome_escola, contagem_situacao DESC;
                                                                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql.
[0m01:40:24.313930 [info ] [Thread-1 (]: 4 of 13 START sql view model staging_marts.view_matricula_detalhada ............ [RUN]
[0m01:40:24.315328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_frequencia_situacao_escola, now model.transformacao_matricula.view_matricula_detalhada)
[0m01:40:24.316333 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_matricula_detalhada
[0m01:40:24.320522 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_matricula_detalhada"
[0m01:40:24.321611 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_matricula_detalhada
[0m01:40:24.326632 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_matricula_detalhada"
[0m01:40:24.329048 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m01:40:24.329811 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: BEGIN
[0m01:40:24.330863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:40:24.343753 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m01:40:24.344446 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m01:40:24.345218 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_matricula_detalhada"} */

  create view "transformacao_matricula"."staging_marts"."view_matricula_detalhada__dbt_tmp"
    
    
  as (
    
SELECT
    fm.matricula,
    da.sexo,
    da.idade,
    da.faixa_etaria,
    de.nome_escola,
    de.codigo_escola,
    dt.turma,
    dt.turno,
    dt.serie,
    dt.modalidade_ensino,
    ds.situacao_nome,
    ds.categoria AS categoria_situacao,
    ds.eh_aprovado,
    ds.eh_reprovado,
    dl.desc_rpa,
    dl.endereco_bairro AS bairro_localizacao,
    dtemp.ano AS ano_registro
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo;
  );
[0m01:40:24.346620 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 39:     dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo;
                                                            ^

[0m01:40:24.347429 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: ROLLBACK
[0m01:40:24.349480 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: Close
[0m01:40:24.353489 [debug] [Thread-1 (]: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  syntax error at or near ";"
  LINE 39:     dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo;
                                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m01:40:24.354953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df7d115-96cd-4f71-9192-f409d68f3cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7630502f9ca0>]}
[0m01:40:24.356389 [error] [Thread-1 (]: 4 of 13 ERROR creating sql view model staging_marts.view_matricula_detalhada ... [[31mERROR[0m in 0.04s]
[0m01:40:24.357228 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_matricula_detalhada
[0m01:40:24.358087 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_taxa_aprovados
[0m01:40:24.359423 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_matricula_detalhada' to be skipped because of status 'error'.  Reason: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  syntax error at or near ";"
  LINE 39:     dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo;
                                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql.
[0m01:40:24.361828 [info ] [Thread-1 (]: 5 of 13 START sql view model staging_marts.view_taxa_aprovados ................. [RUN]
[0m01:40:24.362824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_matricula_detalhada, now model.transformacao_matricula.view_taxa_aprovados)
[0m01:40:24.363370 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_taxa_aprovados
[0m01:40:24.366476 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_taxa_aprovados"
[0m01:40:24.367423 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_taxa_aprovados
[0m01:40:24.373279 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_taxa_aprovados"
[0m01:40:24.374193 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m01:40:24.374741 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: BEGIN
[0m01:40:24.375397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:40:24.388835 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m01:40:24.389698 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m01:40:24.390534 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_taxa_aprovados"} */

  create view "transformacao_matricula"."staging_marts"."view_taxa_aprovados__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dt.modalidade_ensino,
    COUNT(fm.matricula) AS total_matriculas,
    SUM(ds.eh_aprovado) AS total_aprovados,
    SUM(ds.eh_reprovado) AS total_reprovados,
    -- Calcula a taxa de aprovação (como porcentagem)
    CAST(SUM(ds.eh_aprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_aprovacao_percentual,
    -- Calcula a taxa de reprovação (como porcentagem)
    CAST(SUM(ds.eh_reprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_reprovacao_percentual
FROM
    fato_matricula fm
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dt.modalidade_ensino
ORDER BY
    dtemp.ano, dt.modalidade_ensino;
  );
[0m01:40:24.392566 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 29:     dtemp.ano, dt.modalidade_ensino;
                                            ^

[0m01:40:24.394729 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: ROLLBACK
[0m01:40:24.396273 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: Close
[0m01:40:24.400574 [debug] [Thread-1 (]: Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  syntax error at or near ";"
  LINE 29:     dtemp.ano, dt.modalidade_ensino;
                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m01:40:24.401980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df7d115-96cd-4f71-9192-f409d68f3cbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76305033bef0>]}
[0m01:40:24.403376 [error] [Thread-1 (]: 5 of 13 ERROR creating sql view model staging_marts.view_taxa_aprovados ........ [[31mERROR[0m in 0.04s]
[0m01:40:24.405010 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_taxa_aprovados
[0m01:40:24.405807 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_aluno
[0m01:40:24.407128 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_taxa_aprovados' to be skipped because of status 'error'.  Reason: Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  syntax error at or near ";"
  LINE 29:     dtemp.ano, dt.modalidade_ensino;
                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql.
[0m01:40:24.407879 [info ] [Thread-1 (]: 6 of 13 SKIP relation staging_marts.dim_aluno .................................. [[33mSKIP[0m]
[0m01:40:24.408958 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_aluno
[0m01:40:24.409620 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.transform_data
[0m01:40:24.410522 [info ] [Thread-1 (]: 7 of 13 SKIP relation staging_marts.transform_data ............................. [[33mSKIP[0m]
[0m01:40:24.411582 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.transform_data
[0m01:40:24.413582 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_escola
[0m01:40:24.414525 [info ] [Thread-1 (]: 8 of 13 SKIP relation staging_marts.dim_escola ................................. [[33mSKIP[0m]
[0m01:40:24.415457 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_escola
[0m01:40:24.416519 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_localizacao
[0m01:40:24.417796 [info ] [Thread-1 (]: 9 of 13 SKIP relation staging_marts.dim_localizacao ............................ [[33mSKIP[0m]
[0m01:40:24.418533 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_localizacao
[0m01:40:24.419040 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_situacao
[0m01:40:24.419638 [info ] [Thread-1 (]: 10 of 13 SKIP relation staging_marts.dim_situacao .............................. [[33mSKIP[0m]
[0m01:40:24.420256 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_situacao
[0m01:40:24.420916 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_tempo
[0m01:40:24.421647 [info ] [Thread-1 (]: 11 of 13 SKIP relation staging_marts.dim_tempo ................................. [[33mSKIP[0m]
[0m01:40:24.422522 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_tempo
[0m01:40:24.423396 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_turma
[0m01:40:24.424415 [info ] [Thread-1 (]: 12 of 13 SKIP relation staging_marts.dim_turma ................................. [[33mSKIP[0m]
[0m01:40:24.425593 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_turma
[0m01:40:24.428302 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.fato_matricula
[0m01:40:24.429154 [info ] [Thread-1 (]: 13 of 13 SKIP relation staging_marts.fato_matricula ............................ [[33mSKIP[0m]
[0m01:40:24.430111 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.fato_matricula
[0m01:40:24.433413 [debug] [MainThread]: Using postgres connection "master"
[0m01:40:24.434417 [debug] [MainThread]: On master: BEGIN
[0m01:40:24.435081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:40:24.450138 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m01:40:24.450784 [debug] [MainThread]: On master: COMMIT
[0m01:40:24.451349 [debug] [MainThread]: Using postgres connection "master"
[0m01:40:24.452029 [debug] [MainThread]: On master: COMMIT
[0m01:40:24.452959 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:40:24.453527 [debug] [MainThread]: On master: Close
[0m01:40:24.454827 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:40:24.455594 [debug] [MainThread]: Connection 'model.transformacao_matricula.view_taxa_aprovados' was properly closed.
[0m01:40:24.456415 [info ] [MainThread]: 
[0m01:40:24.457351 [info ] [MainThread]: Finished running 9 table models, 4 view models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m01:40:24.460331 [debug] [MainThread]: Command end result
[0m01:40:24.502098 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m01:40:24.504472 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m01:40:24.512529 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m01:40:24.513168 [info ] [MainThread]: 
[0m01:40:24.513735 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m01:40:24.514247 [info ] [MainThread]: 
[0m01:40:24.515062 [error] [MainThread]: [31mFailure in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)[0m
[0m01:40:24.515689 [error] [MainThread]:   Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  syntax error at or near ","
  LINE 68:       WHEN sexo = 1 THEN 'Masculino',
                                               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m01:40:24.516171 [info ] [MainThread]: 
[0m01:40:24.516694 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m01:40:24.517237 [info ] [MainThread]: 
[0m01:40:24.517922 [error] [MainThread]: [31mFailure in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)[0m
[0m01:40:24.518738 [error] [MainThread]:   Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  syntax error at or near ";"
  LINE 24:     dtemp.ano, dl.desc_rpa, da.faixa_etaria;
                                                      ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m01:40:24.519503 [info ] [MainThread]: 
[0m01:40:24.520205 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m01:40:24.520719 [info ] [MainThread]: 
[0m01:40:24.521321 [error] [MainThread]: [31mFailure in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)[0m
[0m01:40:24.521948 [error] [MainThread]:   Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  syntax error at or near ";"
  LINE 25:     dtemp.ano, de.nome_escola, contagem_situacao DESC;
                                                                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m01:40:24.522378 [info ] [MainThread]: 
[0m01:40:24.522888 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m01:40:24.523351 [info ] [MainThread]: 
[0m01:40:24.523834 [error] [MainThread]: [31mFailure in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)[0m
[0m01:40:24.524330 [error] [MainThread]:   Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  syntax error at or near ";"
  LINE 39:     dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo;
                                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m01:40:24.524731 [info ] [MainThread]: 
[0m01:40:24.525260 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m01:40:24.525724 [info ] [MainThread]: 
[0m01:40:24.527318 [error] [MainThread]: [31mFailure in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)[0m
[0m01:40:24.528718 [error] [MainThread]:   Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  syntax error at or near ";"
  LINE 29:     dtemp.ano, dt.modalidade_ensino;
                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m01:40:24.529450 [info ] [MainThread]: 
[0m01:40:24.530178 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m01:40:24.530768 [info ] [MainThread]: 
[0m01:40:24.531515 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=8 NO-OP=0 TOTAL=13
[0m01:40:24.533092 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.3461847, "process_in_blocks": "1152", "process_kernel_time": 0.325691, "process_mem_max_rss": "129100", "process_out_blocks": "3168", "process_user_time": 3.124042}
[0m01:40:24.534098 [debug] [MainThread]: Command `dbt run` failed at 01:40:24.533905 after 2.35 seconds
[0m01:40:24.534939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7630566f16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763055532a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7630541d3cb0>]}
[0m01:40:24.535929 [debug] [MainThread]: Flushing usage events
[0m01:40:25.174821 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:41:04.137806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e24ea094590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e24e97bfe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e24eb397bc0>]}


============================== 01:41:04.140695 | a501e46d-d461-4fbe-bc09-1eb69e311bca ==============================
[0m01:41:04.140695 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:41:04.141240 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/home/murilo/.dbt', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'no_print': 'None', 'target_path': 'None', 'quiet': 'False', 'empty': 'None', 'debug': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_format': 'default', 'version_check': 'True', 'static_parser': 'True', 'warn_error': 'None', 'invocation_command': 'dbt test', 'fail_fast': 'False'}
[0m01:41:04.296674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a501e46d-d461-4fbe-bc09-1eb69e311bca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e24e8d203b0>]}
[0m01:41:04.346878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a501e46d-d461-4fbe-bc09-1eb69e311bca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e24e933e3f0>]}
[0m01:41:04.347812 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:41:04.464307 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m01:41:04.555999 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:41:04.556430 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:41:04.562281 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.transformacao_matricula.intermediate
- models.transformacao_matricula.facts
- models.transformacao_matricula.dimensions
[0m01:41:04.605385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a501e46d-d461-4fbe-bc09-1eb69e311bca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e24e85f3a70>]}
[0m01:41:04.681946 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m01:41:04.685824 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m01:41:04.707563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a501e46d-d461-4fbe-bc09-1eb69e311bca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e24e7127590>]}
[0m01:41:04.708106 [info ] [MainThread]: Found 13 models, 2 data tests, 1 source, 459 macros
[0m01:41:04.708488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a501e46d-d461-4fbe-bc09-1eb69e311bca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e24e8504080>]}
[0m01:41:04.710292 [info ] [MainThread]: 
[0m01:41:04.710959 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m01:41:04.711326 [info ] [MainThread]: 
[0m01:41:04.711820 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:41:04.715604 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula_staging_marts'
[0m01:41:04.763437 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m01:41:04.764083 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: BEGIN
[0m01:41:04.764537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:41:04.776662 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m01:41:04.777189 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m01:41:04.777542 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_marts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m01:41:04.780623 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m01:41:04.782157 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: ROLLBACK
[0m01:41:04.784456 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: Close
[0m01:41:04.785561 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_marts, now list_transformacao_matricula_staging_staging)
[0m01:41:04.787808 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m01:41:04.788269 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: BEGIN
[0m01:41:04.788585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:41:04.797589 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m01:41:04.798128 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m01:41:04.798866 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_staging"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m01:41:04.802392 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m01:41:04.803881 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: ROLLBACK
[0m01:41:04.804709 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: Close
[0m01:41:04.810614 [debug] [MainThread]: Using postgres connection "master"
[0m01:41:04.811075 [debug] [MainThread]: On master: BEGIN
[0m01:41:04.811379 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:41:04.824231 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m01:41:04.824758 [debug] [MainThread]: Using postgres connection "master"
[0m01:41:04.825199 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:41:04.829877 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m01:41:04.831149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a501e46d-d461-4fbe-bc09-1eb69e311bca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e24e7571460>]}
[0m01:41:04.831774 [debug] [MainThread]: On master: ROLLBACK
[0m01:41:04.832752 [debug] [MainThread]: Using postgres connection "master"
[0m01:41:04.833242 [debug] [MainThread]: On master: BEGIN
[0m01:41:04.834145 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:41:04.834551 [debug] [MainThread]: On master: COMMIT
[0m01:41:04.834886 [debug] [MainThread]: Using postgres connection "master"
[0m01:41:04.835192 [debug] [MainThread]: On master: COMMIT
[0m01:41:04.835791 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:41:04.836216 [debug] [MainThread]: On master: Close
[0m01:41:04.838815 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf
[0m01:41:04.839491 [info ] [Thread-1 (]: 1 of 2 START test not_null_staging_situacao_alunos_ano ......................... [RUN]
[0m01:41:04.839991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_staging, now test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf)
[0m01:41:04.840399 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf
[0m01:41:04.858040 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf"
[0m01:41:04.859049 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf
[0m01:41:04.881009 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf"
[0m01:41:04.882120 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf"
[0m01:41:04.882711 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf: BEGIN
[0m01:41:04.883450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:04.895407 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m01:41:04.896352 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf"
[0m01:41:04.897157 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ano
from "transformacao_matricula"."staging_staging"."staging_situacao_alunos"
where ano is null



  
  
      
    ) dbt_internal_test
[0m01:41:04.898931 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_staging.staging_situacao_alunos" does not exist
LINE 17: from "transformacao_matricula"."staging_staging"."staging_si...
              ^

[0m01:41:04.899783 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf: ROLLBACK
[0m01:41:04.901383 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf: Close
[0m01:41:04.907804 [debug] [Thread-1 (]: Database Error in test not_null_staging_situacao_alunos_ano (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_staging.staging_situacao_alunos" does not exist
  LINE 17: from "transformacao_matricula"."staging_staging"."staging_si...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_staging_situacao_alunos_ano.sql
[0m01:41:04.908866 [error] [Thread-1 (]: 1 of 2 ERROR not_null_staging_situacao_alunos_ano .............................. [[31mERROR[0m in 0.07s]
[0m01:41:04.909906 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf
[0m01:41:04.910430 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d
[0m01:41:04.911026 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf' to be skipped because of status 'error'.  Reason: Database Error in test not_null_staging_situacao_alunos_ano (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_staging.staging_situacao_alunos" does not exist
  LINE 17: from "transformacao_matricula"."staging_staging"."staging_si...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_staging_situacao_alunos_ano.sql.
[0m01:41:04.911593 [info ] [Thread-1 (]: 2 of 2 START test not_null_staging_situacao_alunos_matricula ................... [RUN]
[0m01:41:04.913182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf, now test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d)
[0m01:41:04.913790 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d
[0m01:41:04.920559 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d"
[0m01:41:04.921282 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d
[0m01:41:04.923759 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d"
[0m01:41:04.924737 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d"
[0m01:41:04.925497 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d: BEGIN
[0m01:41:04.926095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:04.937605 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m01:41:04.938476 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d"
[0m01:41:04.939178 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select matricula
from "transformacao_matricula"."staging_staging"."staging_situacao_alunos"
where matricula is null



  
  
      
    ) dbt_internal_test
[0m01:41:04.941089 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_staging.staging_situacao_alunos" does not exist
LINE 17: from "transformacao_matricula"."staging_staging"."staging_si...
              ^

[0m01:41:04.941967 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d: ROLLBACK
[0m01:41:04.943280 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d: Close
[0m01:41:04.947084 [debug] [Thread-1 (]: Database Error in test not_null_staging_situacao_alunos_matricula (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_staging.staging_situacao_alunos" does not exist
  LINE 17: from "transformacao_matricula"."staging_staging"."staging_si...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_staging_situacao_alunos_matricula.sql
[0m01:41:04.948423 [error] [Thread-1 (]: 2 of 2 ERROR not_null_staging_situacao_alunos_matricula ........................ [[31mERROR[0m in 0.03s]
[0m01:41:04.951661 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d
[0m01:41:04.953122 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d' to be skipped because of status 'error'.  Reason: Database Error in test not_null_staging_situacao_alunos_matricula (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_staging.staging_situacao_alunos" does not exist
  LINE 17: from "transformacao_matricula"."staging_staging"."staging_si...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_staging_situacao_alunos_matricula.sql.
[0m01:41:04.955196 [debug] [MainThread]: Using postgres connection "master"
[0m01:41:04.956187 [debug] [MainThread]: On master: BEGIN
[0m01:41:04.959222 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:41:04.972760 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m01:41:04.973391 [debug] [MainThread]: On master: COMMIT
[0m01:41:04.973818 [debug] [MainThread]: Using postgres connection "master"
[0m01:41:04.974242 [debug] [MainThread]: On master: COMMIT
[0m01:41:04.975124 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:41:04.975619 [debug] [MainThread]: On master: Close
[0m01:41:04.976223 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:41:04.976682 [debug] [MainThread]: Connection 'test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d' was properly closed.
[0m01:41:04.977306 [info ] [MainThread]: 
[0m01:41:04.978146 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m01:41:04.979268 [debug] [MainThread]: Command end result
[0m01:41:05.004882 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m01:41:05.007365 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m01:41:05.016813 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m01:41:05.018608 [info ] [MainThread]: 
[0m01:41:05.020261 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m01:41:05.021450 [info ] [MainThread]: 
[0m01:41:05.022766 [error] [MainThread]: [31mFailure in test not_null_staging_situacao_alunos_ano (transformacao_aprovados/models/staging/schema.yml)[0m
[0m01:41:05.023947 [error] [MainThread]:   Database Error in test not_null_staging_situacao_alunos_ano (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_staging.staging_situacao_alunos" does not exist
  LINE 17: from "transformacao_matricula"."staging_staging"."staging_si...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_staging_situacao_alunos_ano.sql
[0m01:41:05.024817 [info ] [MainThread]: 
[0m01:41:05.025560 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_staging_situacao_alunos_ano.sql
[0m01:41:05.026201 [info ] [MainThread]: 
[0m01:41:05.027014 [error] [MainThread]: [31mFailure in test not_null_staging_situacao_alunos_matricula (transformacao_aprovados/models/staging/schema.yml)[0m
[0m01:41:05.027903 [error] [MainThread]:   Database Error in test not_null_staging_situacao_alunos_matricula (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_staging.staging_situacao_alunos" does not exist
  LINE 17: from "transformacao_matricula"."staging_staging"."staging_si...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_staging_situacao_alunos_matricula.sql
[0m01:41:05.028633 [info ] [MainThread]: 
[0m01:41:05.029659 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_staging_situacao_alunos_matricula.sql
[0m01:41:05.030446 [info ] [MainThread]: 
[0m01:41:05.031355 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=2
[0m01:41:05.033062 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.9400122, "process_in_blocks": "40", "process_kernel_time": 0.340875, "process_mem_max_rss": "123868", "process_out_blocks": "2088", "process_user_time": 1.742254}
[0m01:41:05.034001 [debug] [MainThread]: Command `dbt test` failed at 01:41:05.033822 after 0.94 seconds
[0m01:41:05.034673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e24e9fdb770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e24e9eb3ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e24e8fd02c0>]}
[0m01:41:05.035479 [debug] [MainThread]: Flushing usage events
[0m01:41:05.583946 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:41:27.361635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77c848430e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77c84aa97bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77c8483db5f0>]}


============================== 01:41:27.365356 | f118ab25-5c27-4023-a906-fcef80d3aff7 ==============================
[0m01:41:27.365356 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:41:27.365921 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'debug': 'False', 'no_print': 'None', 'partial_parse': 'True', 'write_json': 'True', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'empty': 'False', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'warn_error': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'profiles_dir': '/home/murilo/.dbt', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m01:41:27.532449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f118ab25-5c27-4023-a906-fcef80d3aff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77c84783aba0>]}
[0m01:41:27.593756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f118ab25-5c27-4023-a906-fcef80d3aff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77c847b7ea20>]}
[0m01:41:27.594690 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:41:27.705767 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m01:41:27.806457 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:41:27.806896 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:41:27.813358 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.transformacao_matricula.dimensions
- models.transformacao_matricula.facts
- models.transformacao_matricula.intermediate
[0m01:41:27.862712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f118ab25-5c27-4023-a906-fcef80d3aff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77c8469ef650>]}
[0m01:41:27.949098 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m01:41:27.951232 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m01:41:27.967352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f118ab25-5c27-4023-a906-fcef80d3aff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77c84594d160>]}
[0m01:41:27.967950 [info ] [MainThread]: Found 13 models, 2 data tests, 1 source, 459 macros
[0m01:41:27.968456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f118ab25-5c27-4023-a906-fcef80d3aff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77c8469ef9b0>]}
[0m01:41:27.970685 [info ] [MainThread]: 
[0m01:41:27.971274 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m01:41:27.972182 [info ] [MainThread]: 
[0m01:41:27.973186 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:41:27.979046 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula'
[0m01:41:28.034055 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m01:41:28.034636 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m01:41:28.035063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:41:28.047074 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.012 seconds
[0m01:41:28.048388 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m01:41:28.050755 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m01:41:28.051532 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m01:41:28.052437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:41:28.067606 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.015 seconds
[0m01:41:28.069078 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m01:41:28.072250 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula, now list_transformacao_matricula_staging_staging)
[0m01:41:28.078336 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m01:41:28.079007 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: BEGIN
[0m01:41:28.079387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:41:28.090059 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m01:41:28.090549 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m01:41:28.091325 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_staging"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m01:41:28.095618 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m01:41:28.097965 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: ROLLBACK
[0m01:41:28.098776 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: Close
[0m01:41:28.099483 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_staging, now list_transformacao_matricula_staging_marts)
[0m01:41:28.101460 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m01:41:28.101943 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: BEGIN
[0m01:41:28.102276 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:41:28.111559 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m01:41:28.112053 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m01:41:28.112401 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_marts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m01:41:28.115546 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m01:41:28.116706 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: ROLLBACK
[0m01:41:28.117475 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: Close
[0m01:41:28.124515 [debug] [MainThread]: Using postgres connection "master"
[0m01:41:28.125035 [debug] [MainThread]: On master: BEGIN
[0m01:41:28.125353 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:41:28.135917 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m01:41:28.136414 [debug] [MainThread]: Using postgres connection "master"
[0m01:41:28.136788 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:41:28.140794 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m01:41:28.142148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f118ab25-5c27-4023-a906-fcef80d3aff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77c8470f1790>]}
[0m01:41:28.142937 [debug] [MainThread]: On master: ROLLBACK
[0m01:41:28.143644 [debug] [MainThread]: Using postgres connection "master"
[0m01:41:28.144083 [debug] [MainThread]: On master: BEGIN
[0m01:41:28.145192 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:41:28.145735 [debug] [MainThread]: On master: COMMIT
[0m01:41:28.146247 [debug] [MainThread]: Using postgres connection "master"
[0m01:41:28.146630 [debug] [MainThread]: On master: COMMIT
[0m01:41:28.147287 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:41:28.147659 [debug] [MainThread]: On master: Close
[0m01:41:28.150177 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.staging_situacao_alunos
[0m01:41:28.150996 [info ] [Thread-1 (]: 1 of 13 START sql table model staging_staging.staging_situacao_alunos .......... [RUN]
[0m01:41:28.152118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_marts, now model.transformacao_matricula.staging_situacao_alunos)
[0m01:41:28.152731 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.staging_situacao_alunos
[0m01:41:28.162946 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.staging_situacao_alunos"
[0m01:41:28.164056 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.staging_situacao_alunos
[0m01:41:28.214193 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.staging_situacao_alunos"
[0m01:41:28.215668 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m01:41:28.216376 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: BEGIN
[0m01:41:28.216763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:28.227975 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m01:41:28.228507 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m01:41:28.228988 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */

  
    

  create  table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp"
  
  
    as
  
  (
    WITH source AS (
	SELECT * FROM "transformacao_matricula"."staging"."staging_alunos_raw"
),

cleaning_renaming AS (
	SELECT
		ano,
		codigo_escola,
		matricula,
		escola AS nome_escola,
		endereco_logradouro AS endereco_logra,
	 	endereco_bairro,
		endereco_numero,
		rpa,
		modalidade_ensino_codigo AS mod_ens_codigo,
		-- Transformação da SÉRIE
		CASE
		    -- Ensino Fundamental (1º ao 9º)
		    WHEN serie LIKE '%1 ANO%' OR serie LIKE '%1º ANO%' THEN '1º ANO'
		    WHEN serie LIKE '%2 ANO%' OR serie LIKE '%2º ANO%' THEN '2º ANO'
		    WHEN serie LIKE '%3 ANO%' OR serie LIKE '%3º ANO%' THEN '3º ANO'
		    WHEN serie LIKE '%4 ANO%' OR serie LIKE '%4º ANO%' THEN '4º ANO'
		    WHEN serie LIKE '%5 ANO%' OR serie LIKE '%5º ANO%' THEN '5º ANO'
		    WHEN serie LIKE '%6 ANO%' OR serie LIKE '%6º ANO%' THEN '6º ANO'
		    WHEN serie LIKE '%7 ANO%' OR serie LIKE '%7º ANO%' THEN '7º ANO'
		    WHEN serie LIKE '%8 ANO%' OR serie LIKE '%8º ANO%' THEN '8º ANO'
		    WHEN serie LIKE '%9 ANO%' OR serie LIKE '%9º ANO%' THEN '9º ANO'

		    -- Educação Infantil (Berçário e Grupos)
		    WHEN serie LIKE '%BER%' THEN 'BERÇARIO' -- Pega BERÇARIO e BERRIO
		    WHEN serie LIKE '%GRUPO I%' OR serie LIKE '%GRUPO 1%' THEN 'GRUPO I'
		    WHEN serie LIKE '%GRUPO II%' THEN 'GRUPO II'
		    WHEN serie LIKE '%GRUPO III%' THEN 'GRUPO III'
		    WHEN serie LIKE '%GRUPO IV%' THEN 'GRUPO IV'
		    WHEN serie LIKE '%GRUPO V%' THEN 'GRUPO V'

		    -- EJA (Módulos 1 ao 5) 
		    WHEN serie LIKE '%1%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 1'
		    WHEN serie LIKE '%2%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 2'
		    WHEN serie LIKE '%3%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 3'
		    WHEN serie LIKE '%4%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 4'
		    WHEN serie LIKE '%5%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 5'

		    WHEN serie LIKE '%TRAVESSIA%' THEN 'TRAVESSIA RECIFE'
		    WHEN serie LIKE '%CORRECAO%1%' THEN 'CORREÇÃO DE FLUXO 1 - ALFABETIZACAO'
		    WHEN serie LIKE '%CORRECAO%2%' THEN 'CORREÇÃO DE FLUXO 2 - ACELERACAO'

		    ELSE 'OUTROS'
		END AS serie,
		turma,
		turno,
		matricula,
		idade,

		-- transformação do SEXO
		CASE
		    WHEN sexo = 1 THEN 'Masculino',
	 	    WHEN sexo = 2 THEN 'Feminino',
		    WHEN sexo = 3 THEN 'Outros',				
		    ELSE 'Não informado' -- Para cobrir valores inesperados
		END AS sexo,

		idade,
		-- transformação de situacao
		CASE 
		    WHEN situacao_nome LIKE '%APROV%' THEN 'Aprovado',
		    WHEN situacao_nome LIKE '%RET%' OR situacao_nome LIKE '%REPRO%' THEN 'Reprovado',
		    WHEN situacao_nome LIKE '%TR%' OR situacao_nome LIKE '%REMAN%' THEN 'Transferido',
		    WHEN situacao_nome LIKE '%DESIST%' THEN 'Desistente'
		END AS sit_nome,

		-- Transformação da MODALIDADE
		CASE
		    WHEN modalidade_ensino LIKE '%EDUCACAO INFANTIL%' THEN 'EDUCAÇÃO INFANTIL'
		    WHEN modalidade_ensino LIKE '%ENSINO FUNDAMENTAL%' THEN 'ENSINO FUNDAMENTAL'
		    WHEN modalidade_ensino LIKE '%EDUCACAO JOVENS E ADULTOS%' THEN 'EJA'
		    WHEN modalidade_ensino LIKE '%CORRE%' THEN 'CORREÇÃO DE FLUXO' -- Pega "CORREÇÃO" e "CORREO"
		    ELSE 'OUTROS'
		END AS modalidade_ens,

		
	FROM source
)

SELECT * FROM cleaning_renaming
  );
  
[0m01:41:28.230581 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 68:       WHEN sexo = 1 THEN 'Masculino',
                                             ^

[0m01:41:28.231209 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: ROLLBACK
[0m01:41:28.232145 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: Close
[0m01:41:28.235510 [debug] [Thread-1 (]: Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  syntax error at or near ","
  LINE 68:       WHEN sexo = 1 THEN 'Masculino',
                                               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m01:41:28.237191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f118ab25-5c27-4023-a906-fcef80d3aff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77c845934c20>]}
[0m01:41:28.237958 [error] [Thread-1 (]: 1 of 13 ERROR creating sql table model staging_staging.staging_situacao_alunos . [[31mERROR[0m in 0.08s]
[0m01:41:28.238676 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.staging_situacao_alunos
[0m01:41:28.239434 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_count_aluno_idade
[0m01:41:28.240334 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.staging_situacao_alunos' to be skipped because of status 'error'.  Reason: Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  syntax error at or near ","
  LINE 68:       WHEN sexo = 1 THEN 'Masculino',
                                               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql.
[0m01:41:28.241307 [info ] [Thread-1 (]: 2 of 13 START sql view model staging_marts.view_count_aluno_idade .............. [RUN]
[0m01:41:28.243915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.staging_situacao_alunos, now model.transformacao_matricula.view_count_aluno_idade)
[0m01:41:28.244455 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_count_aluno_idade
[0m01:41:28.246856 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_count_aluno_idade"
[0m01:41:28.247564 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_count_aluno_idade
[0m01:41:28.269055 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_count_aluno_idade"
[0m01:41:28.270311 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m01:41:28.270982 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: BEGIN
[0m01:41:28.271568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:28.286161 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m01:41:28.287213 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m01:41:28.289980 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_count_aluno_idade"} */

  create view "transformacao_matricula"."staging_marts"."view_count_aluno_idade__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dl.desc_rpa,
    da.faixa_etaria,
    COUNT(fm.matricula) AS total_alunos
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
ORDER BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria;
  );
[0m01:41:28.291908 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 24:     dtemp.ano, dl.desc_rpa, da.faixa_etaria;
                                                    ^

[0m01:41:28.293174 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: ROLLBACK
[0m01:41:28.295258 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: Close
[0m01:41:28.304905 [debug] [Thread-1 (]: Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  syntax error at or near ";"
  LINE 24:     dtemp.ano, dl.desc_rpa, da.faixa_etaria;
                                                      ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m01:41:28.306433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f118ab25-5c27-4023-a906-fcef80d3aff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77c8441fa450>]}
[0m01:41:28.307745 [error] [Thread-1 (]: 2 of 13 ERROR creating sql view model staging_marts.view_count_aluno_idade ..... [[31mERROR[0m in 0.06s]
[0m01:41:28.308985 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_count_aluno_idade
[0m01:41:28.309887 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m01:41:28.311029 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_count_aluno_idade' to be skipped because of status 'error'.  Reason: Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  syntax error at or near ";"
  LINE 24:     dtemp.ano, dl.desc_rpa, da.faixa_etaria;
                                                      ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql.
[0m01:41:28.311861 [info ] [Thread-1 (]: 3 of 13 START sql view model staging_marts.view_frequencia_situacao_escola ..... [RUN]
[0m01:41:28.312761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_count_aluno_idade, now model.transformacao_matricula.view_frequencia_situacao_escola)
[0m01:41:28.313266 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_frequencia_situacao_escola
[0m01:41:28.315576 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m01:41:28.316457 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_frequencia_situacao_escola
[0m01:41:28.323151 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m01:41:28.324797 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m01:41:28.325537 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: BEGIN
[0m01:41:28.326275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:28.338789 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m01:41:28.339641 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m01:41:28.340294 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_frequencia_situacao_escola"} */

  create view "transformacao_matricula"."staging_marts"."view_frequencia_situacao_escola__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    de.nome_escola,
    de.codigo_escola,
    ds.situacao_nome,
    COUNT(fm.matricula) AS contagem_situacao
FROM
    fato_matricula fm
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, de.nome_escola, de.codigo_escola, ds.situacao_nome
ORDER BY
    dtemp.ano, de.nome_escola, contagem_situacao DESC;
  );
[0m01:41:28.341631 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 25:     dtemp.ano, de.nome_escola, contagem_situacao DESC;
                                                              ^

[0m01:41:28.342382 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: ROLLBACK
[0m01:41:28.343728 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: Close
[0m01:41:28.352699 [debug] [Thread-1 (]: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  syntax error at or near ";"
  LINE 25:     dtemp.ano, de.nome_escola, contagem_situacao DESC;
                                                                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m01:41:28.353934 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f118ab25-5c27-4023-a906-fcef80d3aff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77c844141d30>]}
[0m01:41:28.357153 [error] [Thread-1 (]: 3 of 13 ERROR creating sql view model staging_marts.view_frequencia_situacao_escola  [[31mERROR[0m in 0.04s]
[0m01:41:28.358629 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m01:41:28.359970 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_matricula_detalhada
[0m01:41:28.360968 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_frequencia_situacao_escola' to be skipped because of status 'error'.  Reason: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  syntax error at or near ";"
  LINE 25:     dtemp.ano, de.nome_escola, contagem_situacao DESC;
                                                                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql.
[0m01:41:28.361866 [info ] [Thread-1 (]: 4 of 13 START sql view model staging_marts.view_matricula_detalhada ............ [RUN]
[0m01:41:28.362892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_frequencia_situacao_escola, now model.transformacao_matricula.view_matricula_detalhada)
[0m01:41:28.363502 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_matricula_detalhada
[0m01:41:28.367165 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_matricula_detalhada"
[0m01:41:28.368371 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_matricula_detalhada
[0m01:41:28.374348 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_matricula_detalhada"
[0m01:41:28.375717 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m01:41:28.376297 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: BEGIN
[0m01:41:28.376768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:28.391475 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m01:41:28.392453 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m01:41:28.393285 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_matricula_detalhada"} */

  create view "transformacao_matricula"."staging_marts"."view_matricula_detalhada__dbt_tmp"
    
    
  as (
    
SELECT
    fm.matricula,
    da.sexo,
    da.idade,
    da.faixa_etaria,
    de.nome_escola,
    de.codigo_escola,
    dt.turma,
    dt.turno,
    dt.serie,
    dt.modalidade_ensino,
    ds.situacao_nome,
    ds.categoria AS categoria_situacao,
    ds.eh_aprovado,
    ds.eh_reprovado,
    dl.desc_rpa,
    dl.endereco_bairro AS bairro_localizacao,
    dtemp.ano AS ano_registro
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo;
  );
[0m01:41:28.394868 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 39:     dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo;
                                                            ^

[0m01:41:28.395692 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: ROLLBACK
[0m01:41:28.397142 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: Close
[0m01:41:28.407418 [debug] [Thread-1 (]: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  syntax error at or near ";"
  LINE 39:     dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo;
                                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m01:41:28.408446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f118ab25-5c27-4023-a906-fcef80d3aff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77c844d7d130>]}
[0m01:41:28.409742 [error] [Thread-1 (]: 4 of 13 ERROR creating sql view model staging_marts.view_matricula_detalhada ... [[31mERROR[0m in 0.05s]
[0m01:41:28.411114 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_matricula_detalhada
[0m01:41:28.412375 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_taxa_aprovados
[0m01:41:28.413570 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_matricula_detalhada' to be skipped because of status 'error'.  Reason: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  syntax error at or near ";"
  LINE 39:     dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo;
                                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql.
[0m01:41:28.414605 [info ] [Thread-1 (]: 5 of 13 START sql view model staging_marts.view_taxa_aprovados ................. [RUN]
[0m01:41:28.415722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_matricula_detalhada, now model.transformacao_matricula.view_taxa_aprovados)
[0m01:41:28.416699 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_taxa_aprovados
[0m01:41:28.420746 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_taxa_aprovados"
[0m01:41:28.423583 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_taxa_aprovados
[0m01:41:28.429157 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_taxa_aprovados"
[0m01:41:28.430413 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m01:41:28.431127 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: BEGIN
[0m01:41:28.431672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:28.443272 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m01:41:28.444005 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m01:41:28.444521 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_taxa_aprovados"} */

  create view "transformacao_matricula"."staging_marts"."view_taxa_aprovados__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dt.modalidade_ensino,
    COUNT(fm.matricula) AS total_matriculas,
    SUM(ds.eh_aprovado) AS total_aprovados,
    SUM(ds.eh_reprovado) AS total_reprovados,
    -- Calcula a taxa de aprovação (como porcentagem)
    CAST(SUM(ds.eh_aprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_aprovacao_percentual,
    -- Calcula a taxa de reprovação (como porcentagem)
    CAST(SUM(ds.eh_reprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_reprovacao_percentual
FROM
    fato_matricula fm
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dt.modalidade_ensino
ORDER BY
    dtemp.ano, dt.modalidade_ensino;
  );
[0m01:41:28.447013 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 29:     dtemp.ano, dt.modalidade_ensino;
                                            ^

[0m01:41:28.447892 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: ROLLBACK
[0m01:41:28.449193 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: Close
[0m01:41:28.452395 [debug] [Thread-1 (]: Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  syntax error at or near ";"
  LINE 29:     dtemp.ano, dt.modalidade_ensino;
                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m01:41:28.453818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f118ab25-5c27-4023-a906-fcef80d3aff7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77c842821550>]}
[0m01:41:28.455970 [error] [Thread-1 (]: 5 of 13 ERROR creating sql view model staging_marts.view_taxa_aprovados ........ [[31mERROR[0m in 0.04s]
[0m01:41:28.459115 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_taxa_aprovados
[0m01:41:28.460099 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_aluno
[0m01:41:28.461964 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_taxa_aprovados' to be skipped because of status 'error'.  Reason: Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  syntax error at or near ";"
  LINE 29:     dtemp.ano, dt.modalidade_ensino;
                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql.
[0m01:41:28.460912 [info ] [Thread-1 (]: 6 of 13 SKIP relation staging_marts.dim_aluno .................................. [[33mSKIP[0m]
[0m01:41:28.463708 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_aluno
[0m01:41:28.464824 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.transform_data
[0m01:41:28.465712 [info ] [Thread-1 (]: 7 of 13 SKIP relation staging_marts.transform_data ............................. [[33mSKIP[0m]
[0m01:41:28.466765 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.transform_data
[0m01:41:28.468235 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_escola
[0m01:41:28.469022 [info ] [Thread-1 (]: 8 of 13 SKIP relation staging_marts.dim_escola ................................. [[33mSKIP[0m]
[0m01:41:28.470263 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_escola
[0m01:41:28.471167 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_localizacao
[0m01:41:28.472100 [info ] [Thread-1 (]: 9 of 13 SKIP relation staging_marts.dim_localizacao ............................ [[33mSKIP[0m]
[0m01:41:28.473113 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_localizacao
[0m01:41:28.474116 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_situacao
[0m01:41:28.475172 [info ] [Thread-1 (]: 10 of 13 SKIP relation staging_marts.dim_situacao .............................. [[33mSKIP[0m]
[0m01:41:28.476290 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_situacao
[0m01:41:28.477244 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_tempo
[0m01:41:28.478237 [info ] [Thread-1 (]: 11 of 13 SKIP relation staging_marts.dim_tempo ................................. [[33mSKIP[0m]
[0m01:41:28.479296 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_tempo
[0m01:41:28.480514 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_turma
[0m01:41:28.481531 [info ] [Thread-1 (]: 12 of 13 SKIP relation staging_marts.dim_turma ................................. [[33mSKIP[0m]
[0m01:41:28.482939 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_turma
[0m01:41:28.484265 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.fato_matricula
[0m01:41:28.485376 [info ] [Thread-1 (]: 13 of 13 SKIP relation staging_marts.fato_matricula ............................ [[33mSKIP[0m]
[0m01:41:28.486739 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.fato_matricula
[0m01:41:28.491121 [debug] [MainThread]: Using postgres connection "master"
[0m01:41:28.491935 [debug] [MainThread]: On master: BEGIN
[0m01:41:28.492538 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:41:28.504073 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m01:41:28.504883 [debug] [MainThread]: On master: COMMIT
[0m01:41:28.505628 [debug] [MainThread]: Using postgres connection "master"
[0m01:41:28.506168 [debug] [MainThread]: On master: COMMIT
[0m01:41:28.507168 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:41:28.508014 [debug] [MainThread]: On master: Close
[0m01:41:28.509798 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:41:28.510567 [debug] [MainThread]: Connection 'model.transformacao_matricula.view_taxa_aprovados' was properly closed.
[0m01:41:28.511189 [info ] [MainThread]: 
[0m01:41:28.511792 [info ] [MainThread]: Finished running 9 table models, 4 view models in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m01:41:28.514108 [debug] [MainThread]: Command end result
[0m01:41:28.552749 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m01:41:28.557474 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m01:41:28.568139 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m01:41:28.568917 [info ] [MainThread]: 
[0m01:41:28.569577 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m01:41:28.570186 [info ] [MainThread]: 
[0m01:41:28.570826 [error] [MainThread]: [31mFailure in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)[0m
[0m01:41:28.571629 [error] [MainThread]:   Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  syntax error at or near ","
  LINE 68:       WHEN sexo = 1 THEN 'Masculino',
                                               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m01:41:28.572630 [info ] [MainThread]: 
[0m01:41:28.573526 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m01:41:28.574143 [info ] [MainThread]: 
[0m01:41:28.574858 [error] [MainThread]: [31mFailure in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)[0m
[0m01:41:28.575490 [error] [MainThread]:   Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  syntax error at or near ";"
  LINE 24:     dtemp.ano, dl.desc_rpa, da.faixa_etaria;
                                                      ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m01:41:28.575979 [info ] [MainThread]: 
[0m01:41:28.576631 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m01:41:28.577483 [info ] [MainThread]: 
[0m01:41:28.578132 [error] [MainThread]: [31mFailure in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)[0m
[0m01:41:28.579075 [error] [MainThread]:   Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  syntax error at or near ";"
  LINE 25:     dtemp.ano, de.nome_escola, contagem_situacao DESC;
                                                                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m01:41:28.579864 [info ] [MainThread]: 
[0m01:41:28.580726 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m01:41:28.581670 [info ] [MainThread]: 
[0m01:41:28.582437 [error] [MainThread]: [31mFailure in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)[0m
[0m01:41:28.583269 [error] [MainThread]:   Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  syntax error at or near ";"
  LINE 39:     dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo;
                                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m01:41:28.584103 [info ] [MainThread]: 
[0m01:41:28.585320 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m01:41:28.586449 [info ] [MainThread]: 
[0m01:41:28.587773 [error] [MainThread]: [31mFailure in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)[0m
[0m01:41:28.588605 [error] [MainThread]:   Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  syntax error at or near ";"
  LINE 29:     dtemp.ano, dt.modalidade_ensino;
                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m01:41:28.589545 [info ] [MainThread]: 
[0m01:41:28.592347 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m01:41:28.593361 [info ] [MainThread]: 
[0m01:41:28.594335 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=8 NO-OP=0 TOTAL=13
[0m01:41:28.595994 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.286343, "process_in_blocks": "0", "process_kernel_time": 0.324345, "process_mem_max_rss": "123284", "process_out_blocks": "2208", "process_user_time": 2.110737}
[0m01:41:28.596904 [debug] [MainThread]: Command `dbt run` failed at 01:41:28.596742 after 1.29 seconds
[0m01:41:28.597775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77c847e48c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77c847cb90a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77c8441f5850>]}
[0m01:41:28.599203 [debug] [MainThread]: Flushing usage events
[0m01:41:29.232353 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:43:30.019945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592d2047c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592d389f320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592d1172990>]}


============================== 01:43:30.023666 | 869769b2-76e1-46b7-aac7-1a588b55cebd ==============================
[0m01:43:30.023666 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:43:30.024229 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'empty': 'False', 'version_check': 'True', 'target_path': 'None', 'fail_fast': 'False', 'static_parser': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'use_colors': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'debug': 'False', 'profiles_dir': '/home/murilo/.dbt', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'warn_error': 'None', 'log_cache_events': 'False'}
[0m01:43:30.178073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '869769b2-76e1-46b7-aac7-1a588b55cebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592d0cd9d60>]}
[0m01:43:30.229325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '869769b2-76e1-46b7-aac7-1a588b55cebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592d3566930>]}
[0m01:43:30.230153 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:43:30.349424 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m01:43:30.438982 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:43:30.439443 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:43:30.445121 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.transformacao_matricula.dimensions
- models.transformacao_matricula.facts
- models.transformacao_matricula.intermediate
[0m01:43:30.490644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '869769b2-76e1-46b7-aac7-1a588b55cebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592d031ff50>]}
[0m01:43:30.568346 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m01:43:30.569979 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m01:43:30.584258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '869769b2-76e1-46b7-aac7-1a588b55cebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592cf779b50>]}
[0m01:43:30.584915 [info ] [MainThread]: Found 13 models, 2 data tests, 1 source, 459 macros
[0m01:43:30.585292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '869769b2-76e1-46b7-aac7-1a588b55cebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592d0ad3200>]}
[0m01:43:30.587253 [info ] [MainThread]: 
[0m01:43:30.587775 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m01:43:30.588200 [info ] [MainThread]: 
[0m01:43:30.588883 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:43:30.593422 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula'
[0m01:43:30.642827 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m01:43:30.643333 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m01:43:30.649387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:43:30.661612 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.012 seconds
[0m01:43:30.662978 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m01:43:30.665150 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m01:43:30.665748 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m01:43:30.666213 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:43:30.678129 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.012 seconds
[0m01:43:30.679392 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m01:43:30.682443 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula, now list_transformacao_matricula_staging_marts)
[0m01:43:30.689712 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m01:43:30.690204 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: BEGIN
[0m01:43:30.690508 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:43:30.699395 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m01:43:30.699875 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m01:43:30.700445 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_marts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m01:43:30.704175 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m01:43:30.706393 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: ROLLBACK
[0m01:43:30.707485 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: Close
[0m01:43:30.709603 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_marts, now list_transformacao_matricula_staging_staging)
[0m01:43:30.712061 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m01:43:30.712543 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: BEGIN
[0m01:43:30.712941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:43:30.722741 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m01:43:30.723339 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m01:43:30.723671 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_staging"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m01:43:30.726976 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m01:43:30.728158 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: ROLLBACK
[0m01:43:30.728926 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: Close
[0m01:43:30.734138 [debug] [MainThread]: Using postgres connection "master"
[0m01:43:30.734576 [debug] [MainThread]: On master: BEGIN
[0m01:43:30.734891 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:43:30.744604 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m01:43:30.745102 [debug] [MainThread]: Using postgres connection "master"
[0m01:43:30.745971 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:43:30.749624 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m01:43:30.751406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '869769b2-76e1-46b7-aac7-1a588b55cebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592d0a76c30>]}
[0m01:43:30.751901 [debug] [MainThread]: On master: ROLLBACK
[0m01:43:30.752711 [debug] [MainThread]: Using postgres connection "master"
[0m01:43:30.753108 [debug] [MainThread]: On master: BEGIN
[0m01:43:30.753958 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:43:30.754345 [debug] [MainThread]: On master: COMMIT
[0m01:43:30.754664 [debug] [MainThread]: Using postgres connection "master"
[0m01:43:30.754979 [debug] [MainThread]: On master: COMMIT
[0m01:43:30.755665 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:43:30.756091 [debug] [MainThread]: On master: Close
[0m01:43:30.758768 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.staging_situacao_alunos
[0m01:43:30.759615 [info ] [Thread-1 (]: 1 of 13 START sql table model staging_staging.staging_situacao_alunos .......... [RUN]
[0m01:43:30.760265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_staging, now model.transformacao_matricula.staging_situacao_alunos)
[0m01:43:30.760646 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.staging_situacao_alunos
[0m01:43:30.766949 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.staging_situacao_alunos"
[0m01:43:30.767662 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.staging_situacao_alunos
[0m01:43:30.812012 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.staging_situacao_alunos"
[0m01:43:30.813550 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m01:43:30.814190 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: BEGIN
[0m01:43:30.814543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:30.825316 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m01:43:30.825880 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m01:43:30.826329 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */

  
    

  create  table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp"
  
  
    as
  
  (
    WITH source AS (
	SELECT * FROM "transformacao_matricula"."staging"."staging_alunos_raw"
),

cleaning_renaming AS (
	SELECT
		ano,
		codigo_escola,
		matricula,
		escola AS nome_escola,
		endereco_logradouro AS endereco_logra,
	 	endereco_bairro,
		endereco_numero,
		rpa,
		modalidade_ensino_codigo AS mod_ens_codigo,
		-- Transformação da SÉRIE
		CASE
		    -- Ensino Fundamental (1º ao 9º)
		    WHEN serie LIKE '%1 ANO%' OR serie LIKE '%1º ANO%' THEN '1º ANO'
		    WHEN serie LIKE '%2 ANO%' OR serie LIKE '%2º ANO%' THEN '2º ANO'
		    WHEN serie LIKE '%3 ANO%' OR serie LIKE '%3º ANO%' THEN '3º ANO'
		    WHEN serie LIKE '%4 ANO%' OR serie LIKE '%4º ANO%' THEN '4º ANO'
		    WHEN serie LIKE '%5 ANO%' OR serie LIKE '%5º ANO%' THEN '5º ANO'
		    WHEN serie LIKE '%6 ANO%' OR serie LIKE '%6º ANO%' THEN '6º ANO'
		    WHEN serie LIKE '%7 ANO%' OR serie LIKE '%7º ANO%' THEN '7º ANO'
		    WHEN serie LIKE '%8 ANO%' OR serie LIKE '%8º ANO%' THEN '8º ANO'
		    WHEN serie LIKE '%9 ANO%' OR serie LIKE '%9º ANO%' THEN '9º ANO'

		    -- Educação Infantil (Berçário e Grupos)
		    WHEN serie LIKE '%BER%' THEN 'BERÇARIO' -- Pega BERÇARIO e BERRIO
		    WHEN serie LIKE '%GRUPO I%' OR serie LIKE '%GRUPO 1%' THEN 'GRUPO I'
		    WHEN serie LIKE '%GRUPO II%' THEN 'GRUPO II'
		    WHEN serie LIKE '%GRUPO III%' THEN 'GRUPO III'
		    WHEN serie LIKE '%GRUPO IV%' THEN 'GRUPO IV'
		    WHEN serie LIKE '%GRUPO V%' THEN 'GRUPO V'

		    -- EJA (Módulos 1 ao 5) 
		    WHEN serie LIKE '%1%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 1'
		    WHEN serie LIKE '%2%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 2'
		    WHEN serie LIKE '%3%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 3'
		    WHEN serie LIKE '%4%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 4'
		    WHEN serie LIKE '%5%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 5'

		    WHEN serie LIKE '%TRAVESSIA%' THEN 'TRAVESSIA RECIFE'
		    WHEN serie LIKE '%CORRECAO%1%' THEN 'CORREÇÃO DE FLUXO 1 - ALFABETIZACAO'
		    WHEN serie LIKE '%CORRECAO%2%' THEN 'CORREÇÃO DE FLUXO 2 - ACELERACAO'

		    ELSE 'OUTROS'
		END AS serie,
		turma,
		turno,
		matricula,
		idade,

		-- transformação do SEXO
		CASE
		    WHEN sexo = 1 THEN 'Masculino',
	 	    WHEN sexo = 2 THEN 'Feminino',
		    WHEN sexo = 3 THEN 'Outros',				
		    ELSE 'Não informado' -- Para cobrir valores inesperados
		END AS sexo,

		idade,
		-- transformação de situacao
		CASE 
		    WHEN situacao_nome LIKE '%APROV%' THEN 'Aprovado',
		    WHEN situacao_nome LIKE '%RET%' OR situacao_nome LIKE '%REPRO%' THEN 'Reprovado',
		    WHEN situacao_nome LIKE '%TR%' OR situacao_nome LIKE '%REMAN%' THEN 'Transferido',
		    WHEN situacao_nome LIKE '%DESIST%' THEN 'Desistente'
		END AS sit_nome,

		-- Transformação da MODALIDADE
		CASE
		    WHEN modalidade_ensino LIKE '%EDUCACAO INFANTIL%' THEN 'EDUCAÇÃO INFANTIL'
		    WHEN modalidade_ensino LIKE '%ENSINO FUNDAMENTAL%' THEN 'ENSINO FUNDAMENTAL'
		    WHEN modalidade_ensino LIKE '%EDUCACAO JOVENS E ADULTOS%' THEN 'EJA'
		    WHEN modalidade_ensino LIKE '%CORRE%' THEN 'CORREÇÃO DE FLUXO' -- Pega "CORREÇÃO" e "CORREO"
		    ELSE 'OUTROS'
		END AS modalidade_ens,

		
	FROM source
)

SELECT * FROM cleaning_renaming
  );
  
[0m01:43:30.827788 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 68:       WHEN sexo = 1 THEN 'Masculino',
                                             ^

[0m01:43:30.828441 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: ROLLBACK
[0m01:43:30.829297 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: Close
[0m01:43:30.832665 [debug] [Thread-1 (]: Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  syntax error at or near ","
  LINE 68:       WHEN sexo = 1 THEN 'Masculino',
                                               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m01:43:30.834471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '869769b2-76e1-46b7-aac7-1a588b55cebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592ce7968d0>]}
[0m01:43:30.835212 [error] [Thread-1 (]: 1 of 13 ERROR creating sql table model staging_staging.staging_situacao_alunos . [[31mERROR[0m in 0.07s]
[0m01:43:30.835820 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.staging_situacao_alunos
[0m01:43:30.836246 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_count_aluno_idade
[0m01:43:30.836989 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.staging_situacao_alunos' to be skipped because of status 'error'.  Reason: Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  syntax error at or near ","
  LINE 68:       WHEN sexo = 1 THEN 'Masculino',
                                               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql.
[0m01:43:30.837643 [info ] [Thread-1 (]: 2 of 13 START sql view model staging_marts.view_count_aluno_idade .............. [RUN]
[0m01:43:30.839261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.staging_situacao_alunos, now model.transformacao_matricula.view_count_aluno_idade)
[0m01:43:30.839768 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_count_aluno_idade
[0m01:43:30.844236 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_count_aluno_idade"
[0m01:43:30.845429 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_count_aluno_idade
[0m01:43:30.868438 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_count_aluno_idade"
[0m01:43:30.869594 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m01:43:30.870241 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: BEGIN
[0m01:43:30.870789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:30.883574 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m01:43:30.884354 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m01:43:30.884887 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_count_aluno_idade"} */

  create view "transformacao_matricula"."staging_marts"."view_count_aluno_idade__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dl.desc_rpa,
    da.faixa_etaria,
    COUNT(fm.matricula) AS total_alunos
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
ORDER BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria;
  );
[0m01:43:30.888959 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 24:     dtemp.ano, dl.desc_rpa, da.faixa_etaria;
                                                    ^

[0m01:43:30.889706 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: ROLLBACK
[0m01:43:30.890877 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: Close
[0m01:43:30.897375 [debug] [Thread-1 (]: Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  syntax error at or near ";"
  LINE 24:     dtemp.ano, dl.desc_rpa, da.faixa_etaria;
                                                      ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m01:43:30.898369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '869769b2-76e1-46b7-aac7-1a588b55cebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592cc322480>]}
[0m01:43:30.899433 [error] [Thread-1 (]: 2 of 13 ERROR creating sql view model staging_marts.view_count_aluno_idade ..... [[31mERROR[0m in 0.06s]
[0m01:43:30.900522 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_count_aluno_idade
[0m01:43:30.901139 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m01:43:30.901758 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_count_aluno_idade' to be skipped because of status 'error'.  Reason: Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  syntax error at or near ";"
  LINE 24:     dtemp.ano, dl.desc_rpa, da.faixa_etaria;
                                                      ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql.
[0m01:43:30.902491 [info ] [Thread-1 (]: 3 of 13 START sql view model staging_marts.view_frequencia_situacao_escola ..... [RUN]
[0m01:43:30.903422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_count_aluno_idade, now model.transformacao_matricula.view_frequencia_situacao_escola)
[0m01:43:30.904069 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_frequencia_situacao_escola
[0m01:43:30.906971 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m01:43:30.907955 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_frequencia_situacao_escola
[0m01:43:30.912094 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m01:43:30.913076 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m01:43:30.913660 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: BEGIN
[0m01:43:30.914167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:30.926901 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m01:43:30.927621 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m01:43:30.928253 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_frequencia_situacao_escola"} */

  create view "transformacao_matricula"."staging_marts"."view_frequencia_situacao_escola__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    de.nome_escola,
    de.codigo_escola,
    ds.situacao_nome,
    COUNT(fm.matricula) AS contagem_situacao
FROM
    fato_matricula fm
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, de.nome_escola, de.codigo_escola, ds.situacao_nome
ORDER BY
    dtemp.ano, de.nome_escola, contagem_situacao DESC;
  );
[0m01:43:30.929618 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 25:     dtemp.ano, de.nome_escola, contagem_situacao DESC;
                                                              ^

[0m01:43:30.930383 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: ROLLBACK
[0m01:43:30.931539 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: Close
[0m01:43:30.934996 [debug] [Thread-1 (]: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  syntax error at or near ";"
  LINE 25:     dtemp.ano, de.nome_escola, contagem_situacao DESC;
                                                                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m01:43:30.936308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '869769b2-76e1-46b7-aac7-1a588b55cebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592ce789ca0>]}
[0m01:43:30.937338 [error] [Thread-1 (]: 3 of 13 ERROR creating sql view model staging_marts.view_frequencia_situacao_escola  [[31mERROR[0m in 0.03s]
[0m01:43:30.938459 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m01:43:30.939209 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_matricula_detalhada
[0m01:43:30.940095 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_frequencia_situacao_escola' to be skipped because of status 'error'.  Reason: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  syntax error at or near ";"
  LINE 25:     dtemp.ano, de.nome_escola, contagem_situacao DESC;
                                                                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql.
[0m01:43:30.941403 [info ] [Thread-1 (]: 4 of 13 START sql view model staging_marts.view_matricula_detalhada ............ [RUN]
[0m01:43:30.944299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_frequencia_situacao_escola, now model.transformacao_matricula.view_matricula_detalhada)
[0m01:43:30.945055 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_matricula_detalhada
[0m01:43:30.948477 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_matricula_detalhada"
[0m01:43:30.949674 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_matricula_detalhada
[0m01:43:30.956552 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_matricula_detalhada"
[0m01:43:30.957839 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m01:43:30.958681 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: BEGIN
[0m01:43:30.959454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:30.972410 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m01:43:30.973223 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m01:43:30.973737 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_matricula_detalhada"} */

  create view "transformacao_matricula"."staging_marts"."view_matricula_detalhada__dbt_tmp"
    
    
  as (
    
SELECT
    fm.matricula,
    da.sexo,
    da.idade,
    da.faixa_etaria,
    de.nome_escola,
    de.codigo_escola,
    dt.turma,
    dt.turno,
    dt.serie,
    dt.modalidade_ensino,
    ds.situacao_nome,
    ds.categoria AS categoria_situacao,
    ds.eh_aprovado,
    ds.eh_reprovado,
    dl.desc_rpa,
    dl.endereco_bairro AS bairro_localizacao,
    dtemp.ano AS ano_registro
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo;
  );
[0m01:43:30.974975 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 39:     dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo;
                                                            ^

[0m01:43:30.975773 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: ROLLBACK
[0m01:43:30.978063 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: Close
[0m01:43:30.980958 [debug] [Thread-1 (]: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  syntax error at or near ";"
  LINE 39:     dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo;
                                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m01:43:30.981969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '869769b2-76e1-46b7-aac7-1a588b55cebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592cebc9670>]}
[0m01:43:30.983506 [error] [Thread-1 (]: 4 of 13 ERROR creating sql view model staging_marts.view_matricula_detalhada ... [[31mERROR[0m in 0.04s]
[0m01:43:30.984490 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_matricula_detalhada
[0m01:43:30.985049 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_taxa_aprovados
[0m01:43:30.985678 [info ] [Thread-1 (]: 5 of 13 START sql view model staging_marts.view_taxa_aprovados ................. [RUN]
[0m01:43:30.986527 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_matricula_detalhada' to be skipped because of status 'error'.  Reason: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  syntax error at or near ";"
  LINE 39:     dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo;
                                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql.
[0m01:43:30.987647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_matricula_detalhada, now model.transformacao_matricula.view_taxa_aprovados)
[0m01:43:30.988797 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_taxa_aprovados
[0m01:43:30.992741 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_taxa_aprovados"
[0m01:43:30.993872 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_taxa_aprovados
[0m01:43:30.998217 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_taxa_aprovados"
[0m01:43:30.999490 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m01:43:31.000511 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: BEGIN
[0m01:43:31.001298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:31.014009 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m01:43:31.014911 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m01:43:31.015757 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_taxa_aprovados"} */

  create view "transformacao_matricula"."staging_marts"."view_taxa_aprovados__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dt.modalidade_ensino,
    COUNT(fm.matricula) AS total_matriculas,
    SUM(ds.eh_aprovado) AS total_aprovados,
    SUM(ds.eh_reprovado) AS total_reprovados,
    -- Calcula a taxa de aprovação (como porcentagem)
    CAST(SUM(ds.eh_aprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_aprovacao_percentual,
    -- Calcula a taxa de reprovação (como porcentagem)
    CAST(SUM(ds.eh_reprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_reprovacao_percentual
FROM
    fato_matricula fm
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dt.modalidade_ensino
ORDER BY
    dtemp.ano, dt.modalidade_ensino;
  );
[0m01:43:31.017396 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 29:     dtemp.ano, dt.modalidade_ensino;
                                            ^

[0m01:43:31.018312 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: ROLLBACK
[0m01:43:31.020072 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: Close
[0m01:43:31.024083 [debug] [Thread-1 (]: Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  syntax error at or near ";"
  LINE 29:     dtemp.ano, dt.modalidade_ensino;
                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m01:43:31.025704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '869769b2-76e1-46b7-aac7-1a588b55cebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592cebbfdd0>]}
[0m01:43:31.027526 [error] [Thread-1 (]: 5 of 13 ERROR creating sql view model staging_marts.view_taxa_aprovados ........ [[31mERROR[0m in 0.04s]
[0m01:43:31.028757 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_taxa_aprovados
[0m01:43:31.029442 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_aluno
[0m01:43:31.030176 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_taxa_aprovados' to be skipped because of status 'error'.  Reason: Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  syntax error at or near ";"
  LINE 29:     dtemp.ano, dt.modalidade_ensino;
                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql.
[0m01:43:31.030933 [info ] [Thread-1 (]: 6 of 13 SKIP relation staging_marts.dim_aluno .................................. [[33mSKIP[0m]
[0m01:43:31.032107 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_aluno
[0m01:43:31.032833 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.transform_data
[0m01:43:31.033650 [info ] [Thread-1 (]: 7 of 13 SKIP relation staging_marts.transform_data ............................. [[33mSKIP[0m]
[0m01:43:31.034663 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.transform_data
[0m01:43:31.036618 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_escola
[0m01:43:31.037559 [info ] [Thread-1 (]: 8 of 13 SKIP relation staging_marts.dim_escola ................................. [[33mSKIP[0m]
[0m01:43:31.038600 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_escola
[0m01:43:31.039518 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_localizacao
[0m01:43:31.040696 [info ] [Thread-1 (]: 9 of 13 SKIP relation staging_marts.dim_localizacao ............................ [[33mSKIP[0m]
[0m01:43:31.041665 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_localizacao
[0m01:43:31.044427 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_situacao
[0m01:43:31.045685 [info ] [Thread-1 (]: 10 of 13 SKIP relation staging_marts.dim_situacao .............................. [[33mSKIP[0m]
[0m01:43:31.047260 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_situacao
[0m01:43:31.048337 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_tempo
[0m01:43:31.049393 [info ] [Thread-1 (]: 11 of 13 SKIP relation staging_marts.dim_tempo ................................. [[33mSKIP[0m]
[0m01:43:31.050322 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_tempo
[0m01:43:31.051211 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_turma
[0m01:43:31.052729 [info ] [Thread-1 (]: 12 of 13 SKIP relation staging_marts.dim_turma ................................. [[33mSKIP[0m]
[0m01:43:31.053731 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_turma
[0m01:43:31.055794 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.fato_matricula
[0m01:43:31.057030 [info ] [Thread-1 (]: 13 of 13 SKIP relation staging_marts.fato_matricula ............................ [[33mSKIP[0m]
[0m01:43:31.058232 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.fato_matricula
[0m01:43:31.060305 [debug] [MainThread]: Using postgres connection "master"
[0m01:43:31.061004 [debug] [MainThread]: On master: BEGIN
[0m01:43:31.061434 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:43:31.073525 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m01:43:31.074378 [debug] [MainThread]: On master: COMMIT
[0m01:43:31.074957 [debug] [MainThread]: Using postgres connection "master"
[0m01:43:31.075497 [debug] [MainThread]: On master: COMMIT
[0m01:43:31.076887 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:43:31.077724 [debug] [MainThread]: On master: Close
[0m01:43:31.078802 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:43:31.079666 [debug] [MainThread]: Connection 'model.transformacao_matricula.view_taxa_aprovados' was properly closed.
[0m01:43:31.080503 [info ] [MainThread]: 
[0m01:43:31.081241 [info ] [MainThread]: Finished running 9 table models, 4 view models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m01:43:31.084043 [debug] [MainThread]: Command end result
[0m01:43:31.120824 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m01:43:31.123787 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m01:43:31.131186 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m01:43:31.132154 [info ] [MainThread]: 
[0m01:43:31.132988 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m01:43:31.133586 [info ] [MainThread]: 
[0m01:43:31.134282 [error] [MainThread]: [31mFailure in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)[0m
[0m01:43:31.134886 [error] [MainThread]:   Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  syntax error at or near ","
  LINE 68:       WHEN sexo = 1 THEN 'Masculino',
                                               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m01:43:31.135699 [info ] [MainThread]: 
[0m01:43:31.136481 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m01:43:31.137624 [info ] [MainThread]: 
[0m01:43:31.138512 [error] [MainThread]: [31mFailure in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)[0m
[0m01:43:31.139500 [error] [MainThread]:   Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  syntax error at or near ";"
  LINE 24:     dtemp.ano, dl.desc_rpa, da.faixa_etaria;
                                                      ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m01:43:31.140633 [info ] [MainThread]: 
[0m01:43:31.141988 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m01:43:31.143414 [info ] [MainThread]: 
[0m01:43:31.145005 [error] [MainThread]: [31mFailure in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)[0m
[0m01:43:31.145759 [error] [MainThread]:   Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  syntax error at or near ";"
  LINE 25:     dtemp.ano, de.nome_escola, contagem_situacao DESC;
                                                                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m01:43:31.146719 [info ] [MainThread]: 
[0m01:43:31.147608 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m01:43:31.148320 [info ] [MainThread]: 
[0m01:43:31.149086 [error] [MainThread]: [31mFailure in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)[0m
[0m01:43:31.149878 [error] [MainThread]:   Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  syntax error at or near ";"
  LINE 39:     dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo;
                                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m01:43:31.150536 [info ] [MainThread]: 
[0m01:43:31.151367 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m01:43:31.152244 [info ] [MainThread]: 
[0m01:43:31.153251 [error] [MainThread]: [31mFailure in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)[0m
[0m01:43:31.154369 [error] [MainThread]:   Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  syntax error at or near ";"
  LINE 29:     dtemp.ano, dt.modalidade_ensino;
                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m01:43:31.155186 [info ] [MainThread]: 
[0m01:43:31.155985 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m01:43:31.156667 [info ] [MainThread]: 
[0m01:43:31.157443 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=8 NO-OP=0 TOTAL=13
[0m01:43:31.159264 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1857456, "process_in_blocks": "0", "process_kernel_time": 0.36072, "process_mem_max_rss": "123244", "process_out_blocks": "2208", "process_user_time": 1.967478}
[0m01:43:31.160217 [debug] [MainThread]: Command `dbt run` failed at 01:43:31.160077 after 1.19 seconds
[0m01:43:31.160989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592d0e03890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592d1c7f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7592d1c7cb00>]}
[0m01:43:31.161811 [debug] [MainThread]: Flushing usage events
[0m01:43:31.775514 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:44:12.007162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389a3985820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389a558e6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389a3328500>]}


============================== 01:44:12.010066 | 1a139ce1-1749-4b9c-a4fd-7876edd42767 ==============================
[0m01:44:12.010066 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:44:12.010627 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'profiles_dir': '/home/murilo/.dbt', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'static_parser': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'write_json': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'warn_error': 'None', 'no_print': 'None'}
[0m01:44:12.163593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a139ce1-1749-4b9c-a4fd-7876edd42767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389a52bfb00>]}
[0m01:44:12.212776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a139ce1-1749-4b9c-a4fd-7876edd42767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389a58070b0>]}
[0m01:44:12.213591 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:44:12.328464 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m01:44:12.415340 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:44:12.416000 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m01:44:12.727253 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.transformacao_matricula.intermediate
- models.transformacao_matricula.dimensions
- models.transformacao_matricula.facts
[0m01:44:12.738407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a139ce1-1749-4b9c-a4fd-7876edd42767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389a0982b10>]}
[0m01:44:12.819084 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m01:44:12.820765 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m01:44:12.836834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a139ce1-1749-4b9c-a4fd-7876edd42767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389a058ae70>]}
[0m01:44:12.837430 [info ] [MainThread]: Found 13 models, 2 data tests, 1 source, 459 macros
[0m01:44:12.837832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a139ce1-1749-4b9c-a4fd-7876edd42767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389a15f1ac0>]}
[0m01:44:12.840074 [info ] [MainThread]: 
[0m01:44:12.840577 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m01:44:12.840966 [info ] [MainThread]: 
[0m01:44:12.841495 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:44:12.845509 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula'
[0m01:44:12.980816 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m01:44:12.981343 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m01:44:12.981677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:44:12.992401 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m01:44:12.993671 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m01:44:12.996316 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m01:44:12.996965 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m01:44:12.997408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:44:13.005864 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m01:44:13.007065 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m01:44:13.009475 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula, now list_transformacao_matricula_staging_marts)
[0m01:44:13.014749 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m01:44:13.015203 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: BEGIN
[0m01:44:13.015502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:44:13.025259 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m01:44:13.025716 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m01:44:13.026248 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_marts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m01:44:13.030213 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m01:44:13.031744 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: ROLLBACK
[0m01:44:13.032481 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: Close
[0m01:44:13.033096 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_marts, now list_transformacao_matricula_staging_staging)
[0m01:44:13.034996 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m01:44:13.035430 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: BEGIN
[0m01:44:13.035741 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:44:13.044555 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m01:44:13.045238 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m01:44:13.045599 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_staging"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m01:44:13.048748 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m01:44:13.050438 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: ROLLBACK
[0m01:44:13.051252 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: Close
[0m01:44:13.055453 [debug] [MainThread]: Using postgres connection "master"
[0m01:44:13.055950 [debug] [MainThread]: On master: BEGIN
[0m01:44:13.056267 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:44:13.066438 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m01:44:13.066930 [debug] [MainThread]: Using postgres connection "master"
[0m01:44:13.067717 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:44:13.071453 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m01:44:13.073362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a139ce1-1749-4b9c-a4fd-7876edd42767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389a05f1820>]}
[0m01:44:13.073944 [debug] [MainThread]: On master: ROLLBACK
[0m01:44:13.074700 [debug] [MainThread]: Using postgres connection "master"
[0m01:44:13.075082 [debug] [MainThread]: On master: BEGIN
[0m01:44:13.075835 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:44:13.076251 [debug] [MainThread]: On master: COMMIT
[0m01:44:13.076568 [debug] [MainThread]: Using postgres connection "master"
[0m01:44:13.076954 [debug] [MainThread]: On master: COMMIT
[0m01:44:13.077657 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:44:13.078107 [debug] [MainThread]: On master: Close
[0m01:44:13.080630 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.staging_situacao_alunos
[0m01:44:13.081400 [info ] [Thread-1 (]: 1 of 13 START sql table model staging_staging.staging_situacao_alunos .......... [RUN]
[0m01:44:13.081925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_staging, now model.transformacao_matricula.staging_situacao_alunos)
[0m01:44:13.082380 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.staging_situacao_alunos
[0m01:44:13.088597 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.staging_situacao_alunos"
[0m01:44:13.089432 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.staging_situacao_alunos
[0m01:44:13.134158 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.staging_situacao_alunos"
[0m01:44:13.135322 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m01:44:13.135986 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: BEGIN
[0m01:44:13.136527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:44:13.146400 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:44:13.147418 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m01:44:13.148294 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */

  
    

  create  table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp"
  
  
    as
  
  (
    WITH source AS (
	SELECT * FROM "transformacao_matricula"."staging"."staging_alunos_raw"
),

cleaning_renaming AS (
	SELECT
		ano,
		codigo_escola,
		matricula,
		escola AS nome_escola,
		endereco_logradouro AS endereco_logra,
	 	endereco_bairro,
		endereco_numero,
		rpa,
		modalidade_ensino_codigo AS mod_ens_codigo,
		-- Transformação da SÉRIE
		CASE
		    -- Ensino Fundamental (1º ao 9º)
		    WHEN serie LIKE '%1 ANO%' OR serie LIKE '%1º ANO%' THEN '1º ANO'
		    WHEN serie LIKE '%2 ANO%' OR serie LIKE '%2º ANO%' THEN '2º ANO'
		    WHEN serie LIKE '%3 ANO%' OR serie LIKE '%3º ANO%' THEN '3º ANO'
		    WHEN serie LIKE '%4 ANO%' OR serie LIKE '%4º ANO%' THEN '4º ANO'
		    WHEN serie LIKE '%5 ANO%' OR serie LIKE '%5º ANO%' THEN '5º ANO'
		    WHEN serie LIKE '%6 ANO%' OR serie LIKE '%6º ANO%' THEN '6º ANO'
		    WHEN serie LIKE '%7 ANO%' OR serie LIKE '%7º ANO%' THEN '7º ANO'
		    WHEN serie LIKE '%8 ANO%' OR serie LIKE '%8º ANO%' THEN '8º ANO'
		    WHEN serie LIKE '%9 ANO%' OR serie LIKE '%9º ANO%' THEN '9º ANO'

		    -- Educação Infantil (Berçário e Grupos)
		    WHEN serie LIKE '%BER%' THEN 'BERÇARIO' -- Pega BERÇARIO e BERRIO
		    WHEN serie LIKE '%GRUPO I%' OR serie LIKE '%GRUPO 1%' THEN 'GRUPO I'
		    WHEN serie LIKE '%GRUPO II%' THEN 'GRUPO II'
		    WHEN serie LIKE '%GRUPO III%' THEN 'GRUPO III'
		    WHEN serie LIKE '%GRUPO IV%' THEN 'GRUPO IV'
		    WHEN serie LIKE '%GRUPO V%' THEN 'GRUPO V'

		    -- EJA (Módulos 1 ao 5) 
		    WHEN serie LIKE '%1%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 1'
		    WHEN serie LIKE '%2%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 2'
		    WHEN serie LIKE '%3%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 3'
		    WHEN serie LIKE '%4%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 4'
		    WHEN serie LIKE '%5%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 5'

		    WHEN serie LIKE '%TRAVESSIA%' THEN 'TRAVESSIA RECIFE'
		    WHEN serie LIKE '%CORRECAO%1%' THEN 'CORREÇÃO DE FLUXO 1 - ALFABETIZACAO'
		    WHEN serie LIKE '%CORRECAO%2%' THEN 'CORREÇÃO DE FLUXO 2 - ACELERACAO'

		    ELSE 'OUTROS'
		END AS serie,
		turma,
		turno,
		matricula,
		idade,

		-- transformação do SEXO
		CASE
		    WHEN sexo = 1 THEN 'Masculino'
	 	    WHEN sexo = 2 THEN 'Feminino'
		    WHEN sexo = 3 THEN 'Outros'				
		    ELSE 'Não informado' -- Para cobrir valores inesperados
		END AS sexo,

		idade,
		-- transformação de situacao
		CASE 
		    WHEN situacao_nome LIKE '%APROV%' THEN 'Aprovado',
		    WHEN situacao_nome LIKE '%RET%' OR situacao_nome LIKE '%REPRO%' THEN 'Reprovado',
		    WHEN situacao_nome LIKE '%TR%' OR situacao_nome LIKE '%REMAN%' THEN 'Transferido',
		    WHEN situacao_nome LIKE '%DESIST%' THEN 'Desistente'
		END AS sit_nome,

		-- Transformação da MODALIDADE
		CASE
		    WHEN modalidade_ensino LIKE '%EDUCACAO INFANTIL%' THEN 'EDUCAÇÃO INFANTIL'
		    WHEN modalidade_ensino LIKE '%ENSINO FUNDAMENTAL%' THEN 'ENSINO FUNDAMENTAL'
		    WHEN modalidade_ensino LIKE '%EDUCACAO JOVENS E ADULTOS%' THEN 'EJA'
		    WHEN modalidade_ensino LIKE '%CORRE%' THEN 'CORREÇÃO DE FLUXO' -- Pega "CORREÇÃO" e "CORREO"
		    ELSE 'OUTROS'
		END AS modalidade_ens,

		
	FROM source
)

SELECT * FROM cleaning_renaming
  );
  
[0m01:44:13.149881 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 77:       WHEN situacao_nome LIKE '%APROV%' THEN 'Aprovado',
                                                                ^

[0m01:44:13.150391 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: ROLLBACK
[0m01:44:13.151210 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: Close
[0m01:44:13.154373 [debug] [Thread-1 (]: Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  syntax error at or near ","
  LINE 77:       WHEN situacao_nome LIKE '%APROV%' THEN 'Aprovado',
                                                                  ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m01:44:13.156179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a139ce1-1749-4b9c-a4fd-7876edd42767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389a3960b90>]}
[0m01:44:13.157116 [error] [Thread-1 (]: 1 of 13 ERROR creating sql table model staging_staging.staging_situacao_alunos . [[31mERROR[0m in 0.07s]
[0m01:44:13.159659 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.staging_situacao_alunos
[0m01:44:13.160405 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_count_aluno_idade
[0m01:44:13.161244 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.staging_situacao_alunos' to be skipped because of status 'error'.  Reason: Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  syntax error at or near ","
  LINE 77:       WHEN situacao_nome LIKE '%APROV%' THEN 'Aprovado',
                                                                  ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql.
[0m01:44:13.161987 [info ] [Thread-1 (]: 2 of 13 START sql view model staging_marts.view_count_aluno_idade .............. [RUN]
[0m01:44:13.163611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.staging_situacao_alunos, now model.transformacao_matricula.view_count_aluno_idade)
[0m01:44:13.164252 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_count_aluno_idade
[0m01:44:13.167488 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_count_aluno_idade"
[0m01:44:13.168507 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_count_aluno_idade
[0m01:44:13.197044 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_count_aluno_idade"
[0m01:44:13.198403 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m01:44:13.199359 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: BEGIN
[0m01:44:13.200251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:44:13.213581 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m01:44:13.214422 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m01:44:13.215104 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_count_aluno_idade"} */

  create view "transformacao_matricula"."staging_marts"."view_count_aluno_idade__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dl.desc_rpa,
    da.faixa_etaria,
    COUNT(fm.matricula) AS total_alunos
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
ORDER BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria;
  );
[0m01:44:13.216455 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 24:     dtemp.ano, dl.desc_rpa, da.faixa_etaria;
                                                    ^

[0m01:44:13.217233 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: ROLLBACK
[0m01:44:13.218379 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: Close
[0m01:44:13.222629 [debug] [Thread-1 (]: Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  syntax error at or near ";"
  LINE 24:     dtemp.ano, dl.desc_rpa, da.faixa_etaria;
                                                      ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m01:44:13.223770 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a139ce1-1749-4b9c-a4fd-7876edd42767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389a1dd3260>]}
[0m01:44:13.224872 [error] [Thread-1 (]: 2 of 13 ERROR creating sql view model staging_marts.view_count_aluno_idade ..... [[31mERROR[0m in 0.06s]
[0m01:44:13.225681 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_count_aluno_idade
[0m01:44:13.226224 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m01:44:13.227181 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_count_aluno_idade' to be skipped because of status 'error'.  Reason: Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  syntax error at or near ";"
  LINE 24:     dtemp.ano, dl.desc_rpa, da.faixa_etaria;
                                                      ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql.
[0m01:44:13.227835 [info ] [Thread-1 (]: 3 of 13 START sql view model staging_marts.view_frequencia_situacao_escola ..... [RUN]
[0m01:44:13.228692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_count_aluno_idade, now model.transformacao_matricula.view_frequencia_situacao_escola)
[0m01:44:13.229222 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_frequencia_situacao_escola
[0m01:44:13.232472 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m01:44:13.233594 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_frequencia_situacao_escola
[0m01:44:13.238029 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m01:44:13.239064 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m01:44:13.239484 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: BEGIN
[0m01:44:13.239883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:44:13.248918 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m01:44:13.249497 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m01:44:13.249941 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_frequencia_situacao_escola"} */

  create view "transformacao_matricula"."staging_marts"."view_frequencia_situacao_escola__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    de.nome_escola,
    de.codigo_escola,
    ds.situacao_nome,
    COUNT(fm.matricula) AS contagem_situacao
FROM
    fato_matricula fm
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, de.nome_escola, de.codigo_escola, ds.situacao_nome
ORDER BY
    dtemp.ano, de.nome_escola, contagem_situacao DESC;
  );
[0m01:44:13.251032 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 25:     dtemp.ano, de.nome_escola, contagem_situacao DESC;
                                                              ^

[0m01:44:13.252073 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: ROLLBACK
[0m01:44:13.253435 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: Close
[0m01:44:13.256629 [debug] [Thread-1 (]: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  syntax error at or near ";"
  LINE 25:     dtemp.ano, de.nome_escola, contagem_situacao DESC;
                                                                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m01:44:13.258551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a139ce1-1749-4b9c-a4fd-7876edd42767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389a0d1a9f0>]}
[0m01:44:13.260953 [error] [Thread-1 (]: 3 of 13 ERROR creating sql view model staging_marts.view_frequencia_situacao_escola  [[31mERROR[0m in 0.03s]
[0m01:44:13.262162 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m01:44:13.262820 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_matricula_detalhada
[0m01:44:13.263726 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_frequencia_situacao_escola' to be skipped because of status 'error'.  Reason: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  syntax error at or near ";"
  LINE 25:     dtemp.ano, de.nome_escola, contagem_situacao DESC;
                                                                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql.
[0m01:44:13.264837 [info ] [Thread-1 (]: 4 of 13 START sql view model staging_marts.view_matricula_detalhada ............ [RUN]
[0m01:44:13.265911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_frequencia_situacao_escola, now model.transformacao_matricula.view_matricula_detalhada)
[0m01:44:13.266518 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_matricula_detalhada
[0m01:44:13.270527 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_matricula_detalhada"
[0m01:44:13.271786 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_matricula_detalhada
[0m01:44:13.276974 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_matricula_detalhada"
[0m01:44:13.278309 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m01:44:13.279143 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: BEGIN
[0m01:44:13.279859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:44:13.293759 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m01:44:13.294777 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m01:44:13.295664 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_matricula_detalhada"} */

  create view "transformacao_matricula"."staging_marts"."view_matricula_detalhada__dbt_tmp"
    
    
  as (
    
SELECT
    fm.matricula,
    da.sexo,
    da.idade,
    da.faixa_etaria,
    de.nome_escola,
    de.codigo_escola,
    dt.turma,
    dt.turno,
    dt.serie,
    dt.modalidade_ensino,
    ds.situacao_nome,
    ds.categoria AS categoria_situacao,
    ds.eh_aprovado,
    ds.eh_reprovado,
    dl.desc_rpa,
    dl.endereco_bairro AS bairro_localizacao,
    dtemp.ano AS ano_registro
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo;
  );
[0m01:44:13.297772 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 39:     dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo;
                                                            ^

[0m01:44:13.298780 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: ROLLBACK
[0m01:44:13.300363 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: Close
[0m01:44:13.306615 [debug] [Thread-1 (]: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  syntax error at or near ";"
  LINE 39:     dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo;
                                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m01:44:13.308077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a139ce1-1749-4b9c-a4fd-7876edd42767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389a0d0e120>]}
[0m01:44:13.309833 [error] [Thread-1 (]: 4 of 13 ERROR creating sql view model staging_marts.view_matricula_detalhada ... [[31mERROR[0m in 0.04s]
[0m01:44:13.311344 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_matricula_detalhada
[0m01:44:13.312372 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_taxa_aprovados
[0m01:44:13.313448 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_matricula_detalhada' to be skipped because of status 'error'.  Reason: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  syntax error at or near ";"
  LINE 39:     dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo;
                                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql.
[0m01:44:13.314269 [info ] [Thread-1 (]: 5 of 13 START sql view model staging_marts.view_taxa_aprovados ................. [RUN]
[0m01:44:13.315407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_matricula_detalhada, now model.transformacao_matricula.view_taxa_aprovados)
[0m01:44:13.316197 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_taxa_aprovados
[0m01:44:13.319910 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_taxa_aprovados"
[0m01:44:13.320887 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_taxa_aprovados
[0m01:44:13.324891 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_taxa_aprovados"
[0m01:44:13.325812 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m01:44:13.326305 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: BEGIN
[0m01:44:13.326762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:44:13.338774 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m01:44:13.339578 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m01:44:13.340444 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_taxa_aprovados"} */

  create view "transformacao_matricula"."staging_marts"."view_taxa_aprovados__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dt.modalidade_ensino,
    COUNT(fm.matricula) AS total_matriculas,
    SUM(ds.eh_aprovado) AS total_aprovados,
    SUM(ds.eh_reprovado) AS total_reprovados,
    -- Calcula a taxa de aprovação (como porcentagem)
    CAST(SUM(ds.eh_aprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_aprovacao_percentual,
    -- Calcula a taxa de reprovação (como porcentagem)
    CAST(SUM(ds.eh_reprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_reprovacao_percentual
FROM
    fato_matricula fm
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dt.modalidade_ensino
ORDER BY
    dtemp.ano, dt.modalidade_ensino;
  );
[0m01:44:13.341926 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 29:     dtemp.ano, dt.modalidade_ensino;
                                            ^

[0m01:44:13.342665 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: ROLLBACK
[0m01:44:13.343781 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: Close
[0m01:44:13.351743 [debug] [Thread-1 (]: Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  syntax error at or near ";"
  LINE 29:     dtemp.ano, dt.modalidade_ensino;
                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m01:44:13.352719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a139ce1-1749-4b9c-a4fd-7876edd42767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389a0940680>]}
[0m01:44:13.353884 [error] [Thread-1 (]: 5 of 13 ERROR creating sql view model staging_marts.view_taxa_aprovados ........ [[31mERROR[0m in 0.04s]
[0m01:44:13.355197 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_taxa_aprovados
[0m01:44:13.355978 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_aluno
[0m01:44:13.356927 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_taxa_aprovados' to be skipped because of status 'error'.  Reason: Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  syntax error at or near ";"
  LINE 29:     dtemp.ano, dt.modalidade_ensino;
                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql.
[0m01:44:13.358064 [info ] [Thread-1 (]: 6 of 13 SKIP relation staging_marts.dim_aluno .................................. [[33mSKIP[0m]
[0m01:44:13.361324 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_aluno
[0m01:44:13.362374 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.transform_data
[0m01:44:13.363203 [info ] [Thread-1 (]: 7 of 13 SKIP relation staging_marts.transform_data ............................. [[33mSKIP[0m]
[0m01:44:13.363998 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.transform_data
[0m01:44:13.365337 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_escola
[0m01:44:13.366183 [info ] [Thread-1 (]: 8 of 13 SKIP relation staging_marts.dim_escola ................................. [[33mSKIP[0m]
[0m01:44:13.366947 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_escola
[0m01:44:13.367693 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_localizacao
[0m01:44:13.368504 [info ] [Thread-1 (]: 9 of 13 SKIP relation staging_marts.dim_localizacao ............................ [[33mSKIP[0m]
[0m01:44:13.369316 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_localizacao
[0m01:44:13.370169 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_situacao
[0m01:44:13.371169 [info ] [Thread-1 (]: 10 of 13 SKIP relation staging_marts.dim_situacao .............................. [[33mSKIP[0m]
[0m01:44:13.372236 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_situacao
[0m01:44:13.373118 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_tempo
[0m01:44:13.373964 [info ] [Thread-1 (]: 11 of 13 SKIP relation staging_marts.dim_tempo ................................. [[33mSKIP[0m]
[0m01:44:13.374762 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_tempo
[0m01:44:13.375504 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_turma
[0m01:44:13.376383 [info ] [Thread-1 (]: 12 of 13 SKIP relation staging_marts.dim_turma ................................. [[33mSKIP[0m]
[0m01:44:13.377048 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_turma
[0m01:44:13.378320 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.fato_matricula
[0m01:44:13.378974 [info ] [Thread-1 (]: 13 of 13 SKIP relation staging_marts.fato_matricula ............................ [[33mSKIP[0m]
[0m01:44:13.379515 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.fato_matricula
[0m01:44:13.381249 [debug] [MainThread]: Using postgres connection "master"
[0m01:44:13.381808 [debug] [MainThread]: On master: BEGIN
[0m01:44:13.382297 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:44:13.396037 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m01:44:13.396936 [debug] [MainThread]: On master: COMMIT
[0m01:44:13.397436 [debug] [MainThread]: Using postgres connection "master"
[0m01:44:13.397943 [debug] [MainThread]: On master: COMMIT
[0m01:44:13.398862 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:44:13.399317 [debug] [MainThread]: On master: Close
[0m01:44:13.399906 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:44:13.400296 [debug] [MainThread]: Connection 'model.transformacao_matricula.view_taxa_aprovados' was properly closed.
[0m01:44:13.400837 [info ] [MainThread]: 
[0m01:44:13.401297 [info ] [MainThread]: Finished running 9 table models, 4 view models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m01:44:13.402803 [debug] [MainThread]: Command end result
[0m01:44:13.438270 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m01:44:13.441181 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m01:44:13.449723 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m01:44:13.450458 [info ] [MainThread]: 
[0m01:44:13.451134 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m01:44:13.451771 [info ] [MainThread]: 
[0m01:44:13.452512 [error] [MainThread]: [31mFailure in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)[0m
[0m01:44:13.453246 [error] [MainThread]:   Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  syntax error at or near ","
  LINE 77:       WHEN situacao_nome LIKE '%APROV%' THEN 'Aprovado',
                                                                  ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m01:44:13.453853 [info ] [MainThread]: 
[0m01:44:13.454519 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m01:44:13.455135 [info ] [MainThread]: 
[0m01:44:13.455823 [error] [MainThread]: [31mFailure in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)[0m
[0m01:44:13.456607 [error] [MainThread]:   Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  syntax error at or near ";"
  LINE 24:     dtemp.ano, dl.desc_rpa, da.faixa_etaria;
                                                      ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m01:44:13.457525 [info ] [MainThread]: 
[0m01:44:13.458521 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m01:44:13.459489 [info ] [MainThread]: 
[0m01:44:13.461935 [error] [MainThread]: [31mFailure in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)[0m
[0m01:44:13.462938 [error] [MainThread]:   Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  syntax error at or near ";"
  LINE 25:     dtemp.ano, de.nome_escola, contagem_situacao DESC;
                                                                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m01:44:13.463670 [info ] [MainThread]: 
[0m01:44:13.464463 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m01:44:13.465093 [info ] [MainThread]: 
[0m01:44:13.465792 [error] [MainThread]: [31mFailure in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)[0m
[0m01:44:13.466518 [error] [MainThread]:   Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  syntax error at or near ";"
  LINE 39:     dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo;
                                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m01:44:13.467216 [info ] [MainThread]: 
[0m01:44:13.468099 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m01:44:13.468932 [info ] [MainThread]: 
[0m01:44:13.469543 [error] [MainThread]: [31mFailure in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)[0m
[0m01:44:13.470068 [error] [MainThread]:   Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  syntax error at or near ";"
  LINE 29:     dtemp.ano, dt.modalidade_ensino;
                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m01:44:13.470510 [info ] [MainThread]: 
[0m01:44:13.471022 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m01:44:13.471457 [info ] [MainThread]: 
[0m01:44:13.471993 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=8 NO-OP=0 TOTAL=13
[0m01:44:13.473403 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5105724, "process_in_blocks": "0", "process_kernel_time": 0.343851, "process_mem_max_rss": "127948", "process_out_blocks": "3176", "process_user_time": 2.329217}
[0m01:44:13.474198 [debug] [MainThread]: Command `dbt run` failed at 01:44:13.474076 after 1.51 seconds
[0m01:44:13.474725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389a058bfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73899d84dfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73899d84e4b0>]}
[0m01:44:13.475248 [debug] [MainThread]: Flushing usage events
[0m01:44:14.085313 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:44:43.671902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757f5e9557f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757f5de3a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757f5e53af90>]}


============================== 01:44:43.675009 | b525a6b7-c130-41ea-8900-cdef45ff49b4 ==============================
[0m01:44:43.675009 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:44:43.675624 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'debug': 'False', 'empty': 'False', 'target_path': 'None', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'profiles_dir': '/home/murilo/.dbt', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'version_check': 'True', 'introspect': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'use_colors': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'partial_parse': 'True', 'log_cache_events': 'False'}
[0m01:44:43.832972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b525a6b7-c130-41ea-8900-cdef45ff49b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757f5dc979b0>]}
[0m01:44:43.883836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b525a6b7-c130-41ea-8900-cdef45ff49b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757f5dc69e80>]}
[0m01:44:43.884678 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:44:44.004733 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m01:44:44.094334 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:44:44.095017 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m01:44:44.415127 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.transformacao_matricula.intermediate
- models.transformacao_matricula.dimensions
- models.transformacao_matricula.facts
[0m01:44:44.428019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b525a6b7-c130-41ea-8900-cdef45ff49b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757f5bf8ab10>]}
[0m01:44:44.514473 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m01:44:44.516329 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m01:44:44.530277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b525a6b7-c130-41ea-8900-cdef45ff49b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757f5bbf1cd0>]}
[0m01:44:44.530944 [info ] [MainThread]: Found 13 models, 2 data tests, 1 source, 459 macros
[0m01:44:44.531397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b525a6b7-c130-41ea-8900-cdef45ff49b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757f5bf9ef00>]}
[0m01:44:44.533427 [info ] [MainThread]: 
[0m01:44:44.533952 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m01:44:44.534322 [info ] [MainThread]: 
[0m01:44:44.534825 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:44:44.539463 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula'
[0m01:44:44.678415 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m01:44:44.678970 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m01:44:44.679308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:44:44.691167 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.012 seconds
[0m01:44:44.692444 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m01:44:44.694591 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m01:44:44.695200 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m01:44:44.695578 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:44:44.705323 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m01:44:44.706548 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m01:44:44.709124 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula, now list_transformacao_matricula_staging_marts)
[0m01:44:44.715175 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m01:44:44.715623 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: BEGIN
[0m01:44:44.715954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:44:44.725468 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m01:44:44.725947 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m01:44:44.726277 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_marts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m01:44:44.729890 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m01:44:44.731405 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: ROLLBACK
[0m01:44:44.732297 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: Close
[0m01:44:44.733043 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_marts, now list_transformacao_matricula_staging_staging)
[0m01:44:44.735009 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m01:44:44.735513 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: BEGIN
[0m01:44:44.735924 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:44:44.745790 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m01:44:44.746621 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m01:44:44.747349 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_staging"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m01:44:44.750833 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m01:44:44.752784 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: ROLLBACK
[0m01:44:44.753695 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: Close
[0m01:44:44.758805 [debug] [MainThread]: Using postgres connection "master"
[0m01:44:44.759310 [debug] [MainThread]: On master: BEGIN
[0m01:44:44.759619 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:44:44.768793 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m01:44:44.769252 [debug] [MainThread]: Using postgres connection "master"
[0m01:44:44.769611 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:44:44.772797 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m01:44:44.774136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b525a6b7-c130-41ea-8900-cdef45ff49b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757f5b761df0>]}
[0m01:44:44.774829 [debug] [MainThread]: On master: ROLLBACK
[0m01:44:44.775676 [debug] [MainThread]: Using postgres connection "master"
[0m01:44:44.776116 [debug] [MainThread]: On master: BEGIN
[0m01:44:44.777091 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:44:44.777542 [debug] [MainThread]: On master: COMMIT
[0m01:44:44.777882 [debug] [MainThread]: Using postgres connection "master"
[0m01:44:44.778183 [debug] [MainThread]: On master: COMMIT
[0m01:44:44.778968 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:44:44.779359 [debug] [MainThread]: On master: Close
[0m01:44:44.782205 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.staging_situacao_alunos
[0m01:44:44.783024 [info ] [Thread-1 (]: 1 of 13 START sql table model staging_staging.staging_situacao_alunos .......... [RUN]
[0m01:44:44.783641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_staging, now model.transformacao_matricula.staging_situacao_alunos)
[0m01:44:44.784229 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.staging_situacao_alunos
[0m01:44:44.790936 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.staging_situacao_alunos"
[0m01:44:44.791922 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.staging_situacao_alunos
[0m01:44:44.839638 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.staging_situacao_alunos"
[0m01:44:44.840725 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m01:44:44.841357 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: BEGIN
[0m01:44:44.841903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:44:44.852221 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m01:44:44.852748 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m01:44:44.853605 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */

  
    

  create  table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp"
  
  
    as
  
  (
    WITH source AS (
	SELECT * FROM "transformacao_matricula"."staging"."staging_alunos_raw"
),

cleaning_renaming AS (
	SELECT
		ano,
		codigo_escola,
		matricula,
		escola AS nome_escola,
		endereco_logradouro AS endereco_logra,
	 	endereco_bairro,
		endereco_numero,
		rpa,
		modalidade_ensino_codigo AS mod_ens_codigo,
		-- Transformação da SÉRIE
		CASE
		    -- Ensino Fundamental (1º ao 9º)
		    WHEN serie LIKE '%1 ANO%' OR serie LIKE '%1º ANO%' THEN '1º ANO'
		    WHEN serie LIKE '%2 ANO%' OR serie LIKE '%2º ANO%' THEN '2º ANO'
		    WHEN serie LIKE '%3 ANO%' OR serie LIKE '%3º ANO%' THEN '3º ANO'
		    WHEN serie LIKE '%4 ANO%' OR serie LIKE '%4º ANO%' THEN '4º ANO'
		    WHEN serie LIKE '%5 ANO%' OR serie LIKE '%5º ANO%' THEN '5º ANO'
		    WHEN serie LIKE '%6 ANO%' OR serie LIKE '%6º ANO%' THEN '6º ANO'
		    WHEN serie LIKE '%7 ANO%' OR serie LIKE '%7º ANO%' THEN '7º ANO'
		    WHEN serie LIKE '%8 ANO%' OR serie LIKE '%8º ANO%' THEN '8º ANO'
		    WHEN serie LIKE '%9 ANO%' OR serie LIKE '%9º ANO%' THEN '9º ANO'

		    -- Educação Infantil (Berçário e Grupos)
		    WHEN serie LIKE '%BER%' THEN 'BERÇARIO' -- Pega BERÇARIO e BERRIO
		    WHEN serie LIKE '%GRUPO I%' OR serie LIKE '%GRUPO 1%' THEN 'GRUPO I'
		    WHEN serie LIKE '%GRUPO II%' THEN 'GRUPO II'
		    WHEN serie LIKE '%GRUPO III%' THEN 'GRUPO III'
		    WHEN serie LIKE '%GRUPO IV%' THEN 'GRUPO IV'
		    WHEN serie LIKE '%GRUPO V%' THEN 'GRUPO V'

		    -- EJA (Módulos 1 ao 5) 
		    WHEN serie LIKE '%1%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 1'
		    WHEN serie LIKE '%2%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 2'
		    WHEN serie LIKE '%3%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 3'
		    WHEN serie LIKE '%4%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 4'
		    WHEN serie LIKE '%5%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 5'

		    WHEN serie LIKE '%TRAVESSIA%' THEN 'TRAVESSIA RECIFE'
		    WHEN serie LIKE '%CORRECAO%1%' THEN 'CORREÇÃO DE FLUXO 1 - ALFABETIZACAO'
		    WHEN serie LIKE '%CORRECAO%2%' THEN 'CORREÇÃO DE FLUXO 2 - ACELERACAO'

		    ELSE 'OUTROS'
		END AS serie,
		turma,
		turno,
		matricula,
		idade,

		-- transformação do SEXO
		CASE
		    WHEN sexo = 1 THEN 'Masculino'
	 	    WHEN sexo = 2 THEN 'Feminino'
		    WHEN sexo = 3 THEN 'Outros'				
		    ELSE 'Não informado' -- Para cobrir valores inesperados
		END AS sexo,

		idade,
		-- transformação de situacao
		CASE 
		    WHEN situacao_nome LIKE '%APROV%' THEN 'Aprovado'
		    WHEN situacao_nome LIKE '%RET%' OR situacao_nome LIKE '%REPRO%' THEN 'Reprovado'
		    WHEN situacao_nome LIKE '%TR%' OR situacao_nome LIKE '%REMAN%' THEN 'Transferido'
		    WHEN situacao_nome LIKE '%DESIST%' THEN 'Desistente'
		END AS sit_nome,

		-- Transformação da MODALIDADE
		CASE
		    WHEN modalidade_ensino LIKE '%EDUCACAO INFANTIL%' THEN 'EDUCAÇÃO INFANTIL'
		    WHEN modalidade_ensino LIKE '%ENSINO FUNDAMENTAL%' THEN 'ENSINO FUNDAMENTAL'
		    WHEN modalidade_ensino LIKE '%EDUCACAO JOVENS E ADULTOS%' THEN 'EJA'
		    WHEN modalidade_ensino LIKE '%CORRE%' THEN 'CORREÇÃO DE FLUXO' -- Pega "CORREÇÃO" e "CORREO"
		    ELSE 'OUTROS'
		END AS modalidade_ens,

		
	FROM source
)

SELECT * FROM cleaning_renaming
  );
  
[0m01:44:44.855431 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 93:  FROM source
          ^

[0m01:44:44.856086 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: ROLLBACK
[0m01:44:44.857067 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: Close
[0m01:44:44.862233 [debug] [Thread-1 (]: Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  syntax error at or near "FROM"
  LINE 93:  FROM source
            ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m01:44:44.863981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b525a6b7-c130-41ea-8900-cdef45ff49b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757f5ec5cad0>]}
[0m01:44:44.864683 [error] [Thread-1 (]: 1 of 13 ERROR creating sql table model staging_staging.staging_situacao_alunos . [[31mERROR[0m in 0.08s]
[0m01:44:44.865285 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.staging_situacao_alunos
[0m01:44:44.865690 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_count_aluno_idade
[0m01:44:44.866139 [info ] [Thread-1 (]: 2 of 13 START sql view model staging_marts.view_count_aluno_idade .............. [RUN]
[0m01:44:44.866874 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.staging_situacao_alunos' to be skipped because of status 'error'.  Reason: Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  syntax error at or near "FROM"
  LINE 93:  FROM source
            ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql.
[0m01:44:44.867389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.staging_situacao_alunos, now model.transformacao_matricula.view_count_aluno_idade)
[0m01:44:44.868648 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_count_aluno_idade
[0m01:44:44.871464 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_count_aluno_idade"
[0m01:44:44.872307 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_count_aluno_idade
[0m01:44:44.902602 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_count_aluno_idade"
[0m01:44:44.904066 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m01:44:44.904924 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: BEGIN
[0m01:44:44.905647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:44:44.918243 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m01:44:44.919009 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m01:44:44.919631 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_count_aluno_idade"} */

  create view "transformacao_matricula"."staging_marts"."view_count_aluno_idade__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dl.desc_rpa,
    da.faixa_etaria,
    COUNT(fm.matricula) AS total_alunos
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
ORDER BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria;
  );
[0m01:44:44.921146 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 24:     dtemp.ano, dl.desc_rpa, da.faixa_etaria;
                                                    ^

[0m01:44:44.921972 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: ROLLBACK
[0m01:44:44.923349 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: Close
[0m01:44:44.928925 [debug] [Thread-1 (]: Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  syntax error at or near ";"
  LINE 24:     dtemp.ano, dl.desc_rpa, da.faixa_etaria;
                                                      ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m01:44:44.930675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b525a6b7-c130-41ea-8900-cdef45ff49b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757f5dd18a70>]}
[0m01:44:44.931749 [error] [Thread-1 (]: 2 of 13 ERROR creating sql view model staging_marts.view_count_aluno_idade ..... [[31mERROR[0m in 0.06s]
[0m01:44:44.932640 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_count_aluno_idade
[0m01:44:44.933282 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m01:44:44.934183 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_count_aluno_idade' to be skipped because of status 'error'.  Reason: Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  syntax error at or near ";"
  LINE 24:     dtemp.ano, dl.desc_rpa, da.faixa_etaria;
                                                      ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql.
[0m01:44:44.935422 [info ] [Thread-1 (]: 3 of 13 START sql view model staging_marts.view_frequencia_situacao_escola ..... [RUN]
[0m01:44:44.936458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_count_aluno_idade, now model.transformacao_matricula.view_frequencia_situacao_escola)
[0m01:44:44.937057 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_frequencia_situacao_escola
[0m01:44:44.940571 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m01:44:44.941490 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_frequencia_situacao_escola
[0m01:44:44.946518 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m01:44:44.947538 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m01:44:44.948059 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: BEGIN
[0m01:44:44.948504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:44:44.957754 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m01:44:44.958727 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m01:44:44.959717 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_frequencia_situacao_escola"} */

  create view "transformacao_matricula"."staging_marts"."view_frequencia_situacao_escola__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    de.nome_escola,
    de.codigo_escola,
    ds.situacao_nome,
    COUNT(fm.matricula) AS contagem_situacao
FROM
    fato_matricula fm
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, de.nome_escola, de.codigo_escola, ds.situacao_nome
ORDER BY
    dtemp.ano, de.nome_escola, contagem_situacao DESC;
  );
[0m01:44:44.961050 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 25:     dtemp.ano, de.nome_escola, contagem_situacao DESC;
                                                              ^

[0m01:44:44.961716 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: ROLLBACK
[0m01:44:44.962681 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: Close
[0m01:44:44.966452 [debug] [Thread-1 (]: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  syntax error at or near ";"
  LINE 25:     dtemp.ano, de.nome_escola, contagem_situacao DESC;
                                                                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m01:44:44.967713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b525a6b7-c130-41ea-8900-cdef45ff49b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757f5cb7b7d0>]}
[0m01:44:44.968571 [error] [Thread-1 (]: 3 of 13 ERROR creating sql view model staging_marts.view_frequencia_situacao_escola  [[31mERROR[0m in 0.03s]
[0m01:44:44.969432 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m01:44:44.970015 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_matricula_detalhada
[0m01:44:44.970606 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_frequencia_situacao_escola' to be skipped because of status 'error'.  Reason: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  syntax error at or near ";"
  LINE 25:     dtemp.ano, de.nome_escola, contagem_situacao DESC;
                                                                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql.
[0m01:44:44.971434 [info ] [Thread-1 (]: 4 of 13 START sql view model staging_marts.view_matricula_detalhada ............ [RUN]
[0m01:44:44.972400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_frequencia_situacao_escola, now model.transformacao_matricula.view_matricula_detalhada)
[0m01:44:44.973022 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_matricula_detalhada
[0m01:44:44.976415 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_matricula_detalhada"
[0m01:44:44.978056 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_matricula_detalhada
[0m01:44:44.988553 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_matricula_detalhada"
[0m01:44:44.990150 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m01:44:44.991105 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: BEGIN
[0m01:44:44.992060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:44:45.007214 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m01:44:45.008806 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m01:44:45.011247 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_matricula_detalhada"} */

  create view "transformacao_matricula"."staging_marts"."view_matricula_detalhada__dbt_tmp"
    
    
  as (
    
SELECT
    fm.matricula,
    da.sexo,
    da.idade,
    da.faixa_etaria,
    de.nome_escola,
    de.codigo_escola,
    dt.turma,
    dt.turno,
    dt.serie,
    dt.modalidade_ensino,
    ds.situacao_nome,
    ds.categoria AS categoria_situacao,
    ds.eh_aprovado,
    ds.eh_reprovado,
    dl.desc_rpa,
    dl.endereco_bairro AS bairro_localizacao,
    dtemp.ano AS ano_registro
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo;
  );
[0m01:44:45.015997 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 39:     dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo;
                                                            ^

[0m01:44:45.017127 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: ROLLBACK
[0m01:44:45.019366 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: Close
[0m01:44:45.023905 [debug] [Thread-1 (]: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  syntax error at or near ";"
  LINE 39:     dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo;
                                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m01:44:45.025145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b525a6b7-c130-41ea-8900-cdef45ff49b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757f5c3e7d40>]}
[0m01:44:45.026762 [error] [Thread-1 (]: 4 of 13 ERROR creating sql view model staging_marts.view_matricula_detalhada ... [[31mERROR[0m in 0.05s]
[0m01:44:45.028607 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_matricula_detalhada
[0m01:44:45.029730 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_taxa_aprovados
[0m01:44:45.030917 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_matricula_detalhada' to be skipped because of status 'error'.  Reason: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  syntax error at or near ";"
  LINE 39:     dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo;
                                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql.
[0m01:44:45.032256 [info ] [Thread-1 (]: 5 of 13 START sql view model staging_marts.view_taxa_aprovados ................. [RUN]
[0m01:44:45.034196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_matricula_detalhada, now model.transformacao_matricula.view_taxa_aprovados)
[0m01:44:45.035660 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_taxa_aprovados
[0m01:44:45.039045 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_taxa_aprovados"
[0m01:44:45.040069 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_taxa_aprovados
[0m01:44:45.044141 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_taxa_aprovados"
[0m01:44:45.046440 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m01:44:45.049664 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: BEGIN
[0m01:44:45.050574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:44:45.062706 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m01:44:45.063696 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m01:44:45.064565 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_taxa_aprovados"} */

  create view "transformacao_matricula"."staging_marts"."view_taxa_aprovados__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dt.modalidade_ensino,
    COUNT(fm.matricula) AS total_matriculas,
    SUM(ds.eh_aprovado) AS total_aprovados,
    SUM(ds.eh_reprovado) AS total_reprovados,
    -- Calcula a taxa de aprovação (como porcentagem)
    CAST(SUM(ds.eh_aprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_aprovacao_percentual,
    -- Calcula a taxa de reprovação (como porcentagem)
    CAST(SUM(ds.eh_reprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_reprovacao_percentual
FROM
    fato_matricula fm
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dt.modalidade_ensino
ORDER BY
    dtemp.ano, dt.modalidade_ensino;
  );
[0m01:44:45.066294 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 29:     dtemp.ano, dt.modalidade_ensino;
                                            ^

[0m01:44:45.067217 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: ROLLBACK
[0m01:44:45.068699 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: Close
[0m01:44:45.072691 [debug] [Thread-1 (]: Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  syntax error at or near ";"
  LINE 29:     dtemp.ano, dt.modalidade_ensino;
                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m01:44:45.074071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b525a6b7-c130-41ea-8900-cdef45ff49b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757f5bf7c830>]}
[0m01:44:45.075262 [error] [Thread-1 (]: 5 of 13 ERROR creating sql view model staging_marts.view_taxa_aprovados ........ [[31mERROR[0m in 0.04s]
[0m01:44:45.076259 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_taxa_aprovados
[0m01:44:45.076900 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_aluno
[0m01:44:45.077615 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_taxa_aprovados' to be skipped because of status 'error'.  Reason: Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  syntax error at or near ";"
  LINE 29:     dtemp.ano, dt.modalidade_ensino;
                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql.
[0m01:44:45.078426 [info ] [Thread-1 (]: 6 of 13 SKIP relation staging_marts.dim_aluno .................................. [[33mSKIP[0m]
[0m01:44:45.079797 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_aluno
[0m01:44:45.083235 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.transform_data
[0m01:44:45.084835 [info ] [Thread-1 (]: 7 of 13 SKIP relation staging_marts.transform_data ............................. [[33mSKIP[0m]
[0m01:44:45.085713 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.transform_data
[0m01:44:45.087052 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_escola
[0m01:44:45.087935 [info ] [Thread-1 (]: 8 of 13 SKIP relation staging_marts.dim_escola ................................. [[33mSKIP[0m]
[0m01:44:45.088707 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_escola
[0m01:44:45.089438 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_localizacao
[0m01:44:45.090251 [info ] [Thread-1 (]: 9 of 13 SKIP relation staging_marts.dim_localizacao ............................ [[33mSKIP[0m]
[0m01:44:45.091125 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_localizacao
[0m01:44:45.092148 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_situacao
[0m01:44:45.093103 [info ] [Thread-1 (]: 10 of 13 SKIP relation staging_marts.dim_situacao .............................. [[33mSKIP[0m]
[0m01:44:45.094104 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_situacao
[0m01:44:45.095425 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_tempo
[0m01:44:45.096779 [info ] [Thread-1 (]: 11 of 13 SKIP relation staging_marts.dim_tempo ................................. [[33mSKIP[0m]
[0m01:44:45.097748 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_tempo
[0m01:44:45.098664 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_turma
[0m01:44:45.099632 [info ] [Thread-1 (]: 12 of 13 SKIP relation staging_marts.dim_turma ................................. [[33mSKIP[0m]
[0m01:44:45.100497 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_turma
[0m01:44:45.101507 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.fato_matricula
[0m01:44:45.102319 [info ] [Thread-1 (]: 13 of 13 SKIP relation staging_marts.fato_matricula ............................ [[33mSKIP[0m]
[0m01:44:45.103111 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.fato_matricula
[0m01:44:45.105180 [debug] [MainThread]: Using postgres connection "master"
[0m01:44:45.105943 [debug] [MainThread]: On master: BEGIN
[0m01:44:45.106389 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:44:45.119224 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m01:44:45.119956 [debug] [MainThread]: On master: COMMIT
[0m01:44:45.120601 [debug] [MainThread]: Using postgres connection "master"
[0m01:44:45.121196 [debug] [MainThread]: On master: COMMIT
[0m01:44:45.122289 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:44:45.122918 [debug] [MainThread]: On master: Close
[0m01:44:45.123702 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:44:45.124455 [debug] [MainThread]: Connection 'model.transformacao_matricula.view_taxa_aprovados' was properly closed.
[0m01:44:45.125431 [info ] [MainThread]: 
[0m01:44:45.126263 [info ] [MainThread]: Finished running 9 table models, 4 view models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m01:44:45.128677 [debug] [MainThread]: Command end result
[0m01:44:45.162642 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m01:44:45.166053 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m01:44:45.175481 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m01:44:45.176204 [info ] [MainThread]: 
[0m01:44:45.176919 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m01:44:45.177589 [info ] [MainThread]: 
[0m01:44:45.178371 [error] [MainThread]: [31mFailure in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)[0m
[0m01:44:45.179183 [error] [MainThread]:   Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  syntax error at or near "FROM"
  LINE 93:  FROM source
            ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m01:44:45.179818 [info ] [MainThread]: 
[0m01:44:45.180597 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m01:44:45.181567 [info ] [MainThread]: 
[0m01:44:45.183255 [error] [MainThread]: [31mFailure in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)[0m
[0m01:44:45.184282 [error] [MainThread]:   Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  syntax error at or near ";"
  LINE 24:     dtemp.ano, dl.desc_rpa, da.faixa_etaria;
                                                      ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m01:44:45.184912 [info ] [MainThread]: 
[0m01:44:45.185582 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m01:44:45.186217 [info ] [MainThread]: 
[0m01:44:45.187276 [error] [MainThread]: [31mFailure in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)[0m
[0m01:44:45.188415 [error] [MainThread]:   Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  syntax error at or near ";"
  LINE 25:     dtemp.ano, de.nome_escola, contagem_situacao DESC;
                                                                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m01:44:45.189402 [info ] [MainThread]: 
[0m01:44:45.190554 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m01:44:45.191495 [info ] [MainThread]: 
[0m01:44:45.192619 [error] [MainThread]: [31mFailure in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)[0m
[0m01:44:45.193597 [error] [MainThread]:   Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  syntax error at or near ";"
  LINE 39:     dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo;
                                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m01:44:45.194428 [info ] [MainThread]: 
[0m01:44:45.195294 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m01:44:45.196146 [info ] [MainThread]: 
[0m01:44:45.197059 [error] [MainThread]: [31mFailure in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)[0m
[0m01:44:45.198042 [error] [MainThread]:   Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  syntax error at or near ";"
  LINE 29:     dtemp.ano, dt.modalidade_ensino;
                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m01:44:45.198733 [info ] [MainThread]: 
[0m01:44:45.199701 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m01:44:45.200753 [info ] [MainThread]: 
[0m01:44:45.201658 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=8 NO-OP=0 TOTAL=13
[0m01:44:45.204041 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.57733, "process_in_blocks": "0", "process_kernel_time": 0.327823, "process_mem_max_rss": "127936", "process_out_blocks": "3168", "process_user_time": 2.373965}
[0m01:44:45.205177 [debug] [MainThread]: Command `dbt run` failed at 01:44:45.204984 after 1.58 seconds
[0m01:44:45.206101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757f6234c200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757f5e5398b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x757f608456a0>]}
[0m01:44:45.206999 [debug] [MainThread]: Flushing usage events
[0m01:44:45.844096 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:46:58.095980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7004ca120860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7004cc0d2e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7004ca5d7dd0>]}


============================== 01:46:58.101117 | 1f858adb-48d7-4d0c-b5af-da8e9a75afd0 ==============================
[0m01:46:58.101117 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:46:58.101991 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/home/murilo/.dbt', 'empty': 'False', 'log_format': 'default', 'quiet': 'False', 'introspect': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'partial_parse': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'static_parser': 'True', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'fail_fast': 'False', 'printer_width': '80'}
[0m01:46:58.364373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f858adb-48d7-4d0c-b5af-da8e9a75afd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7004c9b86de0>]}
[0m01:46:58.433290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f858adb-48d7-4d0c-b5af-da8e9a75afd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7004ca6fa840>]}
[0m01:46:58.434319 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:46:58.603410 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m01:46:58.727979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m01:46:58.729056 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m01:46:58.729840 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m01:46:58.730637 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m01:46:59.051883 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.transformacao_matricula.intermediate
- models.transformacao_matricula.dimensions
- models.transformacao_matricula.facts
[0m01:46:59.070285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f858adb-48d7-4d0c-b5af-da8e9a75afd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7004c75d7f20>]}
[0m01:46:59.177171 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m01:46:59.179578 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m01:46:59.202952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f858adb-48d7-4d0c-b5af-da8e9a75afd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7004c757f290>]}
[0m01:46:59.203586 [info ] [MainThread]: Found 13 models, 2 data tests, 1 source, 459 macros
[0m01:46:59.204025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f858adb-48d7-4d0c-b5af-da8e9a75afd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7004c75cf680>]}
[0m01:46:59.206160 [info ] [MainThread]: 
[0m01:46:59.206745 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m01:46:59.207244 [info ] [MainThread]: 
[0m01:46:59.207963 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:46:59.212595 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula'
[0m01:46:59.273943 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m01:46:59.274733 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m01:46:59.275516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:46:59.294127 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.019 seconds
[0m01:46:59.296474 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m01:46:59.300934 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m01:46:59.301752 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m01:46:59.302762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:46:59.316924 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.014 seconds
[0m01:46:59.318869 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m01:46:59.325391 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula, now list_transformacao_matricula_staging_staging)
[0m01:46:59.340408 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m01:46:59.341282 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: BEGIN
[0m01:46:59.342025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:46:59.359048 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m01:46:59.360362 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m01:46:59.361356 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_staging"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m01:46:59.368688 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m01:46:59.370436 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: ROLLBACK
[0m01:46:59.371574 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: Close
[0m01:46:59.372880 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_staging, now list_transformacao_matricula_staging_marts)
[0m01:46:59.375901 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m01:46:59.376548 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: BEGIN
[0m01:46:59.377332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:46:59.388934 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m01:46:59.392026 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m01:46:59.392767 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_marts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m01:46:59.396878 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m01:46:59.398580 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: ROLLBACK
[0m01:46:59.400512 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: Close
[0m01:46:59.408174 [debug] [MainThread]: Using postgres connection "master"
[0m01:46:59.408764 [debug] [MainThread]: On master: BEGIN
[0m01:46:59.409249 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:46:59.418803 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m01:46:59.419482 [debug] [MainThread]: Using postgres connection "master"
[0m01:46:59.420173 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:46:59.426583 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m01:46:59.428032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f858adb-48d7-4d0c-b5af-da8e9a75afd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7004cbd96b40>]}
[0m01:46:59.428668 [debug] [MainThread]: On master: ROLLBACK
[0m01:46:59.429480 [debug] [MainThread]: Using postgres connection "master"
[0m01:46:59.429903 [debug] [MainThread]: On master: BEGIN
[0m01:46:59.430789 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:46:59.431341 [debug] [MainThread]: On master: COMMIT
[0m01:46:59.431721 [debug] [MainThread]: Using postgres connection "master"
[0m01:46:59.432090 [debug] [MainThread]: On master: COMMIT
[0m01:46:59.432798 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:46:59.433243 [debug] [MainThread]: On master: Close
[0m01:46:59.436441 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.staging_situacao_alunos
[0m01:46:59.437173 [info ] [Thread-1 (]: 1 of 13 START sql table model staging_staging.staging_situacao_alunos .......... [RUN]
[0m01:46:59.437829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_marts, now model.transformacao_matricula.staging_situacao_alunos)
[0m01:46:59.438357 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.staging_situacao_alunos
[0m01:46:59.446018 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.staging_situacao_alunos"
[0m01:46:59.446795 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.staging_situacao_alunos
[0m01:46:59.506831 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.staging_situacao_alunos"
[0m01:46:59.508548 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m01:46:59.509637 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: BEGIN
[0m01:46:59.510486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:46:59.525704 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m01:46:59.526660 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m01:46:59.527513 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */

  
    

  create  table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp"
  
  
    as
  
  (
    WITH source AS (
	SELECT * FROM "transformacao_matricula"."staging"."staging_alunos_raw"
),

cleaning_renaming AS (
	SELECT
		ano,
		codigo_escola,
		matricula,
		escola AS nome_escola,
		endereco_logradouro AS endereco_logra,
	 	endereco_bairro,
		endereco_numero,
		rpa,
		modalidade_ensino_codigo AS mod_ens_codigo,
		-- Transformação da SÉRIE
		CASE
		    -- Ensino Fundamental (1º ao 9º)
		    WHEN serie LIKE '%1 ANO%' OR serie LIKE '%1º ANO%' THEN '1º ANO'
		    WHEN serie LIKE '%2 ANO%' OR serie LIKE '%2º ANO%' THEN '2º ANO'
		    WHEN serie LIKE '%3 ANO%' OR serie LIKE '%3º ANO%' THEN '3º ANO'
		    WHEN serie LIKE '%4 ANO%' OR serie LIKE '%4º ANO%' THEN '4º ANO'
		    WHEN serie LIKE '%5 ANO%' OR serie LIKE '%5º ANO%' THEN '5º ANO'
		    WHEN serie LIKE '%6 ANO%' OR serie LIKE '%6º ANO%' THEN '6º ANO'
		    WHEN serie LIKE '%7 ANO%' OR serie LIKE '%7º ANO%' THEN '7º ANO'
		    WHEN serie LIKE '%8 ANO%' OR serie LIKE '%8º ANO%' THEN '8º ANO'
		    WHEN serie LIKE '%9 ANO%' OR serie LIKE '%9º ANO%' THEN '9º ANO'

		    -- Educação Infantil (Berçário e Grupos)
		    WHEN serie LIKE '%BER%' THEN 'BERÇARIO' -- Pega BERÇARIO e BERRIO
		    WHEN serie LIKE '%GRUPO I%' OR serie LIKE '%GRUPO 1%' THEN 'GRUPO I'
		    WHEN serie LIKE '%GRUPO II%' THEN 'GRUPO II'
		    WHEN serie LIKE '%GRUPO III%' THEN 'GRUPO III'
		    WHEN serie LIKE '%GRUPO IV%' THEN 'GRUPO IV'
		    WHEN serie LIKE '%GRUPO V%' THEN 'GRUPO V'

		    -- EJA (Módulos 1 ao 5) 
		    WHEN serie LIKE '%1%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 1'
		    WHEN serie LIKE '%2%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 2'
		    WHEN serie LIKE '%3%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 3'
		    WHEN serie LIKE '%4%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 4'
		    WHEN serie LIKE '%5%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 5'

		    WHEN serie LIKE '%TRAVESSIA%' THEN 'TRAVESSIA RECIFE'
		    WHEN serie LIKE '%CORRECAO%1%' THEN 'CORREÇÃO DE FLUXO 1 - ALFABETIZACAO'
		    WHEN serie LIKE '%CORRECAO%2%' THEN 'CORREÇÃO DE FLUXO 2 - ACELERACAO'

		    ELSE 'OUTROS'
		END AS serie,
		turma,
		turno,
		matricula,
		idade,

		-- transformação do SEXO
		CASE
		    WHEN sexo = 1 THEN 'Masculino'
	 	    WHEN sexo = 2 THEN 'Feminino'
		    WHEN sexo = 3 THEN 'Outros'				
		    ELSE 'Não informado' -- Para cobrir valores inesperados
		END AS sexo,

		idade,
		-- transformação de situacao
		CASE 
		    WHEN situacao_nome LIKE '%APROV%' THEN 'Aprovado'
		    WHEN situacao_nome LIKE '%RET%' OR situacao_nome LIKE '%REPRO%' THEN 'Reprovado'
		    WHEN situacao_nome LIKE '%TR%' OR situacao_nome LIKE '%REMAN%' THEN 'Transferido'
		    WHEN situacao_nome LIKE '%DESIST%' THEN 'Desistente'
		END AS sit_nome,

		-- Transformação da MODALIDADE
		CASE
		    WHEN modalidade_ensino LIKE '%EDUCACAO INFANTIL%' THEN 'EDUCAÇÃO INFANTIL'
		    WHEN modalidade_ensino LIKE '%ENSINO FUNDAMENTAL%' THEN 'ENSINO FUNDAMENTAL'
		    WHEN modalidade_ensino LIKE '%EDUCACAO JOVENS E ADULTOS%' THEN 'EJA'
		    WHEN modalidade_ensino LIKE '%CORRE%' THEN 'CORREÇÃO DE FLUXO' -- Pega "CORREÇÃO" e "CORREO"
		    ELSE 'OUTROS'
		END AS modalidade_ens,

		
	FROM source
)

SELECT * FROM cleaning_renaming
  );
  
[0m01:46:59.529398 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 93:  FROM source
          ^

[0m01:46:59.530293 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: ROLLBACK
[0m01:46:59.531543 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: Close
[0m01:46:59.539557 [debug] [Thread-1 (]: Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  syntax error at or near "FROM"
  LINE 93:  FROM source
            ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m01:46:59.542073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f858adb-48d7-4d0c-b5af-da8e9a75afd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7004c455d850>]}
[0m01:46:59.543167 [error] [Thread-1 (]: 1 of 13 ERROR creating sql table model staging_staging.staging_situacao_alunos . [[31mERROR[0m in 0.10s]
[0m01:46:59.544128 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.staging_situacao_alunos
[0m01:46:59.544885 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_count_aluno_idade
[0m01:46:59.545683 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.staging_situacao_alunos' to be skipped because of status 'error'.  Reason: Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  syntax error at or near "FROM"
  LINE 93:  FROM source
            ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql.
[0m01:46:59.546542 [info ] [Thread-1 (]: 2 of 13 START sql view model staging_marts.view_count_aluno_idade .............. [RUN]
[0m01:46:59.548959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.staging_situacao_alunos, now model.transformacao_matricula.view_count_aluno_idade)
[0m01:46:59.549874 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_count_aluno_idade
[0m01:46:59.552630 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_count_aluno_idade"
[0m01:46:59.553568 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_count_aluno_idade
[0m01:46:59.583189 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_count_aluno_idade"
[0m01:46:59.584374 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m01:46:59.585188 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: BEGIN
[0m01:46:59.585923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:46:59.601906 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m01:46:59.602961 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m01:46:59.603988 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_count_aluno_idade"} */

  create view "transformacao_matricula"."staging_marts"."view_count_aluno_idade__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dl.desc_rpa,
    da.faixa_etaria,
    COUNT(fm.matricula) AS total_alunos
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
ORDER BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
  );
[0m01:46:59.606166 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 14:     fato_matricula fm
             ^

[0m01:46:59.607175 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: ROLLBACK
[0m01:46:59.608899 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: Close
[0m01:46:59.613803 [debug] [Thread-1 (]: Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  relation "fato_matricula" does not exist
  LINE 14:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m01:46:59.616082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f858adb-48d7-4d0c-b5af-da8e9a75afd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7004c45e1160>]}
[0m01:46:59.617819 [error] [Thread-1 (]: 2 of 13 ERROR creating sql view model staging_marts.view_count_aluno_idade ..... [[31mERROR[0m in 0.07s]
[0m01:46:59.618982 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_count_aluno_idade
[0m01:46:59.620059 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m01:46:59.621547 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_count_aluno_idade' to be skipped because of status 'error'.  Reason: Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  relation "fato_matricula" does not exist
  LINE 14:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql.
[0m01:46:59.622945 [info ] [Thread-1 (]: 3 of 13 START sql view model staging_marts.view_frequencia_situacao_escola ..... [RUN]
[0m01:46:59.627049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_count_aluno_idade, now model.transformacao_matricula.view_frequencia_situacao_escola)
[0m01:46:59.628143 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_frequencia_situacao_escola
[0m01:46:59.632910 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m01:46:59.634513 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_frequencia_situacao_escola
[0m01:46:59.644707 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m01:46:59.646573 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m01:46:59.647423 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: BEGIN
[0m01:46:59.648027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:46:59.661903 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m01:46:59.662587 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m01:46:59.663143 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_frequencia_situacao_escola"} */

  create view "transformacao_matricula"."staging_marts"."view_frequencia_situacao_escola__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    de.nome_escola,
    de.codigo_escola,
    ds.situacao_nome,
    COUNT(fm.matricula) AS contagem_situacao
FROM
    fato_matricula fm
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, de.nome_escola, de.codigo_escola, ds.situacao_nome
ORDER BY
    dtemp.ano, de.nome_escola, contagem_situacao DESC
  );
[0m01:46:59.664674 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 15:     fato_matricula fm
             ^

[0m01:46:59.665704 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: ROLLBACK
[0m01:46:59.667293 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: Close
[0m01:46:59.671130 [debug] [Thread-1 (]: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m01:46:59.672466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f858adb-48d7-4d0c-b5af-da8e9a75afd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7004c4461280>]}
[0m01:46:59.673977 [error] [Thread-1 (]: 3 of 13 ERROR creating sql view model staging_marts.view_frequencia_situacao_escola  [[31mERROR[0m in 0.05s]
[0m01:46:59.675355 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m01:46:59.676432 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_matricula_detalhada
[0m01:46:59.677522 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_frequencia_situacao_escola' to be skipped because of status 'error'.  Reason: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql.
[0m01:46:59.679929 [info ] [Thread-1 (]: 4 of 13 START sql view model staging_marts.view_matricula_detalhada ............ [RUN]
[0m01:46:59.681417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_frequencia_situacao_escola, now model.transformacao_matricula.view_matricula_detalhada)
[0m01:46:59.682328 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_matricula_detalhada
[0m01:46:59.809813 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_matricula_detalhada"
[0m01:46:59.811288 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_matricula_detalhada
[0m01:46:59.817073 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_matricula_detalhada"
[0m01:46:59.818172 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m01:46:59.818787 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: BEGIN
[0m01:46:59.819294 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:46:59.834351 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m01:46:59.835023 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m01:46:59.835536 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_matricula_detalhada"} */

  create view "transformacao_matricula"."staging_marts"."view_matricula_detalhada__dbt_tmp"
    
    
  as (
    
SELECT
    fm.matricula,
    da.sexo,
    da.idade,
    da.faixa_etaria,
    de.nome_escola,
    de.codigo_escola,
    dt.turma,
    dt.turno,
    dt.serie,
    dt.modalidade_ensino,
    ds.situacao_nome,
    ds.categoria AS categoria_situacao,
    ds.eh_aprovado,
    ds.eh_reprovado,
    dl.desc_rpa,
    dl.endereco_bairro AS bairro_localizacao,
    dtemp.ano AS ano_registro
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
  );
[0m01:46:59.837166 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 27:     fato_matricula fm
             ^

[0m01:46:59.837826 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: ROLLBACK
[0m01:46:59.839458 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: Close
[0m01:46:59.842412 [debug] [Thread-1 (]: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m01:46:59.843148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f858adb-48d7-4d0c-b5af-da8e9a75afd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7004c4461610>]}
[0m01:46:59.843975 [error] [Thread-1 (]: 4 of 13 ERROR creating sql view model staging_marts.view_matricula_detalhada ... [[31mERROR[0m in 0.16s]
[0m01:46:59.844826 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_matricula_detalhada
[0m01:46:59.845341 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_taxa_aprovados
[0m01:46:59.845971 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_matricula_detalhada' to be skipped because of status 'error'.  Reason: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql.
[0m01:46:59.846682 [info ] [Thread-1 (]: 5 of 13 START sql view model staging_marts.view_taxa_aprovados ................. [RUN]
[0m01:46:59.847615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_matricula_detalhada, now model.transformacao_matricula.view_taxa_aprovados)
[0m01:46:59.848118 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_taxa_aprovados
[0m01:46:59.850645 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_taxa_aprovados"
[0m01:46:59.851519 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_taxa_aprovados
[0m01:46:59.858199 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_taxa_aprovados"
[0m01:46:59.862157 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m01:46:59.863050 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: BEGIN
[0m01:46:59.863693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:46:59.876396 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m01:46:59.877268 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m01:46:59.878028 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_taxa_aprovados"} */

  create view "transformacao_matricula"."staging_marts"."view_taxa_aprovados__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dt.modalidade_ensino,
    COUNT(fm.matricula) AS total_matriculas,
    SUM(ds.eh_aprovado) AS total_aprovados,
    SUM(ds.eh_reprovado) AS total_reprovados,
    -- Calcula a taxa de aprovação (como porcentagem)
    CAST(SUM(ds.eh_aprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_aprovacao_percentual,
    -- Calcula a taxa de reprovação (como porcentagem)
    CAST(SUM(ds.eh_reprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_reprovacao_percentual
FROM
    fato_matricula fm
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dt.modalidade_ensino
ORDER BY
    dtemp.ano, dt.modalidade_ensino;
  );
[0m01:46:59.879975 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 29:     dtemp.ano, dt.modalidade_ensino;
                                            ^

[0m01:46:59.880992 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: ROLLBACK
[0m01:46:59.882650 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: Close
[0m01:46:59.892330 [debug] [Thread-1 (]: Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  syntax error at or near ";"
  LINE 29:     dtemp.ano, dt.modalidade_ensino;
                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m01:46:59.893657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f858adb-48d7-4d0c-b5af-da8e9a75afd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7004c7925be0>]}
[0m01:46:59.895026 [error] [Thread-1 (]: 5 of 13 ERROR creating sql view model staging_marts.view_taxa_aprovados ........ [[31mERROR[0m in 0.05s]
[0m01:46:59.896108 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_taxa_aprovados
[0m01:46:59.896866 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_aluno
[0m01:46:59.897741 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_taxa_aprovados' to be skipped because of status 'error'.  Reason: Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  syntax error at or near ";"
  LINE 29:     dtemp.ano, dt.modalidade_ensino;
                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql.
[0m01:46:59.899046 [info ] [Thread-1 (]: 6 of 13 SKIP relation staging_marts.dim_aluno .................................. [[33mSKIP[0m]
[0m01:46:59.900533 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_aluno
[0m01:46:59.901578 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.transform_data
[0m01:46:59.902787 [info ] [Thread-1 (]: 7 of 13 SKIP relation staging_marts.transform_data ............................. [[33mSKIP[0m]
[0m01:46:59.904532 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.transform_data
[0m01:46:59.906950 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_escola
[0m01:46:59.908254 [info ] [Thread-1 (]: 8 of 13 SKIP relation staging_marts.dim_escola ................................. [[33mSKIP[0m]
[0m01:46:59.910705 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_escola
[0m01:46:59.912839 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_localizacao
[0m01:46:59.914121 [info ] [Thread-1 (]: 9 of 13 SKIP relation staging_marts.dim_localizacao ............................ [[33mSKIP[0m]
[0m01:46:59.916221 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_localizacao
[0m01:46:59.917508 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_situacao
[0m01:46:59.918809 [info ] [Thread-1 (]: 10 of 13 SKIP relation staging_marts.dim_situacao .............................. [[33mSKIP[0m]
[0m01:46:59.920564 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_situacao
[0m01:46:59.923068 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_tempo
[0m01:46:59.926201 [info ] [Thread-1 (]: 11 of 13 SKIP relation staging_marts.dim_tempo ................................. [[33mSKIP[0m]
[0m01:46:59.927158 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_tempo
[0m01:46:59.927942 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_turma
[0m01:46:59.929258 [info ] [Thread-1 (]: 12 of 13 SKIP relation staging_marts.dim_turma ................................. [[33mSKIP[0m]
[0m01:46:59.930319 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_turma
[0m01:46:59.932358 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.fato_matricula
[0m01:46:59.933363 [info ] [Thread-1 (]: 13 of 13 SKIP relation staging_marts.fato_matricula ............................ [[33mSKIP[0m]
[0m01:46:59.934302 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.fato_matricula
[0m01:46:59.936496 [debug] [MainThread]: Using postgres connection "master"
[0m01:46:59.937279 [debug] [MainThread]: On master: BEGIN
[0m01:46:59.938019 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:46:59.951181 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m01:46:59.951970 [debug] [MainThread]: On master: COMMIT
[0m01:46:59.952502 [debug] [MainThread]: Using postgres connection "master"
[0m01:46:59.953086 [debug] [MainThread]: On master: COMMIT
[0m01:46:59.954150 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:46:59.954839 [debug] [MainThread]: On master: Close
[0m01:46:59.955938 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:46:59.956786 [debug] [MainThread]: Connection 'model.transformacao_matricula.view_taxa_aprovados' was properly closed.
[0m01:46:59.959788 [info ] [MainThread]: 
[0m01:46:59.960673 [info ] [MainThread]: Finished running 9 table models, 4 view models in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m01:46:59.963087 [debug] [MainThread]: Command end result
[0m01:47:00.006342 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m01:47:00.010180 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m01:47:00.019943 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m01:47:00.020768 [info ] [MainThread]: 
[0m01:47:00.021596 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m01:47:00.022428 [info ] [MainThread]: 
[0m01:47:00.023670 [error] [MainThread]: [31mFailure in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)[0m
[0m01:47:00.026622 [error] [MainThread]:   Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  syntax error at or near "FROM"
  LINE 93:  FROM source
            ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m01:47:00.027564 [info ] [MainThread]: 
[0m01:47:00.028592 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m01:47:00.029562 [info ] [MainThread]: 
[0m01:47:00.030687 [error] [MainThread]: [31mFailure in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)[0m
[0m01:47:00.032169 [error] [MainThread]:   Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  relation "fato_matricula" does not exist
  LINE 14:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m01:47:00.033136 [info ] [MainThread]: 
[0m01:47:00.033905 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m01:47:00.034588 [info ] [MainThread]: 
[0m01:47:00.035429 [error] [MainThread]: [31mFailure in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)[0m
[0m01:47:00.036239 [error] [MainThread]:   Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m01:47:00.037028 [info ] [MainThread]: 
[0m01:47:00.037744 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m01:47:00.038391 [info ] [MainThread]: 
[0m01:47:00.039251 [error] [MainThread]: [31mFailure in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)[0m
[0m01:47:00.040329 [error] [MainThread]:   Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m01:47:00.041216 [info ] [MainThread]: 
[0m01:47:00.042023 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m01:47:00.042618 [info ] [MainThread]: 
[0m01:47:00.043274 [error] [MainThread]: [31mFailure in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)[0m
[0m01:47:00.043981 [error] [MainThread]:   Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  syntax error at or near ";"
  LINE 29:     dtemp.ano, dt.modalidade_ensino;
                                              ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m01:47:00.044540 [info ] [MainThread]: 
[0m01:47:00.045337 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m01:47:00.046073 [info ] [MainThread]: 
[0m01:47:00.046758 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=8 NO-OP=0 TOTAL=13
[0m01:47:00.049692 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.0151794, "process_in_blocks": "4920", "process_kernel_time": 0.447901, "process_mem_max_rss": "126548", "process_out_blocks": "3168", "process_user_time": 3.123389}
[0m01:47:00.051623 [debug] [MainThread]: Command `dbt run` failed at 01:47:00.051295 after 2.02 seconds
[0m01:47:00.052697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7004c9e630b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7004c8d36e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7004cd9e0200>]}
[0m01:47:00.053687 [debug] [MainThread]: Flushing usage events
[0m01:47:00.714580 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:47:17.823103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb35c03d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb35bfeb950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb35b8c8d10>]}


============================== 01:47:17.830219 | 81df5d58-c6f2-499e-9535-30284b7fc8f4 ==============================
[0m01:47:17.830219 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:47:17.830957 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'log_cache_events': 'False', 'fail_fast': 'False', 'target_path': 'None', 'write_json': 'True', 'quiet': 'False', 'empty': 'False', 'debug': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'warn_error': 'None', 'version_check': 'True', 'static_parser': 'True', 'profiles_dir': '/home/murilo/.dbt', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'use_experimental_parser': 'False'}
[0m01:47:18.047576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81df5d58-c6f2-499e-9535-30284b7fc8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb35adf40b0>]}
[0m01:47:18.117719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81df5d58-c6f2-499e-9535-30284b7fc8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb35adf59a0>]}
[0m01:47:18.119264 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:47:18.302371 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m01:47:18.464497 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:47:18.466382 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m01:47:18.868881 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.transformacao_matricula.intermediate
- models.transformacao_matricula.facts
- models.transformacao_matricula.dimensions
[0m01:47:18.893338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81df5d58-c6f2-499e-9535-30284b7fc8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb3591d3290>]}
[0m01:47:19.018792 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m01:47:19.021866 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m01:47:19.054006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81df5d58-c6f2-499e-9535-30284b7fc8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb35917b290>]}
[0m01:47:19.054938 [info ] [MainThread]: Found 13 models, 2 data tests, 1 source, 459 macros
[0m01:47:19.055734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81df5d58-c6f2-499e-9535-30284b7fc8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb35b64f5c0>]}
[0m01:47:19.058858 [info ] [MainThread]: 
[0m01:47:19.059720 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m01:47:19.060269 [info ] [MainThread]: 
[0m01:47:19.061177 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:47:19.070469 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula'
[0m01:47:19.127218 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m01:47:19.127993 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m01:47:19.128584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:47:19.147534 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.019 seconds
[0m01:47:19.149385 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m01:47:19.152673 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m01:47:19.153838 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m01:47:19.154953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:47:19.169954 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.015 seconds
[0m01:47:19.172823 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m01:47:19.179311 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula, now list_transformacao_matricula_staging_marts)
[0m01:47:19.194953 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m01:47:19.197602 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: BEGIN
[0m01:47:19.198571 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:47:19.215209 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m01:47:19.216208 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m01:47:19.217114 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_marts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m01:47:19.224207 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m01:47:19.226777 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: ROLLBACK
[0m01:47:19.228473 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: Close
[0m01:47:19.229693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_marts, now list_transformacao_matricula_staging_staging)
[0m01:47:19.235016 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m01:47:19.235792 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: BEGIN
[0m01:47:19.236629 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:47:19.248499 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m01:47:19.249262 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m01:47:19.249684 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_staging"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m01:47:19.254918 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m01:47:19.256452 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: ROLLBACK
[0m01:47:19.257494 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: Close
[0m01:47:19.263303 [debug] [MainThread]: Using postgres connection "master"
[0m01:47:19.263900 [debug] [MainThread]: On master: BEGIN
[0m01:47:19.264584 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:47:19.278015 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m01:47:19.279048 [debug] [MainThread]: Using postgres connection "master"
[0m01:47:19.279646 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:47:19.283809 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m01:47:19.285647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81df5d58-c6f2-499e-9535-30284b7fc8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb359d16a20>]}
[0m01:47:19.286571 [debug] [MainThread]: On master: ROLLBACK
[0m01:47:19.287487 [debug] [MainThread]: Using postgres connection "master"
[0m01:47:19.288132 [debug] [MainThread]: On master: BEGIN
[0m01:47:19.289273 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:47:19.289977 [debug] [MainThread]: On master: COMMIT
[0m01:47:19.290464 [debug] [MainThread]: Using postgres connection "master"
[0m01:47:19.290947 [debug] [MainThread]: On master: COMMIT
[0m01:47:19.291899 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:47:19.292717 [debug] [MainThread]: On master: Close
[0m01:47:19.298690 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.staging_situacao_alunos
[0m01:47:19.301492 [info ] [Thread-1 (]: 1 of 13 START sql table model staging_staging.staging_situacao_alunos .......... [RUN]
[0m01:47:19.304109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_staging, now model.transformacao_matricula.staging_situacao_alunos)
[0m01:47:19.305167 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.staging_situacao_alunos
[0m01:47:19.315564 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.staging_situacao_alunos"
[0m01:47:19.316731 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.staging_situacao_alunos
[0m01:47:19.382329 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.staging_situacao_alunos"
[0m01:47:19.383935 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m01:47:19.384774 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: BEGIN
[0m01:47:19.385552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:47:19.400216 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m01:47:19.402165 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m01:47:19.403605 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */

  
    

  create  table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp"
  
  
    as
  
  (
    WITH source AS (
	SELECT * FROM "transformacao_matricula"."staging"."staging_alunos_raw"
),

cleaning_renaming AS (
	SELECT
		ano,
		codigo_escola,
		matricula,
		escola AS nome_escola,
		endereco_logradouro AS endereco_logra,
	 	endereco_bairro,
		endereco_numero,
		rpa,
		modalidade_ensino_codigo AS mod_ens_codigo,
		-- Transformação da SÉRIE
		CASE
		    -- Ensino Fundamental (1º ao 9º)
		    WHEN serie LIKE '%1 ANO%' OR serie LIKE '%1º ANO%' THEN '1º ANO'
		    WHEN serie LIKE '%2 ANO%' OR serie LIKE '%2º ANO%' THEN '2º ANO'
		    WHEN serie LIKE '%3 ANO%' OR serie LIKE '%3º ANO%' THEN '3º ANO'
		    WHEN serie LIKE '%4 ANO%' OR serie LIKE '%4º ANO%' THEN '4º ANO'
		    WHEN serie LIKE '%5 ANO%' OR serie LIKE '%5º ANO%' THEN '5º ANO'
		    WHEN serie LIKE '%6 ANO%' OR serie LIKE '%6º ANO%' THEN '6º ANO'
		    WHEN serie LIKE '%7 ANO%' OR serie LIKE '%7º ANO%' THEN '7º ANO'
		    WHEN serie LIKE '%8 ANO%' OR serie LIKE '%8º ANO%' THEN '8º ANO'
		    WHEN serie LIKE '%9 ANO%' OR serie LIKE '%9º ANO%' THEN '9º ANO'

		    -- Educação Infantil (Berçário e Grupos)
		    WHEN serie LIKE '%BER%' THEN 'BERÇARIO' -- Pega BERÇARIO e BERRIO
		    WHEN serie LIKE '%GRUPO I%' OR serie LIKE '%GRUPO 1%' THEN 'GRUPO I'
		    WHEN serie LIKE '%GRUPO II%' THEN 'GRUPO II'
		    WHEN serie LIKE '%GRUPO III%' THEN 'GRUPO III'
		    WHEN serie LIKE '%GRUPO IV%' THEN 'GRUPO IV'
		    WHEN serie LIKE '%GRUPO V%' THEN 'GRUPO V'

		    -- EJA (Módulos 1 ao 5) 
		    WHEN serie LIKE '%1%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 1'
		    WHEN serie LIKE '%2%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 2'
		    WHEN serie LIKE '%3%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 3'
		    WHEN serie LIKE '%4%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 4'
		    WHEN serie LIKE '%5%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 5'

		    WHEN serie LIKE '%TRAVESSIA%' THEN 'TRAVESSIA RECIFE'
		    WHEN serie LIKE '%CORRECAO%1%' THEN 'CORREÇÃO DE FLUXO 1 - ALFABETIZACAO'
		    WHEN serie LIKE '%CORRECAO%2%' THEN 'CORREÇÃO DE FLUXO 2 - ACELERACAO'

		    ELSE 'OUTROS'
		END AS serie,
		turma,
		turno,
		matricula,
		idade,

		-- transformação do SEXO
		CASE
		    WHEN sexo = 1 THEN 'Masculino'
	 	    WHEN sexo = 2 THEN 'Feminino'
		    WHEN sexo = 3 THEN 'Outros'				
		    ELSE 'Não informado' -- Para cobrir valores inesperados
		END AS sexo,

		idade,
		-- transformação de situacao
		CASE 
		    WHEN situacao_nome LIKE '%APROV%' THEN 'Aprovado'
		    WHEN situacao_nome LIKE '%RET%' OR situacao_nome LIKE '%REPRO%' THEN 'Reprovado'
		    WHEN situacao_nome LIKE '%TR%' OR situacao_nome LIKE '%REMAN%' THEN 'Transferido'
		    WHEN situacao_nome LIKE '%DESIST%' THEN 'Desistente'
		END AS sit_nome,

		-- Transformação da MODALIDADE
		CASE
		    WHEN modalidade_ensino LIKE '%EDUCACAO INFANTIL%' THEN 'EDUCAÇÃO INFANTIL'
		    WHEN modalidade_ensino LIKE '%ENSINO FUNDAMENTAL%' THEN 'ENSINO FUNDAMENTAL'
		    WHEN modalidade_ensino LIKE '%EDUCACAO JOVENS E ADULTOS%' THEN 'EJA'
		    WHEN modalidade_ensino LIKE '%CORRE%' THEN 'CORREÇÃO DE FLUXO' -- Pega "CORREÇÃO" e "CORREO"
		    ELSE 'OUTROS'
		END AS modalidade_ens,

		
	FROM source
)

SELECT * FROM cleaning_renaming
  );
  
[0m01:47:19.405738 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 93:  FROM source
          ^

[0m01:47:19.406672 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: ROLLBACK
[0m01:47:19.408030 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: Close
[0m01:47:19.417343 [debug] [Thread-1 (]: Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  syntax error at or near "FROM"
  LINE 93:  FROM source
            ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m01:47:19.420830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81df5d58-c6f2-499e-9535-30284b7fc8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb355d15e20>]}
[0m01:47:19.422521 [error] [Thread-1 (]: 1 of 13 ERROR creating sql table model staging_staging.staging_situacao_alunos . [[31mERROR[0m in 0.11s]
[0m01:47:19.423910 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.staging_situacao_alunos
[0m01:47:19.424702 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_count_aluno_idade
[0m01:47:19.425684 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.staging_situacao_alunos' to be skipped because of status 'error'.  Reason: Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  syntax error at or near "FROM"
  LINE 93:  FROM source
            ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql.
[0m01:47:19.426819 [info ] [Thread-1 (]: 2 of 13 START sql view model staging_marts.view_count_aluno_idade .............. [RUN]
[0m01:47:19.429389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.staging_situacao_alunos, now model.transformacao_matricula.view_count_aluno_idade)
[0m01:47:19.430304 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_count_aluno_idade
[0m01:47:19.440408 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_count_aluno_idade"
[0m01:47:19.442020 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_count_aluno_idade
[0m01:47:19.469589 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_count_aluno_idade"
[0m01:47:19.470911 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m01:47:19.471653 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: BEGIN
[0m01:47:19.472329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:47:19.486826 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m01:47:19.487899 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m01:47:19.488629 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_count_aluno_idade"} */

  create view "transformacao_matricula"."staging_marts"."view_count_aluno_idade__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dl.desc_rpa,
    da.faixa_etaria,
    COUNT(fm.matricula) AS total_alunos
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
ORDER BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
  );
[0m01:47:19.490776 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 14:     fato_matricula fm
             ^

[0m01:47:19.491767 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: ROLLBACK
[0m01:47:19.493091 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: Close
[0m01:47:19.502227 [debug] [Thread-1 (]: Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  relation "fato_matricula" does not exist
  LINE 14:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m01:47:19.503553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81df5d58-c6f2-499e-9535-30284b7fc8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb358d4cd40>]}
[0m01:47:19.505079 [error] [Thread-1 (]: 2 of 13 ERROR creating sql view model staging_marts.view_count_aluno_idade ..... [[31mERROR[0m in 0.07s]
[0m01:47:19.507123 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_count_aluno_idade
[0m01:47:19.508286 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m01:47:19.509446 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_count_aluno_idade' to be skipped because of status 'error'.  Reason: Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  relation "fato_matricula" does not exist
  LINE 14:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql.
[0m01:47:19.510526 [info ] [Thread-1 (]: 3 of 13 START sql view model staging_marts.view_frequencia_situacao_escola ..... [RUN]
[0m01:47:19.512651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_count_aluno_idade, now model.transformacao_matricula.view_frequencia_situacao_escola)
[0m01:47:19.513901 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_frequencia_situacao_escola
[0m01:47:19.518180 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m01:47:19.519154 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_frequencia_situacao_escola
[0m01:47:19.524700 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m01:47:19.525881 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m01:47:19.526537 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: BEGIN
[0m01:47:19.527190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:47:19.540077 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m01:47:19.541149 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m01:47:19.541917 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_frequencia_situacao_escola"} */

  create view "transformacao_matricula"."staging_marts"."view_frequencia_situacao_escola__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    de.nome_escola,
    de.codigo_escola,
    ds.situacao_nome,
    COUNT(fm.matricula) AS contagem_situacao
FROM
    fato_matricula fm
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, de.nome_escola, de.codigo_escola, ds.situacao_nome
ORDER BY
    dtemp.ano, de.nome_escola, contagem_situacao DESC
  );
[0m01:47:19.543948 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 15:     fato_matricula fm
             ^

[0m01:47:19.544775 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: ROLLBACK
[0m01:47:19.546383 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: Close
[0m01:47:19.550189 [debug] [Thread-1 (]: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m01:47:19.551052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81df5d58-c6f2-499e-9535-30284b7fc8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb3542f7260>]}
[0m01:47:19.552348 [error] [Thread-1 (]: 3 of 13 ERROR creating sql view model staging_marts.view_frequencia_situacao_escola  [[31mERROR[0m in 0.04s]
[0m01:47:19.553421 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m01:47:19.554163 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_matricula_detalhada
[0m01:47:19.555622 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_frequencia_situacao_escola' to be skipped because of status 'error'.  Reason: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql.
[0m01:47:19.554965 [info ] [Thread-1 (]: 4 of 13 START sql view model staging_marts.view_matricula_detalhada ............ [RUN]
[0m01:47:19.556874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_frequencia_situacao_escola, now model.transformacao_matricula.view_matricula_detalhada)
[0m01:47:19.557687 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_matricula_detalhada
[0m01:47:19.674398 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_matricula_detalhada"
[0m01:47:19.675553 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_matricula_detalhada
[0m01:47:19.681040 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_matricula_detalhada"
[0m01:47:19.682070 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m01:47:19.682624 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: BEGIN
[0m01:47:19.683182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:47:19.695831 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m01:47:19.696382 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m01:47:19.696808 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_matricula_detalhada"} */

  create view "transformacao_matricula"."staging_marts"."view_matricula_detalhada__dbt_tmp"
    
    
  as (
    
SELECT
    fm.matricula,
    da.sexo,
    da.idade,
    da.faixa_etaria,
    de.nome_escola,
    de.codigo_escola,
    dt.turma,
    dt.turno,
    dt.serie,
    dt.modalidade_ensino,
    ds.situacao_nome,
    ds.categoria AS categoria_situacao,
    ds.eh_aprovado,
    ds.eh_reprovado,
    dl.desc_rpa,
    dl.endereco_bairro AS bairro_localizacao,
    dtemp.ano AS ano_registro
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
  );
[0m01:47:19.697959 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 27:     fato_matricula fm
             ^

[0m01:47:19.698484 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: ROLLBACK
[0m01:47:19.699650 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: Close
[0m01:47:19.703752 [debug] [Thread-1 (]: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m01:47:19.704524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81df5d58-c6f2-499e-9535-30284b7fc8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb35951b680>]}
[0m01:47:19.705325 [error] [Thread-1 (]: 4 of 13 ERROR creating sql view model staging_marts.view_matricula_detalhada ... [[31mERROR[0m in 0.15s]
[0m01:47:19.706066 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_matricula_detalhada
[0m01:47:19.706509 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_taxa_aprovados
[0m01:47:19.707171 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_matricula_detalhada' to be skipped because of status 'error'.  Reason: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql.
[0m01:47:19.707918 [info ] [Thread-1 (]: 5 of 13 START sql view model staging_marts.view_taxa_aprovados ................. [RUN]
[0m01:47:19.708819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_matricula_detalhada, now model.transformacao_matricula.view_taxa_aprovados)
[0m01:47:19.709283 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_taxa_aprovados
[0m01:47:19.712102 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_taxa_aprovados"
[0m01:47:19.713123 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_taxa_aprovados
[0m01:47:19.717468 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_taxa_aprovados"
[0m01:47:19.718406 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m01:47:19.718918 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: BEGIN
[0m01:47:19.719318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:47:19.728509 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m01:47:19.729307 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m01:47:19.730182 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_taxa_aprovados"} */

  create view "transformacao_matricula"."staging_marts"."view_taxa_aprovados__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dt.modalidade_ensino,
    COUNT(fm.matricula) AS total_matriculas,
    SUM(ds.eh_aprovado) AS total_aprovados,
    SUM(ds.eh_reprovado) AS total_reprovados,
    -- Calcula a taxa de aprovação (como porcentagem)
    CAST(SUM(ds.eh_aprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_aprovacao_percentual,
    -- Calcula a taxa de reprovação (como porcentagem)
    CAST(SUM(ds.eh_reprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_reprovacao_percentual
FROM
    fato_matricula fm
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dt.modalidade_ensino
ORDER BY
    dtemp.ano, dt.modalidade_ensino
  );
[0m01:47:19.731794 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 19:     fato_matricula fm
             ^

[0m01:47:19.732512 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: ROLLBACK
[0m01:47:19.736475 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: Close
[0m01:47:19.741145 [debug] [Thread-1 (]: Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  relation "fato_matricula" does not exist
  LINE 19:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m01:47:19.742617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81df5d58-c6f2-499e-9535-30284b7fc8f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb3599a5850>]}
[0m01:47:19.744152 [error] [Thread-1 (]: 5 of 13 ERROR creating sql view model staging_marts.view_taxa_aprovados ........ [[31mERROR[0m in 0.03s]
[0m01:47:19.745556 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_taxa_aprovados
[0m01:47:19.746450 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_aluno
[0m01:47:19.748327 [info ] [Thread-1 (]: 6 of 13 SKIP relation staging_marts.dim_aluno .................................. [[33mSKIP[0m]
[0m01:47:19.749362 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_aluno
[0m01:47:19.747418 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_taxa_aprovados' to be skipped because of status 'error'.  Reason: Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  relation "fato_matricula" does not exist
  LINE 19:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql.
[0m01:47:19.750326 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.transform_data
[0m01:47:19.751927 [info ] [Thread-1 (]: 7 of 13 SKIP relation staging_marts.transform_data ............................. [[33mSKIP[0m]
[0m01:47:19.752937 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.transform_data
[0m01:47:19.754815 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_escola
[0m01:47:19.755674 [info ] [Thread-1 (]: 8 of 13 SKIP relation staging_marts.dim_escola ................................. [[33mSKIP[0m]
[0m01:47:19.756944 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_escola
[0m01:47:19.757755 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_localizacao
[0m01:47:19.759438 [info ] [Thread-1 (]: 9 of 13 SKIP relation staging_marts.dim_localizacao ............................ [[33mSKIP[0m]
[0m01:47:19.760664 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_localizacao
[0m01:47:19.761777 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_situacao
[0m01:47:19.763023 [info ] [Thread-1 (]: 10 of 13 SKIP relation staging_marts.dim_situacao .............................. [[33mSKIP[0m]
[0m01:47:19.763987 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_situacao
[0m01:47:19.764984 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_tempo
[0m01:47:19.766108 [info ] [Thread-1 (]: 11 of 13 SKIP relation staging_marts.dim_tempo ................................. [[33mSKIP[0m]
[0m01:47:19.767486 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_tempo
[0m01:47:19.768671 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_turma
[0m01:47:19.770215 [info ] [Thread-1 (]: 12 of 13 SKIP relation staging_marts.dim_turma ................................. [[33mSKIP[0m]
[0m01:47:19.771259 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_turma
[0m01:47:19.774203 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.fato_matricula
[0m01:47:19.775542 [info ] [Thread-1 (]: 13 of 13 SKIP relation staging_marts.fato_matricula ............................ [[33mSKIP[0m]
[0m01:47:19.776470 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.fato_matricula
[0m01:47:19.778091 [debug] [MainThread]: Using postgres connection "master"
[0m01:47:19.778734 [debug] [MainThread]: On master: BEGIN
[0m01:47:19.779197 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:47:19.792386 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m01:47:19.793298 [debug] [MainThread]: On master: COMMIT
[0m01:47:19.794308 [debug] [MainThread]: Using postgres connection "master"
[0m01:47:19.795415 [debug] [MainThread]: On master: COMMIT
[0m01:47:19.796476 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:47:19.797320 [debug] [MainThread]: On master: Close
[0m01:47:19.798417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:47:19.799440 [debug] [MainThread]: Connection 'model.transformacao_matricula.view_taxa_aprovados' was properly closed.
[0m01:47:19.800707 [info ] [MainThread]: 
[0m01:47:19.801703 [info ] [MainThread]: Finished running 9 table models, 4 view models in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m01:47:19.806425 [debug] [MainThread]: Command end result
[0m01:47:19.846564 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m01:47:19.850938 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m01:47:19.861202 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m01:47:19.862012 [info ] [MainThread]: 
[0m01:47:19.863026 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m01:47:19.864184 [info ] [MainThread]: 
[0m01:47:19.865473 [error] [MainThread]: [31mFailure in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)[0m
[0m01:47:19.866478 [error] [MainThread]:   Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  syntax error at or near "FROM"
  LINE 93:  FROM source
            ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m01:47:19.867859 [info ] [MainThread]: 
[0m01:47:19.868948 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m01:47:19.871218 [info ] [MainThread]: 
[0m01:47:19.872645 [error] [MainThread]: [31mFailure in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)[0m
[0m01:47:19.874033 [error] [MainThread]:   Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  relation "fato_matricula" does not exist
  LINE 14:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m01:47:19.874927 [info ] [MainThread]: 
[0m01:47:19.875772 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m01:47:19.876574 [info ] [MainThread]: 
[0m01:47:19.877681 [error] [MainThread]: [31mFailure in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)[0m
[0m01:47:19.878992 [error] [MainThread]:   Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m01:47:19.880637 [info ] [MainThread]: 
[0m01:47:19.882602 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m01:47:19.883931 [info ] [MainThread]: 
[0m01:47:19.885106 [error] [MainThread]: [31mFailure in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)[0m
[0m01:47:19.886117 [error] [MainThread]:   Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m01:47:19.886989 [info ] [MainThread]: 
[0m01:47:19.887925 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m01:47:19.888893 [info ] [MainThread]: 
[0m01:47:19.889751 [error] [MainThread]: [31mFailure in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)[0m
[0m01:47:19.890524 [error] [MainThread]:   Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  relation "fato_matricula" does not exist
  LINE 19:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m01:47:19.891131 [info ] [MainThread]: 
[0m01:47:19.891948 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m01:47:19.892533 [info ] [MainThread]: 
[0m01:47:19.893226 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=8 NO-OP=0 TOTAL=13
[0m01:47:19.895519 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.1478295, "process_in_blocks": "52344", "process_kernel_time": 0.5801, "process_mem_max_rss": "126524", "process_out_blocks": "3160", "process_user_time": 3.559212}
[0m01:47:19.896780 [debug] [MainThread]: Command `dbt run` failed at 01:47:19.896453 after 2.15 seconds
[0m01:47:19.897537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb35b729490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb35b72b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb35b3a7410>]}
[0m01:47:19.898289 [debug] [MainThread]: Flushing usage events
[0m01:47:20.483907 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:49:49.102511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e53ab24e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e53a586cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e53a02e930>]}


============================== 01:49:49.108950 | ac363d62-a8c6-4126-958f-5abd8480485d ==============================
[0m01:49:49.108950 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:49:49.109544 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'debug': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'write_json': 'True', 'profiles_dir': '/home/murilo/.dbt', 'static_parser': 'True', 'fail_fast': 'False', 'version_check': 'True', 'quiet': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'target_path': 'None', 'invocation_command': 'dbt run'}
[0m01:49:49.317874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac363d62-a8c6-4126-958f-5abd8480485d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e539116de0>]}
[0m01:49:49.385140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac363d62-a8c6-4126-958f-5abd8480485d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e53a160a70>]}
[0m01:49:49.386249 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:49:49.535764 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m01:49:49.656016 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:49:49.656716 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m01:49:49.924187 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.transformacao_matricula.staging_situacao_alunos' (transformacao_aprovados/models/staging/staging_situacao_alunos.sql) depends on a source named 'dados_educacao_staging.alunos_raw' which was not found
[0m01:49:49.925301 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.87999046, "process_in_blocks": "992", "process_kernel_time": 0.303982, "process_mem_max_rss": "116396", "process_out_blocks": "16", "process_user_time": 1.898644}
[0m01:49:49.925819 [debug] [MainThread]: Command `dbt run` failed at 01:49:49.925742 after 0.88 seconds
[0m01:49:49.926299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e53a02e930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e53855c980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e5381fa270>]}
[0m01:49:49.926760 [debug] [MainThread]: Flushing usage events
[0m01:49:50.492113 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:57:53.829764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cb7a30f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cb72be540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cb72bcd10>]}


============================== 01:57:53.833487 | 496c4f3e-f2c9-44e1-a365-590768f42aba ==============================
[0m01:57:53.833487 [info ] [MainThread]: Running with dbt=1.10.15
[0m01:57:53.834053 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'static_parser': 'True', 'profiles_dir': '/home/murilo/.dbt', 'invocation_command': 'dbt run', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'printer_width': '80', 'quiet': 'False', 'log_format': 'default', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'use_colors': 'True', 'no_print': 'None', 'empty': 'False', 'debug': 'False'}
[0m01:57:53.987004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '496c4f3e-f2c9-44e1-a365-590768f42aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cb66c6360>]}
[0m01:57:54.066498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '496c4f3e-f2c9-44e1-a365-590768f42aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cb909e870>]}
[0m01:57:54.067483 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m01:57:54.196088 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m01:57:54.295575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 7 files changed.
[0m01:57:54.296588 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/staging/schema.yml
[0m01:57:54.296977 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/dim_situacao.sql
[0m01:57:54.297317 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/dim_tempo.sql
[0m01:57:54.297645 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/transform_data.sql
[0m01:57:54.297988 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m01:57:54.298315 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/dim_aluno.sql
[0m01:57:54.298638 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/dim_turma.sql
[0m01:57:54.720227 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.transformacao_matricula.intermediate
- models.transformacao_matricula.facts
- models.transformacao_matricula.dimensions
[0m01:57:54.728469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '496c4f3e-f2c9-44e1-a365-590768f42aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cb4f47bc0>]}
[0m01:57:54.822718 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m01:57:54.825180 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m01:57:54.940599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '496c4f3e-f2c9-44e1-a365-590768f42aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cb7865580>]}
[0m01:57:54.941189 [info ] [MainThread]: Found 13 models, 2 data tests, 1 source, 459 macros
[0m01:57:54.941577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '496c4f3e-f2c9-44e1-a365-590768f42aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cb909d6d0>]}
[0m01:57:54.948270 [info ] [MainThread]: 
[0m01:57:54.949156 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m01:57:54.949640 [info ] [MainThread]: 
[0m01:57:54.950601 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:57:54.955600 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula'
[0m01:57:55.005361 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m01:57:55.005938 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m01:57:55.006331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:57:55.021782 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.015 seconds
[0m01:57:55.023879 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m01:57:55.030069 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m01:57:55.031055 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m01:57:55.031705 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:57:55.048871 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.017 seconds
[0m01:57:55.050710 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m01:57:55.054028 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula, now list_transformacao_matricula_staging_staging)
[0m01:57:55.062541 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m01:57:55.063395 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: BEGIN
[0m01:57:55.063892 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:57:55.075784 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m01:57:55.076505 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m01:57:55.076957 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_staging"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m01:57:55.083937 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m01:57:55.086014 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: ROLLBACK
[0m01:57:55.087185 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: Close
[0m01:57:55.088420 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_staging, now list_transformacao_matricula_staging_marts)
[0m01:57:55.097658 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m01:57:55.098411 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: BEGIN
[0m01:57:55.099043 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:57:55.107437 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m01:57:55.107918 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m01:57:55.108252 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_marts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m01:57:55.114806 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m01:57:55.116342 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: ROLLBACK
[0m01:57:55.117302 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: Close
[0m01:57:55.123639 [debug] [MainThread]: Using postgres connection "master"
[0m01:57:55.124199 [debug] [MainThread]: On master: BEGIN
[0m01:57:55.124521 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:57:55.133606 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m01:57:55.134105 [debug] [MainThread]: Using postgres connection "master"
[0m01:57:55.134525 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:57:55.137965 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m01:57:55.139420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '496c4f3e-f2c9-44e1-a365-590768f42aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cb16db980>]}
[0m01:57:55.139925 [debug] [MainThread]: On master: ROLLBACK
[0m01:57:55.140580 [debug] [MainThread]: Using postgres connection "master"
[0m01:57:55.140973 [debug] [MainThread]: On master: BEGIN
[0m01:57:55.141813 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:57:55.142427 [debug] [MainThread]: On master: COMMIT
[0m01:57:55.143621 [debug] [MainThread]: Using postgres connection "master"
[0m01:57:55.144558 [debug] [MainThread]: On master: COMMIT
[0m01:57:55.148204 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m01:57:55.149182 [debug] [MainThread]: On master: Close
[0m01:57:55.157130 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.staging_situacao_alunos
[0m01:57:55.158117 [info ] [Thread-1 (]: 1 of 13 START sql table model staging_staging.staging_situacao_alunos .......... [RUN]
[0m01:57:55.158786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_marts, now model.transformacao_matricula.staging_situacao_alunos)
[0m01:57:55.159714 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.staging_situacao_alunos
[0m01:57:55.166477 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.staging_situacao_alunos"
[0m01:57:55.167225 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.staging_situacao_alunos
[0m01:57:55.218043 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.staging_situacao_alunos"
[0m01:57:55.219270 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m01:57:55.219800 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: BEGIN
[0m01:57:55.220270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:57:55.231461 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m01:57:55.232290 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m01:57:55.232911 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */

  
    

  create  table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp"
  
  
    as
  
  (
    WITH source AS (
    SELECT * FROM "transformacao_matricula"."staging"."alunos_raw"
),

cleaning_renaming AS (
    SELECT
        ano,
        codigo_escola,
        matricula,
        escola AS nome_escola,
        endereco_logradouro AS endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa,
        modalidade_ensino_codigo AS mod_ens_codigo,
        -- Transformação da SÉRIE
        CASE
            -- Ensino Fundamental (1º ao 9º)
            WHEN serie LIKE '%1 ANO%' OR serie LIKE '%1º ANO%' THEN '1º ANO'
            WHEN serie LIKE '%2 ANO%' OR serie LIKE '%2º ANO%' THEN '2º ANO'
            WHEN serie LIKE '%3 ANO%' OR serie LIKE '%3º ANO%' THEN '3º ANO'
            WHEN serie LIKE '%4 ANO%' OR serie LIKE '%4º ANO%' THEN '4º ANO'
            WHEN serie LIKE '%5 ANO%' OR serie LIKE '%5º ANO%' THEN '5º ANO'
            WHEN serie LIKE '%6 ANO%' OR serie LIKE '%6º ANO%' THEN '6º ANO'
            WHEN serie LIKE '%7 ANO%' OR serie LIKE '%7º ANO%' THEN '7º ANO'
            WHEN serie LIKE '%8 ANO%' OR serie LIKE '%8º ANO%' THEN '8º ANO'
            WHEN serie LIKE '%9 ANO%' OR serie LIKE '%9º ANO%' THEN '9º ANO'
            -- Educação Infantil (Berçário e Grupos)
            WHEN serie LIKE '%BER%' THEN 'BERÇARIO'
            WHEN serie LIKE '%GRUPO I%' OR serie LIKE '%GRUPO 1%' THEN 'GRUPO I'
            WHEN serie LIKE '%GRUPO II%' THEN 'GRUPO II'
            WHEN serie LIKE '%GRUPO III%' THEN 'GRUPO III'
            WHEN serie LIKE '%GRUPO IV%' THEN 'GRUPO IV'
            WHEN serie LIKE '%GRUPO V%' THEN 'GRUPO V'
            -- EJA (Módulos 1 ao 5) 
            WHEN serie LIKE '%1%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 1'
            WHEN serie LIKE '%2%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 2'
            WHEN serie LIKE '%3%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 3'
            WHEN serie LIKE '%4%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 4'
            WHEN serie LIKE '%5%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 5'
            WHEN serie LIKE '%TRAVESSIA%' THEN 'TRAVESSIA RECIFE'
            WHEN serie LIKE '%CORRECAO%1%' THEN 'CORREÇÃO DE FLUXO 1 - ALFABETIZACAO'
            WHEN serie LIKE '%CORRECAO%2%' THEN 'CORREÇÃO DE FLUXO 2 - ACELERACAO'
            ELSE 'OUTROS'
        END AS serie,
        turma,
        turno,
        idade,
        -- transformação do SEXO
        CASE
            WHEN sexo = '1' THEN 'Masculino'
            WHEN sexo = '2' THEN 'Feminino'
            WHEN sexo = '3' THEN 'Outros'
            ELSE 'Não informado'
        END AS sexo,
        -- transformação de situacao
        CASE 
            WHEN situacao_nome LIKE '%APROV%' THEN 'Aprovado'
            WHEN situacao_nome LIKE '%RET%' OR situacao_nome LIKE '%REPRO%' THEN 'Reprovado'
            WHEN situacao_nome LIKE '%TR%' OR situacao_nome LIKE '%REMAN%' THEN 'Transferido'
            WHEN situacao_nome LIKE '%DESIST%' THEN 'Desistente'
            ELSE 'Outros'
        END AS sit_nome,
        -- Transformação da MODALIDADE
        CASE
            WHEN modalidade_ensino LIKE '%EDUCACAO INFANTIL%' THEN 'EDUCAÇÃO INFANTIL'
            WHEN modalidade_ensino LIKE '%ENSINO FUNDAMENTAL%' THEN 'ENSINO FUNDAMENTAL'
            WHEN modalidade_ensino LIKE '%EDUCACAO JOVENS E ADULTOS%' THEN 'EJA'
            WHEN modalidade_ensino LIKE '%CORRE%' THEN 'CORREÇÃO DE FLUXO'
            ELSE 'OUTROS'
        END AS modalidade_ens
    FROM source
)

SELECT * FROM cleaning_renaming
  );
  
[0m01:57:55.234499 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging.alunos_raw" does not exist
LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."aluno...
                           ^

[0m01:57:55.235208 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: ROLLBACK
[0m01:57:55.236130 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: Close
[0m01:57:55.239701 [debug] [Thread-1 (]: Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  relation "staging.alunos_raw" does not exist
  LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."aluno...
                             ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m01:57:55.241670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '496c4f3e-f2c9-44e1-a365-590768f42aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cb4ff2c00>]}
[0m01:57:55.242439 [error] [Thread-1 (]: 1 of 13 ERROR creating sql table model staging_staging.staging_situacao_alunos . [[31mERROR[0m in 0.08s]
[0m01:57:55.243220 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.staging_situacao_alunos
[0m01:57:55.244108 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_count_aluno_idade
[0m01:57:55.247263 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.staging_situacao_alunos' to be skipped because of status 'error'.  Reason: Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  relation "staging.alunos_raw" does not exist
  LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."aluno...
                             ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql.
[0m01:57:55.247977 [info ] [Thread-1 (]: 2 of 13 START sql view model staging_marts.view_count_aluno_idade .............. [RUN]
[0m01:57:55.249831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.staging_situacao_alunos, now model.transformacao_matricula.view_count_aluno_idade)
[0m01:57:55.250413 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_count_aluno_idade
[0m01:57:55.253293 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_count_aluno_idade"
[0m01:57:55.254148 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_count_aluno_idade
[0m01:57:55.279097 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_count_aluno_idade"
[0m01:57:55.282284 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m01:57:55.283529 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: BEGIN
[0m01:57:55.284574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:57:55.296580 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m01:57:55.297499 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m01:57:55.298605 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_count_aluno_idade"} */

  create view "transformacao_matricula"."staging_marts"."view_count_aluno_idade__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dl.desc_rpa,
    da.faixa_etaria,
    COUNT(fm.matricula) AS total_alunos
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
ORDER BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
  );
[0m01:57:55.300412 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 14:     fato_matricula fm
             ^

[0m01:57:55.301316 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: ROLLBACK
[0m01:57:55.302528 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: Close
[0m01:57:55.305997 [debug] [Thread-1 (]: Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  relation "fato_matricula" does not exist
  LINE 14:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m01:57:55.306705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '496c4f3e-f2c9-44e1-a365-590768f42aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cb15c9400>]}
[0m01:57:55.307594 [error] [Thread-1 (]: 2 of 13 ERROR creating sql view model staging_marts.view_count_aluno_idade ..... [[31mERROR[0m in 0.06s]
[0m01:57:55.308444 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_count_aluno_idade
[0m01:57:55.308961 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m01:57:55.309517 [info ] [Thread-1 (]: 3 of 13 START sql view model staging_marts.view_frequencia_situacao_escola ..... [RUN]
[0m01:57:55.310242 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_count_aluno_idade' to be skipped because of status 'error'.  Reason: Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  relation "fato_matricula" does not exist
  LINE 14:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql.
[0m01:57:55.310977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_count_aluno_idade, now model.transformacao_matricula.view_frequencia_situacao_escola)
[0m01:57:55.314524 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_frequencia_situacao_escola
[0m01:57:55.318233 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m01:57:55.319120 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_frequencia_situacao_escola
[0m01:57:55.322892 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m01:57:55.324009 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m01:57:55.324584 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: BEGIN
[0m01:57:55.325044 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:57:55.336189 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m01:57:55.336938 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m01:57:55.337558 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_frequencia_situacao_escola"} */

  create view "transformacao_matricula"."staging_marts"."view_frequencia_situacao_escola__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    de.nome_escola,
    de.codigo_escola,
    ds.situacao_nome,
    COUNT(fm.matricula) AS contagem_situacao
FROM
    fato_matricula fm
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, de.nome_escola, de.codigo_escola, ds.situacao_nome
ORDER BY
    dtemp.ano, de.nome_escola, contagem_situacao DESC
  );
[0m01:57:55.338896 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 15:     fato_matricula fm
             ^

[0m01:57:55.339611 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: ROLLBACK
[0m01:57:55.340755 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: Close
[0m01:57:55.344280 [debug] [Thread-1 (]: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m01:57:55.347336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '496c4f3e-f2c9-44e1-a365-590768f42aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cb0407620>]}
[0m01:57:55.349426 [error] [Thread-1 (]: 3 of 13 ERROR creating sql view model staging_marts.view_frequencia_situacao_escola  [[31mERROR[0m in 0.03s]
[0m01:57:55.350540 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m01:57:55.351273 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_matricula_detalhada
[0m01:57:55.352122 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_frequencia_situacao_escola' to be skipped because of status 'error'.  Reason: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql.
[0m01:57:55.353019 [info ] [Thread-1 (]: 4 of 13 START sql view model staging_marts.view_matricula_detalhada ............ [RUN]
[0m01:57:55.354130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_frequencia_situacao_escola, now model.transformacao_matricula.view_matricula_detalhada)
[0m01:57:55.354830 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_matricula_detalhada
[0m01:57:55.362890 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_matricula_detalhada"
[0m01:57:55.364382 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_matricula_detalhada
[0m01:57:55.370151 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_matricula_detalhada"
[0m01:57:55.371240 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m01:57:55.371823 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: BEGIN
[0m01:57:55.372322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:57:55.385767 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m01:57:55.386419 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m01:57:55.386889 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_matricula_detalhada"} */

  create view "transformacao_matricula"."staging_marts"."view_matricula_detalhada__dbt_tmp"
    
    
  as (
    
SELECT
    fm.matricula,
    da.sexo,
    da.idade,
    da.faixa_etaria,
    de.nome_escola,
    de.codigo_escola,
    dt.turma,
    dt.turno,
    dt.serie,
    dt.modalidade_ensino,
    ds.situacao_nome,
    ds.categoria AS categoria_situacao,
    ds.eh_aprovado,
    ds.eh_reprovado,
    dl.desc_rpa,
    dl.endereco_bairro AS bairro_localizacao,
    dtemp.ano AS ano_registro
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
  );
[0m01:57:55.388820 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 27:     fato_matricula fm
             ^

[0m01:57:55.389720 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: ROLLBACK
[0m01:57:55.391056 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: Close
[0m01:57:55.395012 [debug] [Thread-1 (]: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m01:57:55.396133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '496c4f3e-f2c9-44e1-a365-590768f42aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cb1566420>]}
[0m01:57:55.397576 [error] [Thread-1 (]: 4 of 13 ERROR creating sql view model staging_marts.view_matricula_detalhada ... [[31mERROR[0m in 0.04s]
[0m01:57:55.398978 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_matricula_detalhada
[0m01:57:55.399783 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_taxa_aprovados
[0m01:57:55.400590 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_matricula_detalhada' to be skipped because of status 'error'.  Reason: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql.
[0m01:57:55.401524 [info ] [Thread-1 (]: 5 of 13 START sql view model staging_marts.view_taxa_aprovados ................. [RUN]
[0m01:57:55.402654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_matricula_detalhada, now model.transformacao_matricula.view_taxa_aprovados)
[0m01:57:55.403782 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_taxa_aprovados
[0m01:57:55.407449 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_taxa_aprovados"
[0m01:57:55.408655 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_taxa_aprovados
[0m01:57:55.414618 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_taxa_aprovados"
[0m01:57:55.415874 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m01:57:55.416536 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: BEGIN
[0m01:57:55.417159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:57:55.428613 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m01:57:55.429410 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m01:57:55.430311 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_taxa_aprovados"} */

  create view "transformacao_matricula"."staging_marts"."view_taxa_aprovados__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dt.modalidade_ensino,
    COUNT(fm.matricula) AS total_matriculas,
    SUM(ds.eh_aprovado) AS total_aprovados,
    SUM(ds.eh_reprovado) AS total_reprovados,
    -- Calcula a taxa de aprovação (como porcentagem)
    CAST(SUM(ds.eh_aprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_aprovacao_percentual,
    -- Calcula a taxa de reprovação (como porcentagem)
    CAST(SUM(ds.eh_reprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_reprovacao_percentual
FROM
    fato_matricula fm
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dt.modalidade_ensino
ORDER BY
    dtemp.ano, dt.modalidade_ensino
  );
[0m01:57:55.432529 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 19:     fato_matricula fm
             ^

[0m01:57:55.433267 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: ROLLBACK
[0m01:57:55.434498 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: Close
[0m01:57:55.438158 [debug] [Thread-1 (]: Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  relation "fato_matricula" does not exist
  LINE 19:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m01:57:55.439193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '496c4f3e-f2c9-44e1-a365-590768f42aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cb4bb8f20>]}
[0m01:57:55.440250 [error] [Thread-1 (]: 5 of 13 ERROR creating sql view model staging_marts.view_taxa_aprovados ........ [[31mERROR[0m in 0.04s]
[0m01:57:55.441290 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_taxa_aprovados
[0m01:57:55.442072 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_aluno
[0m01:57:55.442808 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_taxa_aprovados' to be skipped because of status 'error'.  Reason: Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  relation "fato_matricula" does not exist
  LINE 19:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql.
[0m01:57:55.443596 [info ] [Thread-1 (]: 6 of 13 SKIP relation staging_marts.dim_aluno .................................. [[33mSKIP[0m]
[0m01:57:55.444678 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_aluno
[0m01:57:55.445617 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.transform_data
[0m01:57:55.448775 [info ] [Thread-1 (]: 7 of 13 SKIP relation staging_marts.transform_data ............................. [[33mSKIP[0m]
[0m01:57:55.450280 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.transform_data
[0m01:57:55.452505 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_escola
[0m01:57:55.453946 [info ] [Thread-1 (]: 8 of 13 SKIP relation staging_marts.dim_escola ................................. [[33mSKIP[0m]
[0m01:57:55.454825 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_escola
[0m01:57:55.455881 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_localizacao
[0m01:57:55.456743 [info ] [Thread-1 (]: 9 of 13 SKIP relation staging_marts.dim_localizacao ............................ [[33mSKIP[0m]
[0m01:57:55.457655 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_localizacao
[0m01:57:55.458499 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_situacao
[0m01:57:55.459419 [info ] [Thread-1 (]: 10 of 13 SKIP relation staging_marts.dim_situacao .............................. [[33mSKIP[0m]
[0m01:57:55.460436 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_situacao
[0m01:57:55.461297 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_tempo
[0m01:57:55.462968 [info ] [Thread-1 (]: 11 of 13 SKIP relation staging_marts.dim_tempo ................................. [[33mSKIP[0m]
[0m01:57:55.464308 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_tempo
[0m01:57:55.465273 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_turma
[0m01:57:55.466167 [info ] [Thread-1 (]: 12 of 13 SKIP relation staging_marts.dim_turma ................................. [[33mSKIP[0m]
[0m01:57:55.467133 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_turma
[0m01:57:55.468376 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.fato_matricula
[0m01:57:55.469230 [info ] [Thread-1 (]: 13 of 13 SKIP relation staging_marts.fato_matricula ............................ [[33mSKIP[0m]
[0m01:57:55.470152 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.fato_matricula
[0m01:57:55.472167 [debug] [MainThread]: Using postgres connection "master"
[0m01:57:55.473125 [debug] [MainThread]: On master: BEGIN
[0m01:57:55.473972 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:57:55.489924 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m01:57:55.490672 [debug] [MainThread]: On master: COMMIT
[0m01:57:55.491241 [debug] [MainThread]: Using postgres connection "master"
[0m01:57:55.491759 [debug] [MainThread]: On master: COMMIT
[0m01:57:55.492990 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m01:57:55.494073 [debug] [MainThread]: On master: Close
[0m01:57:55.495488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:57:55.496368 [debug] [MainThread]: Connection 'model.transformacao_matricula.view_taxa_aprovados' was properly closed.
[0m01:57:55.497228 [info ] [MainThread]: 
[0m01:57:55.498011 [info ] [MainThread]: Finished running 9 table models, 4 view models in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m01:57:55.500282 [debug] [MainThread]: Command end result
[0m01:57:55.527080 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m01:57:55.529921 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m01:57:55.539099 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m01:57:55.539761 [info ] [MainThread]: 
[0m01:57:55.540497 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m01:57:55.541103 [info ] [MainThread]: 
[0m01:57:55.541777 [error] [MainThread]: [31mFailure in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)[0m
[0m01:57:55.542517 [error] [MainThread]:   Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  relation "staging.alunos_raw" does not exist
  LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."aluno...
                             ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m01:57:55.543201 [info ] [MainThread]: 
[0m01:57:55.543887 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m01:57:55.544786 [info ] [MainThread]: 
[0m01:57:55.545945 [error] [MainThread]: [31mFailure in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)[0m
[0m01:57:55.549395 [error] [MainThread]:   Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  relation "fato_matricula" does not exist
  LINE 14:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m01:57:55.550346 [info ] [MainThread]: 
[0m01:57:55.551130 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m01:57:55.551958 [info ] [MainThread]: 
[0m01:57:55.552862 [error] [MainThread]: [31mFailure in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)[0m
[0m01:57:55.553632 [error] [MainThread]:   Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m01:57:55.554276 [info ] [MainThread]: 
[0m01:57:55.554989 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m01:57:55.555677 [info ] [MainThread]: 
[0m01:57:55.556538 [error] [MainThread]: [31mFailure in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)[0m
[0m01:57:55.557488 [error] [MainThread]:   Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m01:57:55.558335 [info ] [MainThread]: 
[0m01:57:55.559151 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m01:57:55.559902 [info ] [MainThread]: 
[0m01:57:55.560815 [error] [MainThread]: [31mFailure in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)[0m
[0m01:57:55.561820 [error] [MainThread]:   Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  relation "fato_matricula" does not exist
  LINE 19:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m01:57:55.562665 [info ] [MainThread]: 
[0m01:57:55.563562 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m01:57:55.564356 [info ] [MainThread]: 
[0m01:57:55.565151 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=8 NO-OP=0 TOTAL=13
[0m01:57:55.566815 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7829515, "process_in_blocks": "1848", "process_kernel_time": 0.374957, "process_mem_max_rss": "129196", "process_out_blocks": "3168", "process_user_time": 2.622715}
[0m01:57:55.567803 [debug] [MainThread]: Command `dbt run` failed at 01:57:55.567623 after 1.78 seconds
[0m01:57:55.568625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cb7422fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cb78b3ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cb88a0200>]}
[0m01:57:55.569494 [debug] [MainThread]: Flushing usage events
[0m01:57:56.255017 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:07:13.862022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a55a5555b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a55a5a3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a559a8a150>]}


============================== 02:07:13.869721 | 0d2512dc-eb01-42e9-b632-e99b0de796b5 ==============================
[0m02:07:13.869721 [info ] [MainThread]: Running with dbt=1.10.15
[0m02:07:13.870903 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'no_print': 'None', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'printer_width': '80', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'invocation_command': 'dbt run', 'use_colors': 'True', 'target_path': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'profiles_dir': '/home/murilo/.dbt', 'quiet': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'write_json': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'fail_fast': 'False'}
[0m02:07:14.041515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d2512dc-eb01-42e9-b632-e99b0de796b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a55beb7b60>]}
[0m02:07:14.108828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d2512dc-eb01-42e9-b632-e99b0de796b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a55a6cb5f0>]}
[0m02:07:14.109711 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:07:14.255912 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m02:07:14.373146 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:07:14.373624 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:07:14.378571 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.transformacao_matricula.facts
- models.transformacao_matricula.dimensions
- models.transformacao_matricula.intermediate
[0m02:07:14.426524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d2512dc-eb01-42e9-b632-e99b0de796b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a5585fafc0>]}
[0m02:07:14.524377 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m02:07:14.526461 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m02:07:14.540546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d2512dc-eb01-42e9-b632-e99b0de796b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a55798e810>]}
[0m02:07:14.541106 [info ] [MainThread]: Found 13 models, 2 data tests, 1 source, 459 macros
[0m02:07:14.541551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d2512dc-eb01-42e9-b632-e99b0de796b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a5585faf60>]}
[0m02:07:14.543778 [info ] [MainThread]: 
[0m02:07:14.544286 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m02:07:14.544619 [info ] [MainThread]: 
[0m02:07:14.545152 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:07:14.549136 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula'
[0m02:07:14.606569 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m02:07:14.607600 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m02:07:14.608310 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:07:14.627767 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.019 seconds
[0m02:07:14.629595 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m02:07:14.634803 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m02:07:14.635889 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m02:07:14.636568 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:07:14.654501 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.016 seconds
[0m02:07:14.658347 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m02:07:14.661919 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula, now list_transformacao_matricula_staging_marts)
[0m02:07:14.671608 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m02:07:14.672295 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: BEGIN
[0m02:07:14.672717 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:07:14.683462 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m02:07:14.686001 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m02:07:14.688955 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_marts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m02:07:14.694590 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m02:07:14.696106 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: ROLLBACK
[0m02:07:14.697019 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: Close
[0m02:07:14.697787 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_marts, now list_transformacao_matricula_staging_staging)
[0m02:07:14.700689 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m02:07:14.701340 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: BEGIN
[0m02:07:14.701892 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:07:14.711512 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m02:07:14.711984 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m02:07:14.712331 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_staging"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m02:07:14.715666 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m02:07:14.718395 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: ROLLBACK
[0m02:07:14.724371 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: Close
[0m02:07:14.729298 [debug] [MainThread]: Using postgres connection "master"
[0m02:07:14.729983 [debug] [MainThread]: On master: BEGIN
[0m02:07:14.730447 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:07:14.740977 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m02:07:14.741442 [debug] [MainThread]: Using postgres connection "master"
[0m02:07:14.741810 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:07:14.745971 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m02:07:14.747533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d2512dc-eb01-42e9-b632-e99b0de796b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a55bf8eea0>]}
[0m02:07:14.748046 [debug] [MainThread]: On master: ROLLBACK
[0m02:07:14.748947 [debug] [MainThread]: Using postgres connection "master"
[0m02:07:14.749435 [debug] [MainThread]: On master: BEGIN
[0m02:07:14.750606 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m02:07:14.752083 [debug] [MainThread]: On master: COMMIT
[0m02:07:14.755396 [debug] [MainThread]: Using postgres connection "master"
[0m02:07:14.755889 [debug] [MainThread]: On master: COMMIT
[0m02:07:14.756819 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:07:14.757434 [debug] [MainThread]: On master: Close
[0m02:07:14.760884 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.staging_situacao_alunos
[0m02:07:14.761611 [info ] [Thread-1 (]: 1 of 13 START sql table model staging_staging.staging_situacao_alunos .......... [RUN]
[0m02:07:14.762215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_staging, now model.transformacao_matricula.staging_situacao_alunos)
[0m02:07:14.762632 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.staging_situacao_alunos
[0m02:07:14.770063 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.staging_situacao_alunos"
[0m02:07:14.771325 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.staging_situacao_alunos
[0m02:07:14.826722 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.staging_situacao_alunos"
[0m02:07:14.828088 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m02:07:14.828643 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: BEGIN
[0m02:07:14.829113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:14.838676 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m02:07:14.839247 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m02:07:14.839772 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */

  
    

  create  table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp"
  
  
    as
  
  (
    WITH source AS (
    SELECT * FROM "transformacao_matricula"."staging"."alunos_raw"
),

cleaning_renaming AS (
    SELECT
        ano,
        codigo_escola,
        matricula,
        escola AS nome_escola,
        endereco_logradouro AS endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa,
        modalidade_ensino_codigo AS mod_ens_codigo,
        -- Transformação da SÉRIE
        CASE
            -- Ensino Fundamental (1º ao 9º)
            WHEN serie LIKE '%1 ANO%' OR serie LIKE '%1º ANO%' THEN '1º ANO'
            WHEN serie LIKE '%2 ANO%' OR serie LIKE '%2º ANO%' THEN '2º ANO'
            WHEN serie LIKE '%3 ANO%' OR serie LIKE '%3º ANO%' THEN '3º ANO'
            WHEN serie LIKE '%4 ANO%' OR serie LIKE '%4º ANO%' THEN '4º ANO'
            WHEN serie LIKE '%5 ANO%' OR serie LIKE '%5º ANO%' THEN '5º ANO'
            WHEN serie LIKE '%6 ANO%' OR serie LIKE '%6º ANO%' THEN '6º ANO'
            WHEN serie LIKE '%7 ANO%' OR serie LIKE '%7º ANO%' THEN '7º ANO'
            WHEN serie LIKE '%8 ANO%' OR serie LIKE '%8º ANO%' THEN '8º ANO'
            WHEN serie LIKE '%9 ANO%' OR serie LIKE '%9º ANO%' THEN '9º ANO'
            -- Educação Infantil (Berçário e Grupos)
            WHEN serie LIKE '%BER%' THEN 'BERÇARIO'
            WHEN serie LIKE '%GRUPO I%' OR serie LIKE '%GRUPO 1%' THEN 'GRUPO I'
            WHEN serie LIKE '%GRUPO II%' THEN 'GRUPO II'
            WHEN serie LIKE '%GRUPO III%' THEN 'GRUPO III'
            WHEN serie LIKE '%GRUPO IV%' THEN 'GRUPO IV'
            WHEN serie LIKE '%GRUPO V%' THEN 'GRUPO V'
            -- EJA (Módulos 1 ao 5) 
            WHEN serie LIKE '%1%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 1'
            WHEN serie LIKE '%2%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 2'
            WHEN serie LIKE '%3%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 3'
            WHEN serie LIKE '%4%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 4'
            WHEN serie LIKE '%5%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 5'
            WHEN serie LIKE '%TRAVESSIA%' THEN 'TRAVESSIA RECIFE'
            WHEN serie LIKE '%CORRECAO%1%' THEN 'CORREÇÃO DE FLUXO 1 - ALFABETIZACAO'
            WHEN serie LIKE '%CORRECAO%2%' THEN 'CORREÇÃO DE FLUXO 2 - ACELERACAO'
            ELSE 'OUTROS'
        END AS serie,
        turma,
        turno,
        idade,
        -- transformação do SEXO
        CASE
            WHEN sexo = '1' THEN 'Masculino'
            WHEN sexo = '2' THEN 'Feminino'
            WHEN sexo = '3' THEN 'Outros'
            ELSE 'Não informado'
        END AS sexo,
        -- transformação de situacao
        CASE 
            WHEN situacao_nome LIKE '%APROV%' THEN 'Aprovado'
            WHEN situacao_nome LIKE '%RET%' OR situacao_nome LIKE '%REPRO%' THEN 'Reprovado'
            WHEN situacao_nome LIKE '%TR%' OR situacao_nome LIKE '%REMAN%' THEN 'Transferido'
            WHEN situacao_nome LIKE '%DESIST%' THEN 'Desistente'
            ELSE 'Outros'
        END AS sit_nome,
        -- Transformação da MODALIDADE
        CASE
            WHEN modalidade_ensino LIKE '%EDUCACAO INFANTIL%' THEN 'EDUCAÇÃO INFANTIL'
            WHEN modalidade_ensino LIKE '%ENSINO FUNDAMENTAL%' THEN 'ENSINO FUNDAMENTAL'
            WHEN modalidade_ensino LIKE '%EDUCACAO JOVENS E ADULTOS%' THEN 'EJA'
            WHEN modalidade_ensino LIKE '%CORRE%' THEN 'CORREÇÃO DE FLUXO'
            ELSE 'OUTROS'
        END AS modalidade_ens
    FROM source
)

SELECT * FROM cleaning_renaming
  );
  
[0m02:07:14.841065 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging.alunos_raw" does not exist
LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."aluno...
                           ^

[0m02:07:14.841608 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: ROLLBACK
[0m02:07:14.842499 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: Close
[0m02:07:14.846031 [debug] [Thread-1 (]: Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  relation "staging.alunos_raw" does not exist
  LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."aluno...
                             ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m02:07:14.847680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d2512dc-eb01-42e9-b632-e99b0de796b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a5585fadb0>]}
[0m02:07:14.848429 [error] [Thread-1 (]: 1 of 13 ERROR creating sql table model staging_staging.staging_situacao_alunos . [[31mERROR[0m in 0.08s]
[0m02:07:14.849128 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.staging_situacao_alunos
[0m02:07:14.849630 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_count_aluno_idade
[0m02:07:14.850444 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.staging_situacao_alunos' to be skipped because of status 'error'.  Reason: Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  relation "staging.alunos_raw" does not exist
  LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."aluno...
                             ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql.
[0m02:07:14.851865 [info ] [Thread-1 (]: 2 of 13 START sql view model staging_marts.view_count_aluno_idade .............. [RUN]
[0m02:07:14.859626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.staging_situacao_alunos, now model.transformacao_matricula.view_count_aluno_idade)
[0m02:07:14.860420 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_count_aluno_idade
[0m02:07:14.863649 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_count_aluno_idade"
[0m02:07:14.864883 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_count_aluno_idade
[0m02:07:14.895910 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_count_aluno_idade"
[0m02:07:14.897452 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m02:07:14.898379 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: BEGIN
[0m02:07:14.899050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:14.911793 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m02:07:14.912641 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m02:07:14.913259 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_count_aluno_idade"} */

  create view "transformacao_matricula"."staging_marts"."view_count_aluno_idade__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dl.desc_rpa,
    da.faixa_etaria,
    COUNT(fm.matricula) AS total_alunos
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
ORDER BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
  );
[0m02:07:14.915035 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 14:     fato_matricula fm
             ^

[0m02:07:14.915818 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: ROLLBACK
[0m02:07:14.917079 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: Close
[0m02:07:14.921239 [debug] [Thread-1 (]: Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  relation "fato_matricula" does not exist
  LINE 14:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m02:07:14.922351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d2512dc-eb01-42e9-b632-e99b0de796b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a5564d2b40>]}
[0m02:07:14.923293 [error] [Thread-1 (]: 2 of 13 ERROR creating sql view model staging_marts.view_count_aluno_idade ..... [[31mERROR[0m in 0.06s]
[0m02:07:14.924006 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_count_aluno_idade
[0m02:07:14.924474 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m02:07:14.925171 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_count_aluno_idade' to be skipped because of status 'error'.  Reason: Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  relation "fato_matricula" does not exist
  LINE 14:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql.
[0m02:07:14.925795 [info ] [Thread-1 (]: 3 of 13 START sql view model staging_marts.view_frequencia_situacao_escola ..... [RUN]
[0m02:07:14.926749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_count_aluno_idade, now model.transformacao_matricula.view_frequencia_situacao_escola)
[0m02:07:14.927228 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_frequencia_situacao_escola
[0m02:07:14.929902 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m02:07:14.930789 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_frequencia_situacao_escola
[0m02:07:14.934461 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m02:07:14.935283 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m02:07:14.935784 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: BEGIN
[0m02:07:14.936261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:14.948399 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m02:07:14.949139 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m02:07:14.949806 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_frequencia_situacao_escola"} */

  create view "transformacao_matricula"."staging_marts"."view_frequencia_situacao_escola__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    de.nome_escola,
    de.codigo_escola,
    ds.situacao_nome,
    COUNT(fm.matricula) AS contagem_situacao
FROM
    fato_matricula fm
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, de.nome_escola, de.codigo_escola, ds.situacao_nome
ORDER BY
    dtemp.ano, de.nome_escola, contagem_situacao DESC
  );
[0m02:07:14.951953 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 15:     fato_matricula fm
             ^

[0m02:07:14.953482 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: ROLLBACK
[0m02:07:14.956595 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: Close
[0m02:07:14.960236 [debug] [Thread-1 (]: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m02:07:14.961322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d2512dc-eb01-42e9-b632-e99b0de796b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a5564074d0>]}
[0m02:07:14.962909 [error] [Thread-1 (]: 3 of 13 ERROR creating sql view model staging_marts.view_frequencia_situacao_escola  [[31mERROR[0m in 0.03s]
[0m02:07:14.964496 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m02:07:14.965273 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_matricula_detalhada
[0m02:07:14.967230 [info ] [Thread-1 (]: 4 of 13 START sql view model staging_marts.view_matricula_detalhada ............ [RUN]
[0m02:07:14.966205 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_frequencia_situacao_escola' to be skipped because of status 'error'.  Reason: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql.
[0m02:07:14.968172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_frequencia_situacao_escola, now model.transformacao_matricula.view_matricula_detalhada)
[0m02:07:14.969294 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_matricula_detalhada
[0m02:07:14.973642 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_matricula_detalhada"
[0m02:07:14.974735 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_matricula_detalhada
[0m02:07:14.978681 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_matricula_detalhada"
[0m02:07:14.979719 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m02:07:14.980304 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: BEGIN
[0m02:07:14.980901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:14.991826 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m02:07:14.992650 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m02:07:14.993383 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_matricula_detalhada"} */

  create view "transformacao_matricula"."staging_marts"."view_matricula_detalhada__dbt_tmp"
    
    
  as (
    
SELECT
    fm.matricula,
    da.sexo,
    da.idade,
    da.faixa_etaria,
    de.nome_escola,
    de.codigo_escola,
    dt.turma,
    dt.turno,
    dt.serie,
    dt.modalidade_ensino,
    ds.situacao_nome,
    ds.categoria AS categoria_situacao,
    ds.eh_aprovado,
    ds.eh_reprovado,
    dl.desc_rpa,
    dl.endereco_bairro AS bairro_localizacao,
    dtemp.ano AS ano_registro
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
  );
[0m02:07:14.994809 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 27:     fato_matricula fm
             ^

[0m02:07:14.995573 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: ROLLBACK
[0m02:07:14.996818 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: Close
[0m02:07:15.000285 [debug] [Thread-1 (]: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m02:07:15.001506 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d2512dc-eb01-42e9-b632-e99b0de796b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a55641cb30>]}
[0m02:07:15.002532 [error] [Thread-1 (]: 4 of 13 ERROR creating sql view model staging_marts.view_matricula_detalhada ... [[31mERROR[0m in 0.03s]
[0m02:07:15.003565 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_matricula_detalhada
[0m02:07:15.004434 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_taxa_aprovados
[0m02:07:15.005325 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_matricula_detalhada' to be skipped because of status 'error'.  Reason: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql.
[0m02:07:15.006285 [info ] [Thread-1 (]: 5 of 13 START sql view model staging_marts.view_taxa_aprovados ................. [RUN]
[0m02:07:15.007329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_matricula_detalhada, now model.transformacao_matricula.view_taxa_aprovados)
[0m02:07:15.008075 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_taxa_aprovados
[0m02:07:15.012608 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_taxa_aprovados"
[0m02:07:15.014251 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_taxa_aprovados
[0m02:07:15.022546 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_taxa_aprovados"
[0m02:07:15.024063 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m02:07:15.024734 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: BEGIN
[0m02:07:15.025421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:15.037022 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m02:07:15.037810 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m02:07:15.038337 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_taxa_aprovados"} */

  create view "transformacao_matricula"."staging_marts"."view_taxa_aprovados__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dt.modalidade_ensino,
    COUNT(fm.matricula) AS total_matriculas,
    SUM(ds.eh_aprovado) AS total_aprovados,
    SUM(ds.eh_reprovado) AS total_reprovados,
    -- Calcula a taxa de aprovação (como porcentagem)
    CAST(SUM(ds.eh_aprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_aprovacao_percentual,
    -- Calcula a taxa de reprovação (como porcentagem)
    CAST(SUM(ds.eh_reprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_reprovacao_percentual
FROM
    fato_matricula fm
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dt.modalidade_ensino
ORDER BY
    dtemp.ano, dt.modalidade_ensino
  );
[0m02:07:15.040023 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 19:     fato_matricula fm
             ^

[0m02:07:15.040778 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: ROLLBACK
[0m02:07:15.041990 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: Close
[0m02:07:15.045382 [debug] [Thread-1 (]: Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  relation "fato_matricula" does not exist
  LINE 19:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m02:07:15.047007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d2512dc-eb01-42e9-b632-e99b0de796b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a554b7b5c0>]}
[0m02:07:15.048258 [error] [Thread-1 (]: 5 of 13 ERROR creating sql view model staging_marts.view_taxa_aprovados ........ [[31mERROR[0m in 0.04s]
[0m02:07:15.049080 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_taxa_aprovados
[0m02:07:15.049606 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_aluno
[0m02:07:15.050187 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_taxa_aprovados' to be skipped because of status 'error'.  Reason: Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  relation "fato_matricula" does not exist
  LINE 19:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql.
[0m02:07:15.050683 [info ] [Thread-1 (]: 6 of 13 SKIP relation staging_marts.dim_aluno .................................. [[33mSKIP[0m]
[0m02:07:15.051558 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_aluno
[0m02:07:15.052139 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.transform_data
[0m02:07:15.055983 [info ] [Thread-1 (]: 7 of 13 SKIP relation staging_marts.transform_data ............................. [[33mSKIP[0m]
[0m02:07:15.057441 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.transform_data
[0m02:07:15.059138 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_escola
[0m02:07:15.059780 [info ] [Thread-1 (]: 8 of 13 SKIP relation staging_marts.dim_escola ................................. [[33mSKIP[0m]
[0m02:07:15.060909 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_escola
[0m02:07:15.061674 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_localizacao
[0m02:07:15.062961 [info ] [Thread-1 (]: 9 of 13 SKIP relation staging_marts.dim_localizacao ............................ [[33mSKIP[0m]
[0m02:07:15.063716 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_localizacao
[0m02:07:15.064429 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_situacao
[0m02:07:15.065227 [info ] [Thread-1 (]: 10 of 13 SKIP relation staging_marts.dim_situacao .............................. [[33mSKIP[0m]
[0m02:07:15.066153 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_situacao
[0m02:07:15.066868 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_tempo
[0m02:07:15.067562 [info ] [Thread-1 (]: 11 of 13 SKIP relation staging_marts.dim_tempo ................................. [[33mSKIP[0m]
[0m02:07:15.068871 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_tempo
[0m02:07:15.070100 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_turma
[0m02:07:15.071052 [info ] [Thread-1 (]: 12 of 13 SKIP relation staging_marts.dim_turma ................................. [[33mSKIP[0m]
[0m02:07:15.071939 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_turma
[0m02:07:15.073301 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.fato_matricula
[0m02:07:15.074070 [info ] [Thread-1 (]: 13 of 13 SKIP relation staging_marts.fato_matricula ............................ [[33mSKIP[0m]
[0m02:07:15.074837 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.fato_matricula
[0m02:07:15.077158 [debug] [MainThread]: Using postgres connection "master"
[0m02:07:15.078143 [debug] [MainThread]: On master: BEGIN
[0m02:07:15.079703 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:07:15.095446 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m02:07:15.096173 [debug] [MainThread]: On master: COMMIT
[0m02:07:15.096735 [debug] [MainThread]: Using postgres connection "master"
[0m02:07:15.097227 [debug] [MainThread]: On master: COMMIT
[0m02:07:15.098258 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:07:15.099375 [debug] [MainThread]: On master: Close
[0m02:07:15.100662 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:07:15.101492 [debug] [MainThread]: Connection 'model.transformacao_matricula.view_taxa_aprovados' was properly closed.
[0m02:07:15.102358 [info ] [MainThread]: 
[0m02:07:15.103137 [info ] [MainThread]: Finished running 9 table models, 4 view models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m02:07:15.105022 [debug] [MainThread]: Command end result
[0m02:07:15.135187 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m02:07:15.138148 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m02:07:15.145861 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m02:07:15.146579 [info ] [MainThread]: 
[0m02:07:15.147237 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m02:07:15.147827 [info ] [MainThread]: 
[0m02:07:15.148524 [error] [MainThread]: [31mFailure in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)[0m
[0m02:07:15.149420 [error] [MainThread]:   Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  relation "staging.alunos_raw" does not exist
  LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."aluno...
                             ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m02:07:15.150141 [info ] [MainThread]: 
[0m02:07:15.150907 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m02:07:15.151621 [info ] [MainThread]: 
[0m02:07:15.152489 [error] [MainThread]: [31mFailure in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)[0m
[0m02:07:15.153338 [error] [MainThread]:   Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  relation "fato_matricula" does not exist
  LINE 14:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m02:07:15.155956 [info ] [MainThread]: 
[0m02:07:15.158518 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m02:07:15.159129 [info ] [MainThread]: 
[0m02:07:15.160337 [error] [MainThread]: [31mFailure in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)[0m
[0m02:07:15.161560 [error] [MainThread]:   Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m02:07:15.162609 [info ] [MainThread]: 
[0m02:07:15.163504 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m02:07:15.164655 [info ] [MainThread]: 
[0m02:07:15.165837 [error] [MainThread]: [31mFailure in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)[0m
[0m02:07:15.166727 [error] [MainThread]:   Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m02:07:15.167478 [info ] [MainThread]: 
[0m02:07:15.168175 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m02:07:15.168650 [info ] [MainThread]: 
[0m02:07:15.169210 [error] [MainThread]: [31mFailure in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)[0m
[0m02:07:15.169724 [error] [MainThread]:   Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  relation "fato_matricula" does not exist
  LINE 19:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m02:07:15.170189 [info ] [MainThread]: 
[0m02:07:15.170696 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m02:07:15.171169 [info ] [MainThread]: 
[0m02:07:15.171635 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=8 NO-OP=0 TOTAL=13
[0m02:07:15.172982 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3678747, "process_in_blocks": "8992", "process_kernel_time": 0.36242, "process_mem_max_rss": "123596", "process_out_blocks": "2208", "process_user_time": 2.208469}
[0m02:07:15.173715 [debug] [MainThread]: Command `dbt run` failed at 02:07:15.173595 after 1.37 seconds
[0m02:07:15.174325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a559a8b0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a559de70e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a55c0cb2c0>]}
[0m02:07:15.175210 [debug] [MainThread]: Flushing usage events
[0m02:07:15.810245 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:07:46.163269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ada885331d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ada8bc47bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ada8a882f90>]}


============================== 02:07:46.171061 | de459791-e073-4da6-8fdd-f17759886051 ==============================
[0m02:07:46.171061 [info ] [MainThread]: Running with dbt=1.10.15
[0m02:07:46.172240 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'introspect': 'True', 'use_colors': 'True', 'quiet': 'False', 'no_print': 'None', 'version_check': 'True', 'write_json': 'True', 'profiles_dir': '/home/murilo/.dbt', 'log_format': 'default', 'log_cache_events': 'False', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'fail_fast': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'printer_width': '80', 'empty': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False'}
[0m02:07:46.332150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de459791-e073-4da6-8fdd-f17759886051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ada88c9ca40>]}
[0m02:07:46.398912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de459791-e073-4da6-8fdd-f17759886051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ada8a8e6c60>]}
[0m02:07:46.403195 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:07:46.519151 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m02:07:46.632023 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:07:46.632624 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:07:46.641491 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.transformacao_matricula.dimensions
- models.transformacao_matricula.facts
- models.transformacao_matricula.intermediate
[0m02:07:46.681966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de459791-e073-4da6-8fdd-f17759886051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ada873932c0>]}
[0m02:07:46.758975 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m02:07:46.760696 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m02:07:46.772162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de459791-e073-4da6-8fdd-f17759886051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ada8639d250>]}
[0m02:07:46.772680 [info ] [MainThread]: Found 13 models, 2 data tests, 1 source, 459 macros
[0m02:07:46.773098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de459791-e073-4da6-8fdd-f17759886051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ada863149b0>]}
[0m02:07:46.775016 [info ] [MainThread]: 
[0m02:07:46.775482 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m02:07:46.775942 [info ] [MainThread]: 
[0m02:07:46.776567 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:07:46.780784 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula'
[0m02:07:46.821624 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m02:07:46.822339 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m02:07:46.822749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:07:46.833429 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.011 seconds
[0m02:07:46.838893 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m02:07:46.844074 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m02:07:46.844977 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m02:07:46.845611 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:07:46.855728 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m02:07:46.856977 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m02:07:46.858960 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula, now list_transformacao_matricula_staging_staging)
[0m02:07:46.863934 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m02:07:46.864367 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: BEGIN
[0m02:07:46.864673 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:07:46.877549 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m02:07:46.878048 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m02:07:46.878413 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_staging"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m02:07:46.881767 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m02:07:46.883492 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: ROLLBACK
[0m02:07:46.884339 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: Close
[0m02:07:46.885007 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_staging, now list_transformacao_matricula_staging_marts)
[0m02:07:46.887069 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m02:07:46.887506 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: BEGIN
[0m02:07:46.887836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:07:46.898151 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m02:07:46.899011 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m02:07:46.899357 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_marts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m02:07:46.903346 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m02:07:46.905200 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: ROLLBACK
[0m02:07:46.905918 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: Close
[0m02:07:46.910871 [debug] [MainThread]: Using postgres connection "master"
[0m02:07:46.911312 [debug] [MainThread]: On master: BEGIN
[0m02:07:46.911617 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:07:46.920586 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m02:07:46.921053 [debug] [MainThread]: Using postgres connection "master"
[0m02:07:46.921417 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:07:46.925275 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m02:07:46.927255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de459791-e073-4da6-8fdd-f17759886051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ada873905f0>]}
[0m02:07:46.927743 [debug] [MainThread]: On master: ROLLBACK
[0m02:07:46.928540 [debug] [MainThread]: Using postgres connection "master"
[0m02:07:46.928960 [debug] [MainThread]: On master: BEGIN
[0m02:07:46.930064 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m02:07:46.930551 [debug] [MainThread]: On master: COMMIT
[0m02:07:46.930902 [debug] [MainThread]: Using postgres connection "master"
[0m02:07:46.931218 [debug] [MainThread]: On master: COMMIT
[0m02:07:46.931882 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:07:46.932280 [debug] [MainThread]: On master: Close
[0m02:07:46.934889 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.staging_situacao_alunos
[0m02:07:46.935971 [info ] [Thread-1 (]: 1 of 13 START sql table model staging_staging.staging_situacao_alunos .......... [RUN]
[0m02:07:46.936502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_marts, now model.transformacao_matricula.staging_situacao_alunos)
[0m02:07:46.936966 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.staging_situacao_alunos
[0m02:07:46.943580 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.staging_situacao_alunos"
[0m02:07:46.944383 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.staging_situacao_alunos
[0m02:07:46.989937 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.staging_situacao_alunos"
[0m02:07:46.990751 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m02:07:46.991195 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: BEGIN
[0m02:07:46.991567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:47.000441 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m02:07:47.001129 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m02:07:47.001719 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */

  
    

  create  table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp"
  
  
    as
  
  (
    WITH source AS (
    SELECT * FROM "transformacao_matricula"."staging"."alunos_raw"
),

cleaning_renaming AS (
    SELECT
        ano,
        codigo_escola,
        matricula,
        escola AS nome_escola,
        endereco_logradouro AS endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa,
        modalidade_ensino_codigo AS mod_ens_codigo,
        -- Transformação da SÉRIE
        CASE
            -- Ensino Fundamental (1º ao 9º)
            WHEN serie LIKE '%1 ANO%' OR serie LIKE '%1º ANO%' THEN '1º ANO'
            WHEN serie LIKE '%2 ANO%' OR serie LIKE '%2º ANO%' THEN '2º ANO'
            WHEN serie LIKE '%3 ANO%' OR serie LIKE '%3º ANO%' THEN '3º ANO'
            WHEN serie LIKE '%4 ANO%' OR serie LIKE '%4º ANO%' THEN '4º ANO'
            WHEN serie LIKE '%5 ANO%' OR serie LIKE '%5º ANO%' THEN '5º ANO'
            WHEN serie LIKE '%6 ANO%' OR serie LIKE '%6º ANO%' THEN '6º ANO'
            WHEN serie LIKE '%7 ANO%' OR serie LIKE '%7º ANO%' THEN '7º ANO'
            WHEN serie LIKE '%8 ANO%' OR serie LIKE '%8º ANO%' THEN '8º ANO'
            WHEN serie LIKE '%9 ANO%' OR serie LIKE '%9º ANO%' THEN '9º ANO'
            -- Educação Infantil (Berçário e Grupos)
            WHEN serie LIKE '%BER%' THEN 'BERÇARIO'
            WHEN serie LIKE '%GRUPO I%' OR serie LIKE '%GRUPO 1%' THEN 'GRUPO I'
            WHEN serie LIKE '%GRUPO II%' THEN 'GRUPO II'
            WHEN serie LIKE '%GRUPO III%' THEN 'GRUPO III'
            WHEN serie LIKE '%GRUPO IV%' THEN 'GRUPO IV'
            WHEN serie LIKE '%GRUPO V%' THEN 'GRUPO V'
            -- EJA (Módulos 1 ao 5) 
            WHEN serie LIKE '%1%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 1'
            WHEN serie LIKE '%2%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 2'
            WHEN serie LIKE '%3%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 3'
            WHEN serie LIKE '%4%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 4'
            WHEN serie LIKE '%5%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 5'
            WHEN serie LIKE '%TRAVESSIA%' THEN 'TRAVESSIA RECIFE'
            WHEN serie LIKE '%CORRECAO%1%' THEN 'CORREÇÃO DE FLUXO 1 - ALFABETIZACAO'
            WHEN serie LIKE '%CORRECAO%2%' THEN 'CORREÇÃO DE FLUXO 2 - ACELERACAO'
            ELSE 'OUTROS'
        END AS serie,
        turma,
        turno,
        idade,
        -- transformação do SEXO
        CASE
            WHEN sexo = '1' THEN 'Masculino'
            WHEN sexo = '2' THEN 'Feminino'
            WHEN sexo = '3' THEN 'Outros'
            ELSE 'Não informado'
        END AS sexo,
        -- transformação de situacao
        CASE 
            WHEN situacao_nome LIKE '%APROV%' THEN 'Aprovado'
            WHEN situacao_nome LIKE '%RET%' OR situacao_nome LIKE '%REPRO%' THEN 'Reprovado'
            WHEN situacao_nome LIKE '%TR%' OR situacao_nome LIKE '%REMAN%' THEN 'Transferido'
            WHEN situacao_nome LIKE '%DESIST%' THEN 'Desistente'
            ELSE 'Outros'
        END AS sit_nome,
        -- Transformação da MODALIDADE
        CASE
            WHEN modalidade_ensino LIKE '%EDUCACAO INFANTIL%' THEN 'EDUCAÇÃO INFANTIL'
            WHEN modalidade_ensino LIKE '%ENSINO FUNDAMENTAL%' THEN 'ENSINO FUNDAMENTAL'
            WHEN modalidade_ensino LIKE '%EDUCACAO JOVENS E ADULTOS%' THEN 'EJA'
            WHEN modalidade_ensino LIKE '%CORRE%' THEN 'CORREÇÃO DE FLUXO'
            ELSE 'OUTROS'
        END AS modalidade_ens
    FROM source
)

SELECT * FROM cleaning_renaming
  );
  
[0m02:07:47.007174 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging.alunos_raw" does not exist
LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."aluno...
                           ^

[0m02:07:47.007773 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: ROLLBACK
[0m02:07:47.008675 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: Close
[0m02:07:47.013975 [debug] [Thread-1 (]: Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  relation "staging.alunos_raw" does not exist
  LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."aluno...
                             ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m02:07:47.016195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de459791-e073-4da6-8fdd-f17759886051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ada85f1b200>]}
[0m02:07:47.017087 [error] [Thread-1 (]: 1 of 13 ERROR creating sql table model staging_staging.staging_situacao_alunos . [[31mERROR[0m in 0.08s]
[0m02:07:47.017785 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.staging_situacao_alunos
[0m02:07:47.018288 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_count_aluno_idade
[0m02:07:47.018864 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.staging_situacao_alunos' to be skipped because of status 'error'.  Reason: Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  relation "staging.alunos_raw" does not exist
  LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."aluno...
                             ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql.
[0m02:07:47.019545 [info ] [Thread-1 (]: 2 of 13 START sql view model staging_marts.view_count_aluno_idade .............. [RUN]
[0m02:07:47.021357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.staging_situacao_alunos, now model.transformacao_matricula.view_count_aluno_idade)
[0m02:07:47.021975 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_count_aluno_idade
[0m02:07:47.024651 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_count_aluno_idade"
[0m02:07:47.025724 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_count_aluno_idade
[0m02:07:47.054186 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_count_aluno_idade"
[0m02:07:47.055450 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m02:07:47.056196 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: BEGIN
[0m02:07:47.056883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:47.074048 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m02:07:47.075299 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m02:07:47.076247 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_count_aluno_idade"} */

  create view "transformacao_matricula"."staging_marts"."view_count_aluno_idade__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dl.desc_rpa,
    da.faixa_etaria,
    COUNT(fm.matricula) AS total_alunos
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
ORDER BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
  );
[0m02:07:47.078028 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 14:     fato_matricula fm
             ^

[0m02:07:47.079056 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: ROLLBACK
[0m02:07:47.080407 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: Close
[0m02:07:47.083255 [debug] [Thread-1 (]: Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  relation "fato_matricula" does not exist
  LINE 14:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m02:07:47.084180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de459791-e073-4da6-8fdd-f17759886051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ada84bf50d0>]}
[0m02:07:47.085242 [error] [Thread-1 (]: 2 of 13 ERROR creating sql view model staging_marts.view_count_aluno_idade ..... [[31mERROR[0m in 0.06s]
[0m02:07:47.086231 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_count_aluno_idade
[0m02:07:47.086776 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m02:07:47.087440 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_count_aluno_idade' to be skipped because of status 'error'.  Reason: Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  relation "fato_matricula" does not exist
  LINE 14:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql.
[0m02:07:47.088186 [info ] [Thread-1 (]: 3 of 13 START sql view model staging_marts.view_frequencia_situacao_escola ..... [RUN]
[0m02:07:47.089758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_count_aluno_idade, now model.transformacao_matricula.view_frequencia_situacao_escola)
[0m02:07:47.090956 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_frequencia_situacao_escola
[0m02:07:47.095227 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m02:07:47.096008 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_frequencia_situacao_escola
[0m02:07:47.099385 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m02:07:47.100402 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m02:07:47.101203 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: BEGIN
[0m02:07:47.101828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:47.114425 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m02:07:47.115187 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m02:07:47.115898 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_frequencia_situacao_escola"} */

  create view "transformacao_matricula"."staging_marts"."view_frequencia_situacao_escola__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    de.nome_escola,
    de.codigo_escola,
    ds.situacao_nome,
    COUNT(fm.matricula) AS contagem_situacao
FROM
    fato_matricula fm
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, de.nome_escola, de.codigo_escola, ds.situacao_nome
ORDER BY
    dtemp.ano, de.nome_escola, contagem_situacao DESC
  );
[0m02:07:47.117828 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 15:     fato_matricula fm
             ^

[0m02:07:47.118831 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: ROLLBACK
[0m02:07:47.120338 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: Close
[0m02:07:47.128518 [debug] [Thread-1 (]: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m02:07:47.129489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de459791-e073-4da6-8fdd-f17759886051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ada84b13440>]}
[0m02:07:47.130672 [error] [Thread-1 (]: 3 of 13 ERROR creating sql view model staging_marts.view_frequencia_situacao_escola  [[31mERROR[0m in 0.04s]
[0m02:07:47.131922 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m02:07:47.132721 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_matricula_detalhada
[0m02:07:47.133533 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_frequencia_situacao_escola' to be skipped because of status 'error'.  Reason: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql.
[0m02:07:47.134595 [info ] [Thread-1 (]: 4 of 13 START sql view model staging_marts.view_matricula_detalhada ............ [RUN]
[0m02:07:47.137340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_frequencia_situacao_escola, now model.transformacao_matricula.view_matricula_detalhada)
[0m02:07:47.140105 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_matricula_detalhada
[0m02:07:47.144807 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_matricula_detalhada"
[0m02:07:47.146414 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_matricula_detalhada
[0m02:07:47.151900 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_matricula_detalhada"
[0m02:07:47.153162 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m02:07:47.154002 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: BEGIN
[0m02:07:47.154897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:47.166443 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m02:07:47.167030 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m02:07:47.167647 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_matricula_detalhada"} */

  create view "transformacao_matricula"."staging_marts"."view_matricula_detalhada__dbt_tmp"
    
    
  as (
    
SELECT
    fm.matricula,
    da.sexo,
    da.idade,
    da.faixa_etaria,
    de.nome_escola,
    de.codigo_escola,
    dt.turma,
    dt.turno,
    dt.serie,
    dt.modalidade_ensino,
    ds.situacao_nome,
    ds.categoria AS categoria_situacao,
    ds.eh_aprovado,
    ds.eh_reprovado,
    dl.desc_rpa,
    dl.endereco_bairro AS bairro_localizacao,
    dtemp.ano AS ano_registro
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
  );
[0m02:07:47.171357 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 27:     fato_matricula fm
             ^

[0m02:07:47.173640 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: ROLLBACK
[0m02:07:47.175437 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: Close
[0m02:07:47.179521 [debug] [Thread-1 (]: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m02:07:47.180426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de459791-e073-4da6-8fdd-f17759886051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ada84b3d3d0>]}
[0m02:07:47.181459 [error] [Thread-1 (]: 4 of 13 ERROR creating sql view model staging_marts.view_matricula_detalhada ... [[31mERROR[0m in 0.04s]
[0m02:07:47.183010 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_matricula_detalhada
[0m02:07:47.184021 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_taxa_aprovados
[0m02:07:47.185008 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_matricula_detalhada' to be skipped because of status 'error'.  Reason: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql.
[0m02:07:47.186204 [info ] [Thread-1 (]: 5 of 13 START sql view model staging_marts.view_taxa_aprovados ................. [RUN]
[0m02:07:47.187633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_matricula_detalhada, now model.transformacao_matricula.view_taxa_aprovados)
[0m02:07:47.188757 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_taxa_aprovados
[0m02:07:47.193105 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_taxa_aprovados"
[0m02:07:47.194396 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_taxa_aprovados
[0m02:07:47.200907 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_taxa_aprovados"
[0m02:07:47.202964 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m02:07:47.207292 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: BEGIN
[0m02:07:47.208120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:07:47.221091 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m02:07:47.221790 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m02:07:47.222320 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_taxa_aprovados"} */

  create view "transformacao_matricula"."staging_marts"."view_taxa_aprovados__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dt.modalidade_ensino,
    COUNT(fm.matricula) AS total_matriculas,
    SUM(ds.eh_aprovado) AS total_aprovados,
    SUM(ds.eh_reprovado) AS total_reprovados,
    -- Calcula a taxa de aprovação (como porcentagem)
    CAST(SUM(ds.eh_aprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_aprovacao_percentual,
    -- Calcula a taxa de reprovação (como porcentagem)
    CAST(SUM(ds.eh_reprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_reprovacao_percentual
FROM
    fato_matricula fm
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dt.modalidade_ensino
ORDER BY
    dtemp.ano, dt.modalidade_ensino
  );
[0m02:07:47.223627 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 19:     fato_matricula fm
             ^

[0m02:07:47.224277 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: ROLLBACK
[0m02:07:47.225222 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: Close
[0m02:07:47.227809 [debug] [Thread-1 (]: Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  relation "fato_matricula" does not exist
  LINE 19:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m02:07:47.228691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de459791-e073-4da6-8fdd-f17759886051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ada842a7470>]}
[0m02:07:47.229873 [error] [Thread-1 (]: 5 of 13 ERROR creating sql view model staging_marts.view_taxa_aprovados ........ [[31mERROR[0m in 0.04s]
[0m02:07:47.230781 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_taxa_aprovados
[0m02:07:47.231431 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_aluno
[0m02:07:47.232008 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_taxa_aprovados' to be skipped because of status 'error'.  Reason: Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  relation "fato_matricula" does not exist
  LINE 19:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql.
[0m02:07:47.232578 [info ] [Thread-1 (]: 6 of 13 SKIP relation staging_marts.dim_aluno .................................. [[33mSKIP[0m]
[0m02:07:47.233391 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_aluno
[0m02:07:47.233938 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.transform_data
[0m02:07:47.235081 [info ] [Thread-1 (]: 7 of 13 SKIP relation staging_marts.transform_data ............................. [[33mSKIP[0m]
[0m02:07:47.237334 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.transform_data
[0m02:07:47.244222 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_escola
[0m02:07:47.245012 [info ] [Thread-1 (]: 8 of 13 SKIP relation staging_marts.dim_escola ................................. [[33mSKIP[0m]
[0m02:07:47.245719 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_escola
[0m02:07:47.246322 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_localizacao
[0m02:07:47.246959 [info ] [Thread-1 (]: 9 of 13 SKIP relation staging_marts.dim_localizacao ............................ [[33mSKIP[0m]
[0m02:07:47.247632 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_localizacao
[0m02:07:47.248270 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_situacao
[0m02:07:47.249223 [info ] [Thread-1 (]: 10 of 13 SKIP relation staging_marts.dim_situacao .............................. [[33mSKIP[0m]
[0m02:07:47.250662 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_situacao
[0m02:07:47.251433 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_tempo
[0m02:07:47.252098 [info ] [Thread-1 (]: 11 of 13 SKIP relation staging_marts.dim_tempo ................................. [[33mSKIP[0m]
[0m02:07:47.252743 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_tempo
[0m02:07:47.253327 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_turma
[0m02:07:47.253955 [info ] [Thread-1 (]: 12 of 13 SKIP relation staging_marts.dim_turma ................................. [[33mSKIP[0m]
[0m02:07:47.254703 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_turma
[0m02:07:47.256068 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.fato_matricula
[0m02:07:47.256713 [info ] [Thread-1 (]: 13 of 13 SKIP relation staging_marts.fato_matricula ............................ [[33mSKIP[0m]
[0m02:07:47.257404 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.fato_matricula
[0m02:07:47.259125 [debug] [MainThread]: Using postgres connection "master"
[0m02:07:47.259909 [debug] [MainThread]: On master: BEGIN
[0m02:07:47.260655 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:07:47.276252 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m02:07:47.276897 [debug] [MainThread]: On master: COMMIT
[0m02:07:47.277398 [debug] [MainThread]: Using postgres connection "master"
[0m02:07:47.277876 [debug] [MainThread]: On master: COMMIT
[0m02:07:47.278738 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:07:47.279707 [debug] [MainThread]: On master: Close
[0m02:07:47.280654 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:07:47.281484 [debug] [MainThread]: Connection 'model.transformacao_matricula.view_taxa_aprovados' was properly closed.
[0m02:07:47.282233 [info ] [MainThread]: 
[0m02:07:47.282875 [info ] [MainThread]: Finished running 9 table models, 4 view models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m02:07:47.284782 [debug] [MainThread]: Command end result
[0m02:07:47.319744 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m02:07:47.323093 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m02:07:47.333081 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m02:07:47.333797 [info ] [MainThread]: 
[0m02:07:47.334797 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m02:07:47.336065 [info ] [MainThread]: 
[0m02:07:47.337274 [error] [MainThread]: [31mFailure in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)[0m
[0m02:07:47.341733 [error] [MainThread]:   Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  relation "staging.alunos_raw" does not exist
  LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."aluno...
                             ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m02:07:47.343033 [info ] [MainThread]: 
[0m02:07:47.344217 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m02:07:47.345815 [info ] [MainThread]: 
[0m02:07:47.347236 [error] [MainThread]: [31mFailure in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)[0m
[0m02:07:47.348674 [error] [MainThread]:   Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  relation "fato_matricula" does not exist
  LINE 14:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m02:07:47.349405 [info ] [MainThread]: 
[0m02:07:47.349967 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m02:07:47.350468 [info ] [MainThread]: 
[0m02:07:47.351130 [error] [MainThread]: [31mFailure in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)[0m
[0m02:07:47.351823 [error] [MainThread]:   Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m02:07:47.352470 [info ] [MainThread]: 
[0m02:07:47.353117 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m02:07:47.353695 [info ] [MainThread]: 
[0m02:07:47.354391 [error] [MainThread]: [31mFailure in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)[0m
[0m02:07:47.355267 [error] [MainThread]:   Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m02:07:47.356180 [info ] [MainThread]: 
[0m02:07:47.357430 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m02:07:47.358244 [info ] [MainThread]: 
[0m02:07:47.359000 [error] [MainThread]: [31mFailure in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)[0m
[0m02:07:47.359559 [error] [MainThread]:   Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  relation "fato_matricula" does not exist
  LINE 19:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m02:07:47.360013 [info ] [MainThread]: 
[0m02:07:47.360513 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m02:07:47.360979 [info ] [MainThread]: 
[0m02:07:47.361518 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=8 NO-OP=0 TOTAL=13
[0m02:07:47.362811 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2580588, "process_in_blocks": "0", "process_kernel_time": 0.341337, "process_mem_max_rss": "123660", "process_out_blocks": "2208", "process_user_time": 2.107735}
[0m02:07:47.363637 [debug] [MainThread]: Command `dbt run` failed at 02:07:47.363489 after 1.26 seconds
[0m02:07:47.364301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ada87db3830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ada8a516ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ada8731bb60>]}
[0m02:07:47.364900 [debug] [MainThread]: Flushing usage events
[0m02:07:47.956342 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:08:28.871967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9ac221dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9ac1c6b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9ac3211bb0>]}


============================== 02:08:28.875234 | 43562e99-dcdf-473d-a217-044c089f89ca ==============================
[0m02:08:28.875234 [info ] [MainThread]: Running with dbt=1.10.15
[0m02:08:28.875750 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'empty': 'False', 'debug': 'False', 'no_print': 'None', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'profiles_dir': '/home/murilo/.dbt', 'invocation_command': 'dbt run', 'printer_width': '80', 'fail_fast': 'False', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'warn_error': 'None', 'log_format': 'default', 'version_check': 'True'}
[0m02:08:29.035185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43562e99-dcdf-473d-a217-044c089f89ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9ac3c8bcb0>]}
[0m02:08:29.088569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43562e99-dcdf-473d-a217-044c089f89ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9ac1d1c7a0>]}
[0m02:08:29.089403 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:08:29.206187 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m02:08:29.300576 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:08:29.301656 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/staging/schema.yml
[0m02:08:29.669979 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.transformacao_matricula.staging_situacao_alunos' (transformacao_aprovados/models/staging/staging_situacao_alunos.sql) depends on a source named 'dados_educacao_staging.alunos_raw' which was not found
[0m02:08:29.675644 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8487811, "process_in_blocks": "624", "process_kernel_time": 0.283977, "process_mem_max_rss": "118620", "process_out_blocks": "16", "process_user_time": 1.869437}
[0m02:08:29.676202 [debug] [MainThread]: Command `dbt run` failed at 02:08:29.676126 after 0.85 seconds
[0m02:08:29.676587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9ac14355b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9abf7de510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9abcd0b350>]}
[0m02:08:29.676959 [debug] [MainThread]: Flushing usage events
[0m02:08:30.195515 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:09:28.244177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7255b8d56ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7255b6c199d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7255b6a47fb0>]}


============================== 02:09:28.250269 | 7a45a8d9-13e4-499e-85b6-167eb31ca7b3 ==============================
[0m02:09:28.250269 [info ] [MainThread]: Running with dbt=1.10.15
[0m02:09:28.251021 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'static_parser': 'True', 'empty': 'False', 'log_format': 'default', 'profiles_dir': '/home/murilo/.dbt', 'partial_parse': 'True', 'warn_error': 'None', 'invocation_command': 'dbt run', 'quiet': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'use_colors': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'fail_fast': 'False', 'target_path': 'None', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False'}
[0m02:09:28.455747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a45a8d9-13e4-499e-85b6-167eb31ca7b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7255b58c7620>]}
[0m02:09:28.526551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a45a8d9-13e4-499e-85b6-167eb31ca7b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7255b6953f80>]}
[0m02:09:28.527493 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:09:28.662392 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m02:09:28.780048 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:09:28.782549 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/staging/schema.yml
[0m02:09:29.405774 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.transformacao_matricula.staging_situacao_alunos' (transformacao_aprovados/models/staging/staging_situacao_alunos.sql) depends on a source named 'dados_educacao_staging.alunos_raw' which was not found
[0m02:09:29.406916 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2394775, "process_in_blocks": "8", "process_kernel_time": 0.323963, "process_mem_max_rss": "118588", "process_out_blocks": "16", "process_user_time": 2.385998}
[0m02:09:29.407427 [debug] [MainThread]: Command `dbt run` failed at 02:09:29.407346 after 1.24 seconds
[0m02:09:29.407838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7255b6d79f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7255b3d6ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7255b452b650>]}
[0m02:09:29.408248 [debug] [MainThread]: Flushing usage events
[0m02:09:29.923840 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:10:29.643011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09fb080ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09fad493a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09fa5291c0>]}


============================== 02:10:29.646330 | 19ac0be8-05c9-4852-a837-9d00971adbd0 ==============================
[0m02:10:29.646330 [info ] [MainThread]: Running with dbt=1.10.15
[0m02:10:29.646898 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'write_json': 'True', 'debug': 'False', 'target_path': 'None', 'log_format': 'default', 'no_print': 'None', 'partial_parse': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'warn_error': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/home/murilo/.dbt', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs'}
[0m02:10:29.848947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19ac0be8-05c9-4852-a837-9d00971adbd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09f9576930>]}
[0m02:10:29.914488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19ac0be8-05c9-4852-a837-9d00971adbd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09f9ef5b20>]}
[0m02:10:29.915295 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:10:30.038723 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m02:10:30.138259 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:10:30.139684 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/staging/schema.yml
[0m02:10:30.581350 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.transformacao_matricula.staging_situacao_alunos' (transformacao_aprovados/models/staging/staging_situacao_alunos.sql) depends on a source named 'dados_educacao_staging.alunos_raw' which was not found
[0m02:10:30.582435 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0026282, "process_in_blocks": "472", "process_kernel_time": 0.31887, "process_mem_max_rss": "118544", "process_out_blocks": "16", "process_user_time": 2.316062}
[0m02:10:30.582959 [debug] [MainThread]: Command `dbt run` failed at 02:10:30.582882 after 1.00 seconds
[0m02:10:30.583358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09faa28b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09f7976ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09f7d1b4d0>]}
[0m02:10:30.583758 [debug] [MainThread]: Flushing usage events
[0m02:10:31.129792 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:11:56.012162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f8cddc6840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f8d00b3a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f8ce23d5b0>]}


============================== 02:11:56.015779 | 66c27407-c80c-4014-ac40-91a8ea91ce9f ==============================
[0m02:11:56.015779 [info ] [MainThread]: Running with dbt=1.10.15
[0m02:11:56.016384 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'target_path': 'None', 'profiles_dir': '/home/murilo/.dbt', 'quiet': 'False', 'warn_error': 'None', 'introspect': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'log_format': 'default', 'empty': 'False'}
[0m02:11:56.170132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66c27407-c80c-4014-ac40-91a8ea91ce9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f8cd6fdcd0>]}
[0m02:11:56.222390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66c27407-c80c-4014-ac40-91a8ea91ce9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f8ceb5ad20>]}
[0m02:11:56.223200 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:11:56.341634 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m02:11:56.434404 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m02:11:56.435464 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/staging/schema.yml
[0m02:11:56.435864 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m02:11:56.799159 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.transformacao_matricula.staging_situacao_alunos' (transformacao_aprovados/models/staging/staging_situacao_alunos.sql) depends on a source named 'transformacao_matricula.alunos_raw' which was not found
[0m02:11:56.800359 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8421353, "process_in_blocks": "40", "process_kernel_time": 0.282636, "process_mem_max_rss": "118516", "process_out_blocks": "8", "process_user_time": 1.764485}
[0m02:11:56.803922 [debug] [MainThread]: Command `dbt run` failed at 02:11:56.803775 after 0.85 seconds
[0m02:11:56.804374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f8cd9a7800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f8cbf12450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f8cbb31d00>]}
[0m02:11:56.804770 [debug] [MainThread]: Flushing usage events
[0m02:11:57.334146 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:12:22.509465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6555ca94c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6554c208c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6554dc16d0>]}


============================== 02:12:22.513296 | 4c156594-ee75-4de2-9161-4924a00809b2 ==============================
[0m02:12:22.513296 [info ] [MainThread]: Running with dbt=1.10.15
[0m02:12:22.514026 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run', 'empty': 'False', 'fail_fast': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'target_path': 'None', 'printer_width': '80', 'static_parser': 'True', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'use_experimental_parser': 'False', 'write_json': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/murilo/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_format': 'default', 'log_cache_events': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'quiet': 'False'}
[0m02:12:22.715014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c156594-ee75-4de2-9161-4924a00809b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6556763950>]}
[0m02:12:22.789944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c156594-ee75-4de2-9161-4924a00809b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6554de49e0>]}
[0m02:12:22.794765 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:12:22.943031 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m02:12:23.073333 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m02:12:23.074864 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/staging/schema.yml
[0m02:12:23.075538 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m02:12:23.598982 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.transformacao_matricula.intermediate
- models.transformacao_matricula.dimensions
- models.transformacao_matricula.facts
[0m02:12:23.607046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c156594-ee75-4de2-9161-4924a00809b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a65519c0140>]}
[0m02:12:23.699874 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m02:12:23.702304 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m02:12:23.821273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c156594-ee75-4de2-9161-4924a00809b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a65519c3950>]}
[0m02:12:23.821821 [info ] [MainThread]: Found 13 models, 2 data tests, 1 source, 459 macros
[0m02:12:23.822238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c156594-ee75-4de2-9161-4924a00809b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a65548c7530>]}
[0m02:12:23.824115 [info ] [MainThread]: 
[0m02:12:23.824615 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m02:12:23.825014 [info ] [MainThread]: 
[0m02:12:23.825593 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:12:23.829614 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula'
[0m02:12:23.870029 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m02:12:23.870689 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m02:12:23.871213 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:12:23.884815 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.013 seconds
[0m02:12:23.886287 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m02:12:23.888517 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m02:12:23.889204 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m02:12:23.889709 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:12:23.903177 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.013 seconds
[0m02:12:23.904552 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m02:12:23.907743 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula, now list_transformacao_matricula_staging_marts)
[0m02:12:23.914525 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m02:12:23.915044 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: BEGIN
[0m02:12:23.915408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:12:23.923405 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m02:12:23.923860 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m02:12:23.924321 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_marts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m02:12:23.929074 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m02:12:23.934021 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: ROLLBACK
[0m02:12:23.935008 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: Close
[0m02:12:23.935875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_marts, now list_transformacao_matricula_staging_staging)
[0m02:12:23.941019 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m02:12:23.941509 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: BEGIN
[0m02:12:23.941876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:12:23.951144 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m02:12:23.951645 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m02:12:23.952016 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_staging"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m02:12:23.955092 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m02:12:23.956680 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: ROLLBACK
[0m02:12:23.957453 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: Close
[0m02:12:23.963583 [debug] [MainThread]: Using postgres connection "master"
[0m02:12:23.967088 [debug] [MainThread]: On master: BEGIN
[0m02:12:23.967592 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:12:23.978021 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m02:12:23.978769 [debug] [MainThread]: Using postgres connection "master"
[0m02:12:23.979396 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:12:23.983462 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m02:12:23.985441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c156594-ee75-4de2-9161-4924a00809b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a654adf5be0>]}
[0m02:12:23.985976 [debug] [MainThread]: On master: ROLLBACK
[0m02:12:23.986753 [debug] [MainThread]: Using postgres connection "master"
[0m02:12:23.987158 [debug] [MainThread]: On master: BEGIN
[0m02:12:23.987916 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:12:23.988320 [debug] [MainThread]: On master: COMMIT
[0m02:12:23.988638 [debug] [MainThread]: Using postgres connection "master"
[0m02:12:23.988960 [debug] [MainThread]: On master: COMMIT
[0m02:12:23.989532 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:12:23.989936 [debug] [MainThread]: On master: Close
[0m02:12:23.992746 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.staging_situacao_alunos
[0m02:12:23.993684 [info ] [Thread-1 (]: 1 of 13 START sql table model staging_staging.staging_situacao_alunos .......... [RUN]
[0m02:12:23.994317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_staging, now model.transformacao_matricula.staging_situacao_alunos)
[0m02:12:23.994716 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.staging_situacao_alunos
[0m02:12:24.005541 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.staging_situacao_alunos"
[0m02:12:24.006401 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.staging_situacao_alunos
[0m02:12:24.060686 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.staging_situacao_alunos"
[0m02:12:24.061768 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m02:12:24.065278 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: BEGIN
[0m02:12:24.067036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:12:24.078727 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m02:12:24.079348 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m02:12:24.079923 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */

  
    

  create  table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp"
  
  
    as
  
  (
    WITH source AS (
    SELECT * FROM "transformacao_matricula"."staging"."staging_alunos_raw"
),

cleaning_renaming AS (
    SELECT
        ano,
        codigo_escola,
        matricula,
        escola AS nome_escola,
        endereco_logradouro AS endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa,
        modalidade_ensino_codigo AS mod_ens_codigo,
        -- Transformação da SÉRIE
        CASE
            -- Ensino Fundamental (1º ao 9º)
            WHEN serie LIKE '%1 ANO%' OR serie LIKE '%1º ANO%' THEN '1º ANO'
            WHEN serie LIKE '%2 ANO%' OR serie LIKE '%2º ANO%' THEN '2º ANO'
            WHEN serie LIKE '%3 ANO%' OR serie LIKE '%3º ANO%' THEN '3º ANO'
            WHEN serie LIKE '%4 ANO%' OR serie LIKE '%4º ANO%' THEN '4º ANO'
            WHEN serie LIKE '%5 ANO%' OR serie LIKE '%5º ANO%' THEN '5º ANO'
            WHEN serie LIKE '%6 ANO%' OR serie LIKE '%6º ANO%' THEN '6º ANO'
            WHEN serie LIKE '%7 ANO%' OR serie LIKE '%7º ANO%' THEN '7º ANO'
            WHEN serie LIKE '%8 ANO%' OR serie LIKE '%8º ANO%' THEN '8º ANO'
            WHEN serie LIKE '%9 ANO%' OR serie LIKE '%9º ANO%' THEN '9º ANO'
            -- Educação Infantil (Berçário e Grupos)
            WHEN serie LIKE '%BER%' THEN 'BERÇARIO'
            WHEN serie LIKE '%GRUPO I%' OR serie LIKE '%GRUPO 1%' THEN 'GRUPO I'
            WHEN serie LIKE '%GRUPO II%' THEN 'GRUPO II'
            WHEN serie LIKE '%GRUPO III%' THEN 'GRUPO III'
            WHEN serie LIKE '%GRUPO IV%' THEN 'GRUPO IV'
            WHEN serie LIKE '%GRUPO V%' THEN 'GRUPO V'
            -- EJA (Módulos 1 ao 5) 
            WHEN serie LIKE '%1%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 1'
            WHEN serie LIKE '%2%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 2'
            WHEN serie LIKE '%3%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 3'
            WHEN serie LIKE '%4%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 4'
            WHEN serie LIKE '%5%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 5'
            WHEN serie LIKE '%TRAVESSIA%' THEN 'TRAVESSIA RECIFE'
            WHEN serie LIKE '%CORRECAO%1%' THEN 'CORREÇÃO DE FLUXO 1 - ALFABETIZACAO'
            WHEN serie LIKE '%CORRECAO%2%' THEN 'CORREÇÃO DE FLUXO 2 - ACELERACAO'
            ELSE 'OUTROS'
        END AS serie,
        turma,
        turno,
        idade,
        -- transformação do SEXO
        CASE
            WHEN sexo = '1' THEN 'Masculino'
            WHEN sexo = '2' THEN 'Feminino'
            WHEN sexo = '3' THEN 'Outros'
            ELSE 'Não informado'
        END AS sexo,
        -- transformação de situacao
        CASE 
            WHEN situacao_nome LIKE '%APROV%' THEN 'Aprovado'
            WHEN situacao_nome LIKE '%RET%' OR situacao_nome LIKE '%REPRO%' THEN 'Reprovado'
            WHEN situacao_nome LIKE '%TR%' OR situacao_nome LIKE '%REMAN%' THEN 'Transferido'
            WHEN situacao_nome LIKE '%DESIST%' THEN 'Desistente'
            ELSE 'Outros'
        END AS sit_nome,
        -- Transformação da MODALIDADE
        CASE
            WHEN modalidade_ensino LIKE '%EDUCACAO INFANTIL%' THEN 'EDUCAÇÃO INFANTIL'
            WHEN modalidade_ensino LIKE '%ENSINO FUNDAMENTAL%' THEN 'ENSINO FUNDAMENTAL'
            WHEN modalidade_ensino LIKE '%EDUCACAO JOVENS E ADULTOS%' THEN 'EJA'
            WHEN modalidade_ensino LIKE '%CORRE%' THEN 'CORREÇÃO DE FLUXO'
            ELSE 'OUTROS'
        END AS modalidade_ens
    FROM source
)

SELECT * FROM cleaning_renaming
  );
  
[0m02:12:24.859436 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 0.779 seconds
[0m02:12:24.874235 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m02:12:24.874777 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
alter table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp" rename to "staging_situacao_alunos"
[0m02:12:24.875921 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:12:24.888216 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: COMMIT
[0m02:12:24.888748 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m02:12:24.889167 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: COMMIT
[0m02:12:24.905039 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m02:12:24.910614 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_backup"
[0m02:12:24.916145 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m02:12:24.916721 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
drop table if exists "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_backup" cascade
[0m02:12:24.917636 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m02:12:24.919840 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: Close
[0m02:12:24.921515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c156594-ee75-4de2-9161-4924a00809b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a65535328a0>]}
[0m02:12:24.922397 [info ] [Thread-1 (]: 1 of 13 OK created sql table model staging_staging.staging_situacao_alunos ..... [[32mSELECT 319146[0m in 0.93s]
[0m02:12:24.923169 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.staging_situacao_alunos
[0m02:12:24.923715 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_count_aluno_idade
[0m02:12:24.924485 [info ] [Thread-1 (]: 2 of 13 START sql view model staging_marts.view_count_aluno_idade .............. [RUN]
[0m02:12:24.925225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.staging_situacao_alunos, now model.transformacao_matricula.view_count_aluno_idade)
[0m02:12:24.925708 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_count_aluno_idade
[0m02:12:24.928135 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_count_aluno_idade"
[0m02:12:24.928946 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_count_aluno_idade
[0m02:12:24.947723 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_count_aluno_idade"
[0m02:12:24.948877 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m02:12:24.949551 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: BEGIN
[0m02:12:24.950137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:12:24.961527 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m02:12:24.962314 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m02:12:24.962984 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_count_aluno_idade"} */

  create view "transformacao_matricula"."staging_marts"."view_count_aluno_idade__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dl.desc_rpa,
    da.faixa_etaria,
    COUNT(fm.matricula) AS total_alunos
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
ORDER BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
  );
[0m02:12:24.964639 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 14:     fato_matricula fm
             ^

[0m02:12:24.965507 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: ROLLBACK
[0m02:12:24.970053 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: Close
[0m02:12:24.981173 [debug] [Thread-1 (]: Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  relation "fato_matricula" does not exist
  LINE 14:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m02:12:24.982162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c156594-ee75-4de2-9161-4924a00809b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a654931b020>]}
[0m02:12:24.983291 [error] [Thread-1 (]: 2 of 13 ERROR creating sql view model staging_marts.view_count_aluno_idade ..... [[31mERROR[0m in 0.06s]
[0m02:12:24.984324 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_count_aluno_idade
[0m02:12:24.985202 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m02:12:24.986126 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_count_aluno_idade' to be skipped because of status 'error'.  Reason: Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  relation "fato_matricula" does not exist
  LINE 14:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql.
[0m02:12:24.987482 [info ] [Thread-1 (]: 3 of 13 START sql view model staging_marts.view_frequencia_situacao_escola ..... [RUN]
[0m02:12:24.990447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_count_aluno_idade, now model.transformacao_matricula.view_frequencia_situacao_escola)
[0m02:12:24.991112 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_frequencia_situacao_escola
[0m02:12:24.994253 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m02:12:24.995082 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_frequencia_situacao_escola
[0m02:12:25.000767 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m02:12:25.004071 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m02:12:25.005340 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: BEGIN
[0m02:12:25.006259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:12:25.017966 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m02:12:25.018788 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m02:12:25.019604 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_frequencia_situacao_escola"} */

  create view "transformacao_matricula"."staging_marts"."view_frequencia_situacao_escola__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    de.nome_escola,
    de.codigo_escola,
    ds.situacao_nome,
    COUNT(fm.matricula) AS contagem_situacao
FROM
    fato_matricula fm
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, de.nome_escola, de.codigo_escola, ds.situacao_nome
ORDER BY
    dtemp.ano, de.nome_escola, contagem_situacao DESC
  );
[0m02:12:25.021218 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 15:     fato_matricula fm
             ^

[0m02:12:25.022141 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: ROLLBACK
[0m02:12:25.023705 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: Close
[0m02:12:25.027263 [debug] [Thread-1 (]: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m02:12:25.028357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c156594-ee75-4de2-9161-4924a00809b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a654ace3ec0>]}
[0m02:12:25.029753 [error] [Thread-1 (]: 3 of 13 ERROR creating sql view model staging_marts.view_frequencia_situacao_escola  [[31mERROR[0m in 0.04s]
[0m02:12:25.031254 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m02:12:25.033942 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_matricula_detalhada
[0m02:12:25.035307 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_frequencia_situacao_escola' to be skipped because of status 'error'.  Reason: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql.
[0m02:12:25.039153 [info ] [Thread-1 (]: 4 of 13 START sql view model staging_marts.view_matricula_detalhada ............ [RUN]
[0m02:12:25.040333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_frequencia_situacao_escola, now model.transformacao_matricula.view_matricula_detalhada)
[0m02:12:25.041145 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_matricula_detalhada
[0m02:12:25.046524 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_matricula_detalhada"
[0m02:12:25.047758 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_matricula_detalhada
[0m02:12:25.053238 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_matricula_detalhada"
[0m02:12:25.054572 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m02:12:25.055342 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: BEGIN
[0m02:12:25.056127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:12:25.073243 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m02:12:25.074193 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m02:12:25.074879 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_matricula_detalhada"} */

  create view "transformacao_matricula"."staging_marts"."view_matricula_detalhada__dbt_tmp"
    
    
  as (
    
SELECT
    fm.matricula,
    da.sexo,
    da.idade,
    da.faixa_etaria,
    de.nome_escola,
    de.codigo_escola,
    dt.turma,
    dt.turno,
    dt.serie,
    dt.modalidade_ensino,
    ds.situacao_nome,
    ds.categoria AS categoria_situacao,
    ds.eh_aprovado,
    ds.eh_reprovado,
    dl.desc_rpa,
    dl.endereco_bairro AS bairro_localizacao,
    dtemp.ano AS ano_registro
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
  );
[0m02:12:25.076289 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 27:     fato_matricula fm
             ^

[0m02:12:25.076931 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: ROLLBACK
[0m02:12:25.078155 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: Close
[0m02:12:25.081902 [debug] [Thread-1 (]: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m02:12:25.083450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c156594-ee75-4de2-9161-4924a00809b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6551d87260>]}
[0m02:12:25.085336 [error] [Thread-1 (]: 4 of 13 ERROR creating sql view model staging_marts.view_matricula_detalhada ... [[31mERROR[0m in 0.04s]
[0m02:12:25.087247 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_matricula_detalhada
[0m02:12:25.088222 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_taxa_aprovados
[0m02:12:25.089305 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_matricula_detalhada' to be skipped because of status 'error'.  Reason: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql.
[0m02:12:25.091472 [info ] [Thread-1 (]: 5 of 13 START sql view model staging_marts.view_taxa_aprovados ................. [RUN]
[0m02:12:25.093529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_matricula_detalhada, now model.transformacao_matricula.view_taxa_aprovados)
[0m02:12:25.094485 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_taxa_aprovados
[0m02:12:25.098274 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_taxa_aprovados"
[0m02:12:25.099618 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_taxa_aprovados
[0m02:12:25.109252 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_taxa_aprovados"
[0m02:12:25.110679 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m02:12:25.111499 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: BEGIN
[0m02:12:25.112711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:12:25.125950 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m02:12:25.126960 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m02:12:25.127961 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_taxa_aprovados"} */

  create view "transformacao_matricula"."staging_marts"."view_taxa_aprovados__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dt.modalidade_ensino,
    COUNT(fm.matricula) AS total_matriculas,
    SUM(ds.eh_aprovado) AS total_aprovados,
    SUM(ds.eh_reprovado) AS total_reprovados,
    -- Calcula a taxa de aprovação (como porcentagem)
    CAST(SUM(ds.eh_aprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_aprovacao_percentual,
    -- Calcula a taxa de reprovação (como porcentagem)
    CAST(SUM(ds.eh_reprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_reprovacao_percentual
FROM
    fato_matricula fm
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dt.modalidade_ensino
ORDER BY
    dtemp.ano, dt.modalidade_ensino
  );
[0m02:12:25.129976 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 19:     fato_matricula fm
             ^

[0m02:12:25.130770 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: ROLLBACK
[0m02:12:25.132173 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: Close
[0m02:12:25.139485 [debug] [Thread-1 (]: Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  relation "fato_matricula" does not exist
  LINE 19:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m02:12:25.140321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c156594-ee75-4de2-9161-4924a00809b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6554321e50>]}
[0m02:12:25.141123 [error] [Thread-1 (]: 5 of 13 ERROR creating sql view model staging_marts.view_taxa_aprovados ........ [[31mERROR[0m in 0.05s]
[0m02:12:25.141798 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_taxa_aprovados
[0m02:12:25.142308 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_aluno
[0m02:12:25.142893 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_taxa_aprovados' to be skipped because of status 'error'.  Reason: Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  relation "fato_matricula" does not exist
  LINE 19:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql.
[0m02:12:25.143508 [info ] [Thread-1 (]: 6 of 13 START sql table model staging_marts.dim_aluno .......................... [RUN]
[0m02:12:25.144316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_taxa_aprovados, now model.transformacao_matricula.dim_aluno)
[0m02:12:25.144776 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_aluno
[0m02:12:25.148638 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_aluno"
[0m02:12:25.149776 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_aluno
[0m02:12:25.154780 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_aluno"
[0m02:12:25.155955 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m02:12:25.156691 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: BEGIN
[0m02:12:25.157352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:12:25.170259 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m02:12:25.171154 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m02:12:25.171974 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_aluno"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."dim_aluno__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_staging"."staging_situacao_alunos" 
    ),
staged_data AS (
    SELECT
        sexo,
        idade,
        CASE
            WHEN idade <= 3 THEN '0-3 Anos (Educação Infantil)'
            WHEN idade <= 5 THEN '4-5 Anos (Pré-escola)'
            WHEN idade <= 10 THEN '6-10 Anos (Fundamental I)'
            WHEN idade <= 14 THEN '11-14 Anos (Fundamental II)'
            WHEN idade >= 15 THEN '15+ Anos (EJA e Outros)'
            ELSE 'Não Informado'
        END AS faixa_etaria
    FROM source
) 
  
SELECT * FROM staged_data;
  );
  
[0m02:12:25.173812 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 32: SELECT * FROM staged_data;
                                  ^

[0m02:12:25.174536 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: ROLLBACK
[0m02:12:25.175656 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: Close
[0m02:12:25.178480 [debug] [Thread-1 (]: Database Error in model dim_aluno (transformacao_aprovados/models/marts/dim_aluno.sql)
  syntax error at or near ";"
  LINE 32: SELECT * FROM staged_data;
                                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_aluno.sql
[0m02:12:25.179230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c156594-ee75-4de2-9161-4924a00809b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6549319490>]}
[0m02:12:25.180271 [error] [Thread-1 (]: 6 of 13 ERROR creating sql table model staging_marts.dim_aluno ................. [[31mERROR[0m in 0.03s]
[0m02:12:25.181302 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_aluno
[0m02:12:25.181972 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.transform_data
[0m02:12:25.182641 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.dim_aluno' to be skipped because of status 'error'.  Reason: Database Error in model dim_aluno (transformacao_aprovados/models/marts/dim_aluno.sql)
  syntax error at or near ";"
  LINE 32: SELECT * FROM staged_data;
                                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_aluno.sql.
[0m02:12:25.183334 [info ] [Thread-1 (]: 7 of 13 START sql table model staging_marts.transform_data ..................... [RUN]
[0m02:12:25.184341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_aluno, now model.transformacao_matricula.transform_data)
[0m02:12:25.185164 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.transform_data
[0m02:12:25.189403 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.transform_data"
[0m02:12:25.190284 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.transform_data
[0m02:12:25.196493 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.transform_data"
[0m02:12:25.197492 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m02:12:25.198259 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: BEGIN
[0m02:12:25.198903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:12:25.214385 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m02:12:25.215319 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m02:12:25.216241 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."transform_data__dbt_tmp"
  
  
    as
  
  (
    

with staged_data AS (
    SELECT * FROM "transformacao_matricula"."staging_staging"."staging_situacao_alunos"
),

transformed_data AS (
    SELECT
        CAST(ano AS INTEGER) AS ano,
        CAST(codigo_escola AS INTEGER) AS codigo_escola,
        CAST(matricula AS INTEGER) AS matricula,
        nome_escola,
        endereco_logra,
        endereco_bairro,
        endereco_numero,
        CAST(rpa AS INTEGER) AS rpa,
        CAST(mod_ens_codigo AS INTEGER) AS mod_ens_codigo,
        serie,
        turma,
        turno,
        CAST(idade AS INTEGER) AS idade,
        sexo,
        sit_nome AS situacao_nome,
        modalidade_ens,
        CASE
            WHEN CAST(idade AS INTEGER) <= 3 THEN '0-3 Anos (Educação Infantil)'
            WHEN CAST(idade AS INTEGER) <= 5 THEN '4-5 Anos (Pré-escola)'
            WHEN CAST(idade AS INTEGER) <= 10 THEN '6-10 Anos (Fundamental I)'
            WHEN CAST(idade AS INTEGER) <= 14 THEN '11-14 Anos (Fundamental II)'
            WHEN CAST(idade AS INTEGER) >= 15 THEN '15+ Anos (EJA e Outros)'
            ELSE 'Não Informado'
        END AS faixa_etaria
    FROM staged_data
)

SELECT * FROM transformed_data
  );
  
[0m02:12:25.964341 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 0.747 seconds
[0m02:12:25.967833 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m02:12:25.968345 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
alter table "transformacao_matricula"."staging_marts"."transform_data__dbt_tmp" rename to "transform_data"
[0m02:12:25.969911 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:12:25.976016 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: COMMIT
[0m02:12:25.976548 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m02:12:25.976924 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: COMMIT
[0m02:12:26.011874 [debug] [Thread-1 (]: SQL status: COMMIT in 0.034 seconds
[0m02:12:26.014542 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."transform_data__dbt_backup"
[0m02:12:26.015578 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m02:12:26.016339 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
drop table if exists "transformacao_matricula"."staging_marts"."transform_data__dbt_backup" cascade
[0m02:12:26.017392 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m02:12:26.019167 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: Close
[0m02:12:26.019886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c156594-ee75-4de2-9161-4924a00809b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a654ade7dd0>]}
[0m02:12:26.020539 [info ] [Thread-1 (]: 7 of 13 OK created sql table model staging_marts.transform_data ................ [[32mSELECT 319146[0m in 0.84s]
[0m02:12:26.021183 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.transform_data
[0m02:12:26.022589 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_escola
[0m02:12:26.023326 [info ] [Thread-1 (]: 8 of 13 START sql table model staging_marts.dim_escola ......................... [RUN]
[0m02:12:26.023881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.transform_data, now model.transformacao_matricula.dim_escola)
[0m02:12:26.024333 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_escola
[0m02:12:26.027021 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_escola"
[0m02:12:26.027685 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_escola
[0m02:12:26.030875 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_escola"
[0m02:12:26.031569 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m02:12:26.031968 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: BEGIN
[0m02:12:26.032323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:12:26.046899 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m02:12:26.047886 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m02:12:26.048470 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."dim_escola__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
    ),

escolas AS (
    SELECT
        DISTINCT codigo_escola,
        nome_escola,
        endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa
    FROM source
)
SELECT * FROM escolas;
  );
  
[0m02:12:26.049972 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 28: SELECT * FROM escolas;
                              ^

[0m02:12:26.050722 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: ROLLBACK
[0m02:12:26.052217 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: Close
[0m02:12:26.056108 [debug] [Thread-1 (]: Database Error in model dim_escola (transformacao_aprovados/models/marts/dim_escola.sql)
  syntax error at or near ";"
  LINE 28: SELECT * FROM escolas;
                                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_escola.sql
[0m02:12:26.057469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c156594-ee75-4de2-9161-4924a00809b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6549365f10>]}
[0m02:12:26.058719 [error] [Thread-1 (]: 8 of 13 ERROR creating sql table model staging_marts.dim_escola ................ [[31mERROR[0m in 0.03s]
[0m02:12:26.059837 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_escola
[0m02:12:26.060681 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_localizacao
[0m02:12:26.061553 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.dim_escola' to be skipped because of status 'error'.  Reason: Database Error in model dim_escola (transformacao_aprovados/models/marts/dim_escola.sql)
  syntax error at or near ";"
  LINE 28: SELECT * FROM escolas;
                                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_escola.sql.
[0m02:12:26.062581 [info ] [Thread-1 (]: 9 of 13 START sql table model staging_marts.dim_localizacao .................... [RUN]
[0m02:12:26.063785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_escola, now model.transformacao_matricula.dim_localizacao)
[0m02:12:26.064544 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_localizacao
[0m02:12:26.068747 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_localizacao"
[0m02:12:26.070263 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_localizacao
[0m02:12:26.081553 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_localizacao"
[0m02:12:26.082687 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m02:12:26.083408 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: BEGIN
[0m02:12:26.084063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:12:26.099512 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m02:12:26.100618 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m02:12:26.101340 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."dim_localizacao__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
    ),
staged_data AS (
    SELECT
        rpa,
        endereco_bairro
    FROM source
)
SELECT * FROM staged_data;
  );
  
[0m02:12:26.102588 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 23: SELECT * FROM staged_data;
                                  ^

[0m02:12:26.103440 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: ROLLBACK
[0m02:12:26.105112 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: Close
[0m02:12:26.112126 [debug] [Thread-1 (]: Database Error in model dim_localizacao (transformacao_aprovados/models/marts/dim_localizacao.sql)
  syntax error at or near ";"
  LINE 23: SELECT * FROM staged_data;
                                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_localizacao.sql
[0m02:12:26.113295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c156594-ee75-4de2-9161-4924a00809b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6549303770>]}
[0m02:12:26.114320 [error] [Thread-1 (]: 9 of 13 ERROR creating sql table model staging_marts.dim_localizacao ........... [[31mERROR[0m in 0.05s]
[0m02:12:26.115381 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_localizacao
[0m02:12:26.116034 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_situacao
[0m02:12:26.116762 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.dim_localizacao' to be skipped because of status 'error'.  Reason: Database Error in model dim_localizacao (transformacao_aprovados/models/marts/dim_localizacao.sql)
  syntax error at or near ";"
  LINE 23: SELECT * FROM staged_data;
                                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_localizacao.sql.
[0m02:12:26.117520 [info ] [Thread-1 (]: 10 of 13 START sql table model staging_marts.dim_situacao ...................... [RUN]
[0m02:12:26.118905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_localizacao, now model.transformacao_matricula.dim_situacao)
[0m02:12:26.119883 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_situacao
[0m02:12:26.124758 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_situacao"
[0m02:12:26.126221 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_situacao
[0m02:12:26.132116 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_situacao"
[0m02:12:26.133188 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m02:12:26.133830 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: BEGIN
[0m02:12:26.134450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:12:26.150307 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m02:12:26.151631 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m02:12:26.152860 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."dim_situacao__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
    ),
staged_data AS (
    SELECT DISTINCT
        situacao_nome,
        CASE 
            WHEN situacao_nome = 'Aprovado' THEN 1
            ELSE 0
        END AS eh_aprovado,
        CASE 
            WHEN situacao_nome = 'Reprovado' THEN 1
            ELSE 0
        END AS eh_reprovado
    FROM source
)
SELECT * FROM staged_data;
  );
  
[0m02:12:26.154761 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 30: SELECT * FROM staged_data;
                                  ^

[0m02:12:26.155921 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: ROLLBACK
[0m02:12:26.157421 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: Close
[0m02:12:26.164151 [debug] [Thread-1 (]: Database Error in model dim_situacao (transformacao_aprovados/models/marts/dim_situacao.sql)
  syntax error at or near ";"
  LINE 30: SELECT * FROM staged_data;
                                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_situacao.sql
[0m02:12:26.165361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c156594-ee75-4de2-9161-4924a00809b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a654acbc0e0>]}
[0m02:12:26.166350 [error] [Thread-1 (]: 10 of 13 ERROR creating sql table model staging_marts.dim_situacao ............. [[31mERROR[0m in 0.05s]
[0m02:12:26.167125 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_situacao
[0m02:12:26.167667 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_tempo
[0m02:12:26.168476 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.dim_situacao' to be skipped because of status 'error'.  Reason: Database Error in model dim_situacao (transformacao_aprovados/models/marts/dim_situacao.sql)
  syntax error at or near ";"
  LINE 30: SELECT * FROM staged_data;
                                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_situacao.sql.
[0m02:12:26.169529 [info ] [Thread-1 (]: 11 of 13 START sql table model staging_marts.dim_tempo ......................... [RUN]
[0m02:12:26.171223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_situacao, now model.transformacao_matricula.dim_tempo)
[0m02:12:26.175459 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_tempo
[0m02:12:26.182549 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_tempo"
[0m02:12:26.183644 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_tempo
[0m02:12:26.189577 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_tempo"
[0m02:12:26.190751 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m02:12:26.191539 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: BEGIN
[0m02:12:26.192185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:12:26.206219 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m02:12:26.207275 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m02:12:26.207928 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."dim_tempo__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
    ),
staged_data AS (
    SELECT
        ano,
    FROM source
)
SELECT * FROM staged_data;
  );
  
[0m02:12:26.212762 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 20:     FROM source
             ^

[0m02:12:26.213624 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: ROLLBACK
[0m02:12:26.214923 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: Close
[0m02:12:26.223039 [debug] [Thread-1 (]: Database Error in model dim_tempo (transformacao_aprovados/models/marts/dim_tempo.sql)
  syntax error at or near "FROM"
  LINE 20:     FROM source
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_tempo.sql
[0m02:12:26.224056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c156594-ee75-4de2-9161-4924a00809b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6549381fa0>]}
[0m02:12:26.225421 [error] [Thread-1 (]: 11 of 13 ERROR creating sql table model staging_marts.dim_tempo ................ [[31mERROR[0m in 0.05s]
[0m02:12:26.226525 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_tempo
[0m02:12:26.227267 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_turma
[0m02:12:26.228100 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.dim_tempo' to be skipped because of status 'error'.  Reason: Database Error in model dim_tempo (transformacao_aprovados/models/marts/dim_tempo.sql)
  syntax error at or near "FROM"
  LINE 20:     FROM source
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_tempo.sql.
[0m02:12:26.228950 [info ] [Thread-1 (]: 12 of 13 START sql table model staging_marts.dim_turma ......................... [RUN]
[0m02:12:26.233707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_tempo, now model.transformacao_matricula.dim_turma)
[0m02:12:26.234479 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_turma
[0m02:12:26.243570 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_turma"
[0m02:12:26.244681 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_turma
[0m02:12:26.249697 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_turma"
[0m02:12:26.250789 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m02:12:26.251478 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: BEGIN
[0m02:12:26.252248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:12:26.265451 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m02:12:26.266318 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m02:12:26.267020 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."dim_turma__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
    ),
staged_data AS (
    SELECT
        turma,
        serie,
        turno,
        mod_ens_codigo,
        modalidade_ens
    FROM source
)
SELECT * FROM staged_data;
  );
  
[0m02:12:26.268492 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 26: SELECT * FROM staged_data;
                                  ^

[0m02:12:26.269370 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: ROLLBACK
[0m02:12:26.271040 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: Close
[0m02:12:26.279745 [debug] [Thread-1 (]: Database Error in model dim_turma (transformacao_aprovados/models/marts/dim_turma.sql)
  syntax error at or near ";"
  LINE 26: SELECT * FROM staged_data;
                                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_turma.sql
[0m02:12:26.281161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c156594-ee75-4de2-9161-4924a00809b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a654938df10>]}
[0m02:12:26.282299 [error] [Thread-1 (]: 12 of 13 ERROR creating sql table model staging_marts.dim_turma ................ [[31mERROR[0m in 0.05s]
[0m02:12:26.283754 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_turma
[0m02:12:26.285073 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.dim_turma' to be skipped because of status 'error'.  Reason: Database Error in model dim_turma (transformacao_aprovados/models/marts/dim_turma.sql)
  syntax error at or near ";"
  LINE 26: SELECT * FROM staged_data;
                                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_turma.sql.
[0m02:12:26.287608 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.fato_matricula
[0m02:12:26.289544 [info ] [Thread-1 (]: 13 of 13 SKIP relation staging_marts.fato_matricula ............................ [[33mSKIP[0m]
[0m02:12:26.291037 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.fato_matricula
[0m02:12:26.293438 [debug] [MainThread]: Using postgres connection "master"
[0m02:12:26.294413 [debug] [MainThread]: On master: BEGIN
[0m02:12:26.295452 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:12:26.314807 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m02:12:26.315509 [debug] [MainThread]: On master: COMMIT
[0m02:12:26.316113 [debug] [MainThread]: Using postgres connection "master"
[0m02:12:26.316699 [debug] [MainThread]: On master: COMMIT
[0m02:12:26.317631 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:12:26.318306 [debug] [MainThread]: On master: Close
[0m02:12:26.319146 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:12:26.319693 [debug] [MainThread]: Connection 'model.transformacao_matricula.dim_turma' was properly closed.
[0m02:12:26.320414 [info ] [MainThread]: 
[0m02:12:26.321624 [info ] [MainThread]: Finished running 9 table models, 4 view models in 0 hours 0 minutes and 2.49 seconds (2.49s).
[0m02:12:26.325464 [debug] [MainThread]: Command end result
[0m02:12:26.360904 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m02:12:26.364641 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m02:12:26.372996 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m02:12:26.376664 [info ] [MainThread]: 
[0m02:12:26.378946 [info ] [MainThread]: [31mCompleted with 10 errors, 0 partial successes, and 0 warnings:[0m
[0m02:12:26.380718 [info ] [MainThread]: 
[0m02:12:26.381982 [error] [MainThread]: [31mFailure in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)[0m
[0m02:12:26.383417 [error] [MainThread]:   Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  relation "fato_matricula" does not exist
  LINE 14:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m02:12:26.384212 [info ] [MainThread]: 
[0m02:12:26.385087 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m02:12:26.386072 [info ] [MainThread]: 
[0m02:12:26.387209 [error] [MainThread]: [31mFailure in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)[0m
[0m02:12:26.388130 [error] [MainThread]:   Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m02:12:26.388887 [info ] [MainThread]: 
[0m02:12:26.389756 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m02:12:26.390635 [info ] [MainThread]: 
[0m02:12:26.391680 [error] [MainThread]: [31mFailure in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)[0m
[0m02:12:26.392630 [error] [MainThread]:   Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m02:12:26.393418 [info ] [MainThread]: 
[0m02:12:26.394317 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m02:12:26.395056 [info ] [MainThread]: 
[0m02:12:26.395974 [error] [MainThread]: [31mFailure in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)[0m
[0m02:12:26.397261 [error] [MainThread]:   Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  relation "fato_matricula" does not exist
  LINE 19:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m02:12:26.398248 [info ] [MainThread]: 
[0m02:12:26.399280 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m02:12:26.400245 [info ] [MainThread]: 
[0m02:12:26.401418 [error] [MainThread]: [31mFailure in model dim_aluno (transformacao_aprovados/models/marts/dim_aluno.sql)[0m
[0m02:12:26.402556 [error] [MainThread]:   Database Error in model dim_aluno (transformacao_aprovados/models/marts/dim_aluno.sql)
  syntax error at or near ";"
  LINE 32: SELECT * FROM staged_data;
                                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_aluno.sql
[0m02:12:26.403491 [info ] [MainThread]: 
[0m02:12:26.404389 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/dim_aluno.sql
[0m02:12:26.405281 [info ] [MainThread]: 
[0m02:12:26.406193 [error] [MainThread]: [31mFailure in model dim_escola (transformacao_aprovados/models/marts/dim_escola.sql)[0m
[0m02:12:26.411572 [error] [MainThread]:   Database Error in model dim_escola (transformacao_aprovados/models/marts/dim_escola.sql)
  syntax error at or near ";"
  LINE 28: SELECT * FROM escolas;
                                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_escola.sql
[0m02:12:26.412937 [info ] [MainThread]: 
[0m02:12:26.413974 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/dim_escola.sql
[0m02:12:26.414919 [info ] [MainThread]: 
[0m02:12:26.415764 [error] [MainThread]: [31mFailure in model dim_localizacao (transformacao_aprovados/models/marts/dim_localizacao.sql)[0m
[0m02:12:26.416533 [error] [MainThread]:   Database Error in model dim_localizacao (transformacao_aprovados/models/marts/dim_localizacao.sql)
  syntax error at or near ";"
  LINE 23: SELECT * FROM staged_data;
                                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_localizacao.sql
[0m02:12:26.417268 [info ] [MainThread]: 
[0m02:12:26.418550 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/dim_localizacao.sql
[0m02:12:26.419960 [info ] [MainThread]: 
[0m02:12:26.420963 [error] [MainThread]: [31mFailure in model dim_situacao (transformacao_aprovados/models/marts/dim_situacao.sql)[0m
[0m02:12:26.421950 [error] [MainThread]:   Database Error in model dim_situacao (transformacao_aprovados/models/marts/dim_situacao.sql)
  syntax error at or near ";"
  LINE 30: SELECT * FROM staged_data;
                                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_situacao.sql
[0m02:12:26.422871 [info ] [MainThread]: 
[0m02:12:26.423958 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/dim_situacao.sql
[0m02:12:26.424891 [info ] [MainThread]: 
[0m02:12:26.425915 [error] [MainThread]: [31mFailure in model dim_tempo (transformacao_aprovados/models/marts/dim_tempo.sql)[0m
[0m02:12:26.426981 [error] [MainThread]:   Database Error in model dim_tempo (transformacao_aprovados/models/marts/dim_tempo.sql)
  syntax error at or near "FROM"
  LINE 20:     FROM source
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_tempo.sql
[0m02:12:26.428029 [info ] [MainThread]: 
[0m02:12:26.429192 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/dim_tempo.sql
[0m02:12:26.430147 [info ] [MainThread]: 
[0m02:12:26.431144 [error] [MainThread]: [31mFailure in model dim_turma (transformacao_aprovados/models/marts/dim_turma.sql)[0m
[0m02:12:26.432148 [error] [MainThread]:   Database Error in model dim_turma (transformacao_aprovados/models/marts/dim_turma.sql)
  syntax error at or near ";"
  LINE 26: SELECT * FROM staged_data;
                                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_turma.sql
[0m02:12:26.432967 [info ] [MainThread]: 
[0m02:12:26.433982 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/dim_turma.sql
[0m02:12:26.435007 [info ] [MainThread]: 
[0m02:12:26.435740 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=10 SKIP=1 NO-OP=0 TOTAL=13
[0m02:12:26.437071 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.9743161, "process_in_blocks": "40", "process_kernel_time": 0.426406, "process_mem_max_rss": "129560", "process_out_blocks": "3352", "process_user_time": 3.15461}
[0m02:12:26.437775 [debug] [MainThread]: Command `dbt run` failed at 02:12:26.437652 after 3.98 seconds
[0m02:12:26.439048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a65542e56d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6553f6eb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a65559de780>]}
[0m02:12:26.440701 [debug] [MainThread]: Flushing usage events
[0m02:12:27.117876 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:13:37.053803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76792524ef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76792572f2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76792572cf20>]}


============================== 02:13:37.063232 | 6c3308cd-327a-4f74-8e1f-e7a268d03d24 ==============================
[0m02:13:37.063232 [info ] [MainThread]: Running with dbt=1.10.15
[0m02:13:37.064183 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'version_check': 'True', 'target_path': 'None', 'introspect': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'use_colors': 'True', 'empty': 'False', 'write_json': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/murilo/.dbt', 'no_print': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'fail_fast': 'False', 'partial_parse': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'indirect_selection': 'eager'}
[0m02:13:37.289600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c3308cd-327a-4f74-8e1f-e7a268d03d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767924dcb560>]}
[0m02:13:37.372472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c3308cd-327a-4f74-8e1f-e7a268d03d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76792524ef00>]}
[0m02:13:37.373736 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:13:37.514503 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m02:13:37.653603 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 6 files changed.
[0m02:13:37.654293 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/dim_aluno.sql
[0m02:13:37.654732 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/fato_matricula.sql
[0m02:13:37.655170 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/dim_localizacao.sql
[0m02:13:37.655578 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/dim_situacao.sql
[0m02:13:37.656001 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/dim_tempo.sql
[0m02:13:37.656403 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/dim_turma.sql
[0m02:13:37.953001 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.transformacao_matricula.facts
- models.transformacao_matricula.intermediate
- models.transformacao_matricula.dimensions
[0m02:13:37.972272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c3308cd-327a-4f74-8e1f-e7a268d03d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767922f0e150>]}
[0m02:13:38.086940 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m02:13:38.089738 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m02:13:38.107051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c3308cd-327a-4f74-8e1f-e7a268d03d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76792375e3f0>]}
[0m02:13:38.107712 [info ] [MainThread]: Found 13 models, 2 data tests, 1 source, 459 macros
[0m02:13:38.108481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c3308cd-327a-4f74-8e1f-e7a268d03d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76792431e540>]}
[0m02:13:38.110952 [info ] [MainThread]: 
[0m02:13:38.111457 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m02:13:38.111832 [info ] [MainThread]: 
[0m02:13:38.112417 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:13:38.116927 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula'
[0m02:13:38.162540 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m02:13:38.163134 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m02:13:38.163542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:13:38.177685 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.014 seconds
[0m02:13:38.179084 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m02:13:38.181335 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m02:13:38.182062 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m02:13:38.182482 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:13:38.191302 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.009 seconds
[0m02:13:38.192951 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m02:13:38.199769 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula, now list_transformacao_matricula_staging_marts)
[0m02:13:38.207310 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m02:13:38.207868 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: BEGIN
[0m02:13:38.208252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:13:38.217479 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m02:13:38.218221 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m02:13:38.218551 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_marts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m02:13:38.221634 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m02:13:38.223023 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: ROLLBACK
[0m02:13:38.223672 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: Close
[0m02:13:38.224295 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_marts, now list_transformacao_matricula_staging_staging)
[0m02:13:38.229702 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m02:13:38.231204 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: BEGIN
[0m02:13:38.231699 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:13:38.239797 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m02:13:38.240429 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m02:13:38.240769 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_staging"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m02:13:38.244418 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m02:13:38.245999 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: ROLLBACK
[0m02:13:38.246903 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: Close
[0m02:13:38.251186 [debug] [MainThread]: Using postgres connection "master"
[0m02:13:38.251632 [debug] [MainThread]: On master: BEGIN
[0m02:13:38.251963 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:13:38.261355 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m02:13:38.261803 [debug] [MainThread]: Using postgres connection "master"
[0m02:13:38.262179 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:13:38.265540 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m02:13:38.266980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c3308cd-327a-4f74-8e1f-e7a268d03d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7679243d3aa0>]}
[0m02:13:38.267528 [debug] [MainThread]: On master: ROLLBACK
[0m02:13:38.268317 [debug] [MainThread]: Using postgres connection "master"
[0m02:13:38.268703 [debug] [MainThread]: On master: BEGIN
[0m02:13:38.269520 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m02:13:38.269931 [debug] [MainThread]: On master: COMMIT
[0m02:13:38.270265 [debug] [MainThread]: Using postgres connection "master"
[0m02:13:38.270587 [debug] [MainThread]: On master: COMMIT
[0m02:13:38.271216 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:13:38.271602 [debug] [MainThread]: On master: Close
[0m02:13:38.274240 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.staging_situacao_alunos
[0m02:13:38.275288 [info ] [Thread-1 (]: 1 of 13 START sql table model staging_staging.staging_situacao_alunos .......... [RUN]
[0m02:13:38.275796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_staging, now model.transformacao_matricula.staging_situacao_alunos)
[0m02:13:38.276235 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.staging_situacao_alunos
[0m02:13:38.282799 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.staging_situacao_alunos"
[0m02:13:38.283588 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.staging_situacao_alunos
[0m02:13:38.326906 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.staging_situacao_alunos"
[0m02:13:38.328053 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m02:13:38.328664 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: BEGIN
[0m02:13:38.329186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:13:38.338125 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m02:13:38.339070 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m02:13:38.339659 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */

  
    

  create  table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp"
  
  
    as
  
  (
    WITH source AS (
    SELECT * FROM "transformacao_matricula"."staging"."staging_alunos_raw"
),

cleaning_renaming AS (
    SELECT
        ano,
        codigo_escola,
        matricula,
        escola AS nome_escola,
        endereco_logradouro AS endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa,
        modalidade_ensino_codigo AS mod_ens_codigo,
        -- Transformação da SÉRIE
        CASE
            -- Ensino Fundamental (1º ao 9º)
            WHEN serie LIKE '%1 ANO%' OR serie LIKE '%1º ANO%' THEN '1º ANO'
            WHEN serie LIKE '%2 ANO%' OR serie LIKE '%2º ANO%' THEN '2º ANO'
            WHEN serie LIKE '%3 ANO%' OR serie LIKE '%3º ANO%' THEN '3º ANO'
            WHEN serie LIKE '%4 ANO%' OR serie LIKE '%4º ANO%' THEN '4º ANO'
            WHEN serie LIKE '%5 ANO%' OR serie LIKE '%5º ANO%' THEN '5º ANO'
            WHEN serie LIKE '%6 ANO%' OR serie LIKE '%6º ANO%' THEN '6º ANO'
            WHEN serie LIKE '%7 ANO%' OR serie LIKE '%7º ANO%' THEN '7º ANO'
            WHEN serie LIKE '%8 ANO%' OR serie LIKE '%8º ANO%' THEN '8º ANO'
            WHEN serie LIKE '%9 ANO%' OR serie LIKE '%9º ANO%' THEN '9º ANO'
            -- Educação Infantil (Berçário e Grupos)
            WHEN serie LIKE '%BER%' THEN 'BERÇARIO'
            WHEN serie LIKE '%GRUPO I%' OR serie LIKE '%GRUPO 1%' THEN 'GRUPO I'
            WHEN serie LIKE '%GRUPO II%' THEN 'GRUPO II'
            WHEN serie LIKE '%GRUPO III%' THEN 'GRUPO III'
            WHEN serie LIKE '%GRUPO IV%' THEN 'GRUPO IV'
            WHEN serie LIKE '%GRUPO V%' THEN 'GRUPO V'
            -- EJA (Módulos 1 ao 5) 
            WHEN serie LIKE '%1%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 1'
            WHEN serie LIKE '%2%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 2'
            WHEN serie LIKE '%3%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 3'
            WHEN serie LIKE '%4%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 4'
            WHEN serie LIKE '%5%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 5'
            WHEN serie LIKE '%TRAVESSIA%' THEN 'TRAVESSIA RECIFE'
            WHEN serie LIKE '%CORRECAO%1%' THEN 'CORREÇÃO DE FLUXO 1 - ALFABETIZACAO'
            WHEN serie LIKE '%CORRECAO%2%' THEN 'CORREÇÃO DE FLUXO 2 - ACELERACAO'
            ELSE 'OUTROS'
        END AS serie,
        turma,
        turno,
        idade,
        -- transformação do SEXO
        CASE
            WHEN sexo = '1' THEN 'Masculino'
            WHEN sexo = '2' THEN 'Feminino'
            WHEN sexo = '3' THEN 'Outros'
            ELSE 'Não informado'
        END AS sexo,
        -- transformação de situacao
        CASE 
            WHEN situacao_nome LIKE '%APROV%' THEN 'Aprovado'
            WHEN situacao_nome LIKE '%RET%' OR situacao_nome LIKE '%REPRO%' THEN 'Reprovado'
            WHEN situacao_nome LIKE '%TR%' OR situacao_nome LIKE '%REMAN%' THEN 'Transferido'
            WHEN situacao_nome LIKE '%DESIST%' THEN 'Desistente'
            ELSE 'Outros'
        END AS sit_nome,
        -- Transformação da MODALIDADE
        CASE
            WHEN modalidade_ensino LIKE '%EDUCACAO INFANTIL%' THEN 'EDUCAÇÃO INFANTIL'
            WHEN modalidade_ensino LIKE '%ENSINO FUNDAMENTAL%' THEN 'ENSINO FUNDAMENTAL'
            WHEN modalidade_ensino LIKE '%EDUCACAO JOVENS E ADULTOS%' THEN 'EJA'
            WHEN modalidade_ensino LIKE '%CORRE%' THEN 'CORREÇÃO DE FLUXO'
            ELSE 'OUTROS'
        END AS modalidade_ens
    FROM source
)

SELECT * FROM cleaning_renaming
  );
  
[0m02:13:39.120101 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 0.780 seconds
[0m02:13:39.129079 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m02:13:39.129573 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
alter table "transformacao_matricula"."staging_staging"."staging_situacao_alunos" rename to "staging_situacao_alunos__dbt_backup"
[0m02:13:39.130730 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:13:39.133606 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m02:13:39.134176 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
alter table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp" rename to "staging_situacao_alunos"
[0m02:13:39.135076 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:13:39.148384 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: COMMIT
[0m02:13:39.148903 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m02:13:39.149272 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: COMMIT
[0m02:13:39.158185 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m02:13:39.165627 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_backup"
[0m02:13:39.228953 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m02:13:39.229458 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
drop table if exists "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_backup" cascade
[0m02:13:39.240538 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.011 seconds
[0m02:13:39.243352 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: Close
[0m02:13:39.245007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c3308cd-327a-4f74-8e1f-e7a268d03d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767922f5d130>]}
[0m02:13:39.245706 [info ] [Thread-1 (]: 1 of 13 OK created sql table model staging_staging.staging_situacao_alunos ..... [[32mSELECT 319146[0m in 0.97s]
[0m02:13:39.246328 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.staging_situacao_alunos
[0m02:13:39.246764 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_count_aluno_idade
[0m02:13:39.247471 [info ] [Thread-1 (]: 2 of 13 START sql view model staging_marts.view_count_aluno_idade .............. [RUN]
[0m02:13:39.248178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.staging_situacao_alunos, now model.transformacao_matricula.view_count_aluno_idade)
[0m02:13:39.248722 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_count_aluno_idade
[0m02:13:39.251394 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_count_aluno_idade"
[0m02:13:39.252174 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_count_aluno_idade
[0m02:13:39.268540 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_count_aluno_idade"
[0m02:13:39.269530 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m02:13:39.270125 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: BEGIN
[0m02:13:39.270640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:13:39.281189 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m02:13:39.282029 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m02:13:39.282692 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_count_aluno_idade"} */

  create view "transformacao_matricula"."staging_marts"."view_count_aluno_idade__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dl.desc_rpa,
    da.faixa_etaria,
    COUNT(fm.matricula) AS total_alunos
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
ORDER BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
  );
[0m02:13:39.283983 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 14:     fato_matricula fm
             ^

[0m02:13:39.284615 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: ROLLBACK
[0m02:13:39.285579 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: Close
[0m02:13:39.292614 [debug] [Thread-1 (]: Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  relation "fato_matricula" does not exist
  LINE 14:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m02:13:39.293463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c3308cd-327a-4f74-8e1f-e7a268d03d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767922faeb10>]}
[0m02:13:39.294156 [error] [Thread-1 (]: 2 of 13 ERROR creating sql view model staging_marts.view_count_aluno_idade ..... [[31mERROR[0m in 0.05s]
[0m02:13:39.294736 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_count_aluno_idade
[0m02:13:39.295176 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m02:13:39.295778 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_count_aluno_idade' to be skipped because of status 'error'.  Reason: Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  relation "fato_matricula" does not exist
  LINE 14:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql.
[0m02:13:39.296428 [info ] [Thread-1 (]: 3 of 13 START sql view model staging_marts.view_frequencia_situacao_escola ..... [RUN]
[0m02:13:39.298090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_count_aluno_idade, now model.transformacao_matricula.view_frequencia_situacao_escola)
[0m02:13:39.298621 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_frequencia_situacao_escola
[0m02:13:39.301658 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m02:13:39.302731 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_frequencia_situacao_escola
[0m02:13:39.306590 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m02:13:39.307316 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m02:13:39.307699 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: BEGIN
[0m02:13:39.308096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:13:39.318194 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m02:13:39.318748 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m02:13:39.319263 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_frequencia_situacao_escola"} */

  create view "transformacao_matricula"."staging_marts"."view_frequencia_situacao_escola__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    de.nome_escola,
    de.codigo_escola,
    ds.situacao_nome,
    COUNT(fm.matricula) AS contagem_situacao
FROM
    fato_matricula fm
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, de.nome_escola, de.codigo_escola, ds.situacao_nome
ORDER BY
    dtemp.ano, de.nome_escola, contagem_situacao DESC
  );
[0m02:13:39.320480 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 15:     fato_matricula fm
             ^

[0m02:13:39.321090 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: ROLLBACK
[0m02:13:39.322191 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: Close
[0m02:13:39.325171 [debug] [Thread-1 (]: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m02:13:39.326482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c3308cd-327a-4f74-8e1f-e7a268d03d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7679203bd9a0>]}
[0m02:13:39.327383 [error] [Thread-1 (]: 3 of 13 ERROR creating sql view model staging_marts.view_frequencia_situacao_escola  [[31mERROR[0m in 0.03s]
[0m02:13:39.328222 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m02:13:39.329003 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_matricula_detalhada
[0m02:13:39.329715 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_frequencia_situacao_escola' to be skipped because of status 'error'.  Reason: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql.
[0m02:13:39.330578 [info ] [Thread-1 (]: 4 of 13 START sql view model staging_marts.view_matricula_detalhada ............ [RUN]
[0m02:13:39.333798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_frequencia_situacao_escola, now model.transformacao_matricula.view_matricula_detalhada)
[0m02:13:39.337594 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_matricula_detalhada
[0m02:13:39.344803 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_matricula_detalhada"
[0m02:13:39.346075 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_matricula_detalhada
[0m02:13:39.351571 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_matricula_detalhada"
[0m02:13:39.352789 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m02:13:39.353429 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: BEGIN
[0m02:13:39.353799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:13:39.362567 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m02:13:39.363454 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m02:13:39.364562 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_matricula_detalhada"} */

  create view "transformacao_matricula"."staging_marts"."view_matricula_detalhada__dbt_tmp"
    
    
  as (
    
SELECT
    fm.matricula,
    da.sexo,
    da.idade,
    da.faixa_etaria,
    de.nome_escola,
    de.codigo_escola,
    dt.turma,
    dt.turno,
    dt.serie,
    dt.modalidade_ensino,
    ds.situacao_nome,
    ds.categoria AS categoria_situacao,
    ds.eh_aprovado,
    ds.eh_reprovado,
    dl.desc_rpa,
    dl.endereco_bairro AS bairro_localizacao,
    dtemp.ano AS ano_registro
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
  );
[0m02:13:39.370833 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 27:     fato_matricula fm
             ^

[0m02:13:39.372367 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: ROLLBACK
[0m02:13:39.373912 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: Close
[0m02:13:39.376183 [debug] [Thread-1 (]: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m02:13:39.376959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c3308cd-327a-4f74-8e1f-e7a268d03d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7679233860f0>]}
[0m02:13:39.378223 [error] [Thread-1 (]: 4 of 13 ERROR creating sql view model staging_marts.view_matricula_detalhada ... [[31mERROR[0m in 0.04s]
[0m02:13:39.379323 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_matricula_detalhada
[0m02:13:39.379883 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_taxa_aprovados
[0m02:13:39.380448 [info ] [Thread-1 (]: 5 of 13 START sql view model staging_marts.view_taxa_aprovados ................. [RUN]
[0m02:13:39.381283 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_matricula_detalhada' to be skipped because of status 'error'.  Reason: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql.
[0m02:13:39.382559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_matricula_detalhada, now model.transformacao_matricula.view_taxa_aprovados)
[0m02:13:39.383521 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_taxa_aprovados
[0m02:13:39.387127 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_taxa_aprovados"
[0m02:13:39.388370 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_taxa_aprovados
[0m02:13:39.393966 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_taxa_aprovados"
[0m02:13:39.395160 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m02:13:39.395889 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: BEGIN
[0m02:13:39.396883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:13:39.413393 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m02:13:39.414192 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m02:13:39.414724 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_taxa_aprovados"} */

  create view "transformacao_matricula"."staging_marts"."view_taxa_aprovados__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dt.modalidade_ensino,
    COUNT(fm.matricula) AS total_matriculas,
    SUM(ds.eh_aprovado) AS total_aprovados,
    SUM(ds.eh_reprovado) AS total_reprovados,
    -- Calcula a taxa de aprovação (como porcentagem)
    CAST(SUM(ds.eh_aprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_aprovacao_percentual,
    -- Calcula a taxa de reprovação (como porcentagem)
    CAST(SUM(ds.eh_reprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_reprovacao_percentual
FROM
    fato_matricula fm
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dt.modalidade_ensino
ORDER BY
    dtemp.ano, dt.modalidade_ensino
  );
[0m02:13:39.416112 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 19:     fato_matricula fm
             ^

[0m02:13:39.416761 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: ROLLBACK
[0m02:13:39.417748 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: Close
[0m02:13:39.421171 [debug] [Thread-1 (]: Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  relation "fato_matricula" does not exist
  LINE 19:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m02:13:39.422143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c3308cd-327a-4f74-8e1f-e7a268d03d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7679204c96d0>]}
[0m02:13:39.423252 [error] [Thread-1 (]: 5 of 13 ERROR creating sql view model staging_marts.view_taxa_aprovados ........ [[31mERROR[0m in 0.04s]
[0m02:13:39.424060 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_taxa_aprovados
[0m02:13:39.424591 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_aluno
[0m02:13:39.425183 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_taxa_aprovados' to be skipped because of status 'error'.  Reason: Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  relation "fato_matricula" does not exist
  LINE 19:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql.
[0m02:13:39.425925 [info ] [Thread-1 (]: 6 of 13 START sql table model staging_marts.dim_aluno .......................... [RUN]
[0m02:13:39.426824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_taxa_aprovados, now model.transformacao_matricula.dim_aluno)
[0m02:13:39.427335 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_aluno
[0m02:13:39.433777 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_aluno"
[0m02:13:39.434560 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_aluno
[0m02:13:39.437965 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_aluno"
[0m02:13:39.438741 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m02:13:39.439209 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: BEGIN
[0m02:13:39.439604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:13:39.451123 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m02:13:39.452167 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m02:13:39.453056 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_aluno"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."dim_aluno__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_staging"."staging_situacao_alunos" 
    ),
staged_data AS (
    SELECT
        sexo,
        idade,
        CASE
            WHEN idade <= 3 THEN '0-3 Anos (Educação Infantil)'
            WHEN idade <= 5 THEN '4-5 Anos (Pré-escola)'
            WHEN idade <= 10 THEN '6-10 Anos (Fundamental I)'
            WHEN idade <= 14 THEN '11-14 Anos (Fundamental II)'
            WHEN idade >= 15 THEN '15+ Anos (EJA e Outros)'
            ELSE 'Não Informado'
        END AS faixa_etaria
    FROM source
) 

SELECT * FROM staged_data
  );
  
[0m02:13:39.455175 [debug] [Thread-1 (]: Postgres adapter: Postgres error: operator does not exist: text <= integer
LINE 22:             WHEN idade <= 3 THEN '0-3 Anos (Educação Infanti...
                                ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m02:13:39.455915 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: ROLLBACK
[0m02:13:39.457077 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: Close
[0m02:13:39.460531 [debug] [Thread-1 (]: Database Error in model dim_aluno (transformacao_aprovados/models/marts/dim_aluno.sql)
  operator does not exist: text <= integer
  LINE 22:             WHEN idade <= 3 THEN '0-3 Anos (Educação Infanti...
                                  ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_aluno.sql
[0m02:13:39.461711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c3308cd-327a-4f74-8e1f-e7a268d03d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76792031fbf0>]}
[0m02:13:39.463097 [error] [Thread-1 (]: 6 of 13 ERROR creating sql table model staging_marts.dim_aluno ................. [[31mERROR[0m in 0.03s]
[0m02:13:39.464698 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_aluno
[0m02:13:39.469822 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.transform_data
[0m02:13:39.470992 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.dim_aluno' to be skipped because of status 'error'.  Reason: Database Error in model dim_aluno (transformacao_aprovados/models/marts/dim_aluno.sql)
  operator does not exist: text <= integer
  LINE 22:             WHEN idade <= 3 THEN '0-3 Anos (Educação Infanti...
                                  ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_aluno.sql.
[0m02:13:39.472194 [info ] [Thread-1 (]: 7 of 13 START sql table model staging_marts.transform_data ..................... [RUN]
[0m02:13:39.473703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_aluno, now model.transformacao_matricula.transform_data)
[0m02:13:39.474617 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.transform_data
[0m02:13:39.479727 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.transform_data"
[0m02:13:39.481151 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.transform_data
[0m02:13:39.486489 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.transform_data"
[0m02:13:39.487586 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m02:13:39.488265 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: BEGIN
[0m02:13:39.488813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:13:39.500317 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m02:13:39.501234 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m02:13:39.501921 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."transform_data__dbt_tmp"
  
  
    as
  
  (
    

with staged_data AS (
    SELECT * FROM "transformacao_matricula"."staging_staging"."staging_situacao_alunos"
),

transformed_data AS (
    SELECT
        CAST(ano AS INTEGER) AS ano,
        CAST(codigo_escola AS INTEGER) AS codigo_escola,
        CAST(matricula AS INTEGER) AS matricula,
        nome_escola,
        endereco_logra,
        endereco_bairro,
        endereco_numero,
        CAST(rpa AS INTEGER) AS rpa,
        CAST(mod_ens_codigo AS INTEGER) AS mod_ens_codigo,
        serie,
        turma,
        turno,
        CAST(idade AS INTEGER) AS idade,
        sexo,
        sit_nome AS situacao_nome,
        modalidade_ens,
        CASE
            WHEN CAST(idade AS INTEGER) <= 3 THEN '0-3 Anos (Educação Infantil)'
            WHEN CAST(idade AS INTEGER) <= 5 THEN '4-5 Anos (Pré-escola)'
            WHEN CAST(idade AS INTEGER) <= 10 THEN '6-10 Anos (Fundamental I)'
            WHEN CAST(idade AS INTEGER) <= 14 THEN '11-14 Anos (Fundamental II)'
            WHEN CAST(idade AS INTEGER) >= 15 THEN '15+ Anos (EJA e Outros)'
            ELSE 'Não Informado'
        END AS faixa_etaria
    FROM staged_data
)

SELECT * FROM transformed_data
  );
  
[0m02:13:40.208908 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 0.706 seconds
[0m02:13:40.213628 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m02:13:40.214225 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
alter table "transformacao_matricula"."staging_marts"."transform_data" rename to "transform_data__dbt_backup"
[0m02:13:40.215566 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:13:40.219664 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m02:13:40.220938 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
alter table "transformacao_matricula"."staging_marts"."transform_data__dbt_tmp" rename to "transform_data"
[0m02:13:40.222493 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:13:40.224357 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: COMMIT
[0m02:13:40.224901 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m02:13:40.225266 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: COMMIT
[0m02:13:40.276966 [debug] [Thread-1 (]: SQL status: COMMIT in 0.051 seconds
[0m02:13:40.279452 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."transform_data__dbt_backup"
[0m02:13:40.280359 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m02:13:40.280746 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
drop table if exists "transformacao_matricula"."staging_marts"."transform_data__dbt_backup" cascade
[0m02:13:40.294730 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m02:13:40.296732 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: Close
[0m02:13:40.297413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c3308cd-327a-4f74-8e1f-e7a268d03d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767923f07cb0>]}
[0m02:13:40.298155 [info ] [Thread-1 (]: 7 of 13 OK created sql table model staging_marts.transform_data ................ [[32mSELECT 319146[0m in 0.82s]
[0m02:13:40.298780 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.transform_data
[0m02:13:40.299784 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_escola
[0m02:13:40.300362 [info ] [Thread-1 (]: 8 of 13 START sql table model staging_marts.dim_escola ......................... [RUN]
[0m02:13:40.300891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.transform_data, now model.transformacao_matricula.dim_escola)
[0m02:13:40.301329 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_escola
[0m02:13:40.303951 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_escola"
[0m02:13:40.304756 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_escola
[0m02:13:40.308147 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_escola"
[0m02:13:40.308896 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m02:13:40.309302 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: BEGIN
[0m02:13:40.309663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:13:40.319969 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m02:13:40.320693 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m02:13:40.321420 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."dim_escola__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
    ),

escolas AS (
    SELECT
        DISTINCT codigo_escola,
        nome_escola,
        endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa
    FROM source
)
SELECT * FROM escolas;
  );
  
[0m02:13:40.322666 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 28: SELECT * FROM escolas;
                              ^

[0m02:13:40.323404 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: ROLLBACK
[0m02:13:40.324584 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: Close
[0m02:13:40.328121 [debug] [Thread-1 (]: Database Error in model dim_escola (transformacao_aprovados/models/marts/dim_escola.sql)
  syntax error at or near ";"
  LINE 28: SELECT * FROM escolas;
                                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_escola.sql
[0m02:13:40.329204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c3308cd-327a-4f74-8e1f-e7a268d03d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7679203150a0>]}
[0m02:13:40.330560 [error] [Thread-1 (]: 8 of 13 ERROR creating sql table model staging_marts.dim_escola ................ [[31mERROR[0m in 0.03s]
[0m02:13:40.331687 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_escola
[0m02:13:40.332520 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_localizacao
[0m02:13:40.333318 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.dim_escola' to be skipped because of status 'error'.  Reason: Database Error in model dim_escola (transformacao_aprovados/models/marts/dim_escola.sql)
  syntax error at or near ";"
  LINE 28: SELECT * FROM escolas;
                                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_escola.sql.
[0m02:13:40.334198 [info ] [Thread-1 (]: 9 of 13 START sql table model staging_marts.dim_localizacao .................... [RUN]
[0m02:13:40.335232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_escola, now model.transformacao_matricula.dim_localizacao)
[0m02:13:40.335951 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_localizacao
[0m02:13:40.340358 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_localizacao"
[0m02:13:40.341559 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_localizacao
[0m02:13:40.349503 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_localizacao"
[0m02:13:40.350583 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m02:13:40.351430 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: BEGIN
[0m02:13:40.352258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:13:40.365412 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m02:13:40.366214 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m02:13:40.367493 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."dim_localizacao__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
    ),
staged_data AS (
    SELECT
        rpa,
        endereco_bairro
    FROM source
)
SELECT * FROM staged_data
  );
  
[0m02:13:40.651673 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 0.283 seconds
[0m02:13:40.655085 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m02:13:40.655522 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */
alter table "transformacao_matricula"."staging_marts"."dim_localizacao__dbt_tmp" rename to "dim_localizacao"
[0m02:13:40.656545 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:13:40.658134 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: COMMIT
[0m02:13:40.658623 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m02:13:40.658985 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: COMMIT
[0m02:13:40.666377 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m02:13:40.669334 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."dim_localizacao__dbt_backup"
[0m02:13:40.670225 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m02:13:40.670598 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */
drop table if exists "transformacao_matricula"."staging_marts"."dim_localizacao__dbt_backup" cascade
[0m02:13:40.671475 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m02:13:40.672750 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: Close
[0m02:13:40.673438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c3308cd-327a-4f74-8e1f-e7a268d03d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76792022aa20>]}
[0m02:13:40.674194 [info ] [Thread-1 (]: 9 of 13 OK created sql table model staging_marts.dim_localizacao ............... [[32mSELECT 319146[0m in 0.34s]
[0m02:13:40.674801 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_localizacao
[0m02:13:40.675238 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_situacao
[0m02:13:40.675800 [info ] [Thread-1 (]: 10 of 13 START sql table model staging_marts.dim_situacao ...................... [RUN]
[0m02:13:40.676351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_localizacao, now model.transformacao_matricula.dim_situacao)
[0m02:13:40.676758 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_situacao
[0m02:13:40.679357 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_situacao"
[0m02:13:40.680161 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_situacao
[0m02:13:40.683560 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_situacao"
[0m02:13:40.684390 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m02:13:40.684898 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: BEGIN
[0m02:13:40.685310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:13:40.696040 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m02:13:40.696713 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m02:13:40.697281 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."dim_situacao__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
    ),
staged_data AS (
    SELECT DISTINCT
        situacao_nome,
        CASE 
            WHEN situacao_nome = 'Aprovado' THEN 1
            ELSE 0
        END AS eh_aprovado,
        CASE 
            WHEN situacao_nome = 'Reprovado' THEN 1
            ELSE 0
        END AS eh_reprovado
    FROM source
)
SELECT * FROM staged_data
  );
  
[0m02:13:40.761638 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.064 seconds
[0m02:13:40.764598 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m02:13:40.765225 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */
alter table "transformacao_matricula"."staging_marts"."dim_situacao__dbt_tmp" rename to "dim_situacao"
[0m02:13:40.766460 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:13:40.768599 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: COMMIT
[0m02:13:40.769303 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m02:13:40.770045 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: COMMIT
[0m02:13:40.775322 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:13:40.777498 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."dim_situacao__dbt_backup"
[0m02:13:40.778400 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m02:13:40.778775 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */
drop table if exists "transformacao_matricula"."staging_marts"."dim_situacao__dbt_backup" cascade
[0m02:13:40.779680 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m02:13:40.781045 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: Close
[0m02:13:40.781749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c3308cd-327a-4f74-8e1f-e7a268d03d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7679203c4c20>]}
[0m02:13:40.782463 [info ] [Thread-1 (]: 10 of 13 OK created sql table model staging_marts.dim_situacao ................. [[32mSELECT 5[0m in 0.11s]
[0m02:13:40.783077 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_situacao
[0m02:13:40.783500 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_tempo
[0m02:13:40.784270 [info ] [Thread-1 (]: 11 of 13 START sql table model staging_marts.dim_tempo ......................... [RUN]
[0m02:13:40.784939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_situacao, now model.transformacao_matricula.dim_tempo)
[0m02:13:40.785357 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_tempo
[0m02:13:40.788070 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_tempo"
[0m02:13:40.788804 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_tempo
[0m02:13:40.792069 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_tempo"
[0m02:13:40.792806 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m02:13:40.793228 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: BEGIN
[0m02:13:40.793587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:13:40.802202 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m02:13:40.802899 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m02:13:40.803431 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."dim_tempo__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
    ),
staged_data AS (
    SELECT
        ano,
    FROM source
)
SELECT * FROM staged_data
  );
  
[0m02:13:40.804420 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 20:     FROM source
             ^

[0m02:13:40.805113 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: ROLLBACK
[0m02:13:40.806224 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: Close
[0m02:13:40.809506 [debug] [Thread-1 (]: Database Error in model dim_tempo (transformacao_aprovados/models/marts/dim_tempo.sql)
  syntax error at or near "FROM"
  LINE 20:     FROM source
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_tempo.sql
[0m02:13:40.810395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c3308cd-327a-4f74-8e1f-e7a268d03d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767922faf470>]}
[0m02:13:40.811554 [error] [Thread-1 (]: 11 of 13 ERROR creating sql table model staging_marts.dim_tempo ................ [[31mERROR[0m in 0.03s]
[0m02:13:40.812780 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_tempo
[0m02:13:40.813458 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_turma
[0m02:13:40.814299 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.dim_tempo' to be skipped because of status 'error'.  Reason: Database Error in model dim_tempo (transformacao_aprovados/models/marts/dim_tempo.sql)
  syntax error at or near "FROM"
  LINE 20:     FROM source
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_tempo.sql.
[0m02:13:40.816205 [info ] [Thread-1 (]: 12 of 13 START sql table model staging_marts.dim_turma ......................... [RUN]
[0m02:13:40.818243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_tempo, now model.transformacao_matricula.dim_turma)
[0m02:13:40.819079 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_turma
[0m02:13:40.823488 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_turma"
[0m02:13:40.824599 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_turma
[0m02:13:40.832555 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_turma"
[0m02:13:40.834103 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m02:13:40.834836 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: BEGIN
[0m02:13:40.835491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:13:40.846958 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m02:13:40.847602 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m02:13:40.848101 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."dim_turma__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
    ),
staged_data AS (
    SELECT
        turma,
        serie,
        turno,
        mod_ens_codigo,
        modalidade_ens
    FROM source
)
SELECT * FROM staged_data
  );
  
[0m02:13:41.176778 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 0.328 seconds
[0m02:13:41.179908 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m02:13:41.180492 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */
alter table "transformacao_matricula"."staging_marts"."dim_turma__dbt_tmp" rename to "dim_turma"
[0m02:13:41.181468 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:13:41.183074 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: COMMIT
[0m02:13:41.183630 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m02:13:41.184069 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: COMMIT
[0m02:13:41.190953 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m02:13:41.193879 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."dim_turma__dbt_backup"
[0m02:13:41.194927 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m02:13:41.195307 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */
drop table if exists "transformacao_matricula"."staging_marts"."dim_turma__dbt_backup" cascade
[0m02:13:41.196165 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m02:13:41.197437 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: Close
[0m02:13:41.198191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c3308cd-327a-4f74-8e1f-e7a268d03d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767920234c80>]}
[0m02:13:41.199129 [info ] [Thread-1 (]: 12 of 13 OK created sql table model staging_marts.dim_turma .................... [[32mSELECT 319146[0m in 0.38s]
[0m02:13:41.199946 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_turma
[0m02:13:41.201025 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.fato_matricula
[0m02:13:41.201606 [info ] [Thread-1 (]: 13 of 13 SKIP relation staging_marts.fato_matricula ............................ [[33mSKIP[0m]
[0m02:13:41.202221 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.fato_matricula
[0m02:13:41.204198 [debug] [MainThread]: Using postgres connection "master"
[0m02:13:41.207873 [debug] [MainThread]: On master: BEGIN
[0m02:13:41.209359 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:13:41.219486 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m02:13:41.220237 [debug] [MainThread]: On master: COMMIT
[0m02:13:41.220607 [debug] [MainThread]: Using postgres connection "master"
[0m02:13:41.220949 [debug] [MainThread]: On master: COMMIT
[0m02:13:41.222074 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m02:13:41.222904 [debug] [MainThread]: On master: Close
[0m02:13:41.223591 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:13:41.224058 [debug] [MainThread]: Connection 'model.transformacao_matricula.dim_turma' was properly closed.
[0m02:13:41.224605 [info ] [MainThread]: 
[0m02:13:41.225191 [info ] [MainThread]: Finished running 9 table models, 4 view models in 0 hours 0 minutes and 3.11 seconds (3.11s).
[0m02:13:41.228180 [debug] [MainThread]: Command end result
[0m02:13:41.257140 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m02:13:41.259724 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m02:13:41.268059 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m02:13:41.268972 [info ] [MainThread]: 
[0m02:13:41.269595 [info ] [MainThread]: [31mCompleted with 7 errors, 0 partial successes, and 0 warnings:[0m
[0m02:13:41.270474 [info ] [MainThread]: 
[0m02:13:41.272177 [error] [MainThread]: [31mFailure in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)[0m
[0m02:13:41.278554 [error] [MainThread]:   Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  relation "fato_matricula" does not exist
  LINE 14:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m02:13:41.280612 [info ] [MainThread]: 
[0m02:13:41.281245 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m02:13:41.281706 [info ] [MainThread]: 
[0m02:13:41.282223 [error] [MainThread]: [31mFailure in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)[0m
[0m02:13:41.282687 [error] [MainThread]:   Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m02:13:41.283139 [info ] [MainThread]: 
[0m02:13:41.283617 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m02:13:41.284049 [info ] [MainThread]: 
[0m02:13:41.284507 [error] [MainThread]: [31mFailure in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)[0m
[0m02:13:41.285024 [error] [MainThread]:   Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m02:13:41.285488 [info ] [MainThread]: 
[0m02:13:41.286348 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m02:13:41.287327 [info ] [MainThread]: 
[0m02:13:41.287970 [error] [MainThread]: [31mFailure in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)[0m
[0m02:13:41.288473 [error] [MainThread]:   Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  relation "fato_matricula" does not exist
  LINE 19:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m02:13:41.288888 [info ] [MainThread]: 
[0m02:13:41.289366 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m02:13:41.289776 [info ] [MainThread]: 
[0m02:13:41.290287 [error] [MainThread]: [31mFailure in model dim_aluno (transformacao_aprovados/models/marts/dim_aluno.sql)[0m
[0m02:13:41.290784 [error] [MainThread]:   Database Error in model dim_aluno (transformacao_aprovados/models/marts/dim_aluno.sql)
  operator does not exist: text <= integer
  LINE 22:             WHEN idade <= 3 THEN '0-3 Anos (Educação Infanti...
                                  ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_aluno.sql
[0m02:13:41.291250 [info ] [MainThread]: 
[0m02:13:41.291914 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/dim_aluno.sql
[0m02:13:41.292500 [info ] [MainThread]: 
[0m02:13:41.293126 [error] [MainThread]: [31mFailure in model dim_escola (transformacao_aprovados/models/marts/dim_escola.sql)[0m
[0m02:13:41.293674 [error] [MainThread]:   Database Error in model dim_escola (transformacao_aprovados/models/marts/dim_escola.sql)
  syntax error at or near ";"
  LINE 28: SELECT * FROM escolas;
                                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_escola.sql
[0m02:13:41.294249 [info ] [MainThread]: 
[0m02:13:41.295009 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/dim_escola.sql
[0m02:13:41.295570 [info ] [MainThread]: 
[0m02:13:41.296184 [error] [MainThread]: [31mFailure in model dim_tempo (transformacao_aprovados/models/marts/dim_tempo.sql)[0m
[0m02:13:41.296862 [error] [MainThread]:   Database Error in model dim_tempo (transformacao_aprovados/models/marts/dim_tempo.sql)
  syntax error at or near "FROM"
  LINE 20:     FROM source
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_tempo.sql
[0m02:13:41.297769 [info ] [MainThread]: 
[0m02:13:41.298733 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/dim_tempo.sql
[0m02:13:41.299525 [info ] [MainThread]: 
[0m02:13:41.300312 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=7 SKIP=1 NO-OP=0 TOTAL=13
[0m02:13:41.302413 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.308992, "process_in_blocks": "976", "process_kernel_time": 0.432842, "process_mem_max_rss": "127232", "process_out_blocks": "3368", "process_user_time": 3.025896}
[0m02:13:41.303554 [debug] [MainThread]: Command `dbt run` failed at 02:13:41.303361 after 4.31 seconds
[0m02:13:41.304647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767925508500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7679203bdc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7679203bf470>]}
[0m02:13:41.307815 [debug] [MainThread]: Flushing usage events
[0m02:13:41.947908 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:17:29.496703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2af7318b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2af3c0a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2af3c1250>]}


============================== 02:17:29.499823 | 001fa1b9-a71d-414a-9a05-d49cdb2b9f34 ==============================
[0m02:17:29.499823 [info ] [MainThread]: Running with dbt=1.10.15
[0m02:17:29.500517 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'cache_selected_only': 'False', 'write_json': 'True', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run', 'warn_error': 'None', 'introspect': 'True', 'fail_fast': 'False', 'profiles_dir': '/home/murilo/.dbt', 'debug': 'False', 'empty': 'False'}
[0m02:17:29.649524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '001fa1b9-a71d-414a-9a05-d49cdb2b9f34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2b1443710>]}
[0m02:17:29.699121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '001fa1b9-a71d-414a-9a05-d49cdb2b9f34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2af1a6c30>]}
[0m02:17:29.699919 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:17:29.820399 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m02:17:29.913411 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m02:17:29.914036 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/dim_aluno.sql
[0m02:17:29.914442 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/dim_escola.sql
[0m02:17:30.123323 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.transformacao_matricula.dimensions
- models.transformacao_matricula.intermediate
- models.transformacao_matricula.facts
[0m02:17:30.134575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '001fa1b9-a71d-414a-9a05-d49cdb2b9f34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2aebb9190>]}
[0m02:17:30.213547 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m02:17:30.215934 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m02:17:30.229743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '001fa1b9-a71d-414a-9a05-d49cdb2b9f34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2ac905eb0>]}
[0m02:17:30.230355 [info ] [MainThread]: Found 13 models, 2 data tests, 1 source, 459 macros
[0m02:17:30.230746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '001fa1b9-a71d-414a-9a05-d49cdb2b9f34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2ac972090>]}
[0m02:17:30.232681 [info ] [MainThread]: 
[0m02:17:30.233182 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m02:17:30.233508 [info ] [MainThread]: 
[0m02:17:30.234045 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:17:30.238073 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula'
[0m02:17:30.282942 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m02:17:30.283532 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m02:17:30.283988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:17:30.296449 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.012 seconds
[0m02:17:30.298210 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m02:17:30.302321 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m02:17:30.302934 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m02:17:30.303328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:17:30.314725 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.011 seconds
[0m02:17:30.316137 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m02:17:30.319124 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula, now list_transformacao_matricula_staging_staging)
[0m02:17:30.324706 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m02:17:30.325200 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: BEGIN
[0m02:17:30.325509 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:17:30.335120 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m02:17:30.335564 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m02:17:30.335920 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_staging"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m02:17:30.339255 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m02:17:30.344732 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: ROLLBACK
[0m02:17:30.345990 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: Close
[0m02:17:30.346724 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_staging, now list_transformacao_matricula_staging_marts)
[0m02:17:30.348764 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m02:17:30.349243 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: BEGIN
[0m02:17:30.349567 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:17:30.359168 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m02:17:30.359679 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m02:17:30.360403 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_marts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m02:17:30.364060 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m02:17:30.366051 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: ROLLBACK
[0m02:17:30.366772 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: Close
[0m02:17:30.371502 [debug] [MainThread]: Using postgres connection "master"
[0m02:17:30.371968 [debug] [MainThread]: On master: BEGIN
[0m02:17:30.372277 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:17:30.380914 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m02:17:30.381364 [debug] [MainThread]: Using postgres connection "master"
[0m02:17:30.381730 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:17:30.385329 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m02:17:30.386492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '001fa1b9-a71d-414a-9a05-d49cdb2b9f34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2ac92dbe0>]}
[0m02:17:30.387001 [debug] [MainThread]: On master: ROLLBACK
[0m02:17:30.387670 [debug] [MainThread]: Using postgres connection "master"
[0m02:17:30.388050 [debug] [MainThread]: On master: BEGIN
[0m02:17:30.388961 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m02:17:30.389340 [debug] [MainThread]: On master: COMMIT
[0m02:17:30.389659 [debug] [MainThread]: Using postgres connection "master"
[0m02:17:30.389975 [debug] [MainThread]: On master: COMMIT
[0m02:17:30.390577 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:17:30.390970 [debug] [MainThread]: On master: Close
[0m02:17:30.393769 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.staging_situacao_alunos
[0m02:17:30.394792 [info ] [Thread-1 (]: 1 of 13 START sql table model staging_staging.staging_situacao_alunos .......... [RUN]
[0m02:17:30.395363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_marts, now model.transformacao_matricula.staging_situacao_alunos)
[0m02:17:30.395892 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.staging_situacao_alunos
[0m02:17:30.402400 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.staging_situacao_alunos"
[0m02:17:30.403167 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.staging_situacao_alunos
[0m02:17:30.444727 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.staging_situacao_alunos"
[0m02:17:30.445657 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m02:17:30.446158 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: BEGIN
[0m02:17:30.446530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:17:30.456234 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m02:17:30.456720 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m02:17:30.457190 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */

  
    

  create  table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp"
  
  
    as
  
  (
    WITH source AS (
    SELECT * FROM "transformacao_matricula"."staging"."staging_alunos_raw"
),

cleaning_renaming AS (
    SELECT
        ano,
        codigo_escola,
        matricula,
        escola AS nome_escola,
        endereco_logradouro AS endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa,
        modalidade_ensino_codigo AS mod_ens_codigo,
        -- Transformação da SÉRIE
        CASE
            -- Ensino Fundamental (1º ao 9º)
            WHEN serie LIKE '%1 ANO%' OR serie LIKE '%1º ANO%' THEN '1º ANO'
            WHEN serie LIKE '%2 ANO%' OR serie LIKE '%2º ANO%' THEN '2º ANO'
            WHEN serie LIKE '%3 ANO%' OR serie LIKE '%3º ANO%' THEN '3º ANO'
            WHEN serie LIKE '%4 ANO%' OR serie LIKE '%4º ANO%' THEN '4º ANO'
            WHEN serie LIKE '%5 ANO%' OR serie LIKE '%5º ANO%' THEN '5º ANO'
            WHEN serie LIKE '%6 ANO%' OR serie LIKE '%6º ANO%' THEN '6º ANO'
            WHEN serie LIKE '%7 ANO%' OR serie LIKE '%7º ANO%' THEN '7º ANO'
            WHEN serie LIKE '%8 ANO%' OR serie LIKE '%8º ANO%' THEN '8º ANO'
            WHEN serie LIKE '%9 ANO%' OR serie LIKE '%9º ANO%' THEN '9º ANO'
            -- Educação Infantil (Berçário e Grupos)
            WHEN serie LIKE '%BER%' THEN 'BERÇARIO'
            WHEN serie LIKE '%GRUPO I%' OR serie LIKE '%GRUPO 1%' THEN 'GRUPO I'
            WHEN serie LIKE '%GRUPO II%' THEN 'GRUPO II'
            WHEN serie LIKE '%GRUPO III%' THEN 'GRUPO III'
            WHEN serie LIKE '%GRUPO IV%' THEN 'GRUPO IV'
            WHEN serie LIKE '%GRUPO V%' THEN 'GRUPO V'
            -- EJA (Módulos 1 ao 5) 
            WHEN serie LIKE '%1%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 1'
            WHEN serie LIKE '%2%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 2'
            WHEN serie LIKE '%3%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 3'
            WHEN serie LIKE '%4%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 4'
            WHEN serie LIKE '%5%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 5'
            WHEN serie LIKE '%TRAVESSIA%' THEN 'TRAVESSIA RECIFE'
            WHEN serie LIKE '%CORRECAO%1%' THEN 'CORREÇÃO DE FLUXO 1 - ALFABETIZACAO'
            WHEN serie LIKE '%CORRECAO%2%' THEN 'CORREÇÃO DE FLUXO 2 - ACELERACAO'
            ELSE 'OUTROS'
        END AS serie,
        turma,
        turno,
        idade,
        -- transformação do SEXO
        CASE
            WHEN sexo = '1' THEN 'Masculino'
            WHEN sexo = '2' THEN 'Feminino'
            WHEN sexo = '3' THEN 'Outros'
            ELSE 'Não informado'
        END AS sexo,
        -- transformação de situacao
        CASE 
            WHEN situacao_nome LIKE '%APROV%' THEN 'Aprovado'
            WHEN situacao_nome LIKE '%RET%' OR situacao_nome LIKE '%REPRO%' THEN 'Reprovado'
            WHEN situacao_nome LIKE '%TR%' OR situacao_nome LIKE '%REMAN%' THEN 'Transferido'
            WHEN situacao_nome LIKE '%DESIST%' THEN 'Desistente'
            ELSE 'Outros'
        END AS sit_nome,
        -- Transformação da MODALIDADE
        CASE
            WHEN modalidade_ensino LIKE '%EDUCACAO INFANTIL%' THEN 'EDUCAÇÃO INFANTIL'
            WHEN modalidade_ensino LIKE '%ENSINO FUNDAMENTAL%' THEN 'ENSINO FUNDAMENTAL'
            WHEN modalidade_ensino LIKE '%EDUCACAO JOVENS E ADULTOS%' THEN 'EJA'
            WHEN modalidade_ensino LIKE '%CORRE%' THEN 'CORREÇÃO DE FLUXO'
            ELSE 'OUTROS'
        END AS modalidade_ens
    FROM source
)

SELECT * FROM cleaning_renaming
  );
  
[0m02:17:31.195059 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 0.737 seconds
[0m02:17:31.204239 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m02:17:31.204722 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
alter table "transformacao_matricula"."staging_staging"."staging_situacao_alunos" rename to "staging_situacao_alunos__dbt_backup"
[0m02:17:31.206023 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:17:31.208862 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m02:17:31.209389 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
alter table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp" rename to "staging_situacao_alunos"
[0m02:17:31.210374 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:17:31.224031 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: COMMIT
[0m02:17:31.224528 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m02:17:31.224890 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: COMMIT
[0m02:17:31.261051 [debug] [Thread-1 (]: SQL status: COMMIT in 0.036 seconds
[0m02:17:31.266487 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_backup"
[0m02:17:31.273138 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m02:17:31.273640 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
drop table if exists "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_backup" cascade
[0m02:17:31.284340 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m02:17:31.287040 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: Close
[0m02:17:31.288694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '001fa1b9-a71d-414a-9a05-d49cdb2b9f34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2afa88ad0>]}
[0m02:17:31.289434 [info ] [Thread-1 (]: 1 of 13 OK created sql table model staging_staging.staging_situacao_alunos ..... [[32mSELECT 319146[0m in 0.89s]
[0m02:17:31.290152 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.staging_situacao_alunos
[0m02:17:31.290615 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_count_aluno_idade
[0m02:17:31.291099 [info ] [Thread-1 (]: 2 of 13 START sql view model staging_marts.view_count_aluno_idade .............. [RUN]
[0m02:17:31.292013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.staging_situacao_alunos, now model.transformacao_matricula.view_count_aluno_idade)
[0m02:17:31.292638 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_count_aluno_idade
[0m02:17:31.373001 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_count_aluno_idade"
[0m02:17:31.373712 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_count_aluno_idade
[0m02:17:31.394559 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_count_aluno_idade"
[0m02:17:31.395435 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m02:17:31.395898 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: BEGIN
[0m02:17:31.396261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:17:31.404698 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m02:17:31.405201 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m02:17:31.405580 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_count_aluno_idade"} */

  create view "transformacao_matricula"."staging_marts"."view_count_aluno_idade__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dl.desc_rpa,
    da.faixa_etaria,
    COUNT(fm.matricula) AS total_alunos
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
ORDER BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
  );
[0m02:17:31.406673 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 14:     fato_matricula fm
             ^

[0m02:17:31.407155 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: ROLLBACK
[0m02:17:31.408011 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: Close
[0m02:17:31.411260 [debug] [Thread-1 (]: Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  relation "fato_matricula" does not exist
  LINE 14:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m02:17:31.411952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '001fa1b9-a71d-414a-9a05-d49cdb2b9f34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2a99db140>]}
[0m02:17:31.412563 [error] [Thread-1 (]: 2 of 13 ERROR creating sql view model staging_marts.view_count_aluno_idade ..... [[31mERROR[0m in 0.12s]
[0m02:17:31.413152 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_count_aluno_idade
[0m02:17:31.413556 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m02:17:31.414341 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_count_aluno_idade' to be skipped because of status 'error'.  Reason: Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  relation "fato_matricula" does not exist
  LINE 14:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql.
[0m02:17:31.415009 [info ] [Thread-1 (]: 3 of 13 START sql view model staging_marts.view_frequencia_situacao_escola ..... [RUN]
[0m02:17:31.416163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_count_aluno_idade, now model.transformacao_matricula.view_frequencia_situacao_escola)
[0m02:17:31.416607 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_frequencia_situacao_escola
[0m02:17:31.418968 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m02:17:31.419936 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_frequencia_situacao_escola
[0m02:17:31.423499 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m02:17:31.424320 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m02:17:31.424828 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: BEGIN
[0m02:17:31.425263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:17:31.435485 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m02:17:31.436260 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m02:17:31.436888 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_frequencia_situacao_escola"} */

  create view "transformacao_matricula"."staging_marts"."view_frequencia_situacao_escola__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    de.nome_escola,
    de.codigo_escola,
    ds.situacao_nome,
    COUNT(fm.matricula) AS contagem_situacao
FROM
    fato_matricula fm
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, de.nome_escola, de.codigo_escola, ds.situacao_nome
ORDER BY
    dtemp.ano, de.nome_escola, contagem_situacao DESC
  );
[0m02:17:31.438215 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 15:     fato_matricula fm
             ^

[0m02:17:31.438864 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: ROLLBACK
[0m02:17:31.439810 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: Close
[0m02:17:31.446434 [debug] [Thread-1 (]: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m02:17:31.447222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '001fa1b9-a71d-414a-9a05-d49cdb2b9f34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2ad16f740>]}
[0m02:17:31.448066 [error] [Thread-1 (]: 3 of 13 ERROR creating sql view model staging_marts.view_frequencia_situacao_escola  [[31mERROR[0m in 0.03s]
[0m02:17:31.448891 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m02:17:31.449481 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_matricula_detalhada
[0m02:17:31.450811 [info ] [Thread-1 (]: 4 of 13 START sql view model staging_marts.view_matricula_detalhada ............ [RUN]
[0m02:17:31.451552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_frequencia_situacao_escola, now model.transformacao_matricula.view_matricula_detalhada)
[0m02:17:31.452254 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_matricula_detalhada
[0m02:17:31.450122 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_frequencia_situacao_escola' to be skipped because of status 'error'.  Reason: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql.
[0m02:17:31.455642 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_matricula_detalhada"
[0m02:17:31.456776 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_matricula_detalhada
[0m02:17:31.461236 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_matricula_detalhada"
[0m02:17:31.462341 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m02:17:31.463016 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: BEGIN
[0m02:17:31.463499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:17:31.473359 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m02:17:31.474300 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m02:17:31.475010 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_matricula_detalhada"} */

  create view "transformacao_matricula"."staging_marts"."view_matricula_detalhada__dbt_tmp"
    
    
  as (
    
SELECT
    fm.matricula,
    da.sexo,
    da.idade,
    da.faixa_etaria,
    de.nome_escola,
    de.codigo_escola,
    dt.turma,
    dt.turno,
    dt.serie,
    dt.modalidade_ensino,
    ds.situacao_nome,
    ds.categoria AS categoria_situacao,
    ds.eh_aprovado,
    ds.eh_reprovado,
    dl.desc_rpa,
    dl.endereco_bairro AS bairro_localizacao,
    dtemp.ano AS ano_registro
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
  );
[0m02:17:31.476308 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 27:     fato_matricula fm
             ^

[0m02:17:31.476927 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: ROLLBACK
[0m02:17:31.477904 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: Close
[0m02:17:31.483582 [debug] [Thread-1 (]: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m02:17:31.484722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '001fa1b9-a71d-414a-9a05-d49cdb2b9f34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2a999d940>]}
[0m02:17:31.485911 [error] [Thread-1 (]: 4 of 13 ERROR creating sql view model staging_marts.view_matricula_detalhada ... [[31mERROR[0m in 0.03s]
[0m02:17:31.486746 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_matricula_detalhada
[0m02:17:31.487530 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_taxa_aprovados
[0m02:17:31.489166 [info ] [Thread-1 (]: 5 of 13 START sql view model staging_marts.view_taxa_aprovados ................. [RUN]
[0m02:17:31.488281 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_matricula_detalhada' to be skipped because of status 'error'.  Reason: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql.
[0m02:17:31.489934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_matricula_detalhada, now model.transformacao_matricula.view_taxa_aprovados)
[0m02:17:31.490921 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_taxa_aprovados
[0m02:17:31.494717 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_taxa_aprovados"
[0m02:17:31.495794 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_taxa_aprovados
[0m02:17:31.501452 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_taxa_aprovados"
[0m02:17:31.502667 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m02:17:31.503361 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: BEGIN
[0m02:17:31.503928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:17:31.518934 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m02:17:31.519525 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m02:17:31.520007 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_taxa_aprovados"} */

  create view "transformacao_matricula"."staging_marts"."view_taxa_aprovados__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dt.modalidade_ensino,
    COUNT(fm.matricula) AS total_matriculas,
    SUM(ds.eh_aprovado) AS total_aprovados,
    SUM(ds.eh_reprovado) AS total_reprovados,
    -- Calcula a taxa de aprovação (como porcentagem)
    CAST(SUM(ds.eh_aprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_aprovacao_percentual,
    -- Calcula a taxa de reprovação (como porcentagem)
    CAST(SUM(ds.eh_reprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_reprovacao_percentual
FROM
    fato_matricula fm
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dt.modalidade_ensino
ORDER BY
    dtemp.ano, dt.modalidade_ensino
  );
[0m02:17:31.521205 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 19:     fato_matricula fm
             ^

[0m02:17:31.521785 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: ROLLBACK
[0m02:17:31.522751 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: Close
[0m02:17:31.525341 [debug] [Thread-1 (]: Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  relation "fato_matricula" does not exist
  LINE 19:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m02:17:31.526573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '001fa1b9-a71d-414a-9a05-d49cdb2b9f34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2a9963080>]}
[0m02:17:31.528036 [error] [Thread-1 (]: 5 of 13 ERROR creating sql view model staging_marts.view_taxa_aprovados ........ [[31mERROR[0m in 0.04s]
[0m02:17:31.529071 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_taxa_aprovados
[0m02:17:31.529740 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_aluno
[0m02:17:31.530423 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_taxa_aprovados' to be skipped because of status 'error'.  Reason: Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  relation "fato_matricula" does not exist
  LINE 19:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql.
[0m02:17:31.531212 [info ] [Thread-1 (]: 6 of 13 START sql table model staging_marts.dim_aluno .......................... [RUN]
[0m02:17:31.532575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_taxa_aprovados, now model.transformacao_matricula.dim_aluno)
[0m02:17:31.533549 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_aluno
[0m02:17:31.537112 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_aluno"
[0m02:17:31.538296 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_aluno
[0m02:17:31.544611 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_aluno"
[0m02:17:31.550118 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m02:17:31.550937 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: BEGIN
[0m02:17:31.551453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:17:31.561151 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m02:17:31.561801 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m02:17:31.563026 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_aluno"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."dim_aluno__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_staging"."staging_situacao_alunos" 
    ),
staged_data AS (
    SELECT
        sexo,
        idade,
        CASE
            WHEN idade < 3 OR idade = 3 THEN '0-3 Anos (Educação Infantil)'
            WHEN idade < 5 OR idade = 5 THEN '4-5 Anos (Pré-escola)'
            WHEN idade < 10 OR idade = 10 THEN '6-10 Anos (Fundamental I)'
            WHEN idade < 14 OR idade = 14 THEN '11-14 Anos (Fundamental II)'
            WHEN idade < 15 OR idade = 15 THEN '15+ Anos (EJA e Outros)'
            ELSE 'Não Informado'
        END AS faixa_etaria
    FROM source
) 

SELECT * FROM staged_data
  );
  
[0m02:17:31.564998 [debug] [Thread-1 (]: Postgres adapter: Postgres error: operator does not exist: text < integer
LINE 22:             WHEN idade < 3 OR idade = 3 THEN '0-3 Anos (Educ...
                                ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m02:17:31.565611 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: ROLLBACK
[0m02:17:31.566910 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: Close
[0m02:17:31.570660 [debug] [Thread-1 (]: Database Error in model dim_aluno (transformacao_aprovados/models/marts/dim_aluno.sql)
  operator does not exist: text < integer
  LINE 22:             WHEN idade < 3 OR idade = 3 THEN '0-3 Anos (Educ...
                                  ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_aluno.sql
[0m02:17:31.571795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '001fa1b9-a71d-414a-9a05-d49cdb2b9f34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2a98feba0>]}
[0m02:17:31.572741 [error] [Thread-1 (]: 6 of 13 ERROR creating sql table model staging_marts.dim_aluno ................. [[31mERROR[0m in 0.04s]
[0m02:17:31.573807 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_aluno
[0m02:17:31.574553 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.transform_data
[0m02:17:31.575324 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.dim_aluno' to be skipped because of status 'error'.  Reason: Database Error in model dim_aluno (transformacao_aprovados/models/marts/dim_aluno.sql)
  operator does not exist: text < integer
  LINE 22:             WHEN idade < 3 OR idade = 3 THEN '0-3 Anos (Educ...
                                  ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_aluno.sql.
[0m02:17:31.576208 [info ] [Thread-1 (]: 7 of 13 START sql table model staging_marts.transform_data ..................... [RUN]
[0m02:17:31.577309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_aluno, now model.transformacao_matricula.transform_data)
[0m02:17:31.578426 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.transform_data
[0m02:17:31.587122 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.transform_data"
[0m02:17:31.588336 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.transform_data
[0m02:17:31.594346 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.transform_data"
[0m02:17:31.595829 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m02:17:31.596869 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: BEGIN
[0m02:17:31.597785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:17:31.609883 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m02:17:31.610570 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m02:17:31.611168 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."transform_data__dbt_tmp"
  
  
    as
  
  (
    

with staged_data AS (
    SELECT * FROM "transformacao_matricula"."staging_staging"."staging_situacao_alunos"
),

transformed_data AS (
    SELECT
        CAST(ano AS INTEGER) AS ano,
        CAST(codigo_escola AS INTEGER) AS codigo_escola,
        CAST(matricula AS INTEGER) AS matricula,
        nome_escola,
        endereco_logra,
        endereco_bairro,
        endereco_numero,
        CAST(rpa AS INTEGER) AS rpa,
        CAST(mod_ens_codigo AS INTEGER) AS mod_ens_codigo,
        serie,
        turma,
        turno,
        CAST(idade AS INTEGER) AS idade,
        sexo,
        sit_nome AS situacao_nome,
        modalidade_ens,
        CASE
            WHEN CAST(idade AS INTEGER) <= 3 THEN '0-3 Anos (Educação Infantil)'
            WHEN CAST(idade AS INTEGER) <= 5 THEN '4-5 Anos (Pré-escola)'
            WHEN CAST(idade AS INTEGER) <= 10 THEN '6-10 Anos (Fundamental I)'
            WHEN CAST(idade AS INTEGER) <= 14 THEN '11-14 Anos (Fundamental II)'
            WHEN CAST(idade AS INTEGER) >= 15 THEN '15+ Anos (EJA e Outros)'
            ELSE 'Não Informado'
        END AS faixa_etaria
    FROM staged_data
)

SELECT * FROM transformed_data
  );
  
[0m02:17:32.211377 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 0.600 seconds
[0m02:17:32.214277 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m02:17:32.214750 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
alter table "transformacao_matricula"."staging_marts"."transform_data" rename to "transform_data__dbt_backup"
[0m02:17:32.215702 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:17:32.218228 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m02:17:32.218700 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
alter table "transformacao_matricula"."staging_marts"."transform_data__dbt_tmp" rename to "transform_data"
[0m02:17:32.219668 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:17:32.221425 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: COMMIT
[0m02:17:32.221929 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m02:17:32.222289 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: COMMIT
[0m02:17:32.261066 [debug] [Thread-1 (]: SQL status: COMMIT in 0.038 seconds
[0m02:17:32.263352 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."transform_data__dbt_backup"
[0m02:17:32.264384 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m02:17:32.264807 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
drop table if exists "transformacao_matricula"."staging_marts"."transform_data__dbt_backup" cascade
[0m02:17:32.278306 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m02:17:32.279683 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: Close
[0m02:17:32.280332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '001fa1b9-a71d-414a-9a05-d49cdb2b9f34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2a9960920>]}
[0m02:17:32.280997 [info ] [Thread-1 (]: 7 of 13 OK created sql table model staging_marts.transform_data ................ [[32mSELECT 319146[0m in 0.70s]
[0m02:17:32.281662 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.transform_data
[0m02:17:32.282999 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_escola
[0m02:17:32.283641 [info ] [Thread-1 (]: 8 of 13 START sql table model staging_marts.dim_escola ......................... [RUN]
[0m02:17:32.284310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.transform_data, now model.transformacao_matricula.dim_escola)
[0m02:17:32.284921 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_escola
[0m02:17:32.287676 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_escola"
[0m02:17:32.288510 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_escola
[0m02:17:32.291953 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_escola"
[0m02:17:32.292756 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m02:17:32.293269 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: BEGIN
[0m02:17:32.293664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:17:32.304573 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m02:17:32.305391 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m02:17:32.306099 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."dim_escola__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
    ),

escolas AS (
    SELECT
        DISTINCT codigo_escola,
        nome_escola,
        endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa
    FROM source
)
SELECT * FROM escolas
  );
  
[0m02:17:32.486685 [debug] [Thread-1 (]: SQL status: SELECT 433 in 0.180 seconds
[0m02:17:32.489673 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m02:17:32.490218 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */
alter table "transformacao_matricula"."staging_marts"."dim_escola__dbt_tmp" rename to "dim_escola"
[0m02:17:32.491377 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:17:32.492916 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: COMMIT
[0m02:17:32.493344 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m02:17:32.493702 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: COMMIT
[0m02:17:32.495499 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m02:17:32.497941 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."dim_escola__dbt_backup"
[0m02:17:32.498894 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m02:17:32.499292 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */
drop table if exists "transformacao_matricula"."staging_marts"."dim_escola__dbt_backup" cascade
[0m02:17:32.500142 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m02:17:32.501425 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: Close
[0m02:17:32.502169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '001fa1b9-a71d-414a-9a05-d49cdb2b9f34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2af90c770>]}
[0m02:17:32.502828 [info ] [Thread-1 (]: 8 of 13 OK created sql table model staging_marts.dim_escola .................... [[32mSELECT 433[0m in 0.22s]
[0m02:17:32.503438 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_escola
[0m02:17:32.503870 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_localizacao
[0m02:17:32.504458 [info ] [Thread-1 (]: 9 of 13 START sql table model staging_marts.dim_localizacao .................... [RUN]
[0m02:17:32.504989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_escola, now model.transformacao_matricula.dim_localizacao)
[0m02:17:32.505389 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_localizacao
[0m02:17:32.509724 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_localizacao"
[0m02:17:32.510432 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_localizacao
[0m02:17:32.513554 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_localizacao"
[0m02:17:32.514303 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m02:17:32.514699 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: BEGIN
[0m02:17:32.515074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:17:32.524701 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m02:17:32.525403 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m02:17:32.525985 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."dim_localizacao__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
    ),
staged_data AS (
    SELECT
        rpa,
        endereco_bairro
    FROM source
)
SELECT * FROM staged_data
  );
  
[0m02:17:32.741389 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 0.215 seconds
[0m02:17:32.744545 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m02:17:32.745037 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */
alter table "transformacao_matricula"."staging_marts"."dim_localizacao" rename to "dim_localizacao__dbt_backup"
[0m02:17:32.746069 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:17:32.748651 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m02:17:32.749115 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */
alter table "transformacao_matricula"."staging_marts"."dim_localizacao__dbt_tmp" rename to "dim_localizacao"
[0m02:17:32.750108 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:17:32.751782 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: COMMIT
[0m02:17:32.752243 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m02:17:32.752620 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: COMMIT
[0m02:17:32.758813 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m02:17:32.761086 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."dim_localizacao__dbt_backup"
[0m02:17:32.761960 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m02:17:32.762349 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */
drop table if exists "transformacao_matricula"."staging_marts"."dim_localizacao__dbt_backup" cascade
[0m02:17:32.765567 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m02:17:32.766955 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: Close
[0m02:17:32.767591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '001fa1b9-a71d-414a-9a05-d49cdb2b9f34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2ad54ffb0>]}
[0m02:17:32.768273 [info ] [Thread-1 (]: 9 of 13 OK created sql table model staging_marts.dim_localizacao ............... [[32mSELECT 319146[0m in 0.26s]
[0m02:17:32.768900 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_localizacao
[0m02:17:32.769342 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_situacao
[0m02:17:32.769916 [info ] [Thread-1 (]: 10 of 13 START sql table model staging_marts.dim_situacao ...................... [RUN]
[0m02:17:32.770407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_localizacao, now model.transformacao_matricula.dim_situacao)
[0m02:17:32.770792 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_situacao
[0m02:17:32.773326 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_situacao"
[0m02:17:32.774114 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_situacao
[0m02:17:32.777351 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_situacao"
[0m02:17:32.778108 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m02:17:32.778494 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: BEGIN
[0m02:17:32.778880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:17:32.789984 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m02:17:32.790672 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m02:17:32.791264 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."dim_situacao__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
    ),
staged_data AS (
    SELECT DISTINCT
        situacao_nome,
        CASE 
            WHEN situacao_nome = 'Aprovado' THEN 1
            ELSE 0
        END AS eh_aprovado,
        CASE 
            WHEN situacao_nome = 'Reprovado' THEN 1
            ELSE 0
        END AS eh_reprovado
    FROM source
)
SELECT * FROM staged_data
  );
  
[0m02:17:32.859165 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.067 seconds
[0m02:17:32.864294 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m02:17:32.864873 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */
alter table "transformacao_matricula"."staging_marts"."dim_situacao" rename to "dim_situacao__dbt_backup"
[0m02:17:32.866092 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:17:32.868972 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m02:17:32.869475 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */
alter table "transformacao_matricula"."staging_marts"."dim_situacao__dbt_tmp" rename to "dim_situacao"
[0m02:17:32.870900 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:17:32.872866 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: COMMIT
[0m02:17:32.873407 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m02:17:32.873819 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: COMMIT
[0m02:17:32.875936 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m02:17:32.878189 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."dim_situacao__dbt_backup"
[0m02:17:32.879144 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m02:17:32.879556 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */
drop table if exists "transformacao_matricula"."staging_marts"."dim_situacao__dbt_backup" cascade
[0m02:17:32.882977 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m02:17:32.889015 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: Close
[0m02:17:32.890635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '001fa1b9-a71d-414a-9a05-d49cdb2b9f34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2a9997e30>]}
[0m02:17:32.892134 [info ] [Thread-1 (]: 10 of 13 OK created sql table model staging_marts.dim_situacao ................. [[32mSELECT 5[0m in 0.12s]
[0m02:17:32.893103 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_situacao
[0m02:17:32.893632 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_tempo
[0m02:17:32.894446 [info ] [Thread-1 (]: 11 of 13 START sql table model staging_marts.dim_tempo ......................... [RUN]
[0m02:17:32.895122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_situacao, now model.transformacao_matricula.dim_tempo)
[0m02:17:32.895582 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_tempo
[0m02:17:32.898346 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_tempo"
[0m02:17:32.899174 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_tempo
[0m02:17:32.904589 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_tempo"
[0m02:17:32.905393 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m02:17:32.905836 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: BEGIN
[0m02:17:32.906306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:17:32.919647 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m02:17:32.923444 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m02:17:32.924384 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."dim_tempo__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
    ),
staged_data AS (
    SELECT
        ano,
    FROM source
)
SELECT * FROM staged_data
  );
  
[0m02:17:32.926017 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 20:     FROM source
             ^

[0m02:17:32.926966 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: ROLLBACK
[0m02:17:32.928436 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: Close
[0m02:17:32.932611 [debug] [Thread-1 (]: Database Error in model dim_tempo (transformacao_aprovados/models/marts/dim_tempo.sql)
  syntax error at or near "FROM"
  LINE 20:     FROM source
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_tempo.sql
[0m02:17:32.933836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '001fa1b9-a71d-414a-9a05-d49cdb2b9f34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2a98fec60>]}
[0m02:17:32.935250 [error] [Thread-1 (]: 11 of 13 ERROR creating sql table model staging_marts.dim_tempo ................ [[31mERROR[0m in 0.04s]
[0m02:17:32.936429 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_tempo
[0m02:17:32.937270 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_turma
[0m02:17:32.938215 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.dim_tempo' to be skipped because of status 'error'.  Reason: Database Error in model dim_tempo (transformacao_aprovados/models/marts/dim_tempo.sql)
  syntax error at or near "FROM"
  LINE 20:     FROM source
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_tempo.sql.
[0m02:17:32.939140 [info ] [Thread-1 (]: 12 of 13 START sql table model staging_marts.dim_turma ......................... [RUN]
[0m02:17:32.940832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_tempo, now model.transformacao_matricula.dim_turma)
[0m02:17:32.941537 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_turma
[0m02:17:32.946123 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_turma"
[0m02:17:32.947396 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_turma
[0m02:17:32.955626 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_turma"
[0m02:17:32.957708 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m02:17:32.958689 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: BEGIN
[0m02:17:32.959336 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:17:32.972606 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m02:17:32.973425 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m02:17:32.974133 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."dim_turma__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
    ),
staged_data AS (
    SELECT
        turma,
        serie,
        turno,
        mod_ens_codigo,
        modalidade_ens
    FROM source
)
SELECT * FROM staged_data
  );
  
[0m02:17:33.366526 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 0.392 seconds
[0m02:17:33.370202 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m02:17:33.370802 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */
alter table "transformacao_matricula"."staging_marts"."dim_turma" rename to "dim_turma__dbt_backup"
[0m02:17:33.372245 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:17:33.375704 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m02:17:33.376329 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */
alter table "transformacao_matricula"."staging_marts"."dim_turma__dbt_tmp" rename to "dim_turma"
[0m02:17:33.377324 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:17:33.379190 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: COMMIT
[0m02:17:33.379811 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m02:17:33.380466 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: COMMIT
[0m02:17:33.390286 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m02:17:33.393315 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."dim_turma__dbt_backup"
[0m02:17:33.394679 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m02:17:33.395275 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */
drop table if exists "transformacao_matricula"."staging_marts"."dim_turma__dbt_backup" cascade
[0m02:17:33.400355 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m02:17:33.401975 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: Close
[0m02:17:33.402807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '001fa1b9-a71d-414a-9a05-d49cdb2b9f34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2ac946a50>]}
[0m02:17:33.403818 [info ] [Thread-1 (]: 12 of 13 OK created sql table model staging_marts.dim_turma .................... [[32mSELECT 319146[0m in 0.46s]
[0m02:17:33.404872 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_turma
[0m02:17:33.405837 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.fato_matricula
[0m02:17:33.406680 [info ] [Thread-1 (]: 13 of 13 SKIP relation staging_marts.fato_matricula ............................ [[33mSKIP[0m]
[0m02:17:33.407414 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.fato_matricula
[0m02:17:33.408924 [debug] [MainThread]: Using postgres connection "master"
[0m02:17:33.409874 [debug] [MainThread]: On master: BEGIN
[0m02:17:33.410427 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:17:33.424873 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m02:17:33.425656 [debug] [MainThread]: On master: COMMIT
[0m02:17:33.426309 [debug] [MainThread]: Using postgres connection "master"
[0m02:17:33.426827 [debug] [MainThread]: On master: COMMIT
[0m02:17:33.427779 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:17:33.428530 [debug] [MainThread]: On master: Close
[0m02:17:33.429405 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:17:33.430176 [debug] [MainThread]: Connection 'model.transformacao_matricula.dim_turma' was properly closed.
[0m02:17:33.431154 [info ] [MainThread]: 
[0m02:17:33.432107 [info ] [MainThread]: Finished running 9 table models, 4 view models in 0 hours 0 minutes and 3.20 seconds (3.20s).
[0m02:17:33.435360 [debug] [MainThread]: Command end result
[0m02:17:33.478026 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m02:17:33.481720 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m02:17:33.497563 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m02:17:33.498514 [info ] [MainThread]: 
[0m02:17:33.499371 [info ] [MainThread]: [31mCompleted with 6 errors, 0 partial successes, and 0 warnings:[0m
[0m02:17:33.500307 [info ] [MainThread]: 
[0m02:17:33.501283 [error] [MainThread]: [31mFailure in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)[0m
[0m02:17:33.502140 [error] [MainThread]:   Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  relation "fato_matricula" does not exist
  LINE 14:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m02:17:33.502634 [info ] [MainThread]: 
[0m02:17:33.503271 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m02:17:33.503759 [info ] [MainThread]: 
[0m02:17:33.504319 [error] [MainThread]: [31mFailure in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)[0m
[0m02:17:33.504863 [error] [MainThread]:   Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m02:17:33.505312 [info ] [MainThread]: 
[0m02:17:33.505808 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m02:17:33.506293 [info ] [MainThread]: 
[0m02:17:33.507094 [error] [MainThread]: [31mFailure in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)[0m
[0m02:17:33.507825 [error] [MainThread]:   Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m02:17:33.508554 [info ] [MainThread]: 
[0m02:17:33.509400 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m02:17:33.510042 [info ] [MainThread]: 
[0m02:17:33.510800 [error] [MainThread]: [31mFailure in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)[0m
[0m02:17:33.511551 [error] [MainThread]:   Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  relation "fato_matricula" does not exist
  LINE 19:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m02:17:33.512339 [info ] [MainThread]: 
[0m02:17:33.513290 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m02:17:33.514494 [info ] [MainThread]: 
[0m02:17:33.515587 [error] [MainThread]: [31mFailure in model dim_aluno (transformacao_aprovados/models/marts/dim_aluno.sql)[0m
[0m02:17:33.516463 [error] [MainThread]:   Database Error in model dim_aluno (transformacao_aprovados/models/marts/dim_aluno.sql)
  operator does not exist: text < integer
  LINE 22:             WHEN idade < 3 OR idade = 3 THEN '0-3 Anos (Educ...
                                  ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_aluno.sql
[0m02:17:33.517063 [info ] [MainThread]: 
[0m02:17:33.517680 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/dim_aluno.sql
[0m02:17:33.518433 [info ] [MainThread]: 
[0m02:17:33.519420 [error] [MainThread]: [31mFailure in model dim_tempo (transformacao_aprovados/models/marts/dim_tempo.sql)[0m
[0m02:17:33.524130 [error] [MainThread]:   Database Error in model dim_tempo (transformacao_aprovados/models/marts/dim_tempo.sql)
  syntax error at or near "FROM"
  LINE 20:     FROM source
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_tempo.sql
[0m02:17:33.525733 [info ] [MainThread]: 
[0m02:17:33.526798 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/dim_tempo.sql
[0m02:17:33.527647 [info ] [MainThread]: 
[0m02:17:33.528402 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=6 SKIP=1 NO-OP=0 TOTAL=13
[0m02:17:33.529973 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.079134, "process_in_blocks": "0", "process_kernel_time": 0.334217, "process_mem_max_rss": "127052", "process_out_blocks": "3368", "process_user_time": 2.498151}
[0m02:17:33.531017 [debug] [MainThread]: Command `dbt run` failed at 02:17:33.530800 after 4.08 seconds
[0m02:17:33.531991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2af7e33b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2a9902f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2a9903200>]}
[0m02:17:33.532932 [debug] [MainThread]: Flushing usage events
[0m02:17:34.197387 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:18:59.306642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7cc03085f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7cbf36f080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7cbecc1100>]}


============================== 02:18:59.309551 | a7c3a6f4-d1a0-4d0a-9159-a2a913d2ee4c ==============================
[0m02:18:59.309551 [info ] [MainThread]: Running with dbt=1.10.15
[0m02:18:59.310178 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_experimental_parser': 'False', 'introspect': 'True', 'debug': 'False', 'empty': 'False', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'use_colors': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'static_parser': 'True', 'fail_fast': 'False', 'quiet': 'False', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'no_print': 'None', 'profiles_dir': '/home/murilo/.dbt', 'partial_parse': 'True', 'write_json': 'True', 'cache_selected_only': 'False'}
[0m02:18:59.463262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7c3a6f4-d1a0-4d0a-9159-a2a913d2ee4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7cbddf03e0>]}
[0m02:18:59.513546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7c3a6f4-d1a0-4d0a-9159-a2a913d2ee4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7cc0fea8d0>]}
[0m02:18:59.514346 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m02:18:59.630355 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m02:18:59.722508 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:18:59.722966 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:18:59.727546 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.transformacao_matricula.dimensions
- models.transformacao_matricula.facts
- models.transformacao_matricula.intermediate
[0m02:18:59.763803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7c3a6f4-d1a0-4d0a-9159-a2a913d2ee4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7cbd94f9e0>]}
[0m02:18:59.840704 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m02:18:59.842358 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m02:18:59.859650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7c3a6f4-d1a0-4d0a-9159-a2a913d2ee4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7cbc9966c0>]}
[0m02:18:59.860219 [info ] [MainThread]: Found 13 models, 2 data tests, 1 source, 459 macros
[0m02:18:59.860589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7c3a6f4-d1a0-4d0a-9159-a2a913d2ee4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7cbc93dee0>]}
[0m02:18:59.862708 [info ] [MainThread]: 
[0m02:18:59.863211 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m02:18:59.863556 [info ] [MainThread]: 
[0m02:18:59.864083 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:18:59.868273 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula'
[0m02:18:59.909915 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m02:18:59.910613 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m02:18:59.911025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:18:59.923130 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.012 seconds
[0m02:18:59.924408 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m02:18:59.926794 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m02:18:59.927393 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m02:18:59.927741 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:18:59.937065 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.009 seconds
[0m02:18:59.938249 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m02:18:59.940997 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula, now list_transformacao_matricula_staging_staging)
[0m02:18:59.953649 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m02:18:59.954636 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: BEGIN
[0m02:18:59.955310 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:18:59.965735 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m02:18:59.966396 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m02:18:59.966777 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_staging"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m02:18:59.970467 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m02:18:59.971831 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: ROLLBACK
[0m02:18:59.972564 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: Close
[0m02:18:59.973173 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_staging, now list_transformacao_matricula_staging_marts)
[0m02:18:59.975720 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m02:18:59.976315 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: BEGIN
[0m02:18:59.976951 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:18:59.989631 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m02:18:59.990160 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m02:18:59.990491 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_marts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m02:18:59.993700 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m02:18:59.995033 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: ROLLBACK
[0m02:18:59.995963 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: Close
[0m02:19:00.000823 [debug] [MainThread]: Using postgres connection "master"
[0m02:19:00.001286 [debug] [MainThread]: On master: BEGIN
[0m02:19:00.001597 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:19:00.015827 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m02:19:00.016402 [debug] [MainThread]: Using postgres connection "master"
[0m02:19:00.016764 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m02:19:00.020687 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m02:19:00.022079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7c3a6f4-d1a0-4d0a-9159-a2a913d2ee4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7cbb500320>]}
[0m02:19:00.022570 [debug] [MainThread]: On master: ROLLBACK
[0m02:19:00.023345 [debug] [MainThread]: Using postgres connection "master"
[0m02:19:00.023730 [debug] [MainThread]: On master: BEGIN
[0m02:19:00.024611 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m02:19:00.025059 [debug] [MainThread]: On master: COMMIT
[0m02:19:00.025466 [debug] [MainThread]: Using postgres connection "master"
[0m02:19:00.025784 [debug] [MainThread]: On master: COMMIT
[0m02:19:00.026470 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:19:00.026962 [debug] [MainThread]: On master: Close
[0m02:19:00.029951 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.staging_situacao_alunos
[0m02:19:00.031048 [info ] [Thread-1 (]: 1 of 13 START sql table model staging_staging.staging_situacao_alunos .......... [RUN]
[0m02:19:00.031553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_marts, now model.transformacao_matricula.staging_situacao_alunos)
[0m02:19:00.031968 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.staging_situacao_alunos
[0m02:19:00.038396 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.staging_situacao_alunos"
[0m02:19:00.039279 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.staging_situacao_alunos
[0m02:19:00.081815 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.staging_situacao_alunos"
[0m02:19:00.082752 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m02:19:00.083208 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: BEGIN
[0m02:19:00.083627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:19:00.091976 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m02:19:00.092567 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m02:19:00.093128 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */

  
    

  create  table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp"
  
  
    as
  
  (
    WITH source AS (
    SELECT * FROM "transformacao_matricula"."staging"."staging_alunos_raw"
),

cleaning_renaming AS (
    SELECT
        ano,
        codigo_escola,
        matricula,
        escola AS nome_escola,
        endereco_logradouro AS endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa,
        modalidade_ensino_codigo AS mod_ens_codigo,
        -- Transformação da SÉRIE
        CASE
            -- Ensino Fundamental (1º ao 9º)
            WHEN serie LIKE '%1 ANO%' OR serie LIKE '%1º ANO%' THEN '1º ANO'
            WHEN serie LIKE '%2 ANO%' OR serie LIKE '%2º ANO%' THEN '2º ANO'
            WHEN serie LIKE '%3 ANO%' OR serie LIKE '%3º ANO%' THEN '3º ANO'
            WHEN serie LIKE '%4 ANO%' OR serie LIKE '%4º ANO%' THEN '4º ANO'
            WHEN serie LIKE '%5 ANO%' OR serie LIKE '%5º ANO%' THEN '5º ANO'
            WHEN serie LIKE '%6 ANO%' OR serie LIKE '%6º ANO%' THEN '6º ANO'
            WHEN serie LIKE '%7 ANO%' OR serie LIKE '%7º ANO%' THEN '7º ANO'
            WHEN serie LIKE '%8 ANO%' OR serie LIKE '%8º ANO%' THEN '8º ANO'
            WHEN serie LIKE '%9 ANO%' OR serie LIKE '%9º ANO%' THEN '9º ANO'
            -- Educação Infantil (Berçário e Grupos)
            WHEN serie LIKE '%BER%' THEN 'BERÇARIO'
            WHEN serie LIKE '%GRUPO I%' OR serie LIKE '%GRUPO 1%' THEN 'GRUPO I'
            WHEN serie LIKE '%GRUPO II%' THEN 'GRUPO II'
            WHEN serie LIKE '%GRUPO III%' THEN 'GRUPO III'
            WHEN serie LIKE '%GRUPO IV%' THEN 'GRUPO IV'
            WHEN serie LIKE '%GRUPO V%' THEN 'GRUPO V'
            -- EJA (Módulos 1 ao 5) 
            WHEN serie LIKE '%1%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 1'
            WHEN serie LIKE '%2%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 2'
            WHEN serie LIKE '%3%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 3'
            WHEN serie LIKE '%4%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 4'
            WHEN serie LIKE '%5%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 5'
            WHEN serie LIKE '%TRAVESSIA%' THEN 'TRAVESSIA RECIFE'
            WHEN serie LIKE '%CORRECAO%1%' THEN 'CORREÇÃO DE FLUXO 1 - ALFABETIZACAO'
            WHEN serie LIKE '%CORRECAO%2%' THEN 'CORREÇÃO DE FLUXO 2 - ACELERACAO'
            ELSE 'OUTROS'
        END AS serie,
        turma,
        turno,
        idade,
        -- transformação do SEXO
        CASE
            WHEN sexo = '1' THEN 'Masculino'
            WHEN sexo = '2' THEN 'Feminino'
            WHEN sexo = '3' THEN 'Outros'
            ELSE 'Não informado'
        END AS sexo,
        -- transformação de situacao
        CASE 
            WHEN situacao_nome LIKE '%APROV%' THEN 'Aprovado'
            WHEN situacao_nome LIKE '%RET%' OR situacao_nome LIKE '%REPRO%' THEN 'Reprovado'
            WHEN situacao_nome LIKE '%TR%' OR situacao_nome LIKE '%REMAN%' THEN 'Transferido'
            WHEN situacao_nome LIKE '%DESIST%' THEN 'Desistente'
            ELSE 'Outros'
        END AS sit_nome,
        -- Transformação da MODALIDADE
        CASE
            WHEN modalidade_ensino LIKE '%EDUCACAO INFANTIL%' THEN 'EDUCAÇÃO INFANTIL'
            WHEN modalidade_ensino LIKE '%ENSINO FUNDAMENTAL%' THEN 'ENSINO FUNDAMENTAL'
            WHEN modalidade_ensino LIKE '%EDUCACAO JOVENS E ADULTOS%' THEN 'EJA'
            WHEN modalidade_ensino LIKE '%CORRE%' THEN 'CORREÇÃO DE FLUXO'
            ELSE 'OUTROS'
        END AS modalidade_ens
    FROM source
)

SELECT * FROM cleaning_renaming
  );
  
[0m02:19:00.828008 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 0.734 seconds
[0m02:19:00.836328 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m02:19:00.836814 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
alter table "transformacao_matricula"."staging_staging"."staging_situacao_alunos" rename to "staging_situacao_alunos__dbt_backup"
[0m02:19:00.838002 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:19:00.840793 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m02:19:00.842505 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
alter table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp" rename to "staging_situacao_alunos"
[0m02:19:00.843652 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:19:00.857210 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: COMMIT
[0m02:19:00.857701 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m02:19:00.858061 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: COMMIT
[0m02:19:00.902439 [debug] [Thread-1 (]: SQL status: COMMIT in 0.044 seconds
[0m02:19:00.908229 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_backup"
[0m02:19:00.913137 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m02:19:00.913697 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
drop table if exists "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_backup" cascade
[0m02:19:00.924723 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m02:19:00.927256 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: Close
[0m02:19:00.928807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7c3a6f4-d1a0-4d0a-9159-a2a913d2ee4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7cbf534a70>]}
[0m02:19:00.929538 [info ] [Thread-1 (]: 1 of 13 OK created sql table model staging_staging.staging_situacao_alunos ..... [[32mSELECT 319146[0m in 0.90s]
[0m02:19:00.930294 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.staging_situacao_alunos
[0m02:19:00.930739 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_count_aluno_idade
[0m02:19:00.931217 [info ] [Thread-1 (]: 2 of 13 START sql view model staging_marts.view_count_aluno_idade .............. [RUN]
[0m02:19:00.932038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.staging_situacao_alunos, now model.transformacao_matricula.view_count_aluno_idade)
[0m02:19:00.932498 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_count_aluno_idade
[0m02:19:00.935043 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_count_aluno_idade"
[0m02:19:00.935857 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_count_aluno_idade
[0m02:19:00.952415 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_count_aluno_idade"
[0m02:19:00.953468 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m02:19:00.954031 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: BEGIN
[0m02:19:00.954519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:19:00.964941 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m02:19:00.965601 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m02:19:00.966193 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_count_aluno_idade"} */

  create view "transformacao_matricula"."staging_marts"."view_count_aluno_idade__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dl.desc_rpa,
    da.faixa_etaria,
    COUNT(fm.matricula) AS total_alunos
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
ORDER BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
  );
[0m02:19:00.967758 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 14:     fato_matricula fm
             ^

[0m02:19:00.968456 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: ROLLBACK
[0m02:19:00.969462 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: Close
[0m02:19:00.975177 [debug] [Thread-1 (]: Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  relation "fato_matricula" does not exist
  LINE 14:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m02:19:00.975785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7c3a6f4-d1a0-4d0a-9159-a2a913d2ee4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7cbb4cc6b0>]}
[0m02:19:00.976403 [error] [Thread-1 (]: 2 of 13 ERROR creating sql view model staging_marts.view_count_aluno_idade ..... [[31mERROR[0m in 0.04s]
[0m02:19:00.977135 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_count_aluno_idade
[0m02:19:00.977822 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m02:19:00.978590 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_count_aluno_idade' to be skipped because of status 'error'.  Reason: Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  relation "fato_matricula" does not exist
  LINE 14:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql.
[0m02:19:00.979447 [info ] [Thread-1 (]: 3 of 13 START sql view model staging_marts.view_frequencia_situacao_escola ..... [RUN]
[0m02:19:00.981249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_count_aluno_idade, now model.transformacao_matricula.view_frequencia_situacao_escola)
[0m02:19:00.981878 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_frequencia_situacao_escola
[0m02:19:00.985811 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m02:19:00.986642 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_frequencia_situacao_escola
[0m02:19:00.990241 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m02:19:00.991004 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m02:19:00.991394 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: BEGIN
[0m02:19:00.991745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:19:01.000640 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m02:19:01.001208 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m02:19:01.001647 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_frequencia_situacao_escola"} */

  create view "transformacao_matricula"."staging_marts"."view_frequencia_situacao_escola__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    de.nome_escola,
    de.codigo_escola,
    ds.situacao_nome,
    COUNT(fm.matricula) AS contagem_situacao
FROM
    fato_matricula fm
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, de.nome_escola, de.codigo_escola, ds.situacao_nome
ORDER BY
    dtemp.ano, de.nome_escola, contagem_situacao DESC
  );
[0m02:19:01.002945 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 15:     fato_matricula fm
             ^

[0m02:19:01.003817 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: ROLLBACK
[0m02:19:01.004841 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: Close
[0m02:19:01.007828 [debug] [Thread-1 (]: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m02:19:01.008962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7c3a6f4-d1a0-4d0a-9159-a2a913d2ee4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7cb9ba8380>]}
[0m02:19:01.010083 [error] [Thread-1 (]: 3 of 13 ERROR creating sql view model staging_marts.view_frequencia_situacao_escola  [[31mERROR[0m in 0.03s]
[0m02:19:01.011263 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m02:19:01.011949 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_matricula_detalhada
[0m02:19:01.012705 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_frequencia_situacao_escola' to be skipped because of status 'error'.  Reason: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql.
[0m02:19:01.013965 [info ] [Thread-1 (]: 4 of 13 START sql view model staging_marts.view_matricula_detalhada ............ [RUN]
[0m02:19:01.016054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_frequencia_situacao_escola, now model.transformacao_matricula.view_matricula_detalhada)
[0m02:19:01.017710 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_matricula_detalhada
[0m02:19:01.025064 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_matricula_detalhada"
[0m02:19:01.026060 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_matricula_detalhada
[0m02:19:01.031003 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_matricula_detalhada"
[0m02:19:01.032248 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m02:19:01.032896 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: BEGIN
[0m02:19:01.033562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:19:01.044603 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m02:19:01.045227 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m02:19:01.045671 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_matricula_detalhada"} */

  create view "transformacao_matricula"."staging_marts"."view_matricula_detalhada__dbt_tmp"
    
    
  as (
    
SELECT
    fm.matricula,
    da.sexo,
    da.idade,
    da.faixa_etaria,
    de.nome_escola,
    de.codigo_escola,
    dt.turma,
    dt.turno,
    dt.serie,
    dt.modalidade_ensino,
    ds.situacao_nome,
    ds.categoria AS categoria_situacao,
    ds.eh_aprovado,
    ds.eh_reprovado,
    dl.desc_rpa,
    dl.endereco_bairro AS bairro_localizacao,
    dtemp.ano AS ano_registro
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
  );
[0m02:19:01.047027 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 27:     fato_matricula fm
             ^

[0m02:19:01.047789 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: ROLLBACK
[0m02:19:01.048738 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: Close
[0m02:19:01.056265 [debug] [Thread-1 (]: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m02:19:01.057127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7c3a6f4-d1a0-4d0a-9159-a2a913d2ee4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7cb9bbc8f0>]}
[0m02:19:01.057982 [error] [Thread-1 (]: 4 of 13 ERROR creating sql view model staging_marts.view_matricula_detalhada ... [[31mERROR[0m in 0.04s]
[0m02:19:01.058825 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_matricula_detalhada
[0m02:19:01.059413 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_taxa_aprovados
[0m02:19:01.059892 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_matricula_detalhada' to be skipped because of status 'error'.  Reason: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql.
[0m02:19:01.060447 [info ] [Thread-1 (]: 5 of 13 START sql view model staging_marts.view_taxa_aprovados ................. [RUN]
[0m02:19:01.061154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_matricula_detalhada, now model.transformacao_matricula.view_taxa_aprovados)
[0m02:19:01.061699 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_taxa_aprovados
[0m02:19:01.065673 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_taxa_aprovados"
[0m02:19:01.067042 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_taxa_aprovados
[0m02:19:01.074036 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_taxa_aprovados"
[0m02:19:01.075227 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m02:19:01.075923 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: BEGIN
[0m02:19:01.076515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:19:01.091372 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m02:19:01.092092 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m02:19:01.092685 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_taxa_aprovados"} */

  create view "transformacao_matricula"."staging_marts"."view_taxa_aprovados__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dt.modalidade_ensino,
    COUNT(fm.matricula) AS total_matriculas,
    SUM(ds.eh_aprovado) AS total_aprovados,
    SUM(ds.eh_reprovado) AS total_reprovados,
    -- Calcula a taxa de aprovação (como porcentagem)
    CAST(SUM(ds.eh_aprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_aprovacao_percentual,
    -- Calcula a taxa de reprovação (como porcentagem)
    CAST(SUM(ds.eh_reprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_reprovacao_percentual
FROM
    fato_matricula fm
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dt.modalidade_ensino
ORDER BY
    dtemp.ano, dt.modalidade_ensino
  );
[0m02:19:01.094256 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 19:     fato_matricula fm
             ^

[0m02:19:01.095168 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: ROLLBACK
[0m02:19:01.096918 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: Close
[0m02:19:01.100234 [debug] [Thread-1 (]: Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  relation "fato_matricula" does not exist
  LINE 19:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m02:19:01.101290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7c3a6f4-d1a0-4d0a-9159-a2a913d2ee4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7cb9bbc830>]}
[0m02:19:01.102591 [error] [Thread-1 (]: 5 of 13 ERROR creating sql view model staging_marts.view_taxa_aprovados ........ [[31mERROR[0m in 0.04s]
[0m02:19:01.103416 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_taxa_aprovados
[0m02:19:01.103973 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_aluno
[0m02:19:01.104651 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_taxa_aprovados' to be skipped because of status 'error'.  Reason: Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  relation "fato_matricula" does not exist
  LINE 19:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql.
[0m02:19:01.105787 [info ] [Thread-1 (]: 6 of 13 START sql table model staging_marts.dim_aluno .......................... [RUN]
[0m02:19:01.107135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_taxa_aprovados, now model.transformacao_matricula.dim_aluno)
[0m02:19:01.107871 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_aluno
[0m02:19:01.111407 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_aluno"
[0m02:19:01.112600 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_aluno
[0m02:19:01.121688 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_aluno"
[0m02:19:01.122661 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m02:19:01.123185 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: BEGIN
[0m02:19:01.123596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:19:01.136919 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m02:19:01.137864 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m02:19:01.138419 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_aluno"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."dim_aluno__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_staging"."staging_situacao_alunos" 
    ),
staged_data AS (
    SELECT
        sexo,
        idade,
        CASE
            WHEN idade < 3 OR idade = 3 THEN '0-3 Anos (Educação Infantil)'
            WHEN idade < 5 OR idade = 5 THEN '4-5 Anos (Pré-escola)'
            WHEN idade < 10 OR idade = 10 THEN '6-10 Anos (Fundamental I)'
            WHEN idade < 14 OR idade = 14 THEN '11-14 Anos (Fundamental II)'
            WHEN idade < 15 OR idade = 15 THEN '15+ Anos (EJA e Outros)'
            ELSE 'Não Informado'
        END AS faixa_etaria
    FROM source
) 

SELECT * FROM staged_data
  );
  
[0m02:19:01.140155 [debug] [Thread-1 (]: Postgres adapter: Postgres error: operator does not exist: text < integer
LINE 22:             WHEN idade < 3 OR idade = 3 THEN '0-3 Anos (Educ...
                                ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m02:19:01.140804 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: ROLLBACK
[0m02:19:01.141864 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: Close
[0m02:19:01.145029 [debug] [Thread-1 (]: Database Error in model dim_aluno (transformacao_aprovados/models/marts/dim_aluno.sql)
  operator does not exist: text < integer
  LINE 22:             WHEN idade < 3 OR idade = 3 THEN '0-3 Anos (Educ...
                                  ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_aluno.sql
[0m02:19:01.146023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7c3a6f4-d1a0-4d0a-9159-a2a913d2ee4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7cbb42e9f0>]}
[0m02:19:01.147034 [error] [Thread-1 (]: 6 of 13 ERROR creating sql table model staging_marts.dim_aluno ................. [[31mERROR[0m in 0.04s]
[0m02:19:01.148449 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_aluno
[0m02:19:01.149487 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.transform_data
[0m02:19:01.153915 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.dim_aluno' to be skipped because of status 'error'.  Reason: Database Error in model dim_aluno (transformacao_aprovados/models/marts/dim_aluno.sql)
  operator does not exist: text < integer
  LINE 22:             WHEN idade < 3 OR idade = 3 THEN '0-3 Anos (Educ...
                                  ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_aluno.sql.
[0m02:19:01.155150 [info ] [Thread-1 (]: 7 of 13 START sql table model staging_marts.transform_data ..................... [RUN]
[0m02:19:01.156062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_aluno, now model.transformacao_matricula.transform_data)
[0m02:19:01.156691 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.transform_data
[0m02:19:01.160685 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.transform_data"
[0m02:19:01.161641 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.transform_data
[0m02:19:01.166311 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.transform_data"
[0m02:19:01.167636 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m02:19:01.168641 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: BEGIN
[0m02:19:01.169558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:19:01.181546 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m02:19:01.182187 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m02:19:01.182635 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."transform_data__dbt_tmp"
  
  
    as
  
  (
    

with staged_data AS (
    SELECT * FROM "transformacao_matricula"."staging_staging"."staging_situacao_alunos"
),

transformed_data AS (
    SELECT
        CAST(ano AS INTEGER) AS ano,
        CAST(codigo_escola AS INTEGER) AS codigo_escola,
        CAST(matricula AS INTEGER) AS matricula,
        nome_escola,
        endereco_logra,
        endereco_bairro,
        endereco_numero,
        CAST(rpa AS INTEGER) AS rpa,
        CAST(mod_ens_codigo AS INTEGER) AS mod_ens_codigo,
        serie,
        turma,
        turno,
        CAST(idade AS INTEGER) AS idade,
        sexo,
        sit_nome AS situacao_nome,
        modalidade_ens,
        CASE
            WHEN CAST(idade AS INTEGER) <= 3 THEN '0-3 Anos (Educação Infantil)'
            WHEN CAST(idade AS INTEGER) <= 5 THEN '4-5 Anos (Pré-escola)'
            WHEN CAST(idade AS INTEGER) <= 10 THEN '6-10 Anos (Fundamental I)'
            WHEN CAST(idade AS INTEGER) <= 14 THEN '11-14 Anos (Fundamental II)'
            WHEN CAST(idade AS INTEGER) >= 15 THEN '15+ Anos (EJA e Outros)'
            ELSE 'Não Informado'
        END AS faixa_etaria
    FROM staged_data
)

SELECT * FROM transformed_data
  );
  
[0m02:19:01.884025 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 0.701 seconds
[0m02:19:01.887367 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m02:19:01.887812 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
alter table "transformacao_matricula"."staging_marts"."transform_data" rename to "transform_data__dbt_backup"
[0m02:19:01.888908 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:19:01.891378 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m02:19:01.891811 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
alter table "transformacao_matricula"."staging_marts"."transform_data__dbt_tmp" rename to "transform_data"
[0m02:19:01.892780 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:19:01.894514 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: COMMIT
[0m02:19:01.895223 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m02:19:01.895789 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: COMMIT
[0m02:19:01.902984 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m02:19:01.905607 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."transform_data__dbt_backup"
[0m02:19:01.906738 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m02:19:01.907154 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
drop table if exists "transformacao_matricula"."staging_marts"."transform_data__dbt_backup" cascade
[0m02:19:01.920494 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m02:19:01.921826 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: Close
[0m02:19:01.922455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7c3a6f4-d1a0-4d0a-9159-a2a913d2ee4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7cbeae4560>]}
[0m02:19:01.923093 [info ] [Thread-1 (]: 7 of 13 OK created sql table model staging_marts.transform_data ................ [[32mSELECT 319146[0m in 0.77s]
[0m02:19:01.923704 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.transform_data
[0m02:19:01.925005 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_escola
[0m02:19:01.925594 [info ] [Thread-1 (]: 8 of 13 START sql table model staging_marts.dim_escola ......................... [RUN]
[0m02:19:01.926246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.transform_data, now model.transformacao_matricula.dim_escola)
[0m02:19:01.926777 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_escola
[0m02:19:01.929517 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_escola"
[0m02:19:01.930319 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_escola
[0m02:19:01.933775 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_escola"
[0m02:19:01.934563 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m02:19:01.935037 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: BEGIN
[0m02:19:01.935440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:19:01.945478 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m02:19:01.946168 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m02:19:01.946707 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."dim_escola__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
    ),

escolas AS (
    SELECT
        DISTINCT codigo_escola,
        nome_escola,
        endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa
    FROM source
)
SELECT * FROM escolas
  );
  
[0m02:19:02.134349 [debug] [Thread-1 (]: SQL status: SELECT 433 in 0.187 seconds
[0m02:19:02.139044 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m02:19:02.139563 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */
alter table "transformacao_matricula"."staging_marts"."dim_escola" rename to "dim_escola__dbt_backup"
[0m02:19:02.140626 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:19:02.229755 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m02:19:02.230405 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */
alter table "transformacao_matricula"."staging_marts"."dim_escola__dbt_tmp" rename to "dim_escola"
[0m02:19:02.231732 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:19:02.233802 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: COMMIT
[0m02:19:02.234271 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m02:19:02.234640 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: COMMIT
[0m02:19:02.237206 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m02:19:02.239902 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."dim_escola__dbt_backup"
[0m02:19:02.241189 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m02:19:02.241572 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */
drop table if exists "transformacao_matricula"."staging_marts"."dim_escola__dbt_backup" cascade
[0m02:19:02.245704 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m02:19:02.247477 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: Close
[0m02:19:02.248191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7c3a6f4-d1a0-4d0a-9159-a2a913d2ee4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7cb9bf3fe0>]}
[0m02:19:02.248829 [info ] [Thread-1 (]: 8 of 13 OK created sql table model staging_marts.dim_escola .................... [[32mSELECT 433[0m in 0.32s]
[0m02:19:02.249407 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_escola
[0m02:19:02.249813 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_localizacao
[0m02:19:02.250421 [info ] [Thread-1 (]: 9 of 13 START sql table model staging_marts.dim_localizacao .................... [RUN]
[0m02:19:02.250969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_escola, now model.transformacao_matricula.dim_localizacao)
[0m02:19:02.251359 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_localizacao
[0m02:19:02.258358 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_localizacao"
[0m02:19:02.259449 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_localizacao
[0m02:19:02.262864 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_localizacao"
[0m02:19:02.263632 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m02:19:02.264036 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: BEGIN
[0m02:19:02.264380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:19:02.274426 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m02:19:02.275017 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m02:19:02.275458 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."dim_localizacao__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
    ),
staged_data AS (
    SELECT
        rpa,
        endereco_bairro
    FROM source
)
SELECT * FROM staged_data
  );
  
[0m02:19:02.537404 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 0.261 seconds
[0m02:19:02.541059 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m02:19:02.541518 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */
alter table "transformacao_matricula"."staging_marts"."dim_localizacao" rename to "dim_localizacao__dbt_backup"
[0m02:19:02.542656 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:19:02.545390 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m02:19:02.545877 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */
alter table "transformacao_matricula"."staging_marts"."dim_localizacao__dbt_tmp" rename to "dim_localizacao"
[0m02:19:02.546755 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m02:19:02.548425 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: COMMIT
[0m02:19:02.548924 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m02:19:02.549440 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: COMMIT
[0m02:19:02.560831 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m02:19:02.563058 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."dim_localizacao__dbt_backup"
[0m02:19:02.564304 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m02:19:02.564819 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */
drop table if exists "transformacao_matricula"."staging_marts"."dim_localizacao__dbt_backup" cascade
[0m02:19:02.570279 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m02:19:02.571770 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: Close
[0m02:19:02.572601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7c3a6f4-d1a0-4d0a-9159-a2a913d2ee4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7cbcd36d20>]}
[0m02:19:02.573808 [info ] [Thread-1 (]: 9 of 13 OK created sql table model staging_marts.dim_localizacao ............... [[32mSELECT 319146[0m in 0.32s]
[0m02:19:02.574741 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_localizacao
[0m02:19:02.575246 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_situacao
[0m02:19:02.576070 [info ] [Thread-1 (]: 10 of 13 START sql table model staging_marts.dim_situacao ...................... [RUN]
[0m02:19:02.576602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_localizacao, now model.transformacao_matricula.dim_situacao)
[0m02:19:02.577229 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_situacao
[0m02:19:02.579785 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_situacao"
[0m02:19:02.580512 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_situacao
[0m02:19:02.583622 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_situacao"
[0m02:19:02.584360 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m02:19:02.584760 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: BEGIN
[0m02:19:02.585141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:19:02.601960 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m02:19:02.603185 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m02:19:02.604133 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."dim_situacao__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
    ),
staged_data AS (
    SELECT DISTINCT
        situacao_nome,
        CASE 
            WHEN situacao_nome = 'Aprovado' THEN 1
            ELSE 0
        END AS eh_aprovado,
        CASE 
            WHEN situacao_nome = 'Reprovado' THEN 1
            ELSE 0
        END AS eh_reprovado
    FROM source
)
SELECT * FROM staged_data
  );
  
[0m02:19:02.684604 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.080 seconds
[0m02:19:02.692310 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m02:19:02.693211 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */
alter table "transformacao_matricula"."staging_marts"."dim_situacao" rename to "dim_situacao__dbt_backup"
[0m02:19:02.694534 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:19:02.699222 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m02:19:02.699869 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */
alter table "transformacao_matricula"."staging_marts"."dim_situacao__dbt_tmp" rename to "dim_situacao"
[0m02:19:02.700933 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:19:02.702767 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: COMMIT
[0m02:19:02.703230 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m02:19:02.703608 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: COMMIT
[0m02:19:02.706067 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m02:19:02.710287 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."dim_situacao__dbt_backup"
[0m02:19:02.711370 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m02:19:02.711774 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */
drop table if exists "transformacao_matricula"."staging_marts"."dim_situacao__dbt_backup" cascade
[0m02:19:02.715009 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m02:19:02.717000 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: Close
[0m02:19:02.717749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7c3a6f4-d1a0-4d0a-9159-a2a913d2ee4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7cbd9b3170>]}
[0m02:19:02.718702 [info ] [Thread-1 (]: 10 of 13 OK created sql table model staging_marts.dim_situacao ................. [[32mSELECT 5[0m in 0.14s]
[0m02:19:02.719565 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_situacao
[0m02:19:02.720187 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_tempo
[0m02:19:02.721192 [info ] [Thread-1 (]: 11 of 13 START sql table model staging_marts.dim_tempo ......................... [RUN]
[0m02:19:02.721853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_situacao, now model.transformacao_matricula.dim_tempo)
[0m02:19:02.722909 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_tempo
[0m02:19:02.729813 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_tempo"
[0m02:19:02.730814 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_tempo
[0m02:19:02.736133 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_tempo"
[0m02:19:02.737659 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m02:19:02.738531 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: BEGIN
[0m02:19:02.739198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:19:02.750369 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m02:19:02.751091 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m02:19:02.751677 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."dim_tempo__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
    ),
staged_data AS (
    SELECT
        ano,
    FROM source
)
SELECT * FROM staged_data
  );
  
[0m02:19:02.752826 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 20:     FROM source
             ^

[0m02:19:02.753497 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: ROLLBACK
[0m02:19:02.755170 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: Close
[0m02:19:02.766977 [debug] [Thread-1 (]: Database Error in model dim_tempo (transformacao_aprovados/models/marts/dim_tempo.sql)
  syntax error at or near "FROM"
  LINE 20:     FROM source
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_tempo.sql
[0m02:19:02.767929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7c3a6f4-d1a0-4d0a-9159-a2a913d2ee4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7cbb4fbf80>]}
[0m02:19:02.768957 [error] [Thread-1 (]: 11 of 13 ERROR creating sql table model staging_marts.dim_tempo ................ [[31mERROR[0m in 0.05s]
[0m02:19:02.770210 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_tempo
[0m02:19:02.771143 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_turma
[0m02:19:02.772082 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.dim_tempo' to be skipped because of status 'error'.  Reason: Database Error in model dim_tempo (transformacao_aprovados/models/marts/dim_tempo.sql)
  syntax error at or near "FROM"
  LINE 20:     FROM source
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_tempo.sql.
[0m02:19:02.772921 [info ] [Thread-1 (]: 12 of 13 START sql table model staging_marts.dim_turma ......................... [RUN]
[0m02:19:02.774160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_tempo, now model.transformacao_matricula.dim_turma)
[0m02:19:02.774932 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_turma
[0m02:19:02.779542 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_turma"
[0m02:19:02.780764 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_turma
[0m02:19:02.788729 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_turma"
[0m02:19:02.792891 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m02:19:02.796919 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: BEGIN
[0m02:19:02.797725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:19:02.810818 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m02:19:02.811835 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m02:19:02.813057 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."dim_turma__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
    ),
staged_data AS (
    SELECT
        turma,
        serie,
        turno,
        mod_ens_codigo,
        modalidade_ens
    FROM source
)
SELECT * FROM staged_data
  );
  
[0m02:19:03.122814 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 0.309 seconds
[0m02:19:03.125659 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m02:19:03.126117 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */
alter table "transformacao_matricula"."staging_marts"."dim_turma" rename to "dim_turma__dbt_backup"
[0m02:19:03.127117 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:19:03.129597 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m02:19:03.130062 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */
alter table "transformacao_matricula"."staging_marts"."dim_turma__dbt_tmp" rename to "dim_turma"
[0m02:19:03.131038 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m02:19:03.132825 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: COMMIT
[0m02:19:03.133403 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m02:19:03.133895 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: COMMIT
[0m02:19:03.142821 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m02:19:03.145081 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."dim_turma__dbt_backup"
[0m02:19:03.145985 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m02:19:03.146356 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */
drop table if exists "transformacao_matricula"."staging_marts"."dim_turma__dbt_backup" cascade
[0m02:19:03.150764 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m02:19:03.152105 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: Close
[0m02:19:03.152726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7c3a6f4-d1a0-4d0a-9159-a2a913d2ee4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7cbf57d370>]}
[0m02:19:03.153567 [info ] [Thread-1 (]: 12 of 13 OK created sql table model staging_marts.dim_turma .................... [[32mSELECT 319146[0m in 0.38s]
[0m02:19:03.154369 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_turma
[0m02:19:03.155220 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.fato_matricula
[0m02:19:03.155894 [info ] [Thread-1 (]: 13 of 13 SKIP relation staging_marts.fato_matricula ............................ [[33mSKIP[0m]
[0m02:19:03.156358 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.fato_matricula
[0m02:19:03.157919 [debug] [MainThread]: Using postgres connection "master"
[0m02:19:03.158394 [debug] [MainThread]: On master: BEGIN
[0m02:19:03.158705 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:19:03.167068 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m02:19:03.167558 [debug] [MainThread]: On master: COMMIT
[0m02:19:03.168015 [debug] [MainThread]: Using postgres connection "master"
[0m02:19:03.168454 [debug] [MainThread]: On master: COMMIT
[0m02:19:03.169187 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m02:19:03.169674 [debug] [MainThread]: On master: Close
[0m02:19:03.170429 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:19:03.170938 [debug] [MainThread]: Connection 'model.transformacao_matricula.dim_turma' was properly closed.
[0m02:19:03.171608 [info ] [MainThread]: 
[0m02:19:03.172224 [info ] [MainThread]: Finished running 9 table models, 4 view models in 0 hours 0 minutes and 3.31 seconds (3.31s).
[0m02:19:03.175327 [debug] [MainThread]: Command end result
[0m02:19:03.206116 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m02:19:03.209185 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m02:19:03.216570 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m02:19:03.217072 [info ] [MainThread]: 
[0m02:19:03.217524 [info ] [MainThread]: [31mCompleted with 6 errors, 0 partial successes, and 0 warnings:[0m
[0m02:19:03.218072 [info ] [MainThread]: 
[0m02:19:03.218567 [error] [MainThread]: [31mFailure in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)[0m
[0m02:19:03.219108 [error] [MainThread]:   Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  relation "fato_matricula" does not exist
  LINE 14:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m02:19:03.219547 [info ] [MainThread]: 
[0m02:19:03.220072 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m02:19:03.220568 [info ] [MainThread]: 
[0m02:19:03.221115 [error] [MainThread]: [31mFailure in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)[0m
[0m02:19:03.221623 [error] [MainThread]:   Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m02:19:03.222095 [info ] [MainThread]: 
[0m02:19:03.222693 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m02:19:03.223209 [info ] [MainThread]: 
[0m02:19:03.223698 [error] [MainThread]: [31mFailure in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)[0m
[0m02:19:03.224171 [error] [MainThread]:   Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m02:19:03.224552 [info ] [MainThread]: 
[0m02:19:03.224995 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m02:19:03.225375 [info ] [MainThread]: 
[0m02:19:03.225797 [error] [MainThread]: [31mFailure in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)[0m
[0m02:19:03.226237 [error] [MainThread]:   Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  relation "fato_matricula" does not exist
  LINE 19:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m02:19:03.226589 [info ] [MainThread]: 
[0m02:19:03.227178 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m02:19:03.227976 [info ] [MainThread]: 
[0m02:19:03.228759 [error] [MainThread]: [31mFailure in model dim_aluno (transformacao_aprovados/models/marts/dim_aluno.sql)[0m
[0m02:19:03.229223 [error] [MainThread]:   Database Error in model dim_aluno (transformacao_aprovados/models/marts/dim_aluno.sql)
  operator does not exist: text < integer
  LINE 22:             WHEN idade < 3 OR idade = 3 THEN '0-3 Anos (Educ...
                                  ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_aluno.sql
[0m02:19:03.229591 [info ] [MainThread]: 
[0m02:19:03.230026 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/dim_aluno.sql
[0m02:19:03.230461 [info ] [MainThread]: 
[0m02:19:03.230894 [error] [MainThread]: [31mFailure in model dim_tempo (transformacao_aprovados/models/marts/dim_tempo.sql)[0m
[0m02:19:03.231307 [error] [MainThread]:   Database Error in model dim_tempo (transformacao_aprovados/models/marts/dim_tempo.sql)
  syntax error at or near "FROM"
  LINE 20:     FROM source
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_tempo.sql
[0m02:19:03.231775 [info ] [MainThread]: 
[0m02:19:03.232324 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/dim_tempo.sql
[0m02:19:03.232836 [info ] [MainThread]: 
[0m02:19:03.233302 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=6 SKIP=1 NO-OP=0 TOTAL=13
[0m02:19:03.234362 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.978322, "process_in_blocks": "0", "process_kernel_time": 0.339814, "process_mem_max_rss": "123896", "process_out_blocks": "2416", "process_user_time": 2.332998}
[0m02:19:03.234832 [debug] [MainThread]: Command `dbt run` failed at 02:19:03.234761 after 3.98 seconds
[0m02:19:03.235224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7cb9bb94c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7cb9bba5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b7cb9bb9760>]}
[0m02:19:03.235586 [debug] [MainThread]: Flushing usage events
[0m02:19:03.935442 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:58:07.207960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76de2d810770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76de2e047bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76de31000680>]}


============================== 14:58:07.211570 | f8fcbcae-9475-4135-92e9-f7591751f2ad ==============================
[0m14:58:07.211570 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:58:07.212176 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': '/home/murilo/.dbt', 'cache_selected_only': 'False', 'no_print': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'use_colors': 'True', 'static_parser': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'introspect': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'version_check': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'warn_error': 'None', 'target_path': 'None', 'write_json': 'True'}
[0m14:58:07.353561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8fcbcae-9475-4135-92e9-f7591751f2ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76de2d1739b0>]}
[0m14:58:07.404251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8fcbcae-9475-4135-92e9-f7591751f2ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76de2cf7d430>]}
[0m14:58:07.405399 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:58:07.514360 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:58:07.619628 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m14:58:07.620490 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/staging/schema.yml
[0m14:58:07.620921 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/dim_tempo.sql
[0m14:58:07.621313 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/dim_escola.sql
[0m14:58:07.621727 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/dim_localizacao.sql
[0m14:58:07.622116 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/dim_situacao.sql
[0m14:58:07.622486 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/fato_matricula.sql
[0m14:58:07.622872 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/dim_turma.sql
[0m14:58:07.623234 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/dim_aluno.sql
[0m14:58:07.907979 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m14:58:07.908522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f8fcbcae-9475-4135-92e9-f7591751f2ad', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76de2b3fbb00>]}
[0m14:58:08.184821 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.transformacao_matricula.facts
- models.transformacao_matricula.intermediate
- models.transformacao_matricula.dimensions
[0m14:58:08.193080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8fcbcae-9475-4135-92e9-f7591751f2ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76de2ab10440>]}
[0m14:58:08.267158 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m14:58:08.269048 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m14:58:08.291134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8fcbcae-9475-4135-92e9-f7591751f2ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76de2b3e9a60>]}
[0m14:58:08.291723 [info ] [MainThread]: Found 13 models, 37 data tests, 1 source, 459 macros
[0m14:58:08.292116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8fcbcae-9475-4135-92e9-f7591751f2ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76de2bb9cb90>]}
[0m14:58:08.294345 [info ] [MainThread]: 
[0m14:58:08.294818 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m14:58:08.295166 [info ] [MainThread]: 
[0m14:58:08.295682 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:58:08.299566 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula'
[0m14:58:08.342888 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m14:58:08.343370 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m14:58:08.343724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:08.346552 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (127.0.0.1), port 5436 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m14:58:08.347443 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m14:58:08.347834 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m14:58:08.348200 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m14:58:08.348520 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m14:58:08.348874 [debug] [ThreadPool]: On list_transformacao_matricula: No close available on handle
[0m14:58:08.350769 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m14:58:08.351294 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m14:58:08.351658 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:08.352342 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (127.0.0.1), port 5436 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m14:58:08.353130 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m14:58:08.353486 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m14:58:08.353866 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m14:58:08.354186 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m14:58:08.354498 [debug] [ThreadPool]: On list_transformacao_matricula: No close available on handle
[0m14:58:08.355069 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:58:08.355429 [debug] [MainThread]: Connection 'list_transformacao_matricula' was properly closed.
[0m14:58:08.355787 [info ] [MainThread]: 
[0m14:58:08.356350 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m14:58:08.357150 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (127.0.0.1), port 5436 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m14:58:08.357701 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 6 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:58:08.358597 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.196737, "process_in_blocks": "66320", "process_kernel_time": 0.335989, "process_mem_max_rss": "124080", "process_out_blocks": "2384", "process_user_time": 2.076115}
[0m14:58:08.359087 [debug] [MainThread]: Command `dbt run` failed at 14:58:08.359009 after 1.20 seconds
[0m14:58:08.359473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76de2d19f830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76de2ab384d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76de2cecac90>]}
[0m14:58:08.359865 [debug] [MainThread]: Flushing usage events
[0m14:58:09.405443 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:58:26.493722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c68e74d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c68e566300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c68e5678f0>]}


============================== 14:58:26.496634 | 6df10ea3-50c3-4652-b675-ca8eef529536 ==============================
[0m14:58:26.496634 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:58:26.497178 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'debug': 'False', 'warn_error': 'None', 'target_path': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'empty': 'None', 'printer_width': '80', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'cache_selected_only': 'False', 'write_json': 'True', 'no_print': 'None', 'use_colors': 'True', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt debug', 'profiles_dir': '/home/murilo/.dbt'}
[0m14:58:26.510378 [info ] [MainThread]: dbt version: 1.10.15
[0m14:58:26.510865 [info ] [MainThread]: python version: 3.12.3
[0m14:58:26.511212 [info ] [MainThread]: python path: /home/murilo/UFPE/BD/Grupo7-BancoDeDados/.venv/bin/python
[0m14:58:26.511548 [info ] [MainThread]: os info: Linux-6.14.0-36-generic-x86_64-with-glibc2.39
[0m14:58:26.562217 [info ] [MainThread]: Using profiles dir at /home/murilo/.dbt
[0m14:58:26.563027 [info ] [MainThread]: Using profiles.yml file at /home/murilo/.dbt/profiles.yml
[0m14:58:26.563633 [info ] [MainThread]: Using dbt_project.yml file at /home/murilo/UFPE/BD/Grupo7-BancoDeDados/dbt_project.yml
[0m14:58:26.564703 [info ] [MainThread]: adapter type: postgres
[0m14:58:26.565489 [info ] [MainThread]: adapter version: 1.9.1
[0m14:58:26.677601 [info ] [MainThread]: Configuration:
[0m14:58:26.678145 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:58:26.678561 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:58:26.678952 [info ] [MainThread]: Required dependencies:
[0m14:58:26.679335 [debug] [MainThread]: Executing "git --help"
[0m14:58:26.682008 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:58:26.682996 [debug] [MainThread]: STDERR: "b''"
[0m14:58:26.683819 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:58:26.684243 [info ] [MainThread]: Connection:
[0m14:58:26.684677 [info ] [MainThread]:   host: localhost
[0m14:58:26.685061 [info ] [MainThread]:   port: 5436
[0m14:58:26.685434 [info ] [MainThread]:   user: postgres
[0m14:58:26.685825 [info ] [MainThread]:   database: transformacao_matricula
[0m14:58:26.686175 [info ] [MainThread]:   schema: staging
[0m14:58:26.686498 [info ] [MainThread]:   connect_timeout: 10
[0m14:58:26.686845 [info ] [MainThread]:   role: None
[0m14:58:26.687166 [info ] [MainThread]:   search_path: None
[0m14:58:26.687491 [info ] [MainThread]:   keepalives_idle: 0
[0m14:58:26.687835 [info ] [MainThread]:   sslmode: None
[0m14:58:26.688160 [info ] [MainThread]:   sslcert: None
[0m14:58:26.688484 [info ] [MainThread]:   sslkey: None
[0m14:58:26.688843 [info ] [MainThread]:   sslrootcert: None
[0m14:58:26.689171 [info ] [MainThread]:   application_name: dbt
[0m14:58:26.689531 [info ] [MainThread]:   retries: 1
[0m14:58:26.690097 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:58:26.801675 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:58:26.827771 [debug] [MainThread]: Using postgres connection "debug"
[0m14:58:26.828253 [debug] [MainThread]: On debug: select 1 as id
[0m14:58:26.828620 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:58:26.829626 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (127.0.0.1), port 5436 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m14:58:26.830478 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m14:58:26.830865 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m14:58:26.831218 [debug] [MainThread]: On debug: No close available on handle
[0m14:58:26.831563 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:58:26.831936 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:58:26.832281 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (127.0.0.1), port 5436 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:58:26.833195 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.38333136, "process_in_blocks": "96", "process_kernel_time": 0.283348, "process_mem_max_rss": "112364", "process_out_blocks": "8", "process_user_time": 1.252122}
[0m14:58:26.833712 [debug] [MainThread]: Command `dbt debug` failed at 14:58:26.833628 after 0.38 seconds
[0m14:58:26.834078 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:58:26.834474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c68e5d7dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c68e1c6cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c6919e0200>]}
[0m14:58:26.834939 [debug] [MainThread]: Flushing usage events
[0m14:58:27.836685 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:58:54.896220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76994483c0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7699460cefc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769943fb2b10>]}


============================== 14:58:54.899854 | eebdf751-e2cd-4cf3-a32a-862ff450ddaf ==============================
[0m14:58:54.899854 [info ] [MainThread]: Running with dbt=1.10.15
[0m14:58:54.900516 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'cache_selected_only': 'False', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'warn_error': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'target_path': 'None', 'profiles_dir': '/home/murilo/.dbt', 'use_colors': 'True', 'printer_width': '80', 'invocation_command': 'dbt run', 'debug': 'False', 'partial_parse': 'True', 'version_check': 'True', 'no_print': 'None', 'log_format': 'default', 'write_json': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True'}
[0m14:58:55.033576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eebdf751-e2cd-4cf3-a32a-862ff450ddaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769942db78f0>]}
[0m14:58:55.082261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eebdf751-e2cd-4cf3-a32a-862ff450ddaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769942d168a0>]}
[0m14:58:55.083120 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:58:55.189673 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m14:58:55.284456 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:58:55.284918 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:58:55.289677 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.transformacao_matricula.facts
- models.transformacao_matricula.intermediate
- models.transformacao_matricula.dimensions
[0m14:58:55.328735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eebdf751-e2cd-4cf3-a32a-862ff450ddaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7699425fde50>]}
[0m14:58:55.403309 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m14:58:55.405077 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m14:58:55.418469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eebdf751-e2cd-4cf3-a32a-862ff450ddaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7699419f0620>]}
[0m14:58:55.419040 [info ] [MainThread]: Found 13 models, 37 data tests, 1 source, 459 macros
[0m14:58:55.419442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eebdf751-e2cd-4cf3-a32a-862ff450ddaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7699429b8b30>]}
[0m14:58:55.421715 [info ] [MainThread]: 
[0m14:58:55.422206 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m14:58:55.422566 [info ] [MainThread]: 
[0m14:58:55.423111 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:58:55.426987 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula'
[0m14:58:55.469843 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m14:58:55.470393 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m14:58:55.470768 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:55.502257 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.031 seconds
[0m14:58:55.504179 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m14:58:55.506524 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m14:58:55.507097 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m14:58:55.507437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:55.519027 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.011 seconds
[0m14:58:55.520523 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m14:58:55.522811 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula, now list_transformacao_matricula_staging_marts)
[0m14:58:55.529264 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m14:58:55.529761 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: BEGIN
[0m14:58:55.530069 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:55.538201 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:58:55.538933 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m14:58:55.539268 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_marts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m14:58:55.546600 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.007 seconds
[0m14:58:55.548831 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: ROLLBACK
[0m14:58:55.549528 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: Close
[0m14:58:55.550164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_marts, now list_transformacao_matricula_staging_staging)
[0m14:58:55.553141 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m14:58:55.553581 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: BEGIN
[0m14:58:55.553924 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:55.562400 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:58:55.563316 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m14:58:55.564025 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_staging"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m14:58:55.567676 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m14:58:55.568949 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: ROLLBACK
[0m14:58:55.570176 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: Close
[0m14:58:55.574367 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:55.574830 [debug] [MainThread]: On master: BEGIN
[0m14:58:55.575140 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:58:55.583856 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:58:55.584320 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:55.584719 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:58:55.591852 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m14:58:55.593458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eebdf751-e2cd-4cf3-a32a-862ff450ddaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7699405333e0>]}
[0m14:58:55.593953 [debug] [MainThread]: On master: ROLLBACK
[0m14:58:55.594717 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:55.595103 [debug] [MainThread]: On master: BEGIN
[0m14:58:55.596168 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:58:55.596921 [debug] [MainThread]: On master: COMMIT
[0m14:58:55.597243 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:55.597548 [debug] [MainThread]: On master: COMMIT
[0m14:58:55.598157 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:58:55.598544 [debug] [MainThread]: On master: Close
[0m14:58:55.601343 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.staging_situacao_alunos
[0m14:58:55.602206 [info ] [Thread-1 (]: 1 of 13 START sql table model staging_staging.staging_situacao_alunos .......... [RUN]
[0m14:58:55.602754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_staging, now model.transformacao_matricula.staging_situacao_alunos)
[0m14:58:55.603144 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.staging_situacao_alunos
[0m14:58:55.609372 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.staging_situacao_alunos"
[0m14:58:55.610145 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.staging_situacao_alunos
[0m14:58:55.650703 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.staging_situacao_alunos"
[0m14:58:55.651509 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m14:58:55.651924 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: BEGIN
[0m14:58:55.652282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:55.661336 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m14:58:55.661875 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m14:58:55.662393 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */

  
    

  create  table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp"
  
  
    as
  
  (
    WITH source AS (
    SELECT * FROM "transformacao_matricula"."staging"."staging_alunos_raw"
),

cleaning_renaming AS (
    SELECT
        ano,
        codigo_escola,
        matricula,
        escola AS nome_escola,
        endereco_logradouro AS endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa,
        modalidade_ensino_codigo AS mod_ens_codigo,
        -- Transformação da SÉRIE
        CASE
            -- Ensino Fundamental (1º ao 9º)
            WHEN serie LIKE '%1 ANO%' OR serie LIKE '%1º ANO%' THEN '1º ANO'
            WHEN serie LIKE '%2 ANO%' OR serie LIKE '%2º ANO%' THEN '2º ANO'
            WHEN serie LIKE '%3 ANO%' OR serie LIKE '%3º ANO%' THEN '3º ANO'
            WHEN serie LIKE '%4 ANO%' OR serie LIKE '%4º ANO%' THEN '4º ANO'
            WHEN serie LIKE '%5 ANO%' OR serie LIKE '%5º ANO%' THEN '5º ANO'
            WHEN serie LIKE '%6 ANO%' OR serie LIKE '%6º ANO%' THEN '6º ANO'
            WHEN serie LIKE '%7 ANO%' OR serie LIKE '%7º ANO%' THEN '7º ANO'
            WHEN serie LIKE '%8 ANO%' OR serie LIKE '%8º ANO%' THEN '8º ANO'
            WHEN serie LIKE '%9 ANO%' OR serie LIKE '%9º ANO%' THEN '9º ANO'
            -- Educação Infantil (Berçário e Grupos)
            WHEN serie LIKE '%BER%' THEN 'BERÇARIO'
            WHEN serie LIKE '%GRUPO I%' OR serie LIKE '%GRUPO 1%' THEN 'GRUPO I'
            WHEN serie LIKE '%GRUPO II%' THEN 'GRUPO II'
            WHEN serie LIKE '%GRUPO III%' THEN 'GRUPO III'
            WHEN serie LIKE '%GRUPO IV%' THEN 'GRUPO IV'
            WHEN serie LIKE '%GRUPO V%' THEN 'GRUPO V'
            -- EJA (Módulos 1 ao 5) 
            WHEN serie LIKE '%1%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 1'
            WHEN serie LIKE '%2%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 2'
            WHEN serie LIKE '%3%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 3'
            WHEN serie LIKE '%4%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 4'
            WHEN serie LIKE '%5%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 5'
            WHEN serie LIKE '%TRAVESSIA%' THEN 'TRAVESSIA RECIFE'
            WHEN serie LIKE '%CORRECAO%1%' THEN 'CORREÇÃO DE FLUXO 1 - ALFABETIZACAO'
            WHEN serie LIKE '%CORRECAO%2%' THEN 'CORREÇÃO DE FLUXO 2 - ACELERACAO'
            ELSE 'OUTROS'
        END AS serie,
        turma,
        turno,
        idade,
        -- transformação do SEXO
        CASE
            WHEN sexo = '1' THEN 'Masculino'
            WHEN sexo = '2' THEN 'Feminino'
            WHEN sexo = '3' THEN 'Outros'
            ELSE 'Não informado'
        END AS sexo,
        -- transformação de situacao
        CASE 
            WHEN situacao_nome LIKE '%APROV%' THEN 'Aprovado'
            WHEN situacao_nome LIKE '%RET%' OR situacao_nome LIKE '%REPRO%' THEN 'Reprovado'
            WHEN situacao_nome LIKE '%TR%' OR situacao_nome LIKE '%REMAN%' THEN 'Transferido'
            WHEN situacao_nome LIKE '%DESIST%' THEN 'Desistente'
            ELSE 'Outros'
        END AS sit_nome,
        -- Transformação da MODALIDADE
        CASE
            WHEN modalidade_ensino LIKE '%EDUCACAO INFANTIL%' THEN 'EDUCAÇÃO INFANTIL'
            WHEN modalidade_ensino LIKE '%ENSINO FUNDAMENTAL%' THEN 'ENSINO FUNDAMENTAL'
            WHEN modalidade_ensino LIKE '%EDUCACAO JOVENS E ADULTOS%' THEN 'EJA'
            WHEN modalidade_ensino LIKE '%CORRE%' THEN 'CORREÇÃO DE FLUXO'
            ELSE 'OUTROS'
        END AS modalidade_ens
    FROM source
)

SELECT * FROM cleaning_renaming
  );
  
[0m14:58:56.352292 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 0.689 seconds
[0m14:58:56.361274 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m14:58:56.361784 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
alter table "transformacao_matricula"."staging_staging"."staging_situacao_alunos" rename to "staging_situacao_alunos__dbt_backup"
[0m14:58:56.362860 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:58:56.365486 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m14:58:56.366020 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
alter table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp" rename to "staging_situacao_alunos"
[0m14:58:56.367052 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:58:56.380471 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: COMMIT
[0m14:58:56.381118 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m14:58:56.381584 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: COMMIT
[0m14:58:56.388078 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m14:58:56.394272 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_backup"
[0m14:58:56.399697 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m14:58:56.400219 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
drop table if exists "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_backup" cascade
[0m14:58:56.406426 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m14:58:56.409456 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: Close
[0m14:58:56.411315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eebdf751-e2cd-4cf3-a32a-862ff450ddaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769945ec2c60>]}
[0m14:58:56.412134 [info ] [Thread-1 (]: 1 of 13 OK created sql table model staging_staging.staging_situacao_alunos ..... [[32mSELECT 319146[0m in 0.81s]
[0m14:58:56.412842 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.staging_situacao_alunos
[0m14:58:56.413329 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_count_aluno_idade
[0m14:58:56.413933 [info ] [Thread-1 (]: 2 of 13 START sql view model staging_marts.view_count_aluno_idade .............. [RUN]
[0m14:58:56.414793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.staging_situacao_alunos, now model.transformacao_matricula.view_count_aluno_idade)
[0m14:58:56.415310 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_count_aluno_idade
[0m14:58:56.419060 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_count_aluno_idade"
[0m14:58:56.420119 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_count_aluno_idade
[0m14:58:56.436961 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_count_aluno_idade"
[0m14:58:56.437936 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m14:58:56.438488 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: BEGIN
[0m14:58:56.439012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:56.448813 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m14:58:56.449478 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m14:58:56.450038 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_count_aluno_idade"} */

  create view "transformacao_matricula"."staging_marts"."view_count_aluno_idade__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dl.desc_rpa,
    da.faixa_etaria,
    COUNT(fm.matricula) AS total_alunos
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
ORDER BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
  );
[0m14:58:56.451675 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 14:     fato_matricula fm
             ^

[0m14:58:56.452292 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: ROLLBACK
[0m14:58:56.453225 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: Close
[0m14:58:56.462954 [debug] [Thread-1 (]: Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  relation "fato_matricula" does not exist
  LINE 14:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m14:58:56.463765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eebdf751-e2cd-4cf3-a32a-862ff450ddaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769940354440>]}
[0m14:58:56.464663 [error] [Thread-1 (]: 2 of 13 ERROR creating sql view model staging_marts.view_count_aluno_idade ..... [[31mERROR[0m in 0.05s]
[0m14:58:56.465551 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_count_aluno_idade
[0m14:58:56.466139 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m14:58:56.466708 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_count_aluno_idade' to be skipped because of status 'error'.  Reason: Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  relation "fato_matricula" does not exist
  LINE 14:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql.
[0m14:58:56.467204 [info ] [Thread-1 (]: 3 of 13 START sql view model staging_marts.view_frequencia_situacao_escola ..... [RUN]
[0m14:58:56.468540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_count_aluno_idade, now model.transformacao_matricula.view_frequencia_situacao_escola)
[0m14:58:56.469040 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_frequencia_situacao_escola
[0m14:58:56.472036 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m14:58:56.472793 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_frequencia_situacao_escola
[0m14:58:56.476113 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m14:58:56.477284 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m14:58:56.477867 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: BEGIN
[0m14:58:56.478267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:56.486931 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m14:58:56.487599 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m14:58:56.488286 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_frequencia_situacao_escola"} */

  create view "transformacao_matricula"."staging_marts"."view_frequencia_situacao_escola__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    de.nome_escola,
    de.codigo_escola,
    ds.situacao_nome,
    COUNT(fm.matricula) AS contagem_situacao
FROM
    fato_matricula fm
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, de.nome_escola, de.codigo_escola, ds.situacao_nome
ORDER BY
    dtemp.ano, de.nome_escola, contagem_situacao DESC
  );
[0m14:58:56.489734 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 15:     fato_matricula fm
             ^

[0m14:58:56.490382 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: ROLLBACK
[0m14:58:56.491376 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: Close
[0m14:58:56.494369 [debug] [Thread-1 (]: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m14:58:56.495239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eebdf751-e2cd-4cf3-a32a-862ff450ddaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76994047d250>]}
[0m14:58:56.496298 [error] [Thread-1 (]: 3 of 13 ERROR creating sql view model staging_marts.view_frequencia_situacao_escola  [[31mERROR[0m in 0.03s]
[0m14:58:56.497346 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m14:58:56.497979 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_matricula_detalhada
[0m14:58:56.498561 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_frequencia_situacao_escola' to be skipped because of status 'error'.  Reason: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql.
[0m14:58:56.499125 [info ] [Thread-1 (]: 4 of 13 START sql view model staging_marts.view_matricula_detalhada ............ [RUN]
[0m14:58:56.499983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_frequencia_situacao_escola, now model.transformacao_matricula.view_matricula_detalhada)
[0m14:58:56.500541 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_matricula_detalhada
[0m14:58:56.503195 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_matricula_detalhada"
[0m14:58:56.504264 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_matricula_detalhada
[0m14:58:56.508112 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_matricula_detalhada"
[0m14:58:56.509080 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m14:58:56.509709 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: BEGIN
[0m14:58:56.510303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:56.521314 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m14:58:56.522012 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m14:58:56.522576 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_matricula_detalhada"} */

  create view "transformacao_matricula"."staging_marts"."view_matricula_detalhada__dbt_tmp"
    
    
  as (
    
SELECT
    fm.matricula,
    da.sexo,
    da.idade,
    da.faixa_etaria,
    de.nome_escola,
    de.codigo_escola,
    dt.turma,
    dt.turno,
    dt.serie,
    dt.modalidade_ensino,
    ds.situacao_nome,
    ds.categoria AS categoria_situacao,
    ds.eh_aprovado,
    ds.eh_reprovado,
    dl.desc_rpa,
    dl.endereco_bairro AS bairro_localizacao,
    dtemp.ano AS ano_registro
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
  );
[0m14:58:56.524004 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 27:     fato_matricula fm
             ^

[0m14:58:56.524662 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: ROLLBACK
[0m14:58:56.525599 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: Close
[0m14:58:56.529322 [debug] [Thread-1 (]: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m14:58:56.530146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eebdf751-e2cd-4cf3-a32a-862ff450ddaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7699425fdca0>]}
[0m14:58:56.530770 [error] [Thread-1 (]: 4 of 13 ERROR creating sql view model staging_marts.view_matricula_detalhada ... [[31mERROR[0m in 0.03s]
[0m14:58:56.531409 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_matricula_detalhada
[0m14:58:56.531894 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_taxa_aprovados
[0m14:58:56.532377 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_matricula_detalhada' to be skipped because of status 'error'.  Reason: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql.
[0m14:58:56.532861 [info ] [Thread-1 (]: 5 of 13 START sql view model staging_marts.view_taxa_aprovados ................. [RUN]
[0m14:58:56.533535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_matricula_detalhada, now model.transformacao_matricula.view_taxa_aprovados)
[0m14:58:56.533988 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_taxa_aprovados
[0m14:58:56.536339 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_taxa_aprovados"
[0m14:58:56.537682 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_taxa_aprovados
[0m14:58:56.541065 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_taxa_aprovados"
[0m14:58:56.541901 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m14:58:56.542346 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: BEGIN
[0m14:58:56.542779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:56.555239 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m14:58:56.555894 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m14:58:56.556421 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_taxa_aprovados"} */

  create view "transformacao_matricula"."staging_marts"."view_taxa_aprovados__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dt.modalidade_ensino,
    COUNT(fm.matricula) AS total_matriculas,
    SUM(ds.eh_aprovado) AS total_aprovados,
    SUM(ds.eh_reprovado) AS total_reprovados,
    -- Calcula a taxa de aprovação (como porcentagem)
    CAST(SUM(ds.eh_aprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_aprovacao_percentual,
    -- Calcula a taxa de reprovação (como porcentagem)
    CAST(SUM(ds.eh_reprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_reprovacao_percentual
FROM
    fato_matricula fm
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dt.modalidade_ensino
ORDER BY
    dtemp.ano, dt.modalidade_ensino
  );
[0m14:58:56.557736 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 19:     fato_matricula fm
             ^

[0m14:58:56.558361 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: ROLLBACK
[0m14:58:56.559299 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: Close
[0m14:58:56.565204 [debug] [Thread-1 (]: Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  relation "fato_matricula" does not exist
  LINE 19:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m14:58:56.565994 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eebdf751-e2cd-4cf3-a32a-862ff450ddaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76994037a660>]}
[0m14:58:56.566828 [error] [Thread-1 (]: 5 of 13 ERROR creating sql view model staging_marts.view_taxa_aprovados ........ [[31mERROR[0m in 0.03s]
[0m14:58:56.567646 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_taxa_aprovados
[0m14:58:56.568256 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_aluno
[0m14:58:56.568896 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_taxa_aprovados' to be skipped because of status 'error'.  Reason: Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  relation "fato_matricula" does not exist
  LINE 19:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql.
[0m14:58:56.569597 [info ] [Thread-1 (]: 6 of 13 START sql table model staging_marts.dim_aluno .......................... [RUN]
[0m14:58:56.570535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_taxa_aprovados, now model.transformacao_matricula.dim_aluno)
[0m14:58:56.571149 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_aluno
[0m14:58:56.574779 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_aluno"
[0m14:58:56.575649 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_aluno
[0m14:58:56.581983 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_aluno"
[0m14:58:56.582977 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m14:58:56.583560 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: BEGIN
[0m14:58:56.584099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:56.593450 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m14:58:56.594119 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m14:58:56.594504 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_aluno"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."dim_aluno__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_staging"."staging_situacao_alunos" 
),
alunos AS (
    SELECT DISTINCT
        matricula,
        sexo,
        idade,
        CASE
            WHEN idade <= 3 THEN '0-3 Anos (Educação Infantil)'
            WHEN idade <= 5 THEN '4-5 Anos (Pré-escola)'
            WHEN idade <= 10 THEN '6-10 Anos (Fundamental I)'
            WHEN idade <= 14 THEN '11-14 Anos (Fundamental II)'
            WHEN idade >= 15 THEN '15+ Anos (EJA e Outros)'
            ELSE 'Não Informado'
        END AS faixa_etaria
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY matricula) - 1 AS id_aluno, -- Surrogate Key
        matricula,
        sexo,
        idade,
        faixa_etaria
    FROM alunos_unicos
)

SELECT * FROM versao_final
  );
  
[0m14:58:56.596205 [debug] [Thread-1 (]: Postgres adapter: Postgres error: operator does not exist: text <= integer
LINE 23:             WHEN idade <= 3 THEN '0-3 Anos (Educação Infanti...
                                ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m14:58:56.596723 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: ROLLBACK
[0m14:58:56.597546 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: Close
[0m14:58:56.599816 [debug] [Thread-1 (]: Database Error in model dim_aluno (transformacao_aprovados/models/marts/dim_aluno.sql)
  operator does not exist: text <= integer
  LINE 23:             WHEN idade <= 3 THEN '0-3 Anos (Educação Infanti...
                                  ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_aluno.sql
[0m14:58:56.600532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eebdf751-e2cd-4cf3-a32a-862ff450ddaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76994021c740>]}
[0m14:58:56.601468 [error] [Thread-1 (]: 6 of 13 ERROR creating sql table model staging_marts.dim_aluno ................. [[31mERROR[0m in 0.03s]
[0m14:58:56.602129 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_aluno
[0m14:58:56.602658 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.transform_data
[0m14:58:56.603158 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.dim_aluno' to be skipped because of status 'error'.  Reason: Database Error in model dim_aluno (transformacao_aprovados/models/marts/dim_aluno.sql)
  operator does not exist: text <= integer
  LINE 23:             WHEN idade <= 3 THEN '0-3 Anos (Educação Infanti...
                                  ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_aluno.sql.
[0m14:58:56.603655 [info ] [Thread-1 (]: 7 of 13 START sql table model staging_marts.transform_data ..................... [RUN]
[0m14:58:56.604366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_aluno, now model.transformacao_matricula.transform_data)
[0m14:58:56.604835 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.transform_data
[0m14:58:56.679563 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.transform_data"
[0m14:58:56.680492 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.transform_data
[0m14:58:56.684910 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.transform_data"
[0m14:58:56.685890 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m14:58:56.686465 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: BEGIN
[0m14:58:56.686994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:56.697010 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m14:58:56.697703 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m14:58:56.698310 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."transform_data__dbt_tmp"
  
  
    as
  
  (
    

with staged_data AS (
    SELECT * FROM "transformacao_matricula"."staging_staging"."staging_situacao_alunos"
),

transformed_data AS (
    SELECT
        CAST(ano AS INTEGER) AS ano,
        CAST(codigo_escola AS INTEGER) AS codigo_escola,
        CAST(matricula AS INTEGER) AS matricula,
        nome_escola,
        endereco_logra,
        endereco_bairro,
        endereco_numero,
        CAST(rpa AS INTEGER) AS rpa,
        CAST(mod_ens_codigo AS INTEGER) AS mod_ens_codigo,
        serie,
        turma,
        turno,
        CAST(idade AS INTEGER) AS idade,
        sexo,
        sit_nome AS situacao_nome,
        modalidade_ens,
        CASE
            WHEN CAST(idade AS INTEGER) <= 3 THEN '0-3 Anos (Educação Infantil)'
            WHEN CAST(idade AS INTEGER) <= 5 THEN '4-5 Anos (Pré-escola)'
            WHEN CAST(idade AS INTEGER) <= 10 THEN '6-10 Anos (Fundamental I)'
            WHEN CAST(idade AS INTEGER) <= 14 THEN '11-14 Anos (Fundamental II)'
            WHEN CAST(idade AS INTEGER) >= 15 THEN '15+ Anos (EJA e Outros)'
            ELSE 'Não Informado'
        END AS faixa_etaria
    FROM staged_data
)

SELECT * FROM transformed_data
  );
  
[0m14:58:57.226856 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 0.528 seconds
[0m14:58:57.229843 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m14:58:57.230282 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
alter table "transformacao_matricula"."staging_marts"."transform_data" rename to "transform_data__dbt_backup"
[0m14:58:57.231180 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:58:57.233704 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m14:58:57.234164 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
alter table "transformacao_matricula"."staging_marts"."transform_data__dbt_tmp" rename to "transform_data"
[0m14:58:57.234961 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:58:57.236670 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: COMMIT
[0m14:58:57.237085 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m14:58:57.237427 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: COMMIT
[0m14:58:57.246206 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m14:58:57.248316 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."transform_data__dbt_backup"
[0m14:58:57.249199 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m14:58:57.249586 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
drop table if exists "transformacao_matricula"."staging_marts"."transform_data__dbt_backup" cascade
[0m14:58:57.255648 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m14:58:57.257006 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: Close
[0m14:58:57.257736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eebdf751-e2cd-4cf3-a32a-862ff450ddaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7699404a3350>]}
[0m14:58:57.258643 [info ] [Thread-1 (]: 7 of 13 OK created sql table model staging_marts.transform_data ................ [[32mSELECT 319146[0m in 0.65s]
[0m14:58:57.259412 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.transform_data
[0m14:58:57.260516 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_escola
[0m14:58:57.261185 [info ] [Thread-1 (]: 8 of 13 START sql table model staging_marts.dim_escola ......................... [RUN]
[0m14:58:57.261787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.transform_data, now model.transformacao_matricula.dim_escola)
[0m14:58:57.262297 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_escola
[0m14:58:57.265083 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_escola"
[0m14:58:57.265781 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_escola
[0m14:58:57.268913 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_escola"
[0m14:58:57.269650 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m14:58:57.270059 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: BEGIN
[0m14:58:57.270418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:57.280315 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m14:58:57.280986 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m14:58:57.281533 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."dim_escola__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
),
escolas_unicas AS (
    SELECT DISTINCT
        codigo_escola,
        nome_escola,
        endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY codigo_escola) - 1 AS id_escola, -- Surrogate Key
        codigo_escola,
        nome_escola,
        endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa
    FROM escolas_unicas
)

SELECT * FROM versao_final
  );
  
[0m14:58:57.443626 [debug] [Thread-1 (]: SQL status: SELECT 433 in 0.161 seconds
[0m14:58:57.446410 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m14:58:57.446860 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */
alter table "transformacao_matricula"."staging_marts"."dim_escola" rename to "dim_escola__dbt_backup"
[0m14:58:57.447841 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:58:57.450301 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m14:58:57.450747 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */
alter table "transformacao_matricula"."staging_marts"."dim_escola__dbt_tmp" rename to "dim_escola"
[0m14:58:57.451703 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:58:57.453358 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: COMMIT
[0m14:58:57.453816 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m14:58:57.454168 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: COMMIT
[0m14:58:57.460775 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m14:58:57.462863 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."dim_escola__dbt_backup"
[0m14:58:57.463754 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m14:58:57.464133 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */
drop table if exists "transformacao_matricula"."staging_marts"."dim_escola__dbt_backup" cascade
[0m14:58:57.467429 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:58:57.468765 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: Close
[0m14:58:57.469366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eebdf751-e2cd-4cf3-a32a-862ff450ddaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7699404a3680>]}
[0m14:58:57.470049 [info ] [Thread-1 (]: 8 of 13 OK created sql table model staging_marts.dim_escola .................... [[32mSELECT 433[0m in 0.21s]
[0m14:58:57.470707 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_escola
[0m14:58:57.471186 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_localizacao
[0m14:58:57.471800 [info ] [Thread-1 (]: 9 of 13 START sql table model staging_marts.dim_localizacao .................... [RUN]
[0m14:58:57.472352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_escola, now model.transformacao_matricula.dim_localizacao)
[0m14:58:57.472808 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_localizacao
[0m14:58:57.477171 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_localizacao"
[0m14:58:57.477922 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_localizacao
[0m14:58:57.481353 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_localizacao"
[0m14:58:57.482166 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m14:58:57.482600 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: BEGIN
[0m14:58:57.482976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:57.492426 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m14:58:57.493091 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m14:58:57.493634 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."dim_localizacao__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
),
localizacoes_unicas AS (
    SELECT DISTINCT
        rpa,
        endereco_bairro,
        CASE rpa
            WHEN 1 THEN 'RPA 1 (Centro)'
            WHEN 2 THEN 'RPA 2 (Zona Norte)'
            WHEN 3 THEN 'RPA 3 (Zona Oeste)'
            WHEN 4 THEN 'RPA 4 (Zona Sudoeste)'
            WHEN 5 THEN 'RPA 5 (Zona Sul)'
            WHEN 6 THEN 'RPA 6 (Zona Sudeste)'
            ELSE 'RPA Não Identificada'
        END AS desc_rpa
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY rpa, endereco_bairro) - 1 AS id_locali, -- Surrogate Key
        rpa,
        endereco_bairro,
        desc_rpa
    FROM localizacoes_unicas
)

SELECT * FROM versao_final
  );
  
[0m14:58:57.608547 [debug] [Thread-1 (]: SQL status: SELECT 88 in 0.114 seconds
[0m14:58:57.611464 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m14:58:57.611926 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */
alter table "transformacao_matricula"."staging_marts"."dim_localizacao" rename to "dim_localizacao__dbt_backup"
[0m14:58:57.613108 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:58:57.615626 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m14:58:57.616078 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */
alter table "transformacao_matricula"."staging_marts"."dim_localizacao__dbt_tmp" rename to "dim_localizacao"
[0m14:58:57.617161 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:58:57.618830 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: COMMIT
[0m14:58:57.619251 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m14:58:57.619623 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: COMMIT
[0m14:58:57.621651 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:58:57.623793 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."dim_localizacao__dbt_backup"
[0m14:58:57.624669 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m14:58:57.625045 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */
drop table if exists "transformacao_matricula"."staging_marts"."dim_localizacao__dbt_backup" cascade
[0m14:58:57.629325 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m14:58:57.630857 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: Close
[0m14:58:57.631455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eebdf751-e2cd-4cf3-a32a-862ff450ddaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7699403f5160>]}
[0m14:58:57.632089 [info ] [Thread-1 (]: 9 of 13 OK created sql table model staging_marts.dim_localizacao ............... [[32mSELECT 88[0m in 0.16s]
[0m14:58:57.632712 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_localizacao
[0m14:58:57.633168 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_situacao
[0m14:58:57.633805 [info ] [Thread-1 (]: 10 of 13 START sql table model staging_marts.dim_situacao ...................... [RUN]
[0m14:58:57.634386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_localizacao, now model.transformacao_matricula.dim_situacao)
[0m14:58:57.634853 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_situacao
[0m14:58:57.637335 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_situacao"
[0m14:58:57.638044 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_situacao
[0m14:58:57.642567 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_situacao"
[0m14:58:57.643597 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m14:58:57.644240 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: BEGIN
[0m14:58:57.644828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:57.655307 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m14:58:57.656047 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m14:58:57.656706 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."dim_situacao__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
),
situacoes_unicas AS (
    SELECT DISTINCT
        situacao_nome,
        CASE 
            WHEN situacao_nome = 'Aprovado' THEN 'APROVADO'
            WHEN situacao_nome = 'Reprovado' THEN 'REPROVADO'
            WHEN situacao_nome = 'Transferido' THEN 'TRANSFERIDO'
            WHEN situacao_nome = 'Desistente' THEN 'DESISTENTE'
            ELSE 'OUTROS'
        END AS categoria,
        CASE 
            WHEN situacao_nome = 'Aprovado' THEN 1
            ELSE 0
        END AS eh_aprovado,
        CASE 
            WHEN situacao_nome = 'Reprovado' THEN 1
            ELSE 0
        END AS eh_reprovado
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY situacao_nome) - 1 AS id_situacao, -- Surrogate Key
        situacao_nome,
        categoria,
        eh_aprovado,
        eh_reprovado
    FROM situacoes_unicas
)

SELECT * FROM versao_final
  );
  
[0m14:58:57.728845 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.072 seconds
[0m14:58:57.732241 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m14:58:57.732735 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */
alter table "transformacao_matricula"."staging_marts"."dim_situacao" rename to "dim_situacao__dbt_backup"
[0m14:58:57.733730 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:58:57.736460 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m14:58:57.736957 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */
alter table "transformacao_matricula"."staging_marts"."dim_situacao__dbt_tmp" rename to "dim_situacao"
[0m14:58:57.737916 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:58:57.739546 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: COMMIT
[0m14:58:57.739963 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m14:58:57.740309 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: COMMIT
[0m14:58:57.742458 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:58:57.744473 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."dim_situacao__dbt_backup"
[0m14:58:57.745319 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m14:58:57.745701 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */
drop table if exists "transformacao_matricula"."staging_marts"."dim_situacao__dbt_backup" cascade
[0m14:58:57.748708 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:58:57.750038 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: Close
[0m14:58:57.750683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eebdf751-e2cd-4cf3-a32a-862ff450ddaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7699403f0530>]}
[0m14:58:57.751330 [info ] [Thread-1 (]: 10 of 13 OK created sql table model staging_marts.dim_situacao ................. [[32mSELECT 5[0m in 0.12s]
[0m14:58:57.751945 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_situacao
[0m14:58:57.752373 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_tempo
[0m14:58:57.752953 [info ] [Thread-1 (]: 11 of 13 START sql table model staging_marts.dim_tempo ......................... [RUN]
[0m14:58:57.753453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_situacao, now model.transformacao_matricula.dim_tempo)
[0m14:58:57.753887 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_tempo
[0m14:58:57.757984 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_tempo"
[0m14:58:57.758686 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_tempo
[0m14:58:57.761745 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_tempo"
[0m14:58:57.762493 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m14:58:57.762931 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: BEGIN
[0m14:58:57.763292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:57.774225 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m14:58:57.774884 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m14:58:57.775442 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."dim_tempo__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
),
tempo_unico AS (
    SELECT DISTINCT
        ano,
        'Registro Anual' AS ano_ensino
    FROM source
)

SELECT * FROM tempo_unico
  );
  
[0m14:58:57.840506 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.064 seconds
[0m14:58:57.843392 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m14:58:57.843883 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */
alter table "transformacao_matricula"."staging_marts"."dim_tempo__dbt_tmp" rename to "dim_tempo"
[0m14:58:57.844884 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:58:57.846386 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: COMMIT
[0m14:58:57.846833 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m14:58:57.847196 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: COMMIT
[0m14:58:57.848952 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:58:57.851055 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."dim_tempo__dbt_backup"
[0m14:58:57.851936 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m14:58:57.852323 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */
drop table if exists "transformacao_matricula"."staging_marts"."dim_tempo__dbt_backup" cascade
[0m14:58:57.853241 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:58:57.854534 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: Close
[0m14:58:57.855184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eebdf751-e2cd-4cf3-a32a-862ff450ddaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769945e35a90>]}
[0m14:58:57.855873 [info ] [Thread-1 (]: 11 of 13 OK created sql table model staging_marts.dim_tempo .................... [[32mSELECT 3[0m in 0.10s]
[0m14:58:57.856498 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_tempo
[0m14:58:57.856951 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_turma
[0m14:58:57.857552 [info ] [Thread-1 (]: 12 of 13 START sql table model staging_marts.dim_turma ......................... [RUN]
[0m14:58:57.858109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_tempo, now model.transformacao_matricula.dim_turma)
[0m14:58:57.858521 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_turma
[0m14:58:57.860966 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_turma"
[0m14:58:57.861628 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_turma
[0m14:58:57.864870 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_turma"
[0m14:58:57.866174 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m14:58:57.866602 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: BEGIN
[0m14:58:57.866974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:57.877228 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m14:58:57.877920 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m14:58:57.878484 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."dim_turma__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
),
turmas_unicas AS (
    SELECT DISTINCT
        turma,
        turno,
        serie,
        mod_ens_codigo,
        modalidade_ens
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY turma, turno, serie) - 1 AS id_turma,
        turma,
        turno,
        serie_codigo DEFAULT NULL,
        serie,
        mod_ens_codigo,
        modalidade_ens AS modalidade_ensino
    FROM turmas_unicas
)

SELECT * FROM versao_final
  );
  
[0m14:58:57.879577 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "NULL"
LINE 31:         serie_codigo DEFAULT NULL,
                                      ^

[0m14:58:57.880245 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: ROLLBACK
[0m14:58:57.881239 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: Close
[0m14:58:57.887185 [debug] [Thread-1 (]: Database Error in model dim_turma (transformacao_aprovados/models/marts/dim_turma.sql)
  syntax error at or near "NULL"
  LINE 31:         serie_codigo DEFAULT NULL,
                                        ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_turma.sql
[0m14:58:57.887968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eebdf751-e2cd-4cf3-a32a-862ff450ddaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7699404a2720>]}
[0m14:58:57.888839 [error] [Thread-1 (]: 12 of 13 ERROR creating sql table model staging_marts.dim_turma ................ [[31mERROR[0m in 0.03s]
[0m14:58:57.889672 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_turma
[0m14:58:57.890410 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.dim_turma' to be skipped because of status 'error'.  Reason: Database Error in model dim_turma (transformacao_aprovados/models/marts/dim_turma.sql)
  syntax error at or near "NULL"
  LINE 31:         serie_codigo DEFAULT NULL,
                                        ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_turma.sql.
[0m14:58:57.892293 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.fato_matricula
[0m14:58:57.892936 [info ] [Thread-1 (]: 13 of 13 SKIP relation staging_marts.fato_matricula ............................ [[33mSKIP[0m]
[0m14:58:57.893567 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.fato_matricula
[0m14:58:57.895266 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:57.895998 [debug] [MainThread]: On master: BEGIN
[0m14:58:57.896557 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:58:57.906772 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m14:58:57.907396 [debug] [MainThread]: On master: COMMIT
[0m14:58:57.907967 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:57.908448 [debug] [MainThread]: On master: COMMIT
[0m14:58:57.909309 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:58:57.909881 [debug] [MainThread]: On master: Close
[0m14:58:57.910681 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:58:57.911205 [debug] [MainThread]: Connection 'model.transformacao_matricula.dim_turma' was properly closed.
[0m14:58:57.912054 [info ] [MainThread]: 
[0m14:58:57.912759 [info ] [MainThread]: Finished running 9 table models, 4 view models in 0 hours 0 minutes and 2.49 seconds (2.49s).
[0m14:58:57.915848 [debug] [MainThread]: Command end result
[0m14:58:57.943937 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m14:58:57.945871 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m14:58:57.953936 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m14:58:57.954572 [info ] [MainThread]: 
[0m14:58:57.955203 [info ] [MainThread]: [31mCompleted with 6 errors, 0 partial successes, and 0 warnings:[0m
[0m14:58:57.955871 [info ] [MainThread]: 
[0m14:58:57.956579 [error] [MainThread]: [31mFailure in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)[0m
[0m14:58:57.957293 [error] [MainThread]:   Database Error in model view_count_aluno_idade (transformacao_aprovados/models/marts/view_count_aluno_idade.sql)
  relation "fato_matricula" does not exist
  LINE 14:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m14:58:57.957917 [info ] [MainThread]: 
[0m14:58:57.958617 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m14:58:57.959248 [info ] [MainThread]: 
[0m14:58:57.960022 [error] [MainThread]: [31mFailure in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)[0m
[0m14:58:57.960829 [error] [MainThread]:   Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m14:58:57.961633 [info ] [MainThread]: 
[0m14:58:57.962405 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m14:58:57.963081 [info ] [MainThread]: 
[0m14:58:57.963802 [error] [MainThread]: [31mFailure in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)[0m
[0m14:58:57.964570 [error] [MainThread]:   Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m14:58:57.965201 [info ] [MainThread]: 
[0m14:58:57.965846 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m14:58:57.966450 [info ] [MainThread]: 
[0m14:58:57.967500 [error] [MainThread]: [31mFailure in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)[0m
[0m14:58:57.968323 [error] [MainThread]:   Database Error in model view_taxa_aprovados (transformacao_aprovados/models/marts/view_taxa_aprovados.sql)
  relation "fato_matricula" does not exist
  LINE 19:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m14:58:57.969005 [info ] [MainThread]: 
[0m14:58:57.969724 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m14:58:57.970390 [info ] [MainThread]: 
[0m14:58:57.971147 [error] [MainThread]: [31mFailure in model dim_aluno (transformacao_aprovados/models/marts/dim_aluno.sql)[0m
[0m14:58:57.972001 [error] [MainThread]:   Database Error in model dim_aluno (transformacao_aprovados/models/marts/dim_aluno.sql)
  operator does not exist: text <= integer
  LINE 23:             WHEN idade <= 3 THEN '0-3 Anos (Educação Infanti...
                                  ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_aluno.sql
[0m14:58:57.972724 [info ] [MainThread]: 
[0m14:58:57.973303 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/dim_aluno.sql
[0m14:58:57.973999 [info ] [MainThread]: 
[0m14:58:57.974699 [error] [MainThread]: [31mFailure in model dim_turma (transformacao_aprovados/models/marts/dim_turma.sql)[0m
[0m14:58:57.975408 [error] [MainThread]:   Database Error in model dim_turma (transformacao_aprovados/models/marts/dim_turma.sql)
  syntax error at or near "NULL"
  LINE 31:         serie_codigo DEFAULT NULL,
                                        ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_turma.sql
[0m14:58:57.976120 [info ] [MainThread]: 
[0m14:58:57.976918 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/dim_turma.sql
[0m14:58:57.977695 [info ] [MainThread]: 
[0m14:58:57.978471 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=6 SKIP=1 NO-OP=0 TOTAL=13
[0m14:58:57.980030 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.1289644, "process_in_blocks": "5640", "process_kernel_time": 0.349731, "process_mem_max_rss": "124248", "process_out_blocks": "2864", "process_user_time": 2.1233}
[0m14:58:57.980864 [debug] [MainThread]: Command `dbt run` failed at 14:58:57.980750 after 3.13 seconds
[0m14:58:57.981561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769943b67b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769943eb38c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7699404a0e60>]}
[0m14:58:57.982359 [debug] [MainThread]: Flushing usage events
[0m14:59:00.169011 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:05:44.302934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724adb1329f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724ad7cd78c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724ada29f170>]}


============================== 15:05:44.306774 | 17907009-cc5b-4ef4-9730-773b8c41d009 ==============================
[0m15:05:44.306774 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:05:44.307364 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'partial_parse': 'True', 'target_path': 'None', 'profiles_dir': '/home/murilo/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'version_check': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'static_parser': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'empty': 'False', 'log_format': 'default', 'debug': 'False', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'indirect_selection': 'eager'}
[0m15:05:44.451584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17907009-cc5b-4ef4-9730-773b8c41d009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724ad86c49e0>]}
[0m15:05:44.500431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17907009-cc5b-4ef4-9730-773b8c41d009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724ad7fb5490>]}
[0m15:05:44.501315 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:05:44.609479 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:05:44.705282 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m15:05:44.706151 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/fato_matricula.sql
[0m15:05:44.706550 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/dim_escola.sql
[0m15:05:44.706990 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/dim_tempo.sql
[0m15:05:44.707391 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/view_taxa_aprovados.sql
[0m15:05:44.707838 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/dim_situacao.sql
[0m15:05:44.708259 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/dim_aluno.sql
[0m15:05:44.708695 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/dim_turma.sql
[0m15:05:44.709096 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/view_count_aluno_idade.sql
[0m15:05:44.709524 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/marts/dim_localizacao.sql
[0m15:05:45.001198 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m15:05:45.001797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '17907009-cc5b-4ef4-9730-773b8c41d009', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724ad5d97a70>]}
[0m15:05:45.139160 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.transformacao_matricula.dimensions
- models.transformacao_matricula.facts
- models.transformacao_matricula.intermediate
[0m15:05:45.224728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17907009-cc5b-4ef4-9730-773b8c41d009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724ad59836e0>]}
[0m15:05:45.295986 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m15:05:45.297909 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m15:05:45.311401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17907009-cc5b-4ef4-9730-773b8c41d009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724ad699b230>]}
[0m15:05:45.311990 [info ] [MainThread]: Found 13 models, 37 data tests, 1 source, 459 macros
[0m15:05:45.312387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17907009-cc5b-4ef4-9730-773b8c41d009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724ad59e3950>]}
[0m15:05:45.314683 [info ] [MainThread]: 
[0m15:05:45.315165 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m15:05:45.315515 [info ] [MainThread]: 
[0m15:05:45.316046 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:05:45.320002 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula'
[0m15:05:45.360800 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m15:05:45.361275 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m15:05:45.361602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:45.372476 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.011 seconds
[0m15:05:45.373824 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m15:05:45.376037 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m15:05:45.376617 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m15:05:45.377073 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:45.386237 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.009 seconds
[0m15:05:45.387860 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m15:05:45.389896 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m15:05:45.390486 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m15:05:45.390865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:45.399002 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m15:05:45.400175 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m15:05:45.401058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula, now create_transformacao_matricula_staging_dimensions)
[0m15:05:45.401646 [debug] [ThreadPool]: Creating schema "database: "transformacao_matricula"
schema: "staging_dimensions"
"
[0m15:05:45.406131 [debug] [ThreadPool]: Using postgres connection "create_transformacao_matricula_staging_dimensions"
[0m15:05:45.406582 [debug] [ThreadPool]: On create_transformacao_matricula_staging_dimensions: BEGIN
[0m15:05:45.406908 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:45.417137 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m15:05:45.417966 [debug] [ThreadPool]: Using postgres connection "create_transformacao_matricula_staging_dimensions"
[0m15:05:45.418385 [debug] [ThreadPool]: On create_transformacao_matricula_staging_dimensions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "create_transformacao_matricula_staging_dimensions"} */
create schema if not exists "staging_dimensions"
[0m15:05:45.421482 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.003 seconds
[0m15:05:45.422649 [debug] [ThreadPool]: On create_transformacao_matricula_staging_dimensions: COMMIT
[0m15:05:45.423270 [debug] [ThreadPool]: Using postgres connection "create_transformacao_matricula_staging_dimensions"
[0m15:05:45.423585 [debug] [ThreadPool]: On create_transformacao_matricula_staging_dimensions: COMMIT
[0m15:05:45.425368 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m15:05:45.425821 [debug] [ThreadPool]: On create_transformacao_matricula_staging_dimensions: Close
[0m15:05:45.428723 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_transformacao_matricula_staging_dimensions, now list_transformacao_matricula_staging_marts)
[0m15:05:45.433770 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m15:05:45.434221 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: BEGIN
[0m15:05:45.434532 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:45.443674 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:05:45.444134 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m15:05:45.444470 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_marts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m15:05:45.447331 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m15:05:45.448747 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: ROLLBACK
[0m15:05:45.449522 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: Close
[0m15:05:45.450134 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_marts, now list_transformacao_matricula_staging_dimensions)
[0m15:05:45.454368 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_dimensions"
[0m15:05:45.454863 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: BEGIN
[0m15:05:45.455174 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:45.466021 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m15:05:45.466889 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_dimensions"
[0m15:05:45.467394 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_dimensions"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dimensions'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dimensions'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dimensions'
  
[0m15:05:45.471272 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m15:05:45.473361 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: ROLLBACK
[0m15:05:45.474081 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: Close
[0m15:05:45.474689 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_dimensions, now list_transformacao_matricula_staging_staging)
[0m15:05:45.476446 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m15:05:45.476850 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: BEGIN
[0m15:05:45.477152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:45.486884 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m15:05:45.487338 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m15:05:45.487695 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_staging"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m15:05:45.490568 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m15:05:45.491863 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: ROLLBACK
[0m15:05:45.492644 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: Close
[0m15:05:45.497915 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:45.498361 [debug] [MainThread]: On master: BEGIN
[0m15:05:45.498682 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:05:45.506975 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:05:45.507440 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:45.507813 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:05:45.511064 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m15:05:45.512246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17907009-cc5b-4ef4-9730-773b8c41d009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724ad555cb90>]}
[0m15:05:45.512743 [debug] [MainThread]: On master: ROLLBACK
[0m15:05:45.513489 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:45.513880 [debug] [MainThread]: On master: BEGIN
[0m15:05:45.514699 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:05:45.515097 [debug] [MainThread]: On master: COMMIT
[0m15:05:45.515421 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:45.515744 [debug] [MainThread]: On master: COMMIT
[0m15:05:45.516318 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:05:45.516717 [debug] [MainThread]: On master: Close
[0m15:05:45.519130 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.staging_situacao_alunos
[0m15:05:45.520346 [info ] [Thread-1 (]: 1 of 13 START sql table model staging_staging.staging_situacao_alunos .......... [RUN]
[0m15:05:45.520909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_staging, now model.transformacao_matricula.staging_situacao_alunos)
[0m15:05:45.521305 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.staging_situacao_alunos
[0m15:05:45.528856 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.staging_situacao_alunos"
[0m15:05:45.529719 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.staging_situacao_alunos
[0m15:05:45.573178 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.staging_situacao_alunos"
[0m15:05:45.574166 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:05:45.574628 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: BEGIN
[0m15:05:45.575030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:45.583234 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:05:45.584187 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:05:45.584837 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */

  
    

  create  table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp"
  
  
    as
  
  (
    WITH source AS (
    SELECT * FROM "transformacao_matricula"."staging"."staging_alunos_raw"
),

cleaning_renaming AS (
    SELECT
        ano,
        codigo_escola,
        matricula,
        escola AS nome_escola,
        endereco_logradouro AS endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa,
        modalidade_ensino_codigo AS mod_ens_codigo,
        -- Transformação da SÉRIE
        CASE
            -- Ensino Fundamental (1º ao 9º)
            WHEN serie LIKE '%1 ANO%' OR serie LIKE '%1º ANO%' THEN '1º ANO'
            WHEN serie LIKE '%2 ANO%' OR serie LIKE '%2º ANO%' THEN '2º ANO'
            WHEN serie LIKE '%3 ANO%' OR serie LIKE '%3º ANO%' THEN '3º ANO'
            WHEN serie LIKE '%4 ANO%' OR serie LIKE '%4º ANO%' THEN '4º ANO'
            WHEN serie LIKE '%5 ANO%' OR serie LIKE '%5º ANO%' THEN '5º ANO'
            WHEN serie LIKE '%6 ANO%' OR serie LIKE '%6º ANO%' THEN '6º ANO'
            WHEN serie LIKE '%7 ANO%' OR serie LIKE '%7º ANO%' THEN '7º ANO'
            WHEN serie LIKE '%8 ANO%' OR serie LIKE '%8º ANO%' THEN '8º ANO'
            WHEN serie LIKE '%9 ANO%' OR serie LIKE '%9º ANO%' THEN '9º ANO'
            -- Educação Infantil (Berçário e Grupos)
            WHEN serie LIKE '%BER%' THEN 'BERÇARIO'
            WHEN serie LIKE '%GRUPO I%' OR serie LIKE '%GRUPO 1%' THEN 'GRUPO I'
            WHEN serie LIKE '%GRUPO II%' THEN 'GRUPO II'
            WHEN serie LIKE '%GRUPO III%' THEN 'GRUPO III'
            WHEN serie LIKE '%GRUPO IV%' THEN 'GRUPO IV'
            WHEN serie LIKE '%GRUPO V%' THEN 'GRUPO V'
            -- EJA (Módulos 1 ao 5) 
            WHEN serie LIKE '%1%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 1'
            WHEN serie LIKE '%2%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 2'
            WHEN serie LIKE '%3%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 3'
            WHEN serie LIKE '%4%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 4'
            WHEN serie LIKE '%5%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 5'
            WHEN serie LIKE '%TRAVESSIA%' THEN 'TRAVESSIA RECIFE'
            WHEN serie LIKE '%CORRECAO%1%' THEN 'CORREÇÃO DE FLUXO 1 - ALFABETIZACAO'
            WHEN serie LIKE '%CORRECAO%2%' THEN 'CORREÇÃO DE FLUXO 2 - ACELERACAO'
            ELSE 'OUTROS'
        END AS serie,
        turma,
        turno,
        idade,
        -- transformação do SEXO
        CASE
            WHEN sexo = '1' THEN 'Masculino'
            WHEN sexo = '2' THEN 'Feminino'
            WHEN sexo = '3' THEN 'Outros'
            ELSE 'Não informado'
        END AS sexo,
        -- transformação de situacao
        CASE 
            WHEN situacao_nome LIKE '%APROV%' THEN 'Aprovado'
            WHEN situacao_nome LIKE '%RET%' OR situacao_nome LIKE '%REPRO%' THEN 'Reprovado'
            WHEN situacao_nome LIKE '%TR%' OR situacao_nome LIKE '%REMAN%' THEN 'Transferido'
            WHEN situacao_nome LIKE '%DESIST%' THEN 'Desistente'
            ELSE 'Outros'
        END AS sit_nome,
        -- Transformação da MODALIDADE
        CASE
            WHEN modalidade_ensino LIKE '%EDUCACAO INFANTIL%' THEN 'EDUCAÇÃO INFANTIL'
            WHEN modalidade_ensino LIKE '%ENSINO FUNDAMENTAL%' THEN 'ENSINO FUNDAMENTAL'
            WHEN modalidade_ensino LIKE '%EDUCACAO JOVENS E ADULTOS%' THEN 'EJA'
            WHEN modalidade_ensino LIKE '%CORRE%' THEN 'CORREÇÃO DE FLUXO'
            ELSE 'OUTROS'
        END AS modalidade_ens
    FROM source
)

SELECT * FROM cleaning_renaming
  );
  
[0m15:05:46.222896 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 0.637 seconds
[0m15:05:46.231146 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:05:46.231656 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
alter table "transformacao_matricula"."staging_staging"."staging_situacao_alunos" rename to "staging_situacao_alunos__dbt_backup"
[0m15:05:46.232768 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:05:46.235321 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:05:46.235802 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
alter table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp" rename to "staging_situacao_alunos"
[0m15:05:46.236989 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:05:46.250276 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: COMMIT
[0m15:05:46.250840 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:05:46.251205 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: COMMIT
[0m15:05:46.267299 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m15:05:46.273141 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_backup"
[0m15:05:46.277895 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:05:46.278384 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
drop table if exists "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_backup" cascade
[0m15:05:46.292730 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m15:05:46.294934 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: Close
[0m15:05:46.296524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17907009-cc5b-4ef4-9730-773b8c41d009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724ada08ae70>]}
[0m15:05:46.297289 [info ] [Thread-1 (]: 1 of 13 OK created sql table model staging_staging.staging_situacao_alunos ..... [[32mSELECT 319146[0m in 0.77s]
[0m15:05:46.297922 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.staging_situacao_alunos
[0m15:05:46.298391 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m15:05:46.298905 [info ] [Thread-1 (]: 2 of 13 START sql view model staging_marts.view_frequencia_situacao_escola ..... [RUN]
[0m15:05:46.299678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.staging_situacao_alunos, now model.transformacao_matricula.view_frequencia_situacao_escola)
[0m15:05:46.300389 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_frequencia_situacao_escola
[0m15:05:46.302643 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m15:05:46.303345 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_frequencia_situacao_escola
[0m15:05:46.321257 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m15:05:46.322288 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m15:05:46.322863 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: BEGIN
[0m15:05:46.323358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:46.333545 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:05:46.334241 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m15:05:46.334807 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_frequencia_situacao_escola"} */

  create view "transformacao_matricula"."staging_marts"."view_frequencia_situacao_escola__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    de.nome_escola,
    de.codigo_escola,
    ds.situacao_nome,
    COUNT(fm.matricula) AS contagem_situacao
FROM
    fato_matricula fm
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, de.nome_escola, de.codigo_escola, ds.situacao_nome
ORDER BY
    dtemp.ano, de.nome_escola, contagem_situacao DESC
  );
[0m15:05:46.336072 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 15:     fato_matricula fm
             ^

[0m15:05:46.336744 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: ROLLBACK
[0m15:05:46.337708 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: Close
[0m15:05:46.341383 [debug] [Thread-1 (]: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m15:05:46.342083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17907009-cc5b-4ef4-9730-773b8c41d009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724ace5a0e90>]}
[0m15:05:46.342711 [error] [Thread-1 (]: 2 of 13 ERROR creating sql view model staging_marts.view_frequencia_situacao_escola  [[31mERROR[0m in 0.04s]
[0m15:05:46.343291 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m15:05:46.343755 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_matricula_detalhada
[0m15:05:46.344566 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_frequencia_situacao_escola' to be skipped because of status 'error'.  Reason: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql.
[0m15:05:46.345338 [info ] [Thread-1 (]: 3 of 13 START sql view model staging_marts.view_matricula_detalhada ............ [RUN]
[0m15:05:46.347206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_frequencia_situacao_escola, now model.transformacao_matricula.view_matricula_detalhada)
[0m15:05:46.347751 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_matricula_detalhada
[0m15:05:46.351866 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_matricula_detalhada"
[0m15:05:46.352590 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_matricula_detalhada
[0m15:05:46.355584 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_matricula_detalhada"
[0m15:05:46.356370 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m15:05:46.356798 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: BEGIN
[0m15:05:46.357161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:46.365900 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:05:46.366542 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m15:05:46.367046 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_matricula_detalhada"} */

  create view "transformacao_matricula"."staging_marts"."view_matricula_detalhada__dbt_tmp"
    
    
  as (
    
SELECT
    fm.matricula,
    da.sexo,
    da.idade,
    da.faixa_etaria,
    de.nome_escola,
    de.codigo_escola,
    dt.turma,
    dt.turno,
    dt.serie,
    dt.modalidade_ensino,
    ds.situacao_nome,
    ds.categoria AS categoria_situacao,
    ds.eh_aprovado,
    ds.eh_reprovado,
    dl.desc_rpa,
    dl.endereco_bairro AS bairro_localizacao,
    dtemp.ano AS ano_registro
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
  );
[0m15:05:46.368342 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 27:     fato_matricula fm
             ^

[0m15:05:46.369052 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: ROLLBACK
[0m15:05:46.370051 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: Close
[0m15:05:46.376368 [debug] [Thread-1 (]: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m15:05:46.377148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17907009-cc5b-4ef4-9730-773b8c41d009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724ace594200>]}
[0m15:05:46.377982 [error] [Thread-1 (]: 3 of 13 ERROR creating sql view model staging_marts.view_matricula_detalhada ... [[31mERROR[0m in 0.03s]
[0m15:05:46.378826 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_matricula_detalhada
[0m15:05:46.379454 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.transform_data
[0m15:05:46.381008 [info ] [Thread-1 (]: 4 of 13 START sql table model staging_marts.transform_data ..................... [RUN]
[0m15:05:46.380222 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_matricula_detalhada' to be skipped because of status 'error'.  Reason: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql.
[0m15:05:46.381696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_matricula_detalhada, now model.transformacao_matricula.transform_data)
[0m15:05:46.382511 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.transform_data
[0m15:05:46.386250 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.transform_data"
[0m15:05:46.387235 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.transform_data
[0m15:05:46.391689 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.transform_data"
[0m15:05:46.392804 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:05:46.393200 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: BEGIN
[0m15:05:46.393551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:46.402523 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:05:46.403110 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:05:46.403510 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."transform_data__dbt_tmp"
  
  
    as
  
  (
    

with staged_data AS (
    SELECT * FROM "transformacao_matricula"."staging_staging"."staging_situacao_alunos"
),

transformed_data AS (
    SELECT
        CAST(ano AS INTEGER) AS ano,
        CAST(codigo_escola AS INTEGER) AS codigo_escola,
        CAST(matricula AS INTEGER) AS matricula,
        nome_escola,
        endereco_logra,
        endereco_bairro,
        endereco_numero,
        CAST(rpa AS INTEGER) AS rpa,
        CAST(mod_ens_codigo AS INTEGER) AS mod_ens_codigo,
        serie,
        turma,
        turno,
        CAST(idade AS INTEGER) AS idade,
        sexo,
        sit_nome AS situacao_nome,
        modalidade_ens,
        CASE
            WHEN CAST(idade AS INTEGER) <= 3 THEN '0-3 Anos (Educação Infantil)'
            WHEN CAST(idade AS INTEGER) <= 5 THEN '4-5 Anos (Pré-escola)'
            WHEN CAST(idade AS INTEGER) <= 10 THEN '6-10 Anos (Fundamental I)'
            WHEN CAST(idade AS INTEGER) <= 14 THEN '11-14 Anos (Fundamental II)'
            WHEN CAST(idade AS INTEGER) >= 15 THEN '15+ Anos (EJA e Outros)'
            ELSE 'Não Informado'
        END AS faixa_etaria
    FROM staged_data
)

SELECT * FROM transformed_data
  );
  
[0m15:05:46.913195 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 0.509 seconds
[0m15:05:46.916447 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:05:46.916927 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
alter table "transformacao_matricula"."staging_marts"."transform_data" rename to "transform_data__dbt_backup"
[0m15:05:46.917879 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:05:46.920671 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:05:46.921287 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
alter table "transformacao_matricula"."staging_marts"."transform_data__dbt_tmp" rename to "transform_data"
[0m15:05:46.922202 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:05:46.924006 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: COMMIT
[0m15:05:46.924474 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:05:46.924883 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: COMMIT
[0m15:05:46.933109 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m15:05:46.935509 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."transform_data__dbt_backup"
[0m15:05:46.936507 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:05:46.936948 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
drop table if exists "transformacao_matricula"."staging_marts"."transform_data__dbt_backup" cascade
[0m15:05:46.953758 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.016 seconds
[0m15:05:46.955148 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: Close
[0m15:05:46.955901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17907009-cc5b-4ef4-9730-773b8c41d009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724ace549100>]}
[0m15:05:46.956708 [info ] [Thread-1 (]: 4 of 13 OK created sql table model staging_marts.transform_data ................ [[32mSELECT 319146[0m in 0.57s]
[0m15:05:46.957500 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.transform_data
[0m15:05:46.958641 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_aluno
[0m15:05:46.959270 [info ] [Thread-1 (]: 5 of 13 START sql table model staging_dimensions.dim_aluno ..................... [RUN]
[0m15:05:46.959868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.transform_data, now model.transformacao_matricula.dim_aluno)
[0m15:05:46.960376 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_aluno
[0m15:05:46.963861 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_aluno"
[0m15:05:46.964763 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_aluno
[0m15:05:46.968446 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_aluno"
[0m15:05:46.969322 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m15:05:46.969832 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: BEGIN
[0m15:05:46.970213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:46.985249 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m15:05:46.985943 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m15:05:46.986502 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_aluno"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_aluno__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
),
alunos AS (
    SELECT DISTINCT
        matricula,
        sexo,
        idade,
        faixa_etaria
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY matricula) - 1 AS id_aluno, -- Surrogate Key
        matricula,
        sexo,
        idade,
        faixa_etaria
    FROM alunos_unicos
)

SELECT * FROM versao_final
  );
  
[0m15:05:46.988312 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "alunos_unicos" does not exist
LINE 32:     FROM alunos_unicos
                  ^

[0m15:05:46.988964 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: ROLLBACK
[0m15:05:46.989927 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: Close
[0m15:05:46.992927 [debug] [Thread-1 (]: Database Error in model dim_aluno (transformacao_aprovados/models/marts/dim_aluno.sql)
  relation "alunos_unicos" does not exist
  LINE 32:     FROM alunos_unicos
                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_aluno.sql
[0m15:05:46.993967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17907009-cc5b-4ef4-9730-773b8c41d009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724accc36840>]}
[0m15:05:46.995116 [error] [Thread-1 (]: 5 of 13 ERROR creating sql table model staging_dimensions.dim_aluno ............ [[31mERROR[0m in 0.03s]
[0m15:05:46.995990 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_aluno
[0m15:05:46.996645 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_escola
[0m15:05:46.997317 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.dim_aluno' to be skipped because of status 'error'.  Reason: Database Error in model dim_aluno (transformacao_aprovados/models/marts/dim_aluno.sql)
  relation "alunos_unicos" does not exist
  LINE 32:     FROM alunos_unicos
                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_aluno.sql.
[0m15:05:46.998117 [info ] [Thread-1 (]: 6 of 13 START sql table model staging_dimensions.dim_escola .................... [RUN]
[0m15:05:46.999065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_aluno, now model.transformacao_matricula.dim_escola)
[0m15:05:47.000068 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_escola
[0m15:05:47.003964 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_escola"
[0m15:05:47.005362 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_escola
[0m15:05:47.013439 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_escola"
[0m15:05:47.014480 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:05:47.015315 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: BEGIN
[0m15:05:47.016121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:47.025029 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:05:47.025821 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:05:47.026471 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_escola__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
),
escolas_unicas AS (
    SELECT DISTINCT
        codigo_escola,
        nome_escola,
        endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY codigo_escola) - 1 AS id_escola, -- Surrogate Key
        codigo_escola,
        nome_escola,
        endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa
    FROM escolas_unicas
)

SELECT * FROM versao_final
  );
  
[0m15:05:47.193405 [debug] [Thread-1 (]: SQL status: SELECT 433 in 0.166 seconds
[0m15:05:47.196201 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:05:47.196671 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_escola__dbt_tmp" rename to "dim_escola"
[0m15:05:47.197580 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:05:47.199057 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: COMMIT
[0m15:05:47.199469 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:05:47.199846 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: COMMIT
[0m15:05:47.205628 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m15:05:47.207697 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_escola__dbt_backup"
[0m15:05:47.208573 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:05:47.208969 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_escola__dbt_backup" cascade
[0m15:05:47.209846 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m15:05:47.211111 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: Close
[0m15:05:47.211763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17907009-cc5b-4ef4-9730-773b8c41d009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724accc4c980>]}
[0m15:05:47.212449 [info ] [Thread-1 (]: 6 of 13 OK created sql table model staging_dimensions.dim_escola ............... [[32mSELECT 433[0m in 0.21s]
[0m15:05:47.213110 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_escola
[0m15:05:47.213567 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_localizacao
[0m15:05:47.214213 [info ] [Thread-1 (]: 7 of 13 START sql table model staging_dimensions.dim_localizacao ............... [RUN]
[0m15:05:47.214782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_escola, now model.transformacao_matricula.dim_localizacao)
[0m15:05:47.215223 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_localizacao
[0m15:05:47.217859 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_localizacao"
[0m15:05:47.218755 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_localizacao
[0m15:05:47.222863 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_localizacao"
[0m15:05:47.223780 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:05:47.224238 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: BEGIN
[0m15:05:47.224594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:47.236291 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m15:05:47.236984 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:05:47.237702 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_localizacao__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
),
localizacoes_unicas AS (
    SELECT DISTINCT
        rpa,
        endereco_bairro,
        CASE rpa
            WHEN 1 THEN 'RPA 1 (Centro)'
            WHEN 2 THEN 'RPA 2 (Zona Norte)'
            WHEN 3 THEN 'RPA 3 (Zona Oeste)'
            WHEN 4 THEN 'RPA 4 (Zona Sudoeste)'
            WHEN 5 THEN 'RPA 5 (Zona Sul)'
            WHEN 6 THEN 'RPA 6 (Zona Sudeste)'
            ELSE 'RPA Não Identificada'
        END AS desc_rpa
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY rpa, endereco_bairro) - 1 AS id_locali, -- Surrogate Key
        rpa,
        endereco_bairro,
        desc_rpa
    FROM localizacoes_unicas
)

SELECT * FROM versao_final
  );
  
[0m15:05:47.349775 [debug] [Thread-1 (]: SQL status: SELECT 88 in 0.111 seconds
[0m15:05:47.352625 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:05:47.353095 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_localizacao__dbt_tmp" rename to "dim_localizacao"
[0m15:05:47.354069 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:05:47.355572 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: COMMIT
[0m15:05:47.356027 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:05:47.356407 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: COMMIT
[0m15:05:47.358528 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:05:47.360559 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_localizacao__dbt_backup"
[0m15:05:47.361434 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:05:47.361831 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_localizacao__dbt_backup" cascade
[0m15:05:47.362737 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m15:05:47.364052 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: Close
[0m15:05:47.365032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17907009-cc5b-4ef4-9730-773b8c41d009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724ad41e73e0>]}
[0m15:05:47.365960 [info ] [Thread-1 (]: 7 of 13 OK created sql table model staging_dimensions.dim_localizacao .......... [[32mSELECT 88[0m in 0.15s]
[0m15:05:47.366734 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_localizacao
[0m15:05:47.367217 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_situacao
[0m15:05:47.367839 [info ] [Thread-1 (]: 8 of 13 START sql table model staging_dimensions.dim_situacao .................. [RUN]
[0m15:05:47.368379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_localizacao, now model.transformacao_matricula.dim_situacao)
[0m15:05:47.368850 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_situacao
[0m15:05:47.371396 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_situacao"
[0m15:05:47.372326 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_situacao
[0m15:05:47.376434 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_situacao"
[0m15:05:47.377352 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:05:47.377925 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: BEGIN
[0m15:05:47.378406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:47.388555 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:05:47.389239 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:05:47.389809 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_situacao__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
),
situacoes_unicas AS (
    SELECT DISTINCT
        situacao_nome,
        CASE 
            WHEN situacao_nome = 'Aprovado' THEN 'APROVADO'
            WHEN situacao_nome = 'Reprovado' THEN 'REPROVADO'
            WHEN situacao_nome = 'Transferido' THEN 'TRANSFERIDO'
            WHEN situacao_nome = 'Desistente' THEN 'DESISTENTE'
            ELSE 'OUTROS'
        END AS categoria,
        CASE 
            WHEN situacao_nome = 'Aprovado' THEN 1
            ELSE 0
        END AS eh_aprovado,
        CASE 
            WHEN situacao_nome = 'Reprovado' THEN 1
            ELSE 0
        END AS eh_reprovado
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY situacao_nome) - 1 AS id_situacao, -- Surrogate Key
        situacao_nome,
        categoria,
        eh_aprovado,
        eh_reprovado
    FROM situacoes_unicas
)

SELECT * FROM versao_final
  );
  
[0m15:05:47.467488 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.077 seconds
[0m15:05:47.471056 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:05:47.471507 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_situacao__dbt_tmp" rename to "dim_situacao"
[0m15:05:47.472528 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:05:47.474151 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: COMMIT
[0m15:05:47.474620 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:05:47.475007 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: COMMIT
[0m15:05:47.476807 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:05:47.480813 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_situacao__dbt_backup"
[0m15:05:47.481775 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:05:47.482175 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_situacao__dbt_backup" cascade
[0m15:05:47.483114 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:05:47.484413 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: Close
[0m15:05:47.485122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17907009-cc5b-4ef4-9730-773b8c41d009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724accc28230>]}
[0m15:05:47.485811 [info ] [Thread-1 (]: 8 of 13 OK created sql table model staging_dimensions.dim_situacao ............. [[32mSELECT 5[0m in 0.12s]
[0m15:05:47.486544 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_situacao
[0m15:05:47.487071 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_tempo
[0m15:05:47.487705 [info ] [Thread-1 (]: 9 of 13 START sql table model staging_dimensions.dim_tempo ..................... [RUN]
[0m15:05:47.488311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_situacao, now model.transformacao_matricula.dim_tempo)
[0m15:05:47.488790 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_tempo
[0m15:05:47.491339 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_tempo"
[0m15:05:47.492309 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_tempo
[0m15:05:47.495812 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_tempo"
[0m15:05:47.496663 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:05:47.497133 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: BEGIN
[0m15:05:47.497487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:47.508015 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:05:47.508846 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:05:47.509458 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_tempo__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
),
tempo_unico AS (
    SELECT DISTINCT
        ano,
        'Registro Anual' AS ano_ensino
    FROM source
)

SELECT * FROM tempo_unico
  );
  
[0m15:05:47.570120 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.060 seconds
[0m15:05:47.572962 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:05:47.573421 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_tempo__dbt_tmp" rename to "dim_tempo"
[0m15:05:47.574399 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:05:47.575874 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: COMMIT
[0m15:05:47.576309 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:05:47.576684 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: COMMIT
[0m15:05:47.578533 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:05:47.580557 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_tempo__dbt_backup"
[0m15:05:47.581444 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:05:47.581835 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_tempo__dbt_backup" cascade
[0m15:05:47.582669 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m15:05:47.583924 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: Close
[0m15:05:47.584575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17907009-cc5b-4ef4-9730-773b8c41d009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724accc622d0>]}
[0m15:05:47.585232 [info ] [Thread-1 (]: 9 of 13 OK created sql table model staging_dimensions.dim_tempo ................ [[32mSELECT 3[0m in 0.10s]
[0m15:05:47.585828 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_tempo
[0m15:05:47.586292 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_turma
[0m15:05:47.586918 [info ] [Thread-1 (]: 10 of 13 START sql table model staging_dimensions.dim_turma .................... [RUN]
[0m15:05:47.587447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_tempo, now model.transformacao_matricula.dim_turma)
[0m15:05:47.587887 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_turma
[0m15:05:47.590457 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_turma"
[0m15:05:47.591161 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_turma
[0m15:05:47.594650 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_turma"
[0m15:05:47.595732 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:05:47.596372 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: BEGIN
[0m15:05:47.596880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:47.606937 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:05:47.607624 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:05:47.608170 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_turma__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
),
turmas_unicas AS (
    SELECT DISTINCT
        turma,
        turno,
        serie,
        mod_ens_codigo,
        modalidade_ens
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY turma, turno, serie) - 1 AS id_turma,
        turma,
        turno,
        NULL AS serie_codigo,
        serie,
        mod_ens_codigo,
        modalidade_ens AS modalidade_ensino
    FROM turmas_unicas
)

SELECT * FROM versao_final
  );
  
[0m15:05:47.755372 [debug] [Thread-1 (]: SQL status: SELECT 335 in 0.147 seconds
[0m15:05:47.758167 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:05:47.758635 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_turma__dbt_tmp" rename to "dim_turma"
[0m15:05:47.759521 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:05:47.761039 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: COMMIT
[0m15:05:47.761462 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:05:47.761845 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: COMMIT
[0m15:05:47.763663 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:05:47.765705 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_turma__dbt_backup"
[0m15:05:47.766568 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:05:47.766973 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_turma__dbt_backup" cascade
[0m15:05:47.767900 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m15:05:47.769209 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: Close
[0m15:05:47.769870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17907009-cc5b-4ef4-9730-773b8c41d009', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724accc77110>]}
[0m15:05:47.770517 [info ] [Thread-1 (]: 10 of 13 OK created sql table model staging_dimensions.dim_turma ............... [[32mSELECT 335[0m in 0.18s]
[0m15:05:47.771227 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_turma
[0m15:05:47.772115 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.fato_matricula
[0m15:05:47.772734 [info ] [Thread-1 (]: 11 of 13 SKIP relation staging_marts.fato_matricula ............................ [[33mSKIP[0m]
[0m15:05:47.773317 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.fato_matricula
[0m15:05:47.774235 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_count_aluno_idade
[0m15:05:47.774807 [info ] [Thread-1 (]: 12 of 13 SKIP relation staging_marts.view_count_aluno_idade .................... [[33mSKIP[0m]
[0m15:05:47.775326 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_count_aluno_idade
[0m15:05:47.775813 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_taxa_aprovados
[0m15:05:47.776308 [info ] [Thread-1 (]: 13 of 13 SKIP relation staging_marts.view_taxa_aprovados ....................... [[33mSKIP[0m]
[0m15:05:47.776937 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_taxa_aprovados
[0m15:05:47.778960 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:47.779412 [debug] [MainThread]: On master: BEGIN
[0m15:05:47.779738 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:05:47.792347 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m15:05:47.793035 [debug] [MainThread]: On master: COMMIT
[0m15:05:47.793533 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:47.794010 [debug] [MainThread]: On master: COMMIT
[0m15:05:47.794767 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:05:47.795277 [debug] [MainThread]: On master: Close
[0m15:05:47.796183 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:47.796768 [debug] [MainThread]: Connection 'model.transformacao_matricula.dim_turma' was properly closed.
[0m15:05:47.797378 [info ] [MainThread]: 
[0m15:05:47.798137 [info ] [MainThread]: Finished running 9 table models, 4 view models in 0 hours 0 minutes and 2.48 seconds (2.48s).
[0m15:05:47.800884 [debug] [MainThread]: Command end result
[0m15:05:47.836709 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m15:05:47.840018 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m15:05:47.845184 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m15:05:47.845701 [info ] [MainThread]: 
[0m15:05:47.846133 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m15:05:47.846567 [info ] [MainThread]: 
[0m15:05:47.847065 [error] [MainThread]: [31mFailure in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)[0m
[0m15:05:47.847529 [error] [MainThread]:   Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m15:05:47.847981 [info ] [MainThread]: 
[0m15:05:47.848446 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m15:05:47.848934 [info ] [MainThread]: 
[0m15:05:47.849409 [error] [MainThread]: [31mFailure in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)[0m
[0m15:05:47.849881 [error] [MainThread]:   Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m15:05:47.850250 [info ] [MainThread]: 
[0m15:05:47.850693 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m15:05:47.851074 [info ] [MainThread]: 
[0m15:05:47.851584 [error] [MainThread]: [31mFailure in model dim_aluno (transformacao_aprovados/models/marts/dim_aluno.sql)[0m
[0m15:05:47.852061 [error] [MainThread]:   Database Error in model dim_aluno (transformacao_aprovados/models/marts/dim_aluno.sql)
  relation "alunos_unicos" does not exist
  LINE 32:     FROM alunos_unicos
                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_aluno.sql
[0m15:05:47.852435 [info ] [MainThread]: 
[0m15:05:47.852872 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/dim_aluno.sql
[0m15:05:47.853239 [info ] [MainThread]: 
[0m15:05:47.853640 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=3 SKIP=3 NO-OP=0 TOTAL=13
[0m15:05:47.854245 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 6 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:05:47.855321 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.5967298, "process_in_blocks": "96", "process_kernel_time": 0.38101, "process_mem_max_rss": "128868", "process_out_blocks": "3888", "process_user_time": 2.507486}
[0m15:05:47.855912 [debug] [MainThread]: Command `dbt run` failed at 15:05:47.855801 after 3.60 seconds
[0m15:05:47.856471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724ad7803920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724ad8799100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x724ada29f170>]}
[0m15:05:47.856960 [debug] [MainThread]: Flushing usage events
[0m15:05:49.181282 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:06:40.170412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2dc773c890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2dc800c740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2dc9710260>]}


============================== 15:06:40.174494 | dbaa0b8c-1c83-403e-8114-9a811ea236b0 ==============================
[0m15:06:40.174494 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:06:40.175067 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'debug': 'False', 'partial_parse': 'True', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'profiles_dir': '/home/murilo/.dbt', 'cache_selected_only': 'False', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'version_check': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'write_json': 'True', 'warn_error': 'None', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True'}
[0m15:06:40.282042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbaa0b8c-1c83-403e-8114-9a811ea236b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2dc9b97da0>]}
[0m15:06:40.294188 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.16962598, "process_in_blocks": "24", "process_kernel_time": 0.207496, "process_mem_max_rss": "101632", "process_out_blocks": "16", "process_user_time": 1.181131}
[0m15:06:40.294821 [debug] [MainThread]: Command `dbt clean` succeeded at 15:06:40.294713 after 0.17 seconds
[0m15:06:40.295249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2dc73f90a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2dc7e67260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2dc7d1da60>]}
[0m15:06:40.295742 [debug] [MainThread]: Flushing usage events
[0m15:06:41.302036 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:06:45.148691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e4f8541250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e4f7d87050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e4f7c6d7f0>]}


============================== 15:06:45.151653 | 61ff0cac-aa9f-4257-a044-a916eee2c3df ==============================
[0m15:06:45.151653 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:06:45.152246 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'quiet': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'warn_error': 'None', 'introspect': 'True', 'version_check': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'profiles_dir': '/home/murilo/.dbt', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'send_anonymous_usage_stats': 'True', 'debug': 'False'}
[0m15:06:45.288752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61ff0cac-aa9f-4257-a044-a916eee2c3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e4f9c9bd40>]}
[0m15:06:45.338660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61ff0cac-aa9f-4257-a044-a916eee2c3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e4f7c2c2c0>]}
[0m15:06:45.339483 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:06:45.445630 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:06:45.446765 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:06:45.447196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '61ff0cac-aa9f-4257-a044-a916eee2c3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e4f67101d0>]}
[0m15:06:46.403717 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m15:06:46.404280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '61ff0cac-aa9f-4257-a044-a916eee2c3df', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e4f5b725a0>]}
[0m15:06:46.617397 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.transformacao_matricula.dimensions
- models.transformacao_matricula.facts
- models.transformacao_matricula.intermediate
[0m15:06:46.626017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61ff0cac-aa9f-4257-a044-a916eee2c3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e4f53948c0>]}
[0m15:06:46.719052 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m15:06:46.721009 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m15:06:46.734798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61ff0cac-aa9f-4257-a044-a916eee2c3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e4f41524b0>]}
[0m15:06:46.735360 [info ] [MainThread]: Found 13 models, 37 data tests, 1 source, 459 macros
[0m15:06:46.735774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61ff0cac-aa9f-4257-a044-a916eee2c3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e4f4f80530>]}
[0m15:06:46.738030 [info ] [MainThread]: 
[0m15:06:46.738542 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m15:06:46.738989 [info ] [MainThread]: 
[0m15:06:46.739550 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:06:46.743977 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula'
[0m15:06:46.785977 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m15:06:46.786590 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m15:06:46.787278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:46.800368 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.013 seconds
[0m15:06:46.801963 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m15:06:46.804285 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m15:06:46.804915 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m15:06:46.805286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:46.815082 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.010 seconds
[0m15:06:46.816338 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m15:06:46.818422 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m15:06:46.819030 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m15:06:46.819395 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:46.829139 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.010 seconds
[0m15:06:46.830347 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m15:06:46.832403 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula, now list_transformacao_matricula_staging_staging)
[0m15:06:46.838499 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m15:06:46.838977 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: BEGIN
[0m15:06:46.839294 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:46.849496 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m15:06:46.849979 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m15:06:46.850312 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_staging"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m15:06:46.853207 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m15:06:46.854415 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: ROLLBACK
[0m15:06:46.855098 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: Close
[0m15:06:46.855738 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_staging, now list_transformacao_matricula_staging_marts)
[0m15:06:46.859205 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m15:06:46.859706 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: BEGIN
[0m15:06:46.860025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:46.868768 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:06:46.869236 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m15:06:46.869579 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_marts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m15:06:46.872532 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m15:06:46.873844 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: ROLLBACK
[0m15:06:46.874634 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: Close
[0m15:06:46.875267 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_marts, now list_transformacao_matricula_staging_dimensions)
[0m15:06:46.878080 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_dimensions"
[0m15:06:46.878556 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: BEGIN
[0m15:06:46.878911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:46.887173 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m15:06:46.887647 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_dimensions"
[0m15:06:46.888007 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_dimensions"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dimensions'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dimensions'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dimensions'
  
[0m15:06:46.890931 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m15:06:46.892224 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: ROLLBACK
[0m15:06:46.893017 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: Close
[0m15:06:46.899298 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:46.899764 [debug] [MainThread]: On master: BEGIN
[0m15:06:46.900074 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:06:46.910644 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m15:06:46.911200 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:46.911686 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:06:46.919522 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m15:06:46.921489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61ff0cac-aa9f-4257-a044-a916eee2c3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e4f6b5d700>]}
[0m15:06:46.921970 [debug] [MainThread]: On master: ROLLBACK
[0m15:06:46.922749 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:46.923133 [debug] [MainThread]: On master: BEGIN
[0m15:06:46.924017 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:06:46.924427 [debug] [MainThread]: On master: COMMIT
[0m15:06:46.924779 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:46.925081 [debug] [MainThread]: On master: COMMIT
[0m15:06:46.925766 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:06:46.926141 [debug] [MainThread]: On master: Close
[0m15:06:46.928519 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.staging_situacao_alunos
[0m15:06:46.929711 [info ] [Thread-1 (]: 1 of 13 START sql table model staging_staging.staging_situacao_alunos .......... [RUN]
[0m15:06:46.930932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_dimensions, now model.transformacao_matricula.staging_situacao_alunos)
[0m15:06:46.931514 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.staging_situacao_alunos
[0m15:06:46.937875 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.staging_situacao_alunos"
[0m15:06:46.938851 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.staging_situacao_alunos
[0m15:06:46.981640 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.staging_situacao_alunos"
[0m15:06:46.982880 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:06:46.983407 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: BEGIN
[0m15:06:46.983825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:46.992142 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:06:46.992747 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:06:46.993392 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */

  
    

  create  table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp"
  
  
    as
  
  (
    WITH source AS (
    SELECT * FROM "transformacao_matricula"."staging"."staging_alunos_raw"
),

cleaning_renaming AS (
    SELECT
        ano,
        codigo_escola,
        matricula,
        escola AS nome_escola,
        endereco_logradouro AS endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa,
        modalidade_ensino_codigo AS mod_ens_codigo,
        -- Transformação da SÉRIE
        CASE
            -- Ensino Fundamental (1º ao 9º)
            WHEN serie LIKE '%1 ANO%' OR serie LIKE '%1º ANO%' THEN '1º ANO'
            WHEN serie LIKE '%2 ANO%' OR serie LIKE '%2º ANO%' THEN '2º ANO'
            WHEN serie LIKE '%3 ANO%' OR serie LIKE '%3º ANO%' THEN '3º ANO'
            WHEN serie LIKE '%4 ANO%' OR serie LIKE '%4º ANO%' THEN '4º ANO'
            WHEN serie LIKE '%5 ANO%' OR serie LIKE '%5º ANO%' THEN '5º ANO'
            WHEN serie LIKE '%6 ANO%' OR serie LIKE '%6º ANO%' THEN '6º ANO'
            WHEN serie LIKE '%7 ANO%' OR serie LIKE '%7º ANO%' THEN '7º ANO'
            WHEN serie LIKE '%8 ANO%' OR serie LIKE '%8º ANO%' THEN '8º ANO'
            WHEN serie LIKE '%9 ANO%' OR serie LIKE '%9º ANO%' THEN '9º ANO'
            -- Educação Infantil (Berçário e Grupos)
            WHEN serie LIKE '%BER%' THEN 'BERÇARIO'
            WHEN serie LIKE '%GRUPO I%' OR serie LIKE '%GRUPO 1%' THEN 'GRUPO I'
            WHEN serie LIKE '%GRUPO II%' THEN 'GRUPO II'
            WHEN serie LIKE '%GRUPO III%' THEN 'GRUPO III'
            WHEN serie LIKE '%GRUPO IV%' THEN 'GRUPO IV'
            WHEN serie LIKE '%GRUPO V%' THEN 'GRUPO V'
            -- EJA (Módulos 1 ao 5) 
            WHEN serie LIKE '%1%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 1'
            WHEN serie LIKE '%2%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 2'
            WHEN serie LIKE '%3%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 3'
            WHEN serie LIKE '%4%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 4'
            WHEN serie LIKE '%5%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 5'
            WHEN serie LIKE '%TRAVESSIA%' THEN 'TRAVESSIA RECIFE'
            WHEN serie LIKE '%CORRECAO%1%' THEN 'CORREÇÃO DE FLUXO 1 - ALFABETIZACAO'
            WHEN serie LIKE '%CORRECAO%2%' THEN 'CORREÇÃO DE FLUXO 2 - ACELERACAO'
            ELSE 'OUTROS'
        END AS serie,
        turma,
        turno,
        idade,
        -- transformação do SEXO
        CASE
            WHEN sexo = '1' THEN 'Masculino'
            WHEN sexo = '2' THEN 'Feminino'
            WHEN sexo = '3' THEN 'Outros'
            ELSE 'Não informado'
        END AS sexo,
        -- transformação de situacao
        CASE 
            WHEN situacao_nome LIKE '%APROV%' THEN 'Aprovado'
            WHEN situacao_nome LIKE '%RET%' OR situacao_nome LIKE '%REPRO%' THEN 'Reprovado'
            WHEN situacao_nome LIKE '%TR%' OR situacao_nome LIKE '%REMAN%' THEN 'Transferido'
            WHEN situacao_nome LIKE '%DESIST%' THEN 'Desistente'
            ELSE 'Outros'
        END AS sit_nome,
        -- Transformação da MODALIDADE
        CASE
            WHEN modalidade_ensino LIKE '%EDUCACAO INFANTIL%' THEN 'EDUCAÇÃO INFANTIL'
            WHEN modalidade_ensino LIKE '%ENSINO FUNDAMENTAL%' THEN 'ENSINO FUNDAMENTAL'
            WHEN modalidade_ensino LIKE '%EDUCACAO JOVENS E ADULTOS%' THEN 'EJA'
            WHEN modalidade_ensino LIKE '%CORRE%' THEN 'CORREÇÃO DE FLUXO'
            ELSE 'OUTROS'
        END AS modalidade_ens
    FROM source
)

SELECT * FROM cleaning_renaming
  );
  
[0m15:06:47.667159 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 0.673 seconds
[0m15:06:47.680010 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:06:47.680810 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
alter table "transformacao_matricula"."staging_staging"."staging_situacao_alunos" rename to "staging_situacao_alunos__dbt_backup"
[0m15:06:47.681885 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:06:47.685201 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:06:47.686087 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
alter table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp" rename to "staging_situacao_alunos"
[0m15:06:47.687297 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:06:47.701256 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: COMMIT
[0m15:06:47.701801 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:06:47.702204 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: COMMIT
[0m15:06:47.712011 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m15:06:47.718089 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_backup"
[0m15:06:47.723161 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:06:47.723715 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
drop table if exists "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_backup" cascade
[0m15:06:47.735890 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.012 seconds
[0m15:06:47.738317 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: Close
[0m15:06:47.740004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61ff0cac-aa9f-4257-a044-a916eee2c3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e4f834cb60>]}
[0m15:06:47.740745 [info ] [Thread-1 (]: 1 of 13 OK created sql table model staging_staging.staging_situacao_alunos ..... [[32mSELECT 319146[0m in 0.81s]
[0m15:06:47.741355 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.staging_situacao_alunos
[0m15:06:47.741807 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m15:06:47.742650 [info ] [Thread-1 (]: 2 of 13 START sql view model staging_marts.view_frequencia_situacao_escola ..... [RUN]
[0m15:06:47.743523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.staging_situacao_alunos, now model.transformacao_matricula.view_frequencia_situacao_escola)
[0m15:06:47.744273 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_frequencia_situacao_escola
[0m15:06:47.748693 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m15:06:47.749400 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_frequencia_situacao_escola
[0m15:06:47.768979 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m15:06:47.770305 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m15:06:47.771000 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: BEGIN
[0m15:06:47.771482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:47.782103 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:06:47.782836 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m15:06:47.783421 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_frequencia_situacao_escola"} */

  create view "transformacao_matricula"."staging_marts"."view_frequencia_situacao_escola__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    de.nome_escola,
    de.codigo_escola,
    ds.situacao_nome,
    COUNT(fm.matricula) AS contagem_situacao
FROM
    fato_matricula fm
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, de.nome_escola, de.codigo_escola, ds.situacao_nome
ORDER BY
    dtemp.ano, de.nome_escola, contagem_situacao DESC
  );
[0m15:06:47.784815 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 15:     fato_matricula fm
             ^

[0m15:06:47.785515 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: ROLLBACK
[0m15:06:47.786738 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: Close
[0m15:06:47.792546 [debug] [Thread-1 (]: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m15:06:47.793572 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61ff0cac-aa9f-4257-a044-a916eee2c3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e4ee0c9e20>]}
[0m15:06:47.795021 [error] [Thread-1 (]: 2 of 13 ERROR creating sql view model staging_marts.view_frequencia_situacao_escola  [[31mERROR[0m in 0.05s]
[0m15:06:47.796246 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m15:06:47.797090 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_matricula_detalhada
[0m15:06:47.797962 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_frequencia_situacao_escola' to be skipped because of status 'error'.  Reason: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql.
[0m15:06:47.798963 [info ] [Thread-1 (]: 3 of 13 START sql view model staging_marts.view_matricula_detalhada ............ [RUN]
[0m15:06:47.801492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_frequencia_situacao_escola, now model.transformacao_matricula.view_matricula_detalhada)
[0m15:06:47.802482 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_matricula_detalhada
[0m15:06:47.806020 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_matricula_detalhada"
[0m15:06:47.806856 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_matricula_detalhada
[0m15:06:47.812087 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_matricula_detalhada"
[0m15:06:47.813207 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m15:06:47.814021 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: BEGIN
[0m15:06:47.814554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:47.825419 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m15:06:47.826202 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m15:06:47.826952 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_matricula_detalhada"} */

  create view "transformacao_matricula"."staging_marts"."view_matricula_detalhada__dbt_tmp"
    
    
  as (
    
SELECT
    fm.matricula,
    da.sexo,
    da.idade,
    da.faixa_etaria,
    de.nome_escola,
    de.codigo_escola,
    dt.turma,
    dt.turno,
    dt.serie,
    dt.modalidade_ensino,
    ds.situacao_nome,
    ds.categoria AS categoria_situacao,
    ds.eh_aprovado,
    ds.eh_reprovado,
    dl.desc_rpa,
    dl.endereco_bairro AS bairro_localizacao,
    dtemp.ano AS ano_registro
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
  );
[0m15:06:47.828658 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 27:     fato_matricula fm
             ^

[0m15:06:47.829417 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: ROLLBACK
[0m15:06:47.831086 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: Close
[0m15:06:47.834484 [debug] [Thread-1 (]: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m15:06:47.835731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61ff0cac-aa9f-4257-a044-a916eee2c3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e4ec6fd3a0>]}
[0m15:06:47.837043 [error] [Thread-1 (]: 3 of 13 ERROR creating sql view model staging_marts.view_matricula_detalhada ... [[31mERROR[0m in 0.03s]
[0m15:06:47.838208 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_matricula_detalhada
[0m15:06:47.839068 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.transform_data
[0m15:06:47.839892 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_matricula_detalhada' to be skipped because of status 'error'.  Reason: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql.
[0m15:06:47.840975 [info ] [Thread-1 (]: 4 of 13 START sql table model staging_marts.transform_data ..................... [RUN]
[0m15:06:47.842835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_matricula_detalhada, now model.transformacao_matricula.transform_data)
[0m15:06:47.843661 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.transform_data
[0m15:06:47.847880 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.transform_data"
[0m15:06:47.848897 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.transform_data
[0m15:06:47.854113 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.transform_data"
[0m15:06:47.855182 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:06:47.856090 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: BEGIN
[0m15:06:47.856807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:47.866103 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:06:47.867003 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:06:47.867528 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */

  
    

  create  table "transformacao_matricula"."staging_marts"."transform_data__dbt_tmp"
  
  
    as
  
  (
    

with staged_data AS (
    SELECT * FROM "transformacao_matricula"."staging_staging"."staging_situacao_alunos"
),

transformed_data AS (
    SELECT
        CAST(ano AS INTEGER) AS ano,
        CAST(codigo_escola AS INTEGER) AS codigo_escola,
        CAST(matricula AS INTEGER) AS matricula,
        nome_escola,
        endereco_logra,
        endereco_bairro,
        endereco_numero,
        CAST(rpa AS INTEGER) AS rpa,
        CAST(mod_ens_codigo AS INTEGER) AS mod_ens_codigo,
        serie,
        turma,
        turno,
        CAST(idade AS INTEGER) AS idade,
        sexo,
        sit_nome AS situacao_nome,
        modalidade_ens,
        CASE
            WHEN CAST(idade AS INTEGER) <= 3 THEN '0-3 Anos (Educação Infantil)'
            WHEN CAST(idade AS INTEGER) <= 5 THEN '4-5 Anos (Pré-escola)'
            WHEN CAST(idade AS INTEGER) <= 10 THEN '6-10 Anos (Fundamental I)'
            WHEN CAST(idade AS INTEGER) <= 14 THEN '11-14 Anos (Fundamental II)'
            WHEN CAST(idade AS INTEGER) >= 15 THEN '15+ Anos (EJA e Outros)'
            ELSE 'Não Informado'
        END AS faixa_etaria
    FROM staged_data
)

SELECT * FROM transformed_data
  );
  
[0m15:06:48.394926 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 0.527 seconds
[0m15:06:48.398107 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:06:48.398634 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
alter table "transformacao_matricula"."staging_marts"."transform_data" rename to "transform_data__dbt_backup"
[0m15:06:48.399642 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:06:48.402772 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:06:48.403299 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
alter table "transformacao_matricula"."staging_marts"."transform_data__dbt_tmp" rename to "transform_data"
[0m15:06:48.404322 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:06:48.406457 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: COMMIT
[0m15:06:48.407077 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:06:48.407531 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: COMMIT
[0m15:06:48.412842 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m15:06:48.415248 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."transform_data__dbt_backup"
[0m15:06:48.416261 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:06:48.416777 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
drop table if exists "transformacao_matricula"."staging_marts"."transform_data__dbt_backup" cascade
[0m15:06:48.430751 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m15:06:48.432259 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: Close
[0m15:06:48.433150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61ff0cac-aa9f-4257-a044-a916eee2c3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e4ee06c6e0>]}
[0m15:06:48.434233 [info ] [Thread-1 (]: 4 of 13 OK created sql table model staging_marts.transform_data ................ [[32mSELECT 319146[0m in 0.59s]
[0m15:06:48.435201 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.transform_data
[0m15:06:48.436441 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_aluno
[0m15:06:48.437246 [info ] [Thread-1 (]: 5 of 13 START sql table model staging_dimensions.dim_aluno ..................... [RUN]
[0m15:06:48.438021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.transform_data, now model.transformacao_matricula.dim_aluno)
[0m15:06:48.438683 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_aluno
[0m15:06:48.442032 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_aluno"
[0m15:06:48.442951 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_aluno
[0m15:06:48.449515 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_aluno"
[0m15:06:48.450754 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m15:06:48.451451 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: BEGIN
[0m15:06:48.452074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:48.464152 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m15:06:48.465023 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m15:06:48.465784 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_aluno"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_aluno__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
),
alunos AS (
    SELECT DISTINCT
        matricula,
        sexo,
        idade,
        faixa_etaria
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY matricula) - 1 AS id_aluno, -- Surrogate Key
        matricula,
        sexo,
        idade,
        faixa_etaria
    FROM alunos_unicos
)

SELECT * FROM versao_final
  );
  
[0m15:06:48.467744 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "alunos_unicos" does not exist
LINE 32:     FROM alunos_unicos
                  ^

[0m15:06:48.468496 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: ROLLBACK
[0m15:06:48.469798 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: Close
[0m15:06:48.477022 [debug] [Thread-1 (]: Database Error in model dim_aluno (transformacao_aprovados/models/marts/dim_aluno.sql)
  relation "alunos_unicos" does not exist
  LINE 32:     FROM alunos_unicos
                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_aluno.sql
[0m15:06:48.478067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61ff0cac-aa9f-4257-a044-a916eee2c3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e4ec7760f0>]}
[0m15:06:48.479175 [error] [Thread-1 (]: 5 of 13 ERROR creating sql table model staging_dimensions.dim_aluno ............ [[31mERROR[0m in 0.04s]
[0m15:06:48.480465 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_aluno
[0m15:06:48.481365 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_escola
[0m15:06:48.482371 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.dim_aluno' to be skipped because of status 'error'.  Reason: Database Error in model dim_aluno (transformacao_aprovados/models/marts/dim_aluno.sql)
  relation "alunos_unicos" does not exist
  LINE 32:     FROM alunos_unicos
                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_aluno.sql.
[0m15:06:48.483165 [info ] [Thread-1 (]: 6 of 13 START sql table model staging_dimensions.dim_escola .................... [RUN]
[0m15:06:48.484560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_aluno, now model.transformacao_matricula.dim_escola)
[0m15:06:48.485211 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_escola
[0m15:06:48.489058 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_escola"
[0m15:06:48.489956 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_escola
[0m15:06:48.493830 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_escola"
[0m15:06:48.494913 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:06:48.495522 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: BEGIN
[0m15:06:48.496021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:48.507559 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m15:06:48.508471 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:06:48.509334 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_escola__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
),
escolas_unicas AS (
    SELECT DISTINCT
        codigo_escola,
        nome_escola,
        endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY codigo_escola) - 1 AS id_escola, -- Surrogate Key
        codigo_escola,
        nome_escola,
        endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa
    FROM escolas_unicas
)

SELECT * FROM versao_final
  );
  
[0m15:06:48.680981 [debug] [Thread-1 (]: SQL status: SELECT 433 in 0.171 seconds
[0m15:06:48.684017 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:06:48.684521 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_escola" rename to "dim_escola__dbt_backup"
[0m15:06:48.685499 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:06:48.688388 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:06:48.688882 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_escola__dbt_tmp" rename to "dim_escola"
[0m15:06:48.689889 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:06:48.691832 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: COMMIT
[0m15:06:48.692480 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:06:48.692903 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: COMMIT
[0m15:06:48.694563 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:06:48.696642 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_escola__dbt_backup"
[0m15:06:48.697597 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:06:48.698026 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_escola__dbt_backup" cascade
[0m15:06:48.701060 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:06:48.702397 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: Close
[0m15:06:48.703065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61ff0cac-aa9f-4257-a044-a916eee2c3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e4ec780200>]}
[0m15:06:48.703747 [info ] [Thread-1 (]: 6 of 13 OK created sql table model staging_dimensions.dim_escola ............... [[32mSELECT 433[0m in 0.22s]
[0m15:06:48.704403 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_escola
[0m15:06:48.704894 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_localizacao
[0m15:06:48.705493 [info ] [Thread-1 (]: 7 of 13 START sql table model staging_dimensions.dim_localizacao ............... [RUN]
[0m15:06:48.706055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_escola, now model.transformacao_matricula.dim_localizacao)
[0m15:06:48.706484 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_localizacao
[0m15:06:48.709126 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_localizacao"
[0m15:06:48.709939 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_localizacao
[0m15:06:48.713104 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_localizacao"
[0m15:06:48.713842 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:06:48.714243 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: BEGIN
[0m15:06:48.714600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:48.724868 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:06:48.725525 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:06:48.726098 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_localizacao__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
),
localizacoes_unicas AS (
    SELECT DISTINCT
        rpa,
        endereco_bairro,
        CASE rpa
            WHEN 1 THEN 'RPA 1 (Centro)'
            WHEN 2 THEN 'RPA 2 (Zona Norte)'
            WHEN 3 THEN 'RPA 3 (Zona Oeste)'
            WHEN 4 THEN 'RPA 4 (Zona Sudoeste)'
            WHEN 5 THEN 'RPA 5 (Zona Sul)'
            WHEN 6 THEN 'RPA 6 (Zona Sudeste)'
            ELSE 'RPA Não Identificada'
        END AS desc_rpa
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY rpa, endereco_bairro) - 1 AS id_locali, -- Surrogate Key
        rpa,
        endereco_bairro,
        desc_rpa
    FROM localizacoes_unicas
)

SELECT * FROM versao_final
  );
  
[0m15:06:48.839973 [debug] [Thread-1 (]: SQL status: SELECT 88 in 0.113 seconds
[0m15:06:48.843866 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:06:48.844382 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_localizacao" rename to "dim_localizacao__dbt_backup"
[0m15:06:48.845334 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:06:48.847888 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:06:48.848341 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_localizacao__dbt_tmp" rename to "dim_localizacao"
[0m15:06:48.849191 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:06:48.850804 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: COMMIT
[0m15:06:48.851240 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:06:48.851621 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: COMMIT
[0m15:06:48.853165 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:06:48.856545 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_localizacao__dbt_backup"
[0m15:06:48.857674 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:06:48.858335 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_localizacao__dbt_backup" cascade
[0m15:06:48.861790 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:06:48.863685 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: Close
[0m15:06:48.864419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61ff0cac-aa9f-4257-a044-a916eee2c3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e4ec784e30>]}
[0m15:06:48.865125 [info ] [Thread-1 (]: 7 of 13 OK created sql table model staging_dimensions.dim_localizacao .......... [[32mSELECT 88[0m in 0.16s]
[0m15:06:48.865753 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_localizacao
[0m15:06:48.866190 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_situacao
[0m15:06:48.866930 [info ] [Thread-1 (]: 8 of 13 START sql table model staging_dimensions.dim_situacao .................. [RUN]
[0m15:06:48.867638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_localizacao, now model.transformacao_matricula.dim_situacao)
[0m15:06:48.868195 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_situacao
[0m15:06:48.871567 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_situacao"
[0m15:06:48.872419 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_situacao
[0m15:06:48.877138 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_situacao"
[0m15:06:48.878279 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:06:48.879047 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: BEGIN
[0m15:06:48.879712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:48.891384 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m15:06:48.892180 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:06:48.892866 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_situacao__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
),
situacoes_unicas AS (
    SELECT DISTINCT
        situacao_nome,
        CASE 
            WHEN situacao_nome = 'Aprovado' THEN 'APROVADO'
            WHEN situacao_nome = 'Reprovado' THEN 'REPROVADO'
            WHEN situacao_nome = 'Transferido' THEN 'TRANSFERIDO'
            WHEN situacao_nome = 'Desistente' THEN 'DESISTENTE'
            ELSE 'OUTROS'
        END AS categoria,
        CASE 
            WHEN situacao_nome = 'Aprovado' THEN 1
            ELSE 0
        END AS eh_aprovado,
        CASE 
            WHEN situacao_nome = 'Reprovado' THEN 1
            ELSE 0
        END AS eh_reprovado
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY situacao_nome) - 1 AS id_situacao, -- Surrogate Key
        situacao_nome,
        categoria,
        eh_aprovado,
        eh_reprovado
    FROM situacoes_unicas
)

SELECT * FROM versao_final
  );
  
[0m15:06:48.957525 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.064 seconds
[0m15:06:48.960708 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:06:48.961170 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_situacao" rename to "dim_situacao__dbt_backup"
[0m15:06:48.962060 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:06:48.964787 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:06:48.965265 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_situacao__dbt_tmp" rename to "dim_situacao"
[0m15:06:48.966126 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:06:48.968062 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: COMMIT
[0m15:06:48.968728 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:06:48.969260 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: COMMIT
[0m15:06:48.971230 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:06:48.973542 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_situacao__dbt_backup"
[0m15:06:48.974548 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:06:48.975066 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_situacao__dbt_backup" cascade
[0m15:06:48.978204 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:06:48.979667 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: Close
[0m15:06:48.980539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61ff0cac-aa9f-4257-a044-a916eee2c3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e4f834cb60>]}
[0m15:06:48.981659 [info ] [Thread-1 (]: 8 of 13 OK created sql table model staging_dimensions.dim_situacao ............. [[32mSELECT 5[0m in 0.11s]
[0m15:06:48.982575 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_situacao
[0m15:06:48.983207 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_tempo
[0m15:06:48.984105 [info ] [Thread-1 (]: 9 of 13 START sql table model staging_dimensions.dim_tempo ..................... [RUN]
[0m15:06:48.984965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_situacao, now model.transformacao_matricula.dim_tempo)
[0m15:06:48.985552 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_tempo
[0m15:06:48.988258 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_tempo"
[0m15:06:48.988933 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_tempo
[0m15:06:48.992233 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_tempo"
[0m15:06:48.993319 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:06:48.994087 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: BEGIN
[0m15:06:48.994889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:49.005106 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:06:49.005714 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:06:49.006172 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_tempo__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
),
tempo_unico AS (
    SELECT DISTINCT
        ano,
        'Registro Anual' AS ano_ensino
    FROM source
)

SELECT * FROM tempo_unico
  );
  
[0m15:06:49.066796 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.060 seconds
[0m15:06:49.069943 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:06:49.070565 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_tempo" rename to "dim_tempo__dbt_backup"
[0m15:06:49.071601 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:06:49.074525 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:06:49.075058 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_tempo__dbt_tmp" rename to "dim_tempo"
[0m15:06:49.076073 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:06:49.078024 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: COMMIT
[0m15:06:49.078625 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:06:49.079159 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: COMMIT
[0m15:06:49.081917 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:06:49.086654 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_tempo__dbt_backup"
[0m15:06:49.087668 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:06:49.088080 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_tempo__dbt_backup" cascade
[0m15:06:49.091089 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:06:49.092430 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: Close
[0m15:06:49.093508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61ff0cac-aa9f-4257-a044-a916eee2c3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e4ec7cc3b0>]}
[0m15:06:49.094279 [info ] [Thread-1 (]: 9 of 13 OK created sql table model staging_dimensions.dim_tempo ................ [[32mSELECT 3[0m in 0.11s]
[0m15:06:49.094941 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_tempo
[0m15:06:49.095383 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_turma
[0m15:06:49.095948 [info ] [Thread-1 (]: 10 of 13 START sql table model staging_dimensions.dim_turma .................... [RUN]
[0m15:06:49.096428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_tempo, now model.transformacao_matricula.dim_turma)
[0m15:06:49.096864 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_turma
[0m15:06:49.099486 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_turma"
[0m15:06:49.100136 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_turma
[0m15:06:49.103339 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_turma"
[0m15:06:49.104136 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:06:49.104788 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: BEGIN
[0m15:06:49.106457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:49.117018 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m15:06:49.117807 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:06:49.118445 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_turma__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_marts"."transform_data" 
),
turmas_unicas AS (
    SELECT DISTINCT
        turma,
        turno,
        serie,
        mod_ens_codigo,
        modalidade_ens
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY turma, turno, serie) - 1 AS id_turma,
        turma,
        turno,
        NULL AS serie_codigo,
        serie,
        mod_ens_codigo,
        modalidade_ens AS modalidade_ensino
    FROM turmas_unicas
)

SELECT * FROM versao_final
  );
  
[0m15:06:49.263044 [debug] [Thread-1 (]: SQL status: SELECT 335 in 0.144 seconds
[0m15:06:49.265967 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:06:49.266415 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_turma" rename to "dim_turma__dbt_backup"
[0m15:06:49.267417 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:06:49.270074 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:06:49.270641 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_turma__dbt_tmp" rename to "dim_turma"
[0m15:06:49.271753 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:06:49.273542 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: COMMIT
[0m15:06:49.274103 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:06:49.274537 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: COMMIT
[0m15:06:49.277030 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:06:49.279872 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_turma__dbt_backup"
[0m15:06:49.281035 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:06:49.281534 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_turma__dbt_backup" cascade
[0m15:06:49.284232 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:06:49.285746 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: Close
[0m15:06:49.286602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61ff0cac-aa9f-4257-a044-a916eee2c3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e4ec7b32c0>]}
[0m15:06:49.287402 [info ] [Thread-1 (]: 10 of 13 OK created sql table model staging_dimensions.dim_turma ............... [[32mSELECT 335[0m in 0.19s]
[0m15:06:49.288102 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_turma
[0m15:06:49.289075 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.fato_matricula
[0m15:06:49.289591 [info ] [Thread-1 (]: 11 of 13 SKIP relation staging_marts.fato_matricula ............................ [[33mSKIP[0m]
[0m15:06:49.290194 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.fato_matricula
[0m15:06:49.290996 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_count_aluno_idade
[0m15:06:49.291493 [info ] [Thread-1 (]: 12 of 13 SKIP relation staging_marts.view_count_aluno_idade .................... [[33mSKIP[0m]
[0m15:06:49.291962 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_count_aluno_idade
[0m15:06:49.292413 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_taxa_aprovados
[0m15:06:49.292909 [info ] [Thread-1 (]: 13 of 13 SKIP relation staging_marts.view_taxa_aprovados ....................... [[33mSKIP[0m]
[0m15:06:49.293465 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_taxa_aprovados
[0m15:06:49.294816 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:49.295243 [debug] [MainThread]: On master: BEGIN
[0m15:06:49.295549 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:06:49.304037 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:06:49.304731 [debug] [MainThread]: On master: COMMIT
[0m15:06:49.305204 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:49.305649 [debug] [MainThread]: On master: COMMIT
[0m15:06:49.306381 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:06:49.306914 [debug] [MainThread]: On master: Close
[0m15:06:49.308948 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:06:49.309512 [debug] [MainThread]: Connection 'model.transformacao_matricula.dim_turma' was properly closed.
[0m15:06:49.310134 [info ] [MainThread]: 
[0m15:06:49.312816 [info ] [MainThread]: Finished running 9 table models, 4 view models in 0 hours 0 minutes and 2.57 seconds (2.57s).
[0m15:06:49.315436 [debug] [MainThread]: Command end result
[0m15:06:49.435937 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m15:06:49.437723 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m15:06:49.442434 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m15:06:49.442865 [info ] [MainThread]: 
[0m15:06:49.443260 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m15:06:49.443685 [info ] [MainThread]: 
[0m15:06:49.444176 [error] [MainThread]: [31mFailure in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)[0m
[0m15:06:49.444684 [error] [MainThread]:   Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m15:06:49.445073 [info ] [MainThread]: 
[0m15:06:49.445482 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m15:06:49.445867 [info ] [MainThread]: 
[0m15:06:49.446286 [error] [MainThread]: [31mFailure in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)[0m
[0m15:06:49.446728 [error] [MainThread]:   Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m15:06:49.447092 [info ] [MainThread]: 
[0m15:06:49.447487 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m15:06:49.447875 [info ] [MainThread]: 
[0m15:06:49.448418 [error] [MainThread]: [31mFailure in model dim_aluno (transformacao_aprovados/models/marts/dim_aluno.sql)[0m
[0m15:06:49.448905 [error] [MainThread]:   Database Error in model dim_aluno (transformacao_aprovados/models/marts/dim_aluno.sql)
  relation "alunos_unicos" does not exist
  LINE 32:     FROM alunos_unicos
                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/dim_aluno.sql
[0m15:06:49.449295 [info ] [MainThread]: 
[0m15:06:49.449707 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/dim_aluno.sql
[0m15:06:49.450079 [info ] [MainThread]: 
[0m15:06:49.450456 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=3 SKIP=3 NO-OP=0 TOTAL=13
[0m15:06:49.451042 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 6 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:06:49.452084 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.3509903, "process_in_blocks": "0", "process_kernel_time": 0.362134, "process_mem_max_rss": "129408", "process_out_blocks": "3872", "process_user_time": 3.268211}
[0m15:06:49.452574 [debug] [MainThread]: Command `dbt run` failed at 15:06:49.452503 after 4.35 seconds
[0m15:06:49.453003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e4fb7e0200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e4f781a4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76e4ee0db740>]}
[0m15:06:49.453378 [debug] [MainThread]: Flushing usage events
[0m15:06:50.209854 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:11:59.269360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d232094ba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d231fda4380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d23208b88c0>]}


============================== 15:11:59.272553 | 366d566e-6347-42b1-a4c4-68eb2eb45f00 ==============================
[0m15:11:59.272553 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:11:59.273146 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'printer_width': '80', 'use_colors': 'True', 'version_check': 'True', 'invocation_command': 'dbt clean', 'profiles_dir': '/home/murilo/.dbt', 'log_format': 'default', 'cache_selected_only': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'write_json': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'no_print': 'None', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'target_path': 'None', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:11:59.374054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '366d566e-6347-42b1-a4c4-68eb2eb45f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2320be8890>]}
[0m15:11:59.385460 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.16025682, "process_in_blocks": "0", "process_kernel_time": 0.21936, "process_mem_max_rss": "101656", "process_out_blocks": "8", "process_user_time": 1.110762}
[0m15:11:59.386071 [debug] [MainThread]: Command `dbt clean` succeeded at 15:11:59.385956 after 0.16 seconds
[0m15:11:59.386533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d23227b2c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d23206e7b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d231fc1d7c0>]}
[0m15:11:59.387039 [debug] [MainThread]: Flushing usage events
[0m15:12:00.487123 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:12:03.721398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7223baa64ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7223ba4dec60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7223b9e00500>]}


============================== 15:12:03.724654 | 78cfff20-1546-478b-8173-b3891fdf768d ==============================
[0m15:12:03.724654 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:12:03.725207 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'profiles_dir': '/home/murilo/.dbt', 'fail_fast': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'introspect': 'True', 'empty': 'False', 'use_colors': 'True', 'target_path': 'None', 'version_check': 'True', 'debug': 'False', 'partial_parse': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'write_json': 'True', 'warn_error': 'None', 'quiet': 'False'}
[0m15:12:03.856515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78cfff20-1546-478b-8173-b3891fdf768d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7223b98aede0>]}
[0m15:12:03.906123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78cfff20-1546-478b-8173-b3891fdf768d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7223b9e26c30>]}
[0m15:12:03.906994 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:12:04.014454 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:12:04.015558 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:12:04.016007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '78cfff20-1546-478b-8173-b3891fdf768d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7223ba920bf0>]}
[0m15:12:04.958814 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m15:12:04.959388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '78cfff20-1546-478b-8173-b3891fdf768d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7223b83d5e80>]}
[0m15:12:05.175394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78cfff20-1546-478b-8173-b3891fdf768d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7223b7b82db0>]}
[0m15:12:05.244706 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m15:12:05.246419 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m15:12:05.259885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78cfff20-1546-478b-8173-b3891fdf768d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7223b7760740>]}
[0m15:12:05.260461 [info ] [MainThread]: Found 13 models, 37 data tests, 1 source, 459 macros
[0m15:12:05.260885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78cfff20-1546-478b-8173-b3891fdf768d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7223b7b81a00>]}
[0m15:12:05.263118 [info ] [MainThread]: 
[0m15:12:05.263625 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m15:12:05.264012 [info ] [MainThread]: 
[0m15:12:05.264560 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:12:05.268948 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula'
[0m15:12:05.308175 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m15:12:05.308811 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m15:12:05.309247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:05.320917 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.012 seconds
[0m15:12:05.322235 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m15:12:05.324362 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m15:12:05.324907 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m15:12:05.325277 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:05.334284 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.009 seconds
[0m15:12:05.335523 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m15:12:05.337564 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m15:12:05.338172 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m15:12:05.338536 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:05.348354 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.010 seconds
[0m15:12:05.349569 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m15:12:05.352232 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m15:12:05.352846 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m15:12:05.353231 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:05.362876 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.010 seconds
[0m15:12:05.364079 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m15:12:05.367227 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m15:12:05.367857 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m15:12:05.368243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:05.378081 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.010 seconds
[0m15:12:05.379291 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m15:12:05.380255 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula, now create_transformacao_matricula_staging_intermediate)
[0m15:12:05.380852 [debug] [ThreadPool]: Creating schema "database: "transformacao_matricula"
schema: "staging_intermediate"
"
[0m15:12:05.385225 [debug] [ThreadPool]: Using postgres connection "create_transformacao_matricula_staging_intermediate"
[0m15:12:05.385705 [debug] [ThreadPool]: On create_transformacao_matricula_staging_intermediate: BEGIN
[0m15:12:05.386036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:05.395772 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m15:12:05.396642 [debug] [ThreadPool]: Using postgres connection "create_transformacao_matricula_staging_intermediate"
[0m15:12:05.397028 [debug] [ThreadPool]: On create_transformacao_matricula_staging_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "create_transformacao_matricula_staging_intermediate"} */
create schema if not exists "staging_intermediate"
[0m15:12:05.397954 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m15:12:05.398872 [debug] [ThreadPool]: On create_transformacao_matricula_staging_intermediate: COMMIT
[0m15:12:05.399296 [debug] [ThreadPool]: Using postgres connection "create_transformacao_matricula_staging_intermediate"
[0m15:12:05.399639 [debug] [ThreadPool]: On create_transformacao_matricula_staging_intermediate: COMMIT
[0m15:12:05.405469 [debug] [ThreadPool]: SQL status: COMMIT in 0.005 seconds
[0m15:12:05.406149 [debug] [ThreadPool]: On create_transformacao_matricula_staging_intermediate: Close
[0m15:12:05.406736 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_transformacao_matricula_staging_intermediate, now create_transformacao_matricula_staging_facts)
[0m15:12:05.407317 [debug] [ThreadPool]: Creating schema "database: "transformacao_matricula"
schema: "staging_facts"
"
[0m15:12:05.409141 [debug] [ThreadPool]: Using postgres connection "create_transformacao_matricula_staging_facts"
[0m15:12:05.409588 [debug] [ThreadPool]: On create_transformacao_matricula_staging_facts: BEGIN
[0m15:12:05.409956 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:05.419050 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:12:05.419520 [debug] [ThreadPool]: Using postgres connection "create_transformacao_matricula_staging_facts"
[0m15:12:05.419875 [debug] [ThreadPool]: On create_transformacao_matricula_staging_facts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "create_transformacao_matricula_staging_facts"} */
create schema if not exists "staging_facts"
[0m15:12:05.420844 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m15:12:05.421764 [debug] [ThreadPool]: On create_transformacao_matricula_staging_facts: COMMIT
[0m15:12:05.422126 [debug] [ThreadPool]: Using postgres connection "create_transformacao_matricula_staging_facts"
[0m15:12:05.422436 [debug] [ThreadPool]: On create_transformacao_matricula_staging_facts: COMMIT
[0m15:12:05.424471 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m15:12:05.424895 [debug] [ThreadPool]: On create_transformacao_matricula_staging_facts: Close
[0m15:12:05.427475 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_transformacao_matricula_staging_facts, now list_transformacao_matricula_staging_staging)
[0m15:12:05.432527 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m15:12:05.432976 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: BEGIN
[0m15:12:05.433281 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:05.442281 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:12:05.442764 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m15:12:05.443436 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_staging"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m15:12:05.446963 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m15:12:05.449107 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: ROLLBACK
[0m15:12:05.449941 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: Close
[0m15:12:05.450559 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_staging, now list_transformacao_matricula_staging_dimensions)
[0m15:12:05.452934 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_dimensions"
[0m15:12:05.453398 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: BEGIN
[0m15:12:05.453789 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:05.463016 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:12:05.463911 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_dimensions"
[0m15:12:05.464257 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_dimensions"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dimensions'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dimensions'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dimensions'
  
[0m15:12:05.467571 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m15:12:05.469334 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: ROLLBACK
[0m15:12:05.470045 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: Close
[0m15:12:05.470674 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_dimensions, now list_transformacao_matricula_staging_marts)
[0m15:12:05.473072 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m15:12:05.473619 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: BEGIN
[0m15:12:05.473963 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:05.483349 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:12:05.483827 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m15:12:05.484450 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_marts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m15:12:05.488225 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m15:12:05.490417 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: ROLLBACK
[0m15:12:05.491211 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: Close
[0m15:12:05.491832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_marts, now list_transformacao_matricula_staging_intermediate)
[0m15:12:05.494384 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_intermediate"
[0m15:12:05.494862 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: BEGIN
[0m15:12:05.495258 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:05.503993 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:12:05.504454 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_intermediate"
[0m15:12:05.504811 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_intermediate"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_intermediate'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_intermediate'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_intermediate'
  
[0m15:12:05.508215 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m15:12:05.510212 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: ROLLBACK
[0m15:12:05.511012 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: Close
[0m15:12:05.511654 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_intermediate, now list_transformacao_matricula_staging_facts)
[0m15:12:05.513521 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_facts"
[0m15:12:05.513983 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: BEGIN
[0m15:12:05.514328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:05.523260 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:12:05.524076 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_facts"
[0m15:12:05.524410 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_facts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_facts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_facts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_facts'
  
[0m15:12:05.527861 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m15:12:05.529608 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: ROLLBACK
[0m15:12:05.530497 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: Close
[0m15:12:05.535085 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:05.535562 [debug] [MainThread]: On master: BEGIN
[0m15:12:05.535898 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:12:05.546115 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m15:12:05.546578 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:05.546967 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:12:05.550276 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m15:12:05.551778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78cfff20-1546-478b-8173-b3891fdf768d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7223b7fb6090>]}
[0m15:12:05.552260 [debug] [MainThread]: On master: ROLLBACK
[0m15:12:05.552966 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:05.553350 [debug] [MainThread]: On master: BEGIN
[0m15:12:05.554434 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:12:05.554864 [debug] [MainThread]: On master: COMMIT
[0m15:12:05.555193 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:05.555502 [debug] [MainThread]: On master: COMMIT
[0m15:12:05.556118 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:12:05.556501 [debug] [MainThread]: On master: Close
[0m15:12:05.558976 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.staging_situacao_alunos
[0m15:12:05.560154 [info ] [Thread-1 (]: 1 of 13 START sql table model staging_staging.staging_situacao_alunos .......... [RUN]
[0m15:12:05.560820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_facts, now model.transformacao_matricula.staging_situacao_alunos)
[0m15:12:05.561261 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.staging_situacao_alunos
[0m15:12:05.567764 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.staging_situacao_alunos"
[0m15:12:05.568664 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.staging_situacao_alunos
[0m15:12:05.612869 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.staging_situacao_alunos"
[0m15:12:05.614401 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:12:05.614930 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: BEGIN
[0m15:12:05.615335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:05.625575 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:12:05.626236 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:12:05.626727 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */

  
    

  create  table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp"
  
  
    as
  
  (
    WITH source AS (
    SELECT * FROM "transformacao_matricula"."staging"."staging_alunos_raw"
),

cleaning_renaming AS (
    SELECT
        ano,
        codigo_escola,
        matricula,
        escola AS nome_escola,
        endereco_logradouro AS endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa,
        modalidade_ensino_codigo AS mod_ens_codigo,
        -- Transformação da SÉRIE
        CASE
            -- Ensino Fundamental (1º ao 9º)
            WHEN serie LIKE '%1 ANO%' OR serie LIKE '%1º ANO%' THEN '1º ANO'
            WHEN serie LIKE '%2 ANO%' OR serie LIKE '%2º ANO%' THEN '2º ANO'
            WHEN serie LIKE '%3 ANO%' OR serie LIKE '%3º ANO%' THEN '3º ANO'
            WHEN serie LIKE '%4 ANO%' OR serie LIKE '%4º ANO%' THEN '4º ANO'
            WHEN serie LIKE '%5 ANO%' OR serie LIKE '%5º ANO%' THEN '5º ANO'
            WHEN serie LIKE '%6 ANO%' OR serie LIKE '%6º ANO%' THEN '6º ANO'
            WHEN serie LIKE '%7 ANO%' OR serie LIKE '%7º ANO%' THEN '7º ANO'
            WHEN serie LIKE '%8 ANO%' OR serie LIKE '%8º ANO%' THEN '8º ANO'
            WHEN serie LIKE '%9 ANO%' OR serie LIKE '%9º ANO%' THEN '9º ANO'
            -- Educação Infantil (Berçário e Grupos)
            WHEN serie LIKE '%BER%' THEN 'BERÇARIO'
            WHEN serie LIKE '%GRUPO I%' OR serie LIKE '%GRUPO 1%' THEN 'GRUPO I'
            WHEN serie LIKE '%GRUPO II%' THEN 'GRUPO II'
            WHEN serie LIKE '%GRUPO III%' THEN 'GRUPO III'
            WHEN serie LIKE '%GRUPO IV%' THEN 'GRUPO IV'
            WHEN serie LIKE '%GRUPO V%' THEN 'GRUPO V'
            -- EJA (Módulos 1 ao 5) 
            WHEN serie LIKE '%1%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 1'
            WHEN serie LIKE '%2%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 2'
            WHEN serie LIKE '%3%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 3'
            WHEN serie LIKE '%4%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 4'
            WHEN serie LIKE '%5%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 5'
            WHEN serie LIKE '%TRAVESSIA%' THEN 'TRAVESSIA RECIFE'
            WHEN serie LIKE '%CORRECAO%1%' THEN 'CORREÇÃO DE FLUXO 1 - ALFABETIZACAO'
            WHEN serie LIKE '%CORRECAO%2%' THEN 'CORREÇÃO DE FLUXO 2 - ACELERACAO'
            ELSE 'OUTROS'
        END AS serie,
        turma,
        turno,
        idade,
        -- transformação do SEXO
        CASE
            WHEN sexo = '1' THEN 'Masculino'
            WHEN sexo = '2' THEN 'Feminino'
            WHEN sexo = '3' THEN 'Outros'
            ELSE 'Não informado'
        END AS sexo,
        -- transformação de situacao
        CASE 
            WHEN situacao_nome LIKE '%APROV%' THEN 'Aprovado'
            WHEN situacao_nome LIKE '%RET%' OR situacao_nome LIKE '%REPRO%' THEN 'Reprovado'
            WHEN situacao_nome LIKE '%TR%' OR situacao_nome LIKE '%REMAN%' THEN 'Transferido'
            WHEN situacao_nome LIKE '%DESIST%' THEN 'Desistente'
            ELSE 'Outros'
        END AS sit_nome,
        -- Transformação da MODALIDADE
        CASE
            WHEN modalidade_ensino LIKE '%EDUCACAO INFANTIL%' THEN 'EDUCAÇÃO INFANTIL'
            WHEN modalidade_ensino LIKE '%ENSINO FUNDAMENTAL%' THEN 'ENSINO FUNDAMENTAL'
            WHEN modalidade_ensino LIKE '%EDUCACAO JOVENS E ADULTOS%' THEN 'EJA'
            WHEN modalidade_ensino LIKE '%CORRE%' THEN 'CORREÇÃO DE FLUXO'
            ELSE 'OUTROS'
        END AS modalidade_ens
    FROM source
)

SELECT * FROM cleaning_renaming
  );
  
[0m15:12:06.346878 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 0.719 seconds
[0m15:12:06.356122 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:12:06.356633 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
alter table "transformacao_matricula"."staging_staging"."staging_situacao_alunos" rename to "staging_situacao_alunos__dbt_backup"
[0m15:12:06.357689 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:12:06.360238 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:12:06.360741 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
alter table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp" rename to "staging_situacao_alunos"
[0m15:12:06.361785 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:12:06.375891 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: COMMIT
[0m15:12:06.376402 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:12:06.376779 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: COMMIT
[0m15:12:06.383966 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m15:12:06.389411 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_backup"
[0m15:12:06.394305 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:12:06.394858 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
drop table if exists "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_backup" cascade
[0m15:12:06.409495 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m15:12:06.411889 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: Close
[0m15:12:06.413514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78cfff20-1546-478b-8173-b3891fdf768d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7223ba878bc0>]}
[0m15:12:06.414309 [info ] [Thread-1 (]: 1 of 13 OK created sql table model staging_staging.staging_situacao_alunos ..... [[32mSELECT 319146[0m in 0.85s]
[0m15:12:06.414954 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.staging_situacao_alunos
[0m15:12:06.415389 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m15:12:06.415905 [info ] [Thread-1 (]: 2 of 13 START sql view model staging_marts.view_frequencia_situacao_escola ..... [RUN]
[0m15:12:06.416619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.staging_situacao_alunos, now model.transformacao_matricula.view_frequencia_situacao_escola)
[0m15:12:06.417450 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_frequencia_situacao_escola
[0m15:12:06.419933 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m15:12:06.420730 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_frequencia_situacao_escola
[0m15:12:06.437083 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m15:12:06.439246 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m15:12:06.439850 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: BEGIN
[0m15:12:06.440509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:06.450853 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:12:06.451544 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m15:12:06.452149 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_frequencia_situacao_escola"} */

  create view "transformacao_matricula"."staging_marts"."view_frequencia_situacao_escola__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    de.nome_escola,
    de.codigo_escola,
    ds.situacao_nome,
    COUNT(fm.matricula) AS contagem_situacao
FROM
    fato_matricula fm
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, de.nome_escola, de.codigo_escola, ds.situacao_nome
ORDER BY
    dtemp.ano, de.nome_escola, contagem_situacao DESC
  );
[0m15:12:06.453401 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 15:     fato_matricula fm
             ^

[0m15:12:06.454069 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: ROLLBACK
[0m15:12:06.455063 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: Close
[0m15:12:06.459643 [debug] [Thread-1 (]: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m15:12:06.460661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78cfff20-1546-478b-8173-b3891fdf768d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7223b47ba5a0>]}
[0m15:12:06.461535 [error] [Thread-1 (]: 2 of 13 ERROR creating sql view model staging_marts.view_frequencia_situacao_escola  [[31mERROR[0m in 0.04s]
[0m15:12:06.462370 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m15:12:06.462967 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_matricula_detalhada
[0m15:12:06.463656 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_frequencia_situacao_escola' to be skipped because of status 'error'.  Reason: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql.
[0m15:12:06.464367 [info ] [Thread-1 (]: 3 of 13 START sql view model staging_marts.view_matricula_detalhada ............ [RUN]
[0m15:12:06.465836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_frequencia_situacao_escola, now model.transformacao_matricula.view_matricula_detalhada)
[0m15:12:06.466424 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_matricula_detalhada
[0m15:12:06.469888 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_matricula_detalhada"
[0m15:12:06.470826 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_matricula_detalhada
[0m15:12:06.475522 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_matricula_detalhada"
[0m15:12:06.476694 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m15:12:06.477438 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: BEGIN
[0m15:12:06.478074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:06.489071 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m15:12:06.489760 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m15:12:06.490307 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_matricula_detalhada"} */

  create view "transformacao_matricula"."staging_marts"."view_matricula_detalhada__dbt_tmp"
    
    
  as (
    
SELECT
    fm.matricula,
    da.sexo,
    da.idade,
    da.faixa_etaria,
    de.nome_escola,
    de.codigo_escola,
    dt.turma,
    dt.turno,
    dt.serie,
    dt.modalidade_ensino,
    ds.situacao_nome,
    ds.categoria AS categoria_situacao,
    ds.eh_aprovado,
    ds.eh_reprovado,
    dl.desc_rpa,
    dl.endereco_bairro AS bairro_localizacao,
    dtemp.ano AS ano_registro
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
  );
[0m15:12:06.491533 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 27:     fato_matricula fm
             ^

[0m15:12:06.492153 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: ROLLBACK
[0m15:12:06.493103 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: Close
[0m15:12:06.499454 [debug] [Thread-1 (]: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m15:12:06.500269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78cfff20-1546-478b-8173-b3891fdf768d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7223b47ee960>]}
[0m15:12:06.501151 [error] [Thread-1 (]: 3 of 13 ERROR creating sql view model staging_marts.view_matricula_detalhada ... [[31mERROR[0m in 0.03s]
[0m15:12:06.501978 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_matricula_detalhada
[0m15:12:06.502583 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.transform_data
[0m15:12:06.504113 [info ] [Thread-1 (]: 4 of 13 START sql table model staging_intermediate.transform_data .............. [RUN]
[0m15:12:06.503335 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_matricula_detalhada' to be skipped because of status 'error'.  Reason: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql.
[0m15:12:06.504789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_matricula_detalhada, now model.transformacao_matricula.transform_data)
[0m15:12:06.505564 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.transform_data
[0m15:12:06.511353 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.transform_data"
[0m15:12:06.512436 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.transform_data
[0m15:12:06.517459 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.transform_data"
[0m15:12:06.518496 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:12:06.518935 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: BEGIN
[0m15:12:06.519296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:06.528732 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:12:06.529384 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:12:06.529805 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */

  
    

  create  table "transformacao_matricula"."staging_intermediate"."transform_data__dbt_tmp"
  
  
    as
  
  (
    

with staged_data AS (
    SELECT * FROM "transformacao_matricula"."staging_staging"."staging_situacao_alunos"
),

transformed_data AS (
    SELECT
        CAST(ano AS INTEGER) AS ano,
        CAST(codigo_escola AS INTEGER) AS codigo_escola,
        CAST(matricula AS INTEGER) AS matricula,
        nome_escola,
        endereco_logra,
        endereco_bairro,
        endereco_numero,
        CAST(rpa AS INTEGER) AS rpa,
        CAST(mod_ens_codigo AS INTEGER) AS mod_ens_codigo,
        serie,
        turma,
        turno,
        CAST(idade AS INTEGER) AS idade,
        sexo,
        sit_nome AS situacao_nome,
        modalidade_ens,
        CASE
            WHEN CAST(idade AS INTEGER) <= 3 THEN '0-3 Anos (Educação Infantil)'
            WHEN CAST(idade AS INTEGER) <= 5 THEN '4-5 Anos (Pré-escola)'
            WHEN CAST(idade AS INTEGER) <= 10 THEN '6-10 Anos (Fundamental I)'
            WHEN CAST(idade AS INTEGER) <= 14 THEN '11-14 Anos (Fundamental II)'
            WHEN CAST(idade AS INTEGER) >= 15 THEN '15+ Anos (EJA e Outros)'
            ELSE 'Não Informado'
        END AS faixa_etaria
    FROM staged_data
)

SELECT * FROM transformed_data
  );
  
[0m15:12:07.027492 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 0.497 seconds
[0m15:12:07.030714 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:12:07.031155 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
alter table "transformacao_matricula"."staging_intermediate"."transform_data__dbt_tmp" rename to "transform_data"
[0m15:12:07.032323 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:12:07.033816 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: COMMIT
[0m15:12:07.034232 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:12:07.034588 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: COMMIT
[0m15:12:07.049091 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m15:12:07.051252 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_intermediate"."transform_data__dbt_backup"
[0m15:12:07.052103 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:12:07.052478 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
drop table if exists "transformacao_matricula"."staging_intermediate"."transform_data__dbt_backup" cascade
[0m15:12:07.053438 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:12:07.054718 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: Close
[0m15:12:07.055316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78cfff20-1546-478b-8173-b3891fdf768d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7223b4605c40>]}
[0m15:12:07.055919 [info ] [Thread-1 (]: 4 of 13 OK created sql table model staging_intermediate.transform_data ......... [[32mSELECT 319146[0m in 0.55s]
[0m15:12:07.056520 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.transform_data
[0m15:12:07.057927 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_aluno
[0m15:12:07.058810 [info ] [Thread-1 (]: 5 of 13 START sql table model staging_dimensions.dim_aluno ..................... [RUN]
[0m15:12:07.059389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.transform_data, now model.transformacao_matricula.dim_aluno)
[0m15:12:07.059818 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_aluno
[0m15:12:07.062498 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_aluno"
[0m15:12:07.063363 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_aluno
[0m15:12:07.066781 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_aluno"
[0m15:12:07.067543 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m15:12:07.067953 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: BEGIN
[0m15:12:07.068319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:07.078736 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:12:07.079412 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m15:12:07.079981 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_aluno"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_aluno__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),
alunos_unicos AS (
    SELECT DISTINCT
        matricula,
        sexo,
        idade,
        faixa_etaria
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY matricula) - 1 AS id_aluno, -- Surrogate Key
        matricula,
        sexo,
        idade,
        faixa_etaria
    FROM alunos_unicos
)

SELECT * FROM versao_final
  );
  
[0m15:12:07.750186 [debug] [Thread-1 (]: SQL status: SELECT 319143 in 0.670 seconds
[0m15:12:07.753223 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m15:12:07.753693 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_aluno"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_aluno__dbt_tmp" rename to "dim_aluno"
[0m15:12:07.754689 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:12:07.756171 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: COMMIT
[0m15:12:07.756668 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m15:12:07.757137 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: COMMIT
[0m15:12:07.769464 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m15:12:07.771540 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_aluno__dbt_backup"
[0m15:12:07.772394 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m15:12:07.772778 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_aluno"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_aluno__dbt_backup" cascade
[0m15:12:07.773662 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m15:12:07.774917 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: Close
[0m15:12:07.775516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78cfff20-1546-478b-8173-b3891fdf768d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7223b47af020>]}
[0m15:12:07.776148 [info ] [Thread-1 (]: 5 of 13 OK created sql table model staging_dimensions.dim_aluno ................ [[32mSELECT 319143[0m in 0.72s]
[0m15:12:07.776754 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_aluno
[0m15:12:07.777171 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_escola
[0m15:12:07.777777 [info ] [Thread-1 (]: 6 of 13 START sql table model staging_dimensions.dim_escola .................... [RUN]
[0m15:12:07.778296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_aluno, now model.transformacao_matricula.dim_escola)
[0m15:12:07.778702 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_escola
[0m15:12:07.781243 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_escola"
[0m15:12:07.781963 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_escola
[0m15:12:07.785313 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_escola"
[0m15:12:07.786093 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:12:07.786625 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: BEGIN
[0m15:12:07.787086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:07.798322 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m15:12:07.799056 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:12:07.799636 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_escola__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),
escolas_unicas AS (
    SELECT DISTINCT
        codigo_escola,
        nome_escola,
        endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY codigo_escola) - 1 AS id_escola, -- Surrogate Key
        codigo_escola,
        nome_escola,
        endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa
    FROM escolas_unicas
)

SELECT * FROM versao_final
  );
  
[0m15:12:07.935383 [debug] [Thread-1 (]: SQL status: SELECT 433 in 0.135 seconds
[0m15:12:07.940533 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:12:07.941063 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_escola" rename to "dim_escola__dbt_backup"
[0m15:12:07.941985 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:12:07.944437 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:12:07.944905 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_escola__dbt_tmp" rename to "dim_escola"
[0m15:12:07.946062 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:12:07.948279 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: COMMIT
[0m15:12:07.948750 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:12:07.949155 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: COMMIT
[0m15:12:07.955525 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m15:12:07.957676 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_escola__dbt_backup"
[0m15:12:07.958631 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:12:07.959036 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_escola__dbt_backup" cascade
[0m15:12:07.962209 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:12:07.963547 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: Close
[0m15:12:07.964215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78cfff20-1546-478b-8173-b3891fdf768d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7223b46a0980>]}
[0m15:12:07.964942 [info ] [Thread-1 (]: 6 of 13 OK created sql table model staging_dimensions.dim_escola ............... [[32mSELECT 433[0m in 0.19s]
[0m15:12:07.965584 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_escola
[0m15:12:07.966074 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_localizacao
[0m15:12:07.966736 [info ] [Thread-1 (]: 7 of 13 START sql table model staging_dimensions.dim_localizacao ............... [RUN]
[0m15:12:07.967282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_escola, now model.transformacao_matricula.dim_localizacao)
[0m15:12:07.967767 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_localizacao
[0m15:12:07.970266 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_localizacao"
[0m15:12:07.970963 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_localizacao
[0m15:12:07.974387 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_localizacao"
[0m15:12:07.975083 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:12:07.975493 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: BEGIN
[0m15:12:07.975903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:07.986302 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:12:07.986984 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:12:07.987528 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_localizacao__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),
localizacoes_unicas AS (
    SELECT DISTINCT
        rpa,
        endereco_bairro,
        CASE rpa
            WHEN 1 THEN 'RPA 1 (Centro)'
            WHEN 2 THEN 'RPA 2 (Zona Norte)'
            WHEN 3 THEN 'RPA 3 (Zona Oeste)'
            WHEN 4 THEN 'RPA 4 (Zona Sudoeste)'
            WHEN 5 THEN 'RPA 5 (Zona Sul)'
            WHEN 6 THEN 'RPA 6 (Zona Sudeste)'
            ELSE 'RPA Não Identificada'
        END AS desc_rpa
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY rpa, endereco_bairro) - 1 AS id_locali, -- Surrogate Key
        rpa,
        endereco_bairro,
        desc_rpa
    FROM localizacoes_unicas
)

SELECT * FROM versao_final
  );
  
[0m15:12:08.096854 [debug] [Thread-1 (]: SQL status: SELECT 88 in 0.109 seconds
[0m15:12:08.099803 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:12:08.100263 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_localizacao" rename to "dim_localizacao__dbt_backup"
[0m15:12:08.101303 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:12:08.103932 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:12:08.104404 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_localizacao__dbt_tmp" rename to "dim_localizacao"
[0m15:12:08.105341 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:12:08.107038 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: COMMIT
[0m15:12:08.107471 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:12:08.107871 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: COMMIT
[0m15:12:08.113837 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m15:12:08.116434 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_localizacao__dbt_backup"
[0m15:12:08.117306 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:12:08.117707 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_localizacao__dbt_backup" cascade
[0m15:12:08.120805 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:12:08.122684 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: Close
[0m15:12:08.123319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78cfff20-1546-478b-8173-b3891fdf768d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7223b47a3e90>]}
[0m15:12:08.124024 [info ] [Thread-1 (]: 7 of 13 OK created sql table model staging_dimensions.dim_localizacao .......... [[32mSELECT 88[0m in 0.16s]
[0m15:12:08.124696 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_localizacao
[0m15:12:08.125209 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_situacao
[0m15:12:08.125849 [info ] [Thread-1 (]: 8 of 13 START sql table model staging_dimensions.dim_situacao .................. [RUN]
[0m15:12:08.126405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_localizacao, now model.transformacao_matricula.dim_situacao)
[0m15:12:08.126914 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_situacao
[0m15:12:08.129594 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_situacao"
[0m15:12:08.130385 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_situacao
[0m15:12:08.133734 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_situacao"
[0m15:12:08.134441 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:12:08.134868 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: BEGIN
[0m15:12:08.135244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:08.146271 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m15:12:08.146965 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:12:08.147544 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_situacao__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),
situacoes_unicas AS (
    SELECT DISTINCT
        situacao_nome,
        CASE 
            WHEN situacao_nome = 'Aprovado' THEN 'APROVADO'
            WHEN situacao_nome = 'Reprovado' THEN 'REPROVADO'
            WHEN situacao_nome = 'Transferido' THEN 'TRANSFERIDO'
            WHEN situacao_nome = 'Desistente' THEN 'DESISTENTE'
            ELSE 'OUTROS'
        END AS categoria,
        CASE 
            WHEN situacao_nome = 'Aprovado' THEN 1
            ELSE 0
        END AS eh_aprovado,
        CASE 
            WHEN situacao_nome = 'Reprovado' THEN 1
            ELSE 0
        END AS eh_reprovado
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY situacao_nome) - 1 AS id_situacao, -- Surrogate Key
        situacao_nome,
        categoria,
        eh_aprovado,
        eh_reprovado
    FROM situacoes_unicas
)

SELECT * FROM versao_final
  );
  
[0m15:12:08.218981 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.071 seconds
[0m15:12:08.223569 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:12:08.224074 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_situacao" rename to "dim_situacao__dbt_backup"
[0m15:12:08.225063 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:12:08.227639 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:12:08.228092 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_situacao__dbt_tmp" rename to "dim_situacao"
[0m15:12:08.229076 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:12:08.230752 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: COMMIT
[0m15:12:08.231192 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:12:08.231559 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: COMMIT
[0m15:12:08.233585 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:12:08.235995 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_situacao__dbt_backup"
[0m15:12:08.237188 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:12:08.237769 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_situacao__dbt_backup" cascade
[0m15:12:08.241579 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:12:08.243115 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: Close
[0m15:12:08.243832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78cfff20-1546-478b-8173-b3891fdf768d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7223b466f650>]}
[0m15:12:08.244736 [info ] [Thread-1 (]: 8 of 13 OK created sql table model staging_dimensions.dim_situacao ............. [[32mSELECT 5[0m in 0.12s]
[0m15:12:08.245581 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_situacao
[0m15:12:08.246176 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_tempo
[0m15:12:08.247303 [info ] [Thread-1 (]: 9 of 13 START sql table model staging_dimensions.dim_tempo ..................... [RUN]
[0m15:12:08.247985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_situacao, now model.transformacao_matricula.dim_tempo)
[0m15:12:08.248443 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_tempo
[0m15:12:08.251813 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_tempo"
[0m15:12:08.252564 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_tempo
[0m15:12:08.256212 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_tempo"
[0m15:12:08.257035 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:12:08.257432 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: BEGIN
[0m15:12:08.257875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:08.268412 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:12:08.269168 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:12:08.269704 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_tempo__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),
tempo_unico AS (
    SELECT DISTINCT
        ano,
        'Registro Anual' AS ano_ensino
    FROM source
)

SELECT * FROM tempo_unico
  );
  
[0m15:12:08.332744 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.062 seconds
[0m15:12:08.335766 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:12:08.336258 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_tempo" rename to "dim_tempo__dbt_backup"
[0m15:12:08.337161 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:12:08.339677 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:12:08.340108 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_tempo__dbt_tmp" rename to "dim_tempo"
[0m15:12:08.341118 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:12:08.342789 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: COMMIT
[0m15:12:08.343240 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:12:08.343589 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: COMMIT
[0m15:12:08.349999 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m15:12:08.352691 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_tempo__dbt_backup"
[0m15:12:08.353525 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:12:08.353903 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_tempo__dbt_backup" cascade
[0m15:12:08.357572 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:12:08.358912 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: Close
[0m15:12:08.359525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78cfff20-1546-478b-8173-b3891fdf768d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7223b466ffb0>]}
[0m15:12:08.360184 [info ] [Thread-1 (]: 9 of 13 OK created sql table model staging_dimensions.dim_tempo ................ [[32mSELECT 3[0m in 0.11s]
[0m15:12:08.360791 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_tempo
[0m15:12:08.361214 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_turma
[0m15:12:08.361703 [info ] [Thread-1 (]: 10 of 13 START sql table model staging_dimensions.dim_turma .................... [RUN]
[0m15:12:08.362282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_tempo, now model.transformacao_matricula.dim_turma)
[0m15:12:08.362739 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_turma
[0m15:12:08.365311 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_turma"
[0m15:12:08.365975 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_turma
[0m15:12:08.369050 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_turma"
[0m15:12:08.369782 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:12:08.370172 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: BEGIN
[0m15:12:08.370578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:08.380305 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:12:08.380994 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:12:08.381530 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_turma__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),
turmas_unicas AS (
    SELECT DISTINCT
        turma,
        turno,
        serie,
        mod_ens_codigo,
        modalidade_ens
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY turma, turno, serie) - 1 AS id_turma,
        turma,
        turno,
        NULL AS serie_codigo,
        serie,
        mod_ens_codigo,
        modalidade_ens AS modalidade_ensino
    FROM turmas_unicas
)

SELECT * FROM versao_final
  );
  
[0m15:12:08.530553 [debug] [Thread-1 (]: SQL status: SELECT 335 in 0.148 seconds
[0m15:12:08.533511 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:12:08.533991 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_turma" rename to "dim_turma__dbt_backup"
[0m15:12:08.535003 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:12:08.539034 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:12:08.539540 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_turma__dbt_tmp" rename to "dim_turma"
[0m15:12:08.540532 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:12:08.542187 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: COMMIT
[0m15:12:08.542624 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:12:08.542984 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: COMMIT
[0m15:12:08.549310 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m15:12:08.613901 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_turma__dbt_backup"
[0m15:12:08.614839 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:12:08.615218 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_turma__dbt_backup" cascade
[0m15:12:08.618560 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:12:08.619912 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: Close
[0m15:12:08.620542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78cfff20-1546-478b-8173-b3891fdf768d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7223b44f2bd0>]}
[0m15:12:08.621208 [info ] [Thread-1 (]: 10 of 13 OK created sql table model staging_dimensions.dim_turma ............... [[32mSELECT 335[0m in 0.26s]
[0m15:12:08.621803 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_turma
[0m15:12:08.622863 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.fato_matricula
[0m15:12:08.623762 [info ] [Thread-1 (]: 11 of 13 START sql table model staging_facts.fato_matricula .................... [RUN]
[0m15:12:08.624283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_turma, now model.transformacao_matricula.fato_matricula)
[0m15:12:08.624749 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.fato_matricula
[0m15:12:08.628326 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.fato_matricula"
[0m15:12:08.629117 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.fato_matricula
[0m15:12:08.632343 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.fato_matricula"
[0m15:12:08.633304 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.fato_matricula"
[0m15:12:08.633817 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: BEGIN
[0m15:12:08.634274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:08.644495 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:12:08.645182 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.fato_matricula"
[0m15:12:08.645820 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.fato_matricula"} */

  
    

  create  table "transformacao_matricula"."staging_facts"."fato_matricula__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),

-- Dimensões com seus IDs
dim_aluno AS (
    SELECT id_aluno, matricula, sexo, idade, faixa_etaria 
    FROM "transformacao_matricula"."staging_dimensions"."dim_aluno"
),

dim_escola AS (
    SELECT id_escola, codigo_escola 
    FROM "transformacao_matricula"."staging_dimensions"."dim_escola"
),

dim_turma AS (
    SELECT id_turma, turma, turno, serie, mod_ens_codigo, modalidade_ensino 
    FROM "transformacao_matricula"."staging_dimensions"."dim_turma"
),

dim_situacao AS (
    SELECT id_situacao, situacao_nome 
    FROM "transformacao_matricula"."staging_dimensions"."dim_situacao"
),

dim_localizacao AS (
    SELECT id_locali, rpa, endereco_bairro 
    FROM "transformacao_matricula"."staging_dimensions"."dim_localizacao"
),

dim_tempo AS (
    SELECT id_tempo, ano 
    FROM "transformacao_matricula"."staging_dimensions"."dim_tempo"
),

-- Construindo a tabela fato
fato AS (
    SELECT
        da.id_aluno,
        de.id_escola,
        dt.id_turma,
        dsi.id_situacao,
        dl.id_locali,
        dte.id_tempo,
        s.matricula,
        1 AS qtd_alunos
    FROM source s
    
    LEFT JOIN dim_aluno da 
        ON s.matricula = da.matricula
        AND s.sexo = da.sexo
        AND s.idade = da.idade
    
    LEFT JOIN dim_escola de 
        ON s.codigo_escola = de.codigo_escola
    
    LEFT JOIN dim_turma dt 
        ON s.turma = dt.turma
        AND s.turno = dt.turno
        AND s.serie = dt.serie
        AND s.mod_ens_codigo = dt.mod_ens_codigo
        AND s.modalidade_ens = dt.modalidade_ensino
    
    LEFT JOIN dim_situacao dsi 
        ON s.situacao_nome = dsi.situacao_nome
    
    LEFT JOIN dim_localizacao dl 
        ON s.rpa = dl.rpa
        AND s.endereco_bairro = dl.endereco_bairro
    
    LEFT JOIN dim_tempo dte 
        ON s.ano = dte.ano
)

SELECT * FROM fato
  );
  
[0m15:12:08.647680 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "id_tempo" does not exist
LINE 45:     SELECT id_tempo, ano 
                    ^

[0m15:12:08.648344 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: ROLLBACK
[0m15:12:08.649432 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: Close
[0m15:12:08.655780 [debug] [Thread-1 (]: Database Error in model fato_matricula (transformacao_aprovados/models/facts/fato_matricula.sql)
  column "id_tempo" does not exist
  LINE 45:     SELECT id_tempo, ano 
                      ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/facts/fato_matricula.sql
[0m15:12:08.656565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78cfff20-1546-478b-8173-b3891fdf768d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7223b44f18b0>]}
[0m15:12:08.657459 [error] [Thread-1 (]: 11 of 13 ERROR creating sql table model staging_facts.fato_matricula ........... [[31mERROR[0m in 0.03s]
[0m15:12:08.658266 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.fato_matricula
[0m15:12:08.658993 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.fato_matricula' to be skipped because of status 'error'.  Reason: Database Error in model fato_matricula (transformacao_aprovados/models/facts/fato_matricula.sql)
  column "id_tempo" does not exist
  LINE 45:     SELECT id_tempo, ano 
                      ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/facts/fato_matricula.sql.
[0m15:12:08.660091 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_count_aluno_idade
[0m15:12:08.660743 [info ] [Thread-1 (]: 12 of 13 SKIP relation staging_marts.view_count_aluno_idade .................... [[33mSKIP[0m]
[0m15:12:08.661398 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_count_aluno_idade
[0m15:12:08.662010 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_taxa_aprovados
[0m15:12:08.662665 [info ] [Thread-1 (]: 13 of 13 SKIP relation staging_marts.view_taxa_aprovados ....................... [[33mSKIP[0m]
[0m15:12:08.663304 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_taxa_aprovados
[0m15:12:08.664762 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:08.665360 [debug] [MainThread]: On master: BEGIN
[0m15:12:08.665853 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:12:08.676455 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m15:12:08.677090 [debug] [MainThread]: On master: COMMIT
[0m15:12:08.677435 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:08.677788 [debug] [MainThread]: On master: COMMIT
[0m15:12:08.678437 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:12:08.678858 [debug] [MainThread]: On master: Close
[0m15:12:08.679377 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:12:08.679925 [debug] [MainThread]: Connection 'model.transformacao_matricula.fato_matricula' was properly closed.
[0m15:12:08.680601 [info ] [MainThread]: 
[0m15:12:08.681115 [info ] [MainThread]: Finished running 9 table models, 4 view models in 0 hours 0 minutes and 3.42 seconds (3.42s).
[0m15:12:08.683404 [debug] [MainThread]: Command end result
[0m15:12:08.713848 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m15:12:08.716711 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m15:12:08.724137 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m15:12:08.724785 [info ] [MainThread]: 
[0m15:12:08.725469 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m15:12:08.726058 [info ] [MainThread]: 
[0m15:12:08.726718 [error] [MainThread]: [31mFailure in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)[0m
[0m15:12:08.727360 [error] [MainThread]:   Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m15:12:08.728003 [info ] [MainThread]: 
[0m15:12:08.728647 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m15:12:08.729260 [info ] [MainThread]: 
[0m15:12:08.729963 [error] [MainThread]: [31mFailure in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)[0m
[0m15:12:08.730629 [error] [MainThread]:   Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m15:12:08.731481 [info ] [MainThread]: 
[0m15:12:08.732124 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m15:12:08.732682 [info ] [MainThread]: 
[0m15:12:08.733306 [error] [MainThread]: [31mFailure in model fato_matricula (transformacao_aprovados/models/facts/fato_matricula.sql)[0m
[0m15:12:08.734110 [error] [MainThread]:   Database Error in model fato_matricula (transformacao_aprovados/models/facts/fato_matricula.sql)
  column "id_tempo" does not exist
  LINE 45:     SELECT id_tempo, ano 
                      ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/facts/fato_matricula.sql
[0m15:12:08.734706 [info ] [MainThread]: 
[0m15:12:08.735370 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/facts/fato_matricula.sql
[0m15:12:08.736075 [info ] [MainThread]: 
[0m15:12:08.736675 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=3 SKIP=2 NO-OP=0 TOTAL=13
[0m15:12:08.737552 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 6 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:12:08.739013 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.061964, "process_in_blocks": "0", "process_kernel_time": 0.373067, "process_mem_max_rss": "129708", "process_out_blocks": "3928", "process_user_time": 3.198579}
[0m15:12:08.739775 [debug] [MainThread]: Command `dbt run` failed at 15:12:08.739665 after 5.06 seconds
[0m15:12:08.740323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7223b771acf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7223b8b39d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7223b8b39df0>]}
[0m15:12:08.741020 [debug] [MainThread]: Flushing usage events
[0m15:12:09.882760 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:14:49.384246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e6e65e4140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e6e75c26c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e6e8536690>]}


============================== 15:14:49.387659 | c5215ebc-66c8-468a-a445-9e2c11d422f7 ==============================
[0m15:14:49.387659 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:14:49.388193 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'printer_width': '80', 'target_path': 'None', 'profiles_dir': '/home/murilo/.dbt', 'log_cache_events': 'False', 'no_print': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'invocation_command': 'dbt clean', 'use_experimental_parser': 'False', 'empty': 'None', 'introspect': 'True', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'use_colors': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'quiet': 'False', 'cache_selected_only': 'False'}
[0m15:14:49.486935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5215ebc-66c8-468a-a445-9e2c11d422f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e6e59cba40>]}
[0m15:14:49.498641 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.15880625, "process_in_blocks": "0", "process_kernel_time": 0.209325, "process_mem_max_rss": "101640", "process_out_blocks": "16", "process_user_time": 1.125373}
[0m15:14:49.499159 [debug] [MainThread]: Command `dbt clean` succeeded at 15:14:49.499082 after 0.16 seconds
[0m15:14:49.499537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e6e5aaeb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e6e681e840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e6e5a59dc0>]}
[0m15:14:49.499941 [debug] [MainThread]: Flushing usage events
[0m15:14:50.501383 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:14:55.417330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770ddea65160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770ddde1d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770dde0c6960>]}


============================== 15:14:55.420390 | 92087cec-6668-47b0-8aa5-cb22cd1809ec ==============================
[0m15:14:55.420390 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:14:55.420986 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'version_check': 'True', 'target_path': 'None', 'debug': 'False', 'use_colors': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'quiet': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'partial_parse': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/home/murilo/.dbt', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'empty': 'False', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'log_cache_events': 'False'}
[0m15:14:55.554982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92087cec-6668-47b0-8aa5-cb22cd1809ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770ddd64cf50>]}
[0m15:14:55.603807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92087cec-6668-47b0-8aa5-cb22cd1809ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770dde8efef0>]}
[0m15:14:55.604695 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:14:55.712493 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:14:55.713690 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:14:55.714144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '92087cec-6668-47b0-8aa5-cb22cd1809ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770dde1b47a0>]}
[0m15:14:56.651391 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m15:14:56.651977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '92087cec-6668-47b0-8aa5-cb22cd1809ec', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770ddbfb5a00>]}
[0m15:14:56.867657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92087cec-6668-47b0-8aa5-cb22cd1809ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770ddbf4fb90>]}
[0m15:14:56.937339 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m15:14:56.939018 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m15:14:56.952820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92087cec-6668-47b0-8aa5-cb22cd1809ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770ddb76af90>]}
[0m15:14:56.953394 [info ] [MainThread]: Found 13 models, 37 data tests, 1 source, 459 macros
[0m15:14:56.953825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92087cec-6668-47b0-8aa5-cb22cd1809ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770ddbf4e030>]}
[0m15:14:56.956034 [info ] [MainThread]: 
[0m15:14:56.956526 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m15:14:56.956892 [info ] [MainThread]: 
[0m15:14:56.957407 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:14:56.961375 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula'
[0m15:14:57.001585 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m15:14:57.002133 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m15:14:57.002477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:57.014131 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.012 seconds
[0m15:14:57.015461 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m15:14:57.017643 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m15:14:57.018233 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m15:14:57.018634 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:57.029388 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.011 seconds
[0m15:14:57.030765 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m15:14:57.032864 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m15:14:57.033429 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m15:14:57.033833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:57.043067 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m15:14:57.044305 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m15:14:57.046327 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m15:14:57.046887 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m15:14:57.047268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:57.057003 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m15:14:57.058575 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m15:14:57.061806 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m15:14:57.062423 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m15:14:57.062839 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:57.071654 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m15:14:57.072871 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m15:14:57.075873 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula, now list_transformacao_matricula_staging_staging)
[0m15:14:57.081756 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m15:14:57.082214 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: BEGIN
[0m15:14:57.082538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:57.091254 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:14:57.091768 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m15:14:57.092152 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_staging"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m15:14:57.095152 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m15:14:57.096440 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: ROLLBACK
[0m15:14:57.097309 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: Close
[0m15:14:57.097973 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_staging, now list_transformacao_matricula_staging_dimensions)
[0m15:14:57.100123 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_dimensions"
[0m15:14:57.100638 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: BEGIN
[0m15:14:57.101055 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:57.110458 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:14:57.110978 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_dimensions"
[0m15:14:57.111752 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_dimensions"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dimensions'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dimensions'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dimensions'
  
[0m15:14:57.115100 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m15:14:57.117256 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: ROLLBACK
[0m15:14:57.118123 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: Close
[0m15:14:57.118750 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_dimensions, now list_transformacao_matricula_staging_marts)
[0m15:14:57.122644 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m15:14:57.123224 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: BEGIN
[0m15:14:57.123547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:57.134401 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m15:14:57.134887 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m15:14:57.135240 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_marts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m15:14:57.138792 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m15:14:57.140598 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: ROLLBACK
[0m15:14:57.141482 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: Close
[0m15:14:57.142141 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_marts, now list_transformacao_matricula_staging_intermediate)
[0m15:14:57.145353 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_intermediate"
[0m15:14:57.146170 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: BEGIN
[0m15:14:57.146503 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:57.154953 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m15:14:57.155819 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_intermediate"
[0m15:14:57.156560 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_intermediate"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_intermediate'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_intermediate'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_intermediate'
  
[0m15:14:57.160145 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m15:14:57.162266 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: ROLLBACK
[0m15:14:57.163173 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: Close
[0m15:14:57.163859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_intermediate, now list_transformacao_matricula_staging_facts)
[0m15:14:57.166174 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_facts"
[0m15:14:57.166651 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: BEGIN
[0m15:14:57.166992 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:57.176742 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m15:14:57.177225 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_facts"
[0m15:14:57.177567 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_facts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_facts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_facts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_facts'
  
[0m15:14:57.181581 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m15:14:57.183497 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: ROLLBACK
[0m15:14:57.184338 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: Close
[0m15:14:57.189720 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:57.190198 [debug] [MainThread]: On master: BEGIN
[0m15:14:57.190526 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:14:57.199815 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m15:14:57.200416 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:57.201235 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:14:57.205292 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m15:14:57.206839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92087cec-6668-47b0-8aa5-cb22cd1809ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770dd878c6b0>]}
[0m15:14:57.207333 [debug] [MainThread]: On master: ROLLBACK
[0m15:14:57.208186 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:57.208555 [debug] [MainThread]: On master: BEGIN
[0m15:14:57.209495 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:14:57.209887 [debug] [MainThread]: On master: COMMIT
[0m15:14:57.210223 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:57.210538 [debug] [MainThread]: On master: COMMIT
[0m15:14:57.211118 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:14:57.211497 [debug] [MainThread]: On master: Close
[0m15:14:57.214122 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.staging_situacao_alunos
[0m15:14:57.214783 [info ] [Thread-1 (]: 1 of 13 START sql table model staging_staging.staging_situacao_alunos .......... [RUN]
[0m15:14:57.215517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_facts, now model.transformacao_matricula.staging_situacao_alunos)
[0m15:14:57.215981 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.staging_situacao_alunos
[0m15:14:57.222147 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.staging_situacao_alunos"
[0m15:14:57.223038 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.staging_situacao_alunos
[0m15:14:57.261637 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.staging_situacao_alunos"
[0m15:14:57.262627 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:14:57.263073 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: BEGIN
[0m15:14:57.263433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:57.273832 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:14:57.274544 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:14:57.275041 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */

  
    

  create  table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp"
  
  
    as
  
  (
    WITH source AS (
    SELECT * FROM "transformacao_matricula"."staging"."staging_alunos_raw"
),

cleaning_renaming AS (
    SELECT
        ano,
        codigo_escola,
        matricula,
        escola AS nome_escola,
        endereco_logradouro AS endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa,
        modalidade_ensino_codigo AS mod_ens_codigo,
        -- Transformação da SÉRIE
        CASE
            -- Ensino Fundamental (1º ao 9º)
            WHEN serie LIKE '%1 ANO%' OR serie LIKE '%1º ANO%' THEN '1º ANO'
            WHEN serie LIKE '%2 ANO%' OR serie LIKE '%2º ANO%' THEN '2º ANO'
            WHEN serie LIKE '%3 ANO%' OR serie LIKE '%3º ANO%' THEN '3º ANO'
            WHEN serie LIKE '%4 ANO%' OR serie LIKE '%4º ANO%' THEN '4º ANO'
            WHEN serie LIKE '%5 ANO%' OR serie LIKE '%5º ANO%' THEN '5º ANO'
            WHEN serie LIKE '%6 ANO%' OR serie LIKE '%6º ANO%' THEN '6º ANO'
            WHEN serie LIKE '%7 ANO%' OR serie LIKE '%7º ANO%' THEN '7º ANO'
            WHEN serie LIKE '%8 ANO%' OR serie LIKE '%8º ANO%' THEN '8º ANO'
            WHEN serie LIKE '%9 ANO%' OR serie LIKE '%9º ANO%' THEN '9º ANO'
            -- Educação Infantil (Berçário e Grupos)
            WHEN serie LIKE '%BER%' THEN 'BERÇARIO'
            WHEN serie LIKE '%GRUPO I%' OR serie LIKE '%GRUPO 1%' THEN 'GRUPO I'
            WHEN serie LIKE '%GRUPO II%' THEN 'GRUPO II'
            WHEN serie LIKE '%GRUPO III%' THEN 'GRUPO III'
            WHEN serie LIKE '%GRUPO IV%' THEN 'GRUPO IV'
            WHEN serie LIKE '%GRUPO V%' THEN 'GRUPO V'
            -- EJA (Módulos 1 ao 5) 
            WHEN serie LIKE '%1%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 1'
            WHEN serie LIKE '%2%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 2'
            WHEN serie LIKE '%3%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 3'
            WHEN serie LIKE '%4%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 4'
            WHEN serie LIKE '%5%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 5'
            WHEN serie LIKE '%TRAVESSIA%' THEN 'TRAVESSIA RECIFE'
            WHEN serie LIKE '%CORRECAO%1%' THEN 'CORREÇÃO DE FLUXO 1 - ALFABETIZACAO'
            WHEN serie LIKE '%CORRECAO%2%' THEN 'CORREÇÃO DE FLUXO 2 - ACELERACAO'
            ELSE 'OUTROS'
        END AS serie,
        turma,
        turno,
        idade,
        -- transformação do SEXO
        CASE
            WHEN sexo = '1' THEN 'Masculino'
            WHEN sexo = '2' THEN 'Feminino'
            WHEN sexo = '3' THEN 'Outros'
            ELSE 'Não informado'
        END AS sexo,
        -- transformação de situacao
        CASE 
            WHEN situacao_nome LIKE '%APROV%' THEN 'Aprovado'
            WHEN situacao_nome LIKE '%RET%' OR situacao_nome LIKE '%REPRO%' THEN 'Reprovado'
            WHEN situacao_nome LIKE '%TR%' OR situacao_nome LIKE '%REMAN%' THEN 'Transferido'
            WHEN situacao_nome LIKE '%DESIST%' THEN 'Desistente'
            ELSE 'Outros'
        END AS sit_nome,
        -- Transformação da MODALIDADE
        CASE
            WHEN modalidade_ensino LIKE '%EDUCACAO INFANTIL%' THEN 'EDUCAÇÃO INFANTIL'
            WHEN modalidade_ensino LIKE '%ENSINO FUNDAMENTAL%' THEN 'ENSINO FUNDAMENTAL'
            WHEN modalidade_ensino LIKE '%EDUCACAO JOVENS E ADULTOS%' THEN 'EJA'
            WHEN modalidade_ensino LIKE '%CORRE%' THEN 'CORREÇÃO DE FLUXO'
            ELSE 'OUTROS'
        END AS modalidade_ens
    FROM source
)

SELECT * FROM cleaning_renaming
  );
  
[0m15:14:57.931914 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 0.656 seconds
[0m15:14:57.943061 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:14:57.943677 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
alter table "transformacao_matricula"."staging_staging"."staging_situacao_alunos" rename to "staging_situacao_alunos__dbt_backup"
[0m15:14:57.944700 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:14:57.947339 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:14:57.947857 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
alter table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp" rename to "staging_situacao_alunos"
[0m15:14:57.948740 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:14:57.962904 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: COMMIT
[0m15:14:57.963410 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:14:57.963786 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: COMMIT
[0m15:14:57.970174 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m15:14:57.976038 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_backup"
[0m15:14:57.980860 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:14:57.981359 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
drop table if exists "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_backup" cascade
[0m15:14:57.992209 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m15:14:57.994837 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: Close
[0m15:14:57.996523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92087cec-6668-47b0-8aa5-cb22cd1809ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770de0292bd0>]}
[0m15:14:57.997287 [info ] [Thread-1 (]: 1 of 13 OK created sql table model staging_staging.staging_situacao_alunos ..... [[32mSELECT 319146[0m in 0.78s]
[0m15:14:57.997897 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.staging_situacao_alunos
[0m15:14:57.998332 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m15:14:57.998942 [info ] [Thread-1 (]: 2 of 13 START sql view model staging_marts.view_frequencia_situacao_escola ..... [RUN]
[0m15:14:57.999553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.staging_situacao_alunos, now model.transformacao_matricula.view_frequencia_situacao_escola)
[0m15:14:58.000001 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_frequencia_situacao_escola
[0m15:14:58.002262 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m15:14:58.003017 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_frequencia_situacao_escola
[0m15:14:58.019863 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m15:14:58.020993 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m15:14:58.021575 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: BEGIN
[0m15:14:58.022102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:58.032644 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:14:58.033337 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m15:14:58.034095 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_frequencia_situacao_escola"} */

  create view "transformacao_matricula"."staging_marts"."view_frequencia_situacao_escola__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    de.nome_escola,
    de.codigo_escola,
    ds.situacao_nome,
    COUNT(fm.matricula) AS contagem_situacao
FROM
    fato_matricula fm
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, de.nome_escola, de.codigo_escola, ds.situacao_nome
ORDER BY
    dtemp.ano, de.nome_escola, contagem_situacao DESC
  );
[0m15:14:58.035658 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 15:     fato_matricula fm
             ^

[0m15:14:58.036325 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: ROLLBACK
[0m15:14:58.037351 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: Close
[0m15:14:58.041774 [debug] [Thread-1 (]: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m15:14:58.042674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92087cec-6668-47b0-8aa5-cb22cd1809ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770dd88bd850>]}
[0m15:14:58.043710 [error] [Thread-1 (]: 2 of 13 ERROR creating sql view model staging_marts.view_frequencia_situacao_escola  [[31mERROR[0m in 0.04s]
[0m15:14:58.044844 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m15:14:58.045303 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_matricula_detalhada
[0m15:14:58.045858 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_frequencia_situacao_escola' to be skipped because of status 'error'.  Reason: Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql.
[0m15:14:58.046702 [info ] [Thread-1 (]: 3 of 13 START sql view model staging_marts.view_matricula_detalhada ............ [RUN]
[0m15:14:58.047969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_frequencia_situacao_escola, now model.transformacao_matricula.view_matricula_detalhada)
[0m15:14:58.048427 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_matricula_detalhada
[0m15:14:58.051001 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_matricula_detalhada"
[0m15:14:58.051741 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_matricula_detalhada
[0m15:14:58.055064 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_matricula_detalhada"
[0m15:14:58.056172 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m15:14:58.056654 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: BEGIN
[0m15:14:58.057033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:58.065685 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:14:58.066308 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m15:14:58.066760 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_matricula_detalhada"} */

  create view "transformacao_matricula"."staging_marts"."view_matricula_detalhada__dbt_tmp"
    
    
  as (
    
SELECT
    fm.matricula,
    da.sexo,
    da.idade,
    da.faixa_etaria,
    de.nome_escola,
    de.codigo_escola,
    dt.turma,
    dt.turno,
    dt.serie,
    dt.modalidade_ensino,
    ds.situacao_nome,
    ds.categoria AS categoria_situacao,
    ds.eh_aprovado,
    ds.eh_reprovado,
    dl.desc_rpa,
    dl.endereco_bairro AS bairro_localizacao,
    dtemp.ano AS ano_registro
FROM
    fato_matricula fm
JOIN
    dim_aluno da ON fm.id_aluno = da.id_aluno
JOIN
    dim_escola de ON fm.id_escola = de.id_escola
JOIN
    dim_turma dt ON fm.id_turma = dt.id_turma
JOIN
    dim_situacao ds ON fm.id_situacao = ds.id_situacao
JOIN
    dim_localizacao dl ON fm.id_locali = dl.id_locali
JOIN
    dim_tempo dtemp ON fm.id_tempo = dtemp.id_tempo
  );
[0m15:14:58.067752 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fato_matricula" does not exist
LINE 27:     fato_matricula fm
             ^

[0m15:14:58.068240 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: ROLLBACK
[0m15:14:58.069105 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: Close
[0m15:14:58.072931 [debug] [Thread-1 (]: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m15:14:58.074082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92087cec-6668-47b0-8aa5-cb22cd1809ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770dd87a8230>]}
[0m15:14:58.074939 [error] [Thread-1 (]: 3 of 13 ERROR creating sql view model staging_marts.view_matricula_detalhada ... [[31mERROR[0m in 0.03s]
[0m15:14:58.075814 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_matricula_detalhada
[0m15:14:58.076450 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.transform_data
[0m15:14:58.077204 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.view_matricula_detalhada' to be skipped because of status 'error'.  Reason: Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql.
[0m15:14:58.077788 [info ] [Thread-1 (]: 4 of 13 START sql table model staging_intermediate.transform_data .............. [RUN]
[0m15:14:58.078621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_matricula_detalhada, now model.transformacao_matricula.transform_data)
[0m15:14:58.079099 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.transform_data
[0m15:14:58.082105 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.transform_data"
[0m15:14:58.082937 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.transform_data
[0m15:14:58.087260 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.transform_data"
[0m15:14:58.088242 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:14:58.088935 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: BEGIN
[0m15:14:58.089496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:58.100291 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m15:14:58.100977 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:14:58.101570 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */

  
    

  create  table "transformacao_matricula"."staging_intermediate"."transform_data__dbt_tmp"
  
  
    as
  
  (
    

with staged_data AS (
    SELECT * FROM "transformacao_matricula"."staging_staging"."staging_situacao_alunos"
),

transformed_data AS (
    SELECT
        CAST(ano AS INTEGER) AS ano,
        CAST(codigo_escola AS INTEGER) AS codigo_escola,
        CAST(matricula AS INTEGER) AS matricula,
        nome_escola,
        endereco_logra,
        endereco_bairro,
        endereco_numero,
        CAST(rpa AS INTEGER) AS rpa,
        CAST(mod_ens_codigo AS INTEGER) AS mod_ens_codigo,
        serie,
        turma,
        turno,
        CAST(idade AS INTEGER) AS idade,
        sexo,
        sit_nome AS situacao_nome,
        modalidade_ens,
        CASE
            WHEN CAST(idade AS INTEGER) <= 3 THEN '0-3 Anos (Educação Infantil)'
            WHEN CAST(idade AS INTEGER) <= 5 THEN '4-5 Anos (Pré-escola)'
            WHEN CAST(idade AS INTEGER) <= 10 THEN '6-10 Anos (Fundamental I)'
            WHEN CAST(idade AS INTEGER) <= 14 THEN '11-14 Anos (Fundamental II)'
            WHEN CAST(idade AS INTEGER) >= 15 THEN '15+ Anos (EJA e Outros)'
            ELSE 'Não Informado'
        END AS faixa_etaria
    FROM staged_data
)

SELECT * FROM transformed_data
  );
  
[0m15:14:58.599822 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 0.498 seconds
[0m15:14:58.604032 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:14:58.604528 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
alter table "transformacao_matricula"."staging_intermediate"."transform_data" rename to "transform_data__dbt_backup"
[0m15:14:58.605568 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:14:58.608097 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:14:58.608574 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
alter table "transformacao_matricula"."staging_intermediate"."transform_data__dbt_tmp" rename to "transform_data"
[0m15:14:58.609707 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:14:58.611488 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: COMMIT
[0m15:14:58.611958 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:14:58.612325 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: COMMIT
[0m15:14:58.623333 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m15:14:58.626556 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_intermediate"."transform_data__dbt_backup"
[0m15:14:58.627559 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:14:58.628014 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
drop table if exists "transformacao_matricula"."staging_intermediate"."transform_data__dbt_backup" cascade
[0m15:14:58.640762 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.012 seconds
[0m15:14:58.642912 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: Close
[0m15:14:58.643900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92087cec-6668-47b0-8aa5-cb22cd1809ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770dd8697980>]}
[0m15:14:58.644665 [info ] [Thread-1 (]: 4 of 13 OK created sql table model staging_intermediate.transform_data ......... [[32mSELECT 319146[0m in 0.57s]
[0m15:14:58.645302 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.transform_data
[0m15:14:58.646281 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_aluno
[0m15:14:58.646871 [info ] [Thread-1 (]: 5 of 13 START sql table model staging_dimensions.dim_aluno ..................... [RUN]
[0m15:14:58.647419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.transform_data, now model.transformacao_matricula.dim_aluno)
[0m15:14:58.647870 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_aluno
[0m15:14:58.650626 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_aluno"
[0m15:14:58.651494 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_aluno
[0m15:14:58.654752 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_aluno"
[0m15:14:58.655489 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m15:14:58.655963 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: BEGIN
[0m15:14:58.656346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:58.666491 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:14:58.667195 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m15:14:58.667746 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_aluno"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_aluno__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),
alunos_unicos AS (
    SELECT DISTINCT
        matricula,
        sexo,
        idade,
        faixa_etaria
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY matricula) - 1 AS id_aluno, -- Surrogate Key
        matricula,
        sexo,
        idade,
        faixa_etaria
    FROM alunos_unicos
)

SELECT * FROM versao_final
  );
  
[0m15:14:59.336678 [debug] [Thread-1 (]: SQL status: SELECT 319143 in 0.668 seconds
[0m15:14:59.339909 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m15:14:59.340368 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_aluno"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_aluno" rename to "dim_aluno__dbt_backup"
[0m15:14:59.341501 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:14:59.344063 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m15:14:59.344530 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_aluno"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_aluno__dbt_tmp" rename to "dim_aluno"
[0m15:14:59.345622 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:14:59.347298 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: COMMIT
[0m15:14:59.347741 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m15:14:59.348092 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: COMMIT
[0m15:14:59.356011 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m15:14:59.358395 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_aluno__dbt_backup"
[0m15:14:59.359252 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m15:14:59.359639 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_aluno"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_aluno__dbt_backup" cascade
[0m15:14:59.365885 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:14:59.367570 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: Close
[0m15:14:59.368213 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92087cec-6668-47b0-8aa5-cb22cd1809ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770dd879bdd0>]}
[0m15:14:59.368912 [info ] [Thread-1 (]: 5 of 13 OK created sql table model staging_dimensions.dim_aluno ................ [[32mSELECT 319143[0m in 0.72s]
[0m15:14:59.369515 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_aluno
[0m15:14:59.369992 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_escola
[0m15:14:59.370654 [info ] [Thread-1 (]: 6 of 13 START sql table model staging_dimensions.dim_escola .................... [RUN]
[0m15:14:59.371206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_aluno, now model.transformacao_matricula.dim_escola)
[0m15:14:59.371663 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_escola
[0m15:14:59.374267 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_escola"
[0m15:14:59.375069 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_escola
[0m15:14:59.378208 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_escola"
[0m15:14:59.378918 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:14:59.379312 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: BEGIN
[0m15:14:59.379676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:59.389932 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:14:59.390640 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:14:59.391368 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_escola__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),
escolas_unicas AS (
    SELECT DISTINCT
        codigo_escola,
        nome_escola,
        endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY codigo_escola) - 1 AS id_escola, -- Surrogate Key
        codigo_escola,
        nome_escola,
        endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa
    FROM escolas_unicas
)

SELECT * FROM versao_final
  );
  
[0m15:14:59.526655 [debug] [Thread-1 (]: SQL status: SELECT 433 in 0.134 seconds
[0m15:14:59.531043 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:14:59.531566 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_escola" rename to "dim_escola__dbt_backup"
[0m15:14:59.532771 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:14:59.535819 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:14:59.536311 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_escola__dbt_tmp" rename to "dim_escola"
[0m15:14:59.537520 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:14:59.539224 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: COMMIT
[0m15:14:59.539712 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:14:59.540114 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: COMMIT
[0m15:14:59.546892 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m15:14:59.549518 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_escola__dbt_backup"
[0m15:14:59.550404 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:14:59.550823 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_escola__dbt_backup" cascade
[0m15:14:59.554356 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:14:59.556066 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: Close
[0m15:14:59.556721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92087cec-6668-47b0-8aa5-cb22cd1809ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770dd86c3710>]}
[0m15:14:59.557366 [info ] [Thread-1 (]: 6 of 13 OK created sql table model staging_dimensions.dim_escola ............... [[32mSELECT 433[0m in 0.19s]
[0m15:14:59.557962 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_escola
[0m15:14:59.558425 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_localizacao
[0m15:14:59.559011 [info ] [Thread-1 (]: 7 of 13 START sql table model staging_dimensions.dim_localizacao ............... [RUN]
[0m15:14:59.559508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_escola, now model.transformacao_matricula.dim_localizacao)
[0m15:14:59.559957 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_localizacao
[0m15:14:59.562526 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_localizacao"
[0m15:14:59.563217 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_localizacao
[0m15:14:59.566512 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_localizacao"
[0m15:14:59.567283 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:14:59.567707 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: BEGIN
[0m15:14:59.568080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:59.578044 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:14:59.578722 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:14:59.579288 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_localizacao__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),
localizacoes_unicas AS (
    SELECT DISTINCT
        rpa,
        endereco_bairro,
        CASE rpa
            WHEN 1 THEN 'RPA 1 (Centro)'
            WHEN 2 THEN 'RPA 2 (Zona Norte)'
            WHEN 3 THEN 'RPA 3 (Zona Oeste)'
            WHEN 4 THEN 'RPA 4 (Zona Sudoeste)'
            WHEN 5 THEN 'RPA 5 (Zona Sul)'
            WHEN 6 THEN 'RPA 6 (Zona Sudeste)'
            ELSE 'RPA Não Identificada'
        END AS desc_rpa
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY rpa, endereco_bairro) - 1 AS id_locali, -- Surrogate Key
        rpa,
        endereco_bairro,
        desc_rpa
    FROM localizacoes_unicas
)

SELECT * FROM versao_final
  );
  
[0m15:14:59.690135 [debug] [Thread-1 (]: SQL status: SELECT 88 in 0.110 seconds
[0m15:14:59.693054 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:14:59.693528 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_localizacao" rename to "dim_localizacao__dbt_backup"
[0m15:14:59.694508 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:14:59.697112 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:14:59.697567 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_localizacao__dbt_tmp" rename to "dim_localizacao"
[0m15:14:59.698586 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:14:59.700273 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: COMMIT
[0m15:14:59.700709 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:14:59.701071 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: COMMIT
[0m15:14:59.703189 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:14:59.705755 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_localizacao__dbt_backup"
[0m15:14:59.706809 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:14:59.707215 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_localizacao__dbt_backup" cascade
[0m15:14:59.710289 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:14:59.711700 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: Close
[0m15:14:59.712338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92087cec-6668-47b0-8aa5-cb22cd1809ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770dd86a1fa0>]}
[0m15:14:59.712984 [info ] [Thread-1 (]: 7 of 13 OK created sql table model staging_dimensions.dim_localizacao .......... [[32mSELECT 88[0m in 0.15s]
[0m15:14:59.713648 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_localizacao
[0m15:14:59.714138 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_situacao
[0m15:14:59.714765 [info ] [Thread-1 (]: 8 of 13 START sql table model staging_dimensions.dim_situacao .................. [RUN]
[0m15:14:59.715300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_localizacao, now model.transformacao_matricula.dim_situacao)
[0m15:14:59.715743 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_situacao
[0m15:14:59.718289 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_situacao"
[0m15:14:59.719077 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_situacao
[0m15:14:59.722327 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_situacao"
[0m15:14:59.723037 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:14:59.723421 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: BEGIN
[0m15:14:59.723798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:59.733980 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:14:59.734668 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:14:59.735646 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_situacao__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),
situacoes_unicas AS (
    SELECT DISTINCT
        situacao_nome,
        CASE 
            WHEN situacao_nome = 'Aprovado' THEN 'APROVADO'
            WHEN situacao_nome = 'Reprovado' THEN 'REPROVADO'
            WHEN situacao_nome = 'Transferido' THEN 'TRANSFERIDO'
            WHEN situacao_nome = 'Desistente' THEN 'DESISTENTE'
            ELSE 'OUTROS'
        END AS categoria,
        CASE 
            WHEN situacao_nome = 'Aprovado' THEN 1
            ELSE 0
        END AS eh_aprovado,
        CASE 
            WHEN situacao_nome = 'Reprovado' THEN 1
            ELSE 0
        END AS eh_reprovado
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY situacao_nome) - 1 AS id_situacao, -- Surrogate Key
        situacao_nome,
        categoria,
        eh_aprovado,
        eh_reprovado
    FROM situacoes_unicas
)

SELECT * FROM versao_final
  );
  
[0m15:14:59.811992 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.076 seconds
[0m15:14:59.814921 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:14:59.815382 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_situacao" rename to "dim_situacao__dbt_backup"
[0m15:14:59.816452 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:14:59.820331 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:14:59.820843 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_situacao__dbt_tmp" rename to "dim_situacao"
[0m15:14:59.821849 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:14:59.823559 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: COMMIT
[0m15:14:59.824029 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:14:59.824395 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: COMMIT
[0m15:14:59.826566 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:14:59.892622 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_situacao__dbt_backup"
[0m15:14:59.893640 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:14:59.894049 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_situacao__dbt_backup" cascade
[0m15:14:59.898088 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:14:59.899736 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: Close
[0m15:14:59.900395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92087cec-6668-47b0-8aa5-cb22cd1809ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770dd86eaf90>]}
[0m15:14:59.901074 [info ] [Thread-1 (]: 8 of 13 OK created sql table model staging_dimensions.dim_situacao ............. [[32mSELECT 5[0m in 0.19s]
[0m15:14:59.901809 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_situacao
[0m15:14:59.902314 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_tempo
[0m15:14:59.902937 [info ] [Thread-1 (]: 9 of 13 START sql table model staging_dimensions.dim_tempo ..................... [RUN]
[0m15:14:59.903539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_situacao, now model.transformacao_matricula.dim_tempo)
[0m15:14:59.904004 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_tempo
[0m15:14:59.906727 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_tempo"
[0m15:14:59.907526 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_tempo
[0m15:14:59.910954 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_tempo"
[0m15:14:59.911826 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:14:59.912315 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: BEGIN
[0m15:14:59.912769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:59.922411 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:14:59.923100 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:14:59.923648 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_tempo__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),

anos_unicos AS (
    SELECT DISTINCT
        ano,
        'Registro Anual' AS ano_ensino
    FROM source
),

versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY ano) - 1 AS id_tempo, -- Surrogate Key
        ano,
        ano_ensino
    FROM anos_unicos
)
SELECT * FROM versao_final
  );
  
[0m15:14:59.965178 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.041 seconds
[0m15:14:59.968096 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:14:59.968550 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_tempo" rename to "dim_tempo__dbt_backup"
[0m15:14:59.969566 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:14:59.972242 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:14:59.972746 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_tempo__dbt_tmp" rename to "dim_tempo"
[0m15:14:59.973709 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:14:59.975501 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: COMMIT
[0m15:14:59.975951 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:14:59.976309 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: COMMIT
[0m15:14:59.978587 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:14:59.981180 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_tempo__dbt_backup"
[0m15:14:59.982081 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:14:59.982462 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_tempo__dbt_backup" cascade
[0m15:14:59.985488 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:14:59.986864 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: Close
[0m15:14:59.987514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92087cec-6668-47b0-8aa5-cb22cd1809ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770ddbf56cf0>]}
[0m15:14:59.988205 [info ] [Thread-1 (]: 9 of 13 OK created sql table model staging_dimensions.dim_tempo ................ [[32mSELECT 3[0m in 0.08s]
[0m15:14:59.988836 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_tempo
[0m15:14:59.989317 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_turma
[0m15:14:59.989988 [info ] [Thread-1 (]: 10 of 13 START sql table model staging_dimensions.dim_turma .................... [RUN]
[0m15:14:59.990536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_tempo, now model.transformacao_matricula.dim_turma)
[0m15:14:59.991034 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_turma
[0m15:14:59.993754 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_turma"
[0m15:14:59.994425 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_turma
[0m15:14:59.997592 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_turma"
[0m15:14:59.998371 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:14:59.998786 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: BEGIN
[0m15:14:59.999154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:00.009071 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:15:00.009787 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:15:00.010358 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_turma__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),
turmas_unicas AS (
    SELECT DISTINCT
        turma,
        turno,
        serie,
        mod_ens_codigo,
        modalidade_ens
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY turma, turno, serie) - 1 AS id_turma,
        turma,
        turno,
        NULL AS serie_codigo,
        serie,
        mod_ens_codigo,
        modalidade_ens AS modalidade_ensino
    FROM turmas_unicas
)

SELECT * FROM versao_final
  );
  
[0m15:15:00.158491 [debug] [Thread-1 (]: SQL status: SELECT 335 in 0.148 seconds
[0m15:15:00.161395 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:15:00.161871 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_turma" rename to "dim_turma__dbt_backup"
[0m15:15:00.162898 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:15:00.165447 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:15:00.165915 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_turma__dbt_tmp" rename to "dim_turma"
[0m15:15:00.166968 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:15:00.170174 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: COMMIT
[0m15:15:00.170698 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:15:00.171065 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: COMMIT
[0m15:15:00.174573 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:15:00.177556 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_turma__dbt_backup"
[0m15:15:00.178437 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:15:00.178837 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_turma__dbt_backup" cascade
[0m15:15:00.182092 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:15:00.183470 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: Close
[0m15:15:00.184133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92087cec-6668-47b0-8aa5-cb22cd1809ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770ddc7c2bd0>]}
[0m15:15:00.184844 [info ] [Thread-1 (]: 10 of 13 OK created sql table model staging_dimensions.dim_turma ............... [[32mSELECT 335[0m in 0.19s]
[0m15:15:00.185452 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_turma
[0m15:15:00.186236 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.fato_matricula
[0m15:15:00.186834 [info ] [Thread-1 (]: 11 of 13 START sql table model staging_facts.fato_matricula .................... [RUN]
[0m15:15:00.187470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_turma, now model.transformacao_matricula.fato_matricula)
[0m15:15:00.187963 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.fato_matricula
[0m15:15:00.192464 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.fato_matricula"
[0m15:15:00.193356 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.fato_matricula
[0m15:15:00.197253 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.fato_matricula"
[0m15:15:00.198311 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.fato_matricula"
[0m15:15:00.198858 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: BEGIN
[0m15:15:00.199347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:00.209180 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:15:00.209882 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.fato_matricula"
[0m15:15:00.210498 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.fato_matricula"} */

  
    

  create  table "transformacao_matricula"."staging_facts"."fato_matricula__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),

-- Dimensões com seus IDs
dim_aluno AS (
    SELECT id_aluno, matricula, sexo, idade, faixa_etaria 
    FROM "transformacao_matricula"."staging_dimensions"."dim_aluno"
),

dim_escola AS (
    SELECT id_escola, codigo_escola 
    FROM "transformacao_matricula"."staging_dimensions"."dim_escola"
),

dim_turma AS (
    SELECT id_turma, turma, turno, serie, mod_ens_codigo, modalidade_ensino 
    FROM "transformacao_matricula"."staging_dimensions"."dim_turma"
),

dim_situacao AS (
    SELECT id_situacao, situacao_nome 
    FROM "transformacao_matricula"."staging_dimensions"."dim_situacao"
),

dim_localizacao AS (
    SELECT id_locali, rpa, endereco_bairro 
    FROM "transformacao_matricula"."staging_dimensions"."dim_localizacao"
),

dim_tempo AS (
    SELECT id_tempo, ano 
    FROM "transformacao_matricula"."staging_dimensions"."dim_tempo"
),

-- Construindo a tabela fato
fato AS (
    SELECT
        da.id_aluno,
        de.id_escola,
        dt.id_turma,
        dsi.id_situacao,
        dl.id_locali,
        dte.id_tempo,
        s.matricula,
        1 AS qtd_alunos
    FROM source s
    
    LEFT JOIN dim_aluno da 
        ON s.matricula = da.matricula
        AND s.sexo = da.sexo
        AND s.idade = da.idade
    
    LEFT JOIN dim_escola de 
        ON s.codigo_escola = de.codigo_escola
    
    LEFT JOIN dim_turma dt 
        ON s.turma = dt.turma
        AND s.turno = dt.turno
        AND s.serie = dt.serie
        AND s.mod_ens_codigo = dt.mod_ens_codigo
        AND s.modalidade_ens = dt.modalidade_ensino
    
    LEFT JOIN dim_situacao dsi 
        ON s.situacao_nome = dsi.situacao_nome
    
    LEFT JOIN dim_localizacao dl 
        ON s.rpa = dl.rpa
        AND s.endereco_bairro = dl.endereco_bairro
    
    LEFT JOIN dim_tempo dte 
        ON s.ano = dte.ano
)

SELECT * FROM fato
  );
  
[0m15:15:01.276743 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 1.066 seconds
[0m15:15:01.279917 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.fato_matricula"
[0m15:15:01.280397 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.fato_matricula"} */
alter table "transformacao_matricula"."staging_facts"."fato_matricula__dbt_tmp" rename to "fato_matricula"
[0m15:15:01.281409 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:15:01.283165 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: COMMIT
[0m15:15:01.283632 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.fato_matricula"
[0m15:15:01.283996 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: COMMIT
[0m15:15:01.292439 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m15:15:01.294617 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_facts"."fato_matricula__dbt_backup"
[0m15:15:01.295575 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.fato_matricula"
[0m15:15:01.295992 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.fato_matricula"} */
drop table if exists "transformacao_matricula"."staging_facts"."fato_matricula__dbt_backup" cascade
[0m15:15:01.296914 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:15:01.298225 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: Close
[0m15:15:01.298940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92087cec-6668-47b0-8aa5-cb22cd1809ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770ddd8ae8a0>]}
[0m15:15:01.299920 [info ] [Thread-1 (]: 11 of 13 OK created sql table model staging_facts.fato_matricula ............... [[32mSELECT 319146[0m in 1.11s]
[0m15:15:01.300800 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.fato_matricula
[0m15:15:01.301830 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_count_aluno_idade
[0m15:15:01.302487 [info ] [Thread-1 (]: 12 of 13 START sql view model staging_marts.view_count_aluno_idade ............. [RUN]
[0m15:15:01.303143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.fato_matricula, now model.transformacao_matricula.view_count_aluno_idade)
[0m15:15:01.303726 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_count_aluno_idade
[0m15:15:01.307882 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_count_aluno_idade"
[0m15:15:01.308771 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_count_aluno_idade
[0m15:15:01.312663 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_count_aluno_idade"
[0m15:15:01.313688 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m15:15:01.314290 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: BEGIN
[0m15:15:01.314853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:01.325131 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:15:01.325837 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m15:15:01.326395 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_count_aluno_idade"} */

  create view "transformacao_matricula"."staging_marts"."view_count_aluno_idade__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dl.desc_rpa,
    da.faixa_etaria,
    COUNT(fm.matricula) AS total_alunos
FROM
    "transformacao_matricula"."staging_facts"."fato_matricula" fm
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_aluno" da ON fm.id_aluno = da.id_aluno
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_localizacao" dl ON fm.id_locali = dl.id_locali
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_tempo" dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
ORDER BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
  );
[0m15:15:01.331994 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m15:15:01.335700 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m15:15:01.336357 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_count_aluno_idade"} */
alter table "transformacao_matricula"."staging_marts"."view_count_aluno_idade__dbt_tmp" rename to "view_count_aluno_idade"
[0m15:15:01.337577 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:15:01.339748 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: COMMIT
[0m15:15:01.340417 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m15:15:01.340979 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: COMMIT
[0m15:15:01.343176 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:15:01.346111 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."view_count_aluno_idade__dbt_backup"
[0m15:15:01.349272 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m15:15:01.349888 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_count_aluno_idade"} */
drop view if exists "transformacao_matricula"."staging_marts"."view_count_aluno_idade__dbt_backup" cascade
[0m15:15:01.350927 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:15:01.353107 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: Close
[0m15:15:01.354291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92087cec-6668-47b0-8aa5-cb22cd1809ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770ddd9ae120>]}
[0m15:15:01.355191 [info ] [Thread-1 (]: 12 of 13 OK created sql view model staging_marts.view_count_aluno_idade ........ [[32mCREATE VIEW[0m in 0.05s]
[0m15:15:01.355970 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_count_aluno_idade
[0m15:15:01.356486 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_taxa_aprovados
[0m15:15:01.357320 [info ] [Thread-1 (]: 13 of 13 START sql view model staging_marts.view_taxa_aprovados ................ [RUN]
[0m15:15:01.357992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_count_aluno_idade, now model.transformacao_matricula.view_taxa_aprovados)
[0m15:15:01.358455 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_taxa_aprovados
[0m15:15:01.361903 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_taxa_aprovados"
[0m15:15:01.362751 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_taxa_aprovados
[0m15:15:01.367769 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_taxa_aprovados"
[0m15:15:01.368471 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m15:15:01.368892 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: BEGIN
[0m15:15:01.369256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:01.378407 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:15:01.378939 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m15:15:01.379342 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_taxa_aprovados"} */

  create view "transformacao_matricula"."staging_marts"."view_taxa_aprovados__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dt.modalidade_ensino,
    COUNT(fm.matricula) AS total_matriculas,
    SUM(ds.eh_aprovado) AS total_aprovados,
    SUM(ds.eh_reprovado) AS total_reprovados,
    -- Calcula a taxa de aprovação (como porcentagem)
    CAST(SUM(ds.eh_aprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_aprovacao_percentual,
    -- Calcula a taxa de reprovação (como porcentagem)
    CAST(SUM(ds.eh_reprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_reprovacao_percentual
FROM
    "transformacao_matricula"."staging_facts"."fato_matricula" fm
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_situacao" ds ON fm.id_situacao = ds.id_situacao
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_turma" dt ON fm.id_turma = dt.id_turma
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_tempo" dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dt.modalidade_ensino
ORDER BY
    dtemp.ano, dt.modalidade_ensino
  );
[0m15:15:01.385130 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m15:15:01.389054 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m15:15:01.389772 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_taxa_aprovados"} */
alter table "transformacao_matricula"."staging_marts"."view_taxa_aprovados__dbt_tmp" rename to "view_taxa_aprovados"
[0m15:15:01.391120 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:15:01.393032 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: COMMIT
[0m15:15:01.393550 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m15:15:01.394070 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: COMMIT
[0m15:15:01.395971 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:15:01.399078 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."view_taxa_aprovados__dbt_backup"
[0m15:15:01.400515 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m15:15:01.401142 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_taxa_aprovados"} */
drop view if exists "transformacao_matricula"."staging_marts"."view_taxa_aprovados__dbt_backup" cascade
[0m15:15:01.402200 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:15:01.404085 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: Close
[0m15:15:01.405071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92087cec-6668-47b0-8aa5-cb22cd1809ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770ddc33e750>]}
[0m15:15:01.406247 [info ] [Thread-1 (]: 13 of 13 OK created sql view model staging_marts.view_taxa_aprovados ........... [[32mCREATE VIEW[0m in 0.05s]
[0m15:15:01.407376 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_taxa_aprovados
[0m15:15:01.409213 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:01.409894 [debug] [MainThread]: On master: BEGIN
[0m15:15:01.410398 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:15:01.422303 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m15:15:01.423156 [debug] [MainThread]: On master: COMMIT
[0m15:15:01.423821 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:01.424438 [debug] [MainThread]: On master: COMMIT
[0m15:15:01.425519 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:15:01.426261 [debug] [MainThread]: On master: Close
[0m15:15:01.428887 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:15:01.429699 [debug] [MainThread]: Connection 'model.transformacao_matricula.view_taxa_aprovados' was properly closed.
[0m15:15:01.431206 [info ] [MainThread]: 
[0m15:15:01.432249 [info ] [MainThread]: Finished running 9 table models, 4 view models in 0 hours 0 minutes and 4.47 seconds (4.47s).
[0m15:15:01.435438 [debug] [MainThread]: Command end result
[0m15:15:01.484556 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m15:15:01.490937 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m15:15:01.501248 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m15:15:01.502056 [info ] [MainThread]: 
[0m15:15:01.502799 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m15:15:01.503495 [info ] [MainThread]: 
[0m15:15:01.504441 [error] [MainThread]: [31mFailure in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)[0m
[0m15:15:01.505575 [error] [MainThread]:   Database Error in model view_frequencia_situacao_escola (transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql)
  relation "fato_matricula" does not exist
  LINE 15:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m15:15:01.506222 [info ] [MainThread]: 
[0m15:15:01.506648 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_frequencia_situacao_escola.sql
[0m15:15:01.506993 [info ] [MainThread]: 
[0m15:15:01.507368 [error] [MainThread]: [31mFailure in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)[0m
[0m15:15:01.507761 [error] [MainThread]:   Database Error in model view_matricula_detalhada (transformacao_aprovados/models/marts/view_matricula_detalhada.sql)
  relation "fato_matricula" does not exist
  LINE 27:     fato_matricula fm
               ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m15:15:01.508192 [info ] [MainThread]: 
[0m15:15:01.508634 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/marts/view_matricula_detalhada.sql
[0m15:15:01.509012 [info ] [MainThread]: 
[0m15:15:01.509580 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=13
[0m15:15:01.510247 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 6 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:15:01.511685 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.1392865, "process_in_blocks": "0", "process_kernel_time": 0.424036, "process_mem_max_rss": "129608", "process_out_blocks": "3992", "process_user_time": 3.248615}
[0m15:15:01.512500 [debug] [MainThread]: Command `dbt run` failed at 15:15:01.512397 after 6.14 seconds
[0m15:15:01.513155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770dddaed0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770dddaed190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770ddbb6b050>]}
[0m15:15:01.514050 [debug] [MainThread]: Flushing usage events
[0m15:15:03.078763 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:16:37.170278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4b0e1f50d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4b0f3bf080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4b0e8bd3a0>]}


============================== 15:16:37.173171 | 5b0a124a-16d7-4450-977a-37eab40be437 ==============================
[0m15:16:37.173171 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:16:37.173724 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'invocation_command': 'dbt clean', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_format': 'default', 'target_path': 'None', 'profiles_dir': '/home/murilo/.dbt', 'introspect': 'True', 'warn_error': 'None', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'write_json': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'version_check': 'True'}
[0m15:16:37.275544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b0a124a-16d7-4450-977a-37eab40be437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4b0efd0980>]}
[0m15:16:37.287030 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.16191164, "process_in_blocks": "56", "process_kernel_time": 0.194471, "process_mem_max_rss": "101520", "process_out_blocks": "8", "process_user_time": 1.142895}
[0m15:16:37.287569 [debug] [MainThread]: Command `dbt clean` succeeded at 15:16:37.287482 after 0.16 seconds
[0m15:16:37.288012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4b10ca3bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4b0dea2f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4b0de91910>]}
[0m15:16:37.288405 [debug] [MainThread]: Flushing usage events
[0m15:16:37.792497 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:16:41.800478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779bf703c080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779bf8dea630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779bf6c2e720>]}


============================== 15:16:41.803970 | 549fc132-aba7-4655-9e86-21a931d11032 ==============================
[0m15:16:41.803970 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:16:41.804583 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'printer_width': '80', 'log_cache_events': 'False', 'target_path': 'None', 'partial_parse': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'use_colors': 'True', 'introspect': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'profiles_dir': '/home/murilo/.dbt', 'write_json': 'True', 'static_parser': 'True', 'log_format': 'default', 'empty': 'False', 'debug': 'False'}
[0m15:16:41.939407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '549fc132-aba7-4655-9e86-21a931d11032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779bf703c530>]}
[0m15:16:41.989092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '549fc132-aba7-4655-9e86-21a931d11032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779bf6718560>]}
[0m15:16:41.989960 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:16:42.099035 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:16:42.100170 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:16:42.100585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '549fc132-aba7-4655-9e86-21a931d11032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779bf5945790>]}
[0m15:16:43.059971 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m15:16:43.060717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '549fc132-aba7-4655-9e86-21a931d11032', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779bf4554500>]}
[0m15:16:43.310450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '549fc132-aba7-4655-9e86-21a931d11032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779bf4194200>]}
[0m15:16:43.379973 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m15:16:43.381972 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m15:16:43.395562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '549fc132-aba7-4655-9e86-21a931d11032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779bf3d9e000>]}
[0m15:16:43.396226 [info ] [MainThread]: Found 13 models, 37 data tests, 1 source, 459 macros
[0m15:16:43.396693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '549fc132-aba7-4655-9e86-21a931d11032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779bf599df40>]}
[0m15:16:43.398868 [info ] [MainThread]: 
[0m15:16:43.399332 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m15:16:43.399685 [info ] [MainThread]: 
[0m15:16:43.400172 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:16:43.404284 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula'
[0m15:16:43.444375 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m15:16:43.444951 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m15:16:43.445328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:43.458779 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.013 seconds
[0m15:16:43.460123 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m15:16:43.462409 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m15:16:43.463024 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m15:16:43.463403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:43.473803 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m15:16:43.475097 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m15:16:43.477163 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m15:16:43.477738 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m15:16:43.478103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:43.488455 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m15:16:43.490104 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m15:16:43.496708 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m15:16:43.497438 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m15:16:43.497909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:43.509371 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.011 seconds
[0m15:16:43.510801 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m15:16:43.516459 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m15:16:43.517128 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m15:16:43.517691 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:43.526076 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m15:16:43.527298 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m15:16:43.529703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula, now list_transformacao_matricula_staging_dimensions)
[0m15:16:43.534835 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_dimensions"
[0m15:16:43.535321 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: BEGIN
[0m15:16:43.535698 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:43.545503 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m15:16:43.546083 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_dimensions"
[0m15:16:43.546890 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_dimensions"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dimensions'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dimensions'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dimensions'
  
[0m15:16:43.550734 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m15:16:43.553193 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: ROLLBACK
[0m15:16:43.554176 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: Close
[0m15:16:43.554945 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_dimensions, now list_transformacao_matricula_staging_intermediate)
[0m15:16:43.556858 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_intermediate"
[0m15:16:43.558593 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: BEGIN
[0m15:16:43.559050 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:43.568731 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m15:16:43.569463 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_intermediate"
[0m15:16:43.569988 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_intermediate"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_intermediate'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_intermediate'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_intermediate'
  
[0m15:16:43.573144 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m15:16:43.574748 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: ROLLBACK
[0m15:16:43.575531 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: Close
[0m15:16:43.576230 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_intermediate, now list_transformacao_matricula_staging_staging)
[0m15:16:43.578378 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m15:16:43.578841 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: BEGIN
[0m15:16:43.579229 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:43.587375 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m15:16:43.587867 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m15:16:43.588217 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_staging"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m15:16:43.591170 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m15:16:43.592384 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: ROLLBACK
[0m15:16:43.593218 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: Close
[0m15:16:43.594000 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_staging, now list_transformacao_matricula_staging_marts)
[0m15:16:43.596325 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m15:16:43.596814 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: BEGIN
[0m15:16:43.597174 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:43.606345 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:16:43.606873 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m15:16:43.607402 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_marts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m15:16:43.610572 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m15:16:43.612184 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: ROLLBACK
[0m15:16:43.612992 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: Close
[0m15:16:43.613636 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_marts, now list_transformacao_matricula_staging_facts)
[0m15:16:43.617599 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_facts"
[0m15:16:43.618070 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: BEGIN
[0m15:16:43.618422 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:43.628398 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m15:16:43.628887 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_facts"
[0m15:16:43.629234 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_facts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_facts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_facts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_facts'
  
[0m15:16:43.632364 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m15:16:43.633625 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: ROLLBACK
[0m15:16:43.634435 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: Close
[0m15:16:43.639019 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:43.639502 [debug] [MainThread]: On master: BEGIN
[0m15:16:43.639837 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:16:43.651111 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m15:16:43.651754 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:43.652306 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:16:43.656542 [debug] [MainThread]: SQL status: SELECT 8 in 0.004 seconds
[0m15:16:43.659771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '549fc132-aba7-4655-9e86-21a931d11032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779bf1094230>]}
[0m15:16:43.660490 [debug] [MainThread]: On master: ROLLBACK
[0m15:16:43.661335 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:43.661833 [debug] [MainThread]: On master: BEGIN
[0m15:16:43.662741 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:16:43.663269 [debug] [MainThread]: On master: COMMIT
[0m15:16:43.663726 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:43.664168 [debug] [MainThread]: On master: COMMIT
[0m15:16:43.664927 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:16:43.665447 [debug] [MainThread]: On master: Close
[0m15:16:43.672377 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.staging_situacao_alunos
[0m15:16:43.673480 [info ] [Thread-1 (]: 1 of 13 START sql table model staging_staging.staging_situacao_alunos .......... [RUN]
[0m15:16:43.674111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_facts, now model.transformacao_matricula.staging_situacao_alunos)
[0m15:16:43.674552 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.staging_situacao_alunos
[0m15:16:43.680981 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.staging_situacao_alunos"
[0m15:16:43.682002 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.staging_situacao_alunos
[0m15:16:43.726158 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.staging_situacao_alunos"
[0m15:16:43.727650 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:16:43.728411 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: BEGIN
[0m15:16:43.728976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:43.739627 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m15:16:43.740318 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:16:43.741065 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */

  
    

  create  table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp"
  
  
    as
  
  (
    WITH source AS (
    SELECT * FROM "transformacao_matricula"."staging"."staging_alunos_raw"
),

cleaning_renaming AS (
    SELECT
        ano,
        codigo_escola,
        matricula,
        escola AS nome_escola,
        endereco_logradouro AS endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa,
        modalidade_ensino_codigo AS mod_ens_codigo,
        -- Transformação da SÉRIE
        CASE
            -- Ensino Fundamental (1º ao 9º)
            WHEN serie LIKE '%1 ANO%' OR serie LIKE '%1º ANO%' THEN '1º ANO'
            WHEN serie LIKE '%2 ANO%' OR serie LIKE '%2º ANO%' THEN '2º ANO'
            WHEN serie LIKE '%3 ANO%' OR serie LIKE '%3º ANO%' THEN '3º ANO'
            WHEN serie LIKE '%4 ANO%' OR serie LIKE '%4º ANO%' THEN '4º ANO'
            WHEN serie LIKE '%5 ANO%' OR serie LIKE '%5º ANO%' THEN '5º ANO'
            WHEN serie LIKE '%6 ANO%' OR serie LIKE '%6º ANO%' THEN '6º ANO'
            WHEN serie LIKE '%7 ANO%' OR serie LIKE '%7º ANO%' THEN '7º ANO'
            WHEN serie LIKE '%8 ANO%' OR serie LIKE '%8º ANO%' THEN '8º ANO'
            WHEN serie LIKE '%9 ANO%' OR serie LIKE '%9º ANO%' THEN '9º ANO'
            -- Educação Infantil (Berçário e Grupos)
            WHEN serie LIKE '%BER%' THEN 'BERÇARIO'
            WHEN serie LIKE '%GRUPO I%' OR serie LIKE '%GRUPO 1%' THEN 'GRUPO I'
            WHEN serie LIKE '%GRUPO II%' THEN 'GRUPO II'
            WHEN serie LIKE '%GRUPO III%' THEN 'GRUPO III'
            WHEN serie LIKE '%GRUPO IV%' THEN 'GRUPO IV'
            WHEN serie LIKE '%GRUPO V%' THEN 'GRUPO V'
            -- EJA (Módulos 1 ao 5) 
            WHEN serie LIKE '%1%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 1'
            WHEN serie LIKE '%2%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 2'
            WHEN serie LIKE '%3%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 3'
            WHEN serie LIKE '%4%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 4'
            WHEN serie LIKE '%5%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 5'
            WHEN serie LIKE '%TRAVESSIA%' THEN 'TRAVESSIA RECIFE'
            WHEN serie LIKE '%CORRECAO%1%' THEN 'CORREÇÃO DE FLUXO 1 - ALFABETIZACAO'
            WHEN serie LIKE '%CORRECAO%2%' THEN 'CORREÇÃO DE FLUXO 2 - ACELERACAO'
            ELSE 'OUTROS'
        END AS serie,
        turma,
        turno,
        idade,
        -- transformação do SEXO
        CASE
            WHEN sexo = '1' THEN 'Masculino'
            WHEN sexo = '2' THEN 'Feminino'
            WHEN sexo = '3' THEN 'Outros'
            ELSE 'Não informado'
        END AS sexo,
        -- transformação de situacao
        CASE 
            WHEN situacao_nome LIKE '%APROV%' THEN 'Aprovado'
            WHEN situacao_nome LIKE '%RET%' OR situacao_nome LIKE '%REPRO%' THEN 'Reprovado'
            WHEN situacao_nome LIKE '%TR%' OR situacao_nome LIKE '%REMAN%' THEN 'Transferido'
            WHEN situacao_nome LIKE '%DESIST%' THEN 'Desistente'
            ELSE 'Outros'
        END AS sit_nome,
        -- Transformação da MODALIDADE
        CASE
            WHEN modalidade_ensino LIKE '%EDUCACAO INFANTIL%' THEN 'EDUCAÇÃO INFANTIL'
            WHEN modalidade_ensino LIKE '%ENSINO FUNDAMENTAL%' THEN 'ENSINO FUNDAMENTAL'
            WHEN modalidade_ensino LIKE '%EDUCACAO JOVENS E ADULTOS%' THEN 'EJA'
            WHEN modalidade_ensino LIKE '%CORRE%' THEN 'CORREÇÃO DE FLUXO'
            ELSE 'OUTROS'
        END AS modalidade_ens
    FROM source
)

SELECT * FROM cleaning_renaming
  );
  
[0m15:16:44.414540 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 0.673 seconds
[0m15:16:44.424716 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:16:44.425227 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
alter table "transformacao_matricula"."staging_staging"."staging_situacao_alunos" rename to "staging_situacao_alunos__dbt_backup"
[0m15:16:44.426234 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:16:44.428866 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:16:44.429328 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
alter table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp" rename to "staging_situacao_alunos"
[0m15:16:44.430320 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:16:44.443901 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: COMMIT
[0m15:16:44.444415 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:16:44.444800 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: COMMIT
[0m15:16:44.460414 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m15:16:44.466135 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_backup"
[0m15:16:44.471026 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:16:44.471534 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
drop table if exists "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_backup" cascade
[0m15:16:44.481973 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m15:16:44.484137 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: Close
[0m15:16:44.485868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '549fc132-aba7-4655-9e86-21a931d11032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779bf8ba2720>]}
[0m15:16:44.486649 [info ] [Thread-1 (]: 1 of 13 OK created sql table model staging_staging.staging_situacao_alunos ..... [[32mSELECT 319146[0m in 0.81s]
[0m15:16:44.487399 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.staging_situacao_alunos
[0m15:16:44.488661 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.transform_data
[0m15:16:44.489297 [info ] [Thread-1 (]: 2 of 13 START sql table model staging_intermediate.transform_data .............. [RUN]
[0m15:16:44.489847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.staging_situacao_alunos, now model.transformacao_matricula.transform_data)
[0m15:16:44.490318 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.transform_data
[0m15:16:44.493045 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.transform_data"
[0m15:16:44.493788 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.transform_data
[0m15:16:44.496895 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.transform_data"
[0m15:16:44.497654 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:16:44.498081 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: BEGIN
[0m15:16:44.498437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:44.507453 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:16:44.508070 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:16:44.508929 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */

  
    

  create  table "transformacao_matricula"."staging_intermediate"."transform_data__dbt_tmp"
  
  
    as
  
  (
    

with staged_data AS (
    SELECT * FROM "transformacao_matricula"."staging_staging"."staging_situacao_alunos"
),

transformed_data AS (
    SELECT
        CAST(ano AS INTEGER) AS ano,
        CAST(codigo_escola AS INTEGER) AS codigo_escola,
        CAST(matricula AS INTEGER) AS matricula,
        nome_escola,
        endereco_logra,
        endereco_bairro,
        endereco_numero,
        CAST(rpa AS INTEGER) AS rpa,
        CAST(mod_ens_codigo AS INTEGER) AS mod_ens_codigo,
        serie,
        turma,
        turno,
        CAST(idade AS INTEGER) AS idade,
        sexo,
        sit_nome AS situacao_nome,
        modalidade_ens,
        CASE
            WHEN CAST(idade AS INTEGER) <= 3 THEN '0-3 Anos (Educação Infantil)'
            WHEN CAST(idade AS INTEGER) <= 5 THEN '4-5 Anos (Pré-escola)'
            WHEN CAST(idade AS INTEGER) <= 10 THEN '6-10 Anos (Fundamental I)'
            WHEN CAST(idade AS INTEGER) <= 14 THEN '11-14 Anos (Fundamental II)'
            WHEN CAST(idade AS INTEGER) >= 15 THEN '15+ Anos (EJA e Outros)'
            ELSE 'Não Informado'
        END AS faixa_etaria
    FROM staged_data
)

SELECT * FROM transformed_data
  );
  
[0m15:16:45.014103 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 0.504 seconds
[0m15:16:45.017378 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:16:45.017876 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
alter table "transformacao_matricula"."staging_intermediate"."transform_data" rename to "transform_data__dbt_backup"
[0m15:16:45.019017 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:16:45.021812 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:16:45.022351 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
alter table "transformacao_matricula"."staging_intermediate"."transform_data__dbt_tmp" rename to "transform_data"
[0m15:16:45.023318 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:16:45.025140 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: COMMIT
[0m15:16:45.025619 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:16:45.026005 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: COMMIT
[0m15:16:45.032319 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m15:16:45.034819 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_intermediate"."transform_data__dbt_backup"
[0m15:16:45.035723 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:16:45.036138 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
drop table if exists "transformacao_matricula"."staging_intermediate"."transform_data__dbt_backup" cascade
[0m15:16:45.049325 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m15:16:45.051084 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: Close
[0m15:16:45.051776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '549fc132-aba7-4655-9e86-21a931d11032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779bf0fff680>]}
[0m15:16:45.052488 [info ] [Thread-1 (]: 2 of 13 OK created sql table model staging_intermediate.transform_data ......... [[32mSELECT 319146[0m in 0.56s]
[0m15:16:45.053129 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.transform_data
[0m15:16:45.054511 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_aluno
[0m15:16:45.055157 [info ] [Thread-1 (]: 3 of 13 START sql table model staging_dimensions.dim_aluno ..................... [RUN]
[0m15:16:45.055710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.transform_data, now model.transformacao_matricula.dim_aluno)
[0m15:16:45.056154 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_aluno
[0m15:16:45.058779 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_aluno"
[0m15:16:45.059560 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_aluno
[0m15:16:45.062768 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_aluno"
[0m15:16:45.063577 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m15:16:45.064096 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: BEGIN
[0m15:16:45.064475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:45.074650 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:16:45.075364 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m15:16:45.075983 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_aluno"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_aluno__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),
alunos_unicos AS (
    SELECT DISTINCT
        matricula,
        sexo,
        idade,
        faixa_etaria
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY matricula) - 1 AS id_aluno, -- Surrogate Key
        matricula,
        sexo,
        idade,
        faixa_etaria
    FROM alunos_unicos
)

SELECT * FROM versao_final
  );
  
[0m15:16:45.743495 [debug] [Thread-1 (]: SQL status: SELECT 319143 in 0.667 seconds
[0m15:16:45.748797 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m15:16:45.749284 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_aluno"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_aluno" rename to "dim_aluno__dbt_backup"
[0m15:16:45.750383 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:16:45.752905 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m15:16:45.753353 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_aluno"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_aluno__dbt_tmp" rename to "dim_aluno"
[0m15:16:45.754351 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:16:45.756011 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: COMMIT
[0m15:16:45.756427 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m15:16:45.756799 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: COMMIT
[0m15:16:45.764656 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m15:16:45.766856 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_aluno__dbt_backup"
[0m15:16:45.767819 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m15:16:45.768219 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_aluno"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_aluno__dbt_backup" cascade
[0m15:16:45.775236 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:16:45.776682 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: Close
[0m15:16:45.777308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '549fc132-aba7-4655-9e86-21a931d11032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779bf073aab0>]}
[0m15:16:45.777977 [info ] [Thread-1 (]: 3 of 13 OK created sql table model staging_dimensions.dim_aluno ................ [[32mSELECT 319143[0m in 0.72s]
[0m15:16:45.778571 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_aluno
[0m15:16:45.779004 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_escola
[0m15:16:45.779599 [info ] [Thread-1 (]: 4 of 13 START sql table model staging_dimensions.dim_escola .................... [RUN]
[0m15:16:45.780133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_aluno, now model.transformacao_matricula.dim_escola)
[0m15:16:45.780537 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_escola
[0m15:16:45.782946 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_escola"
[0m15:16:45.783703 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_escola
[0m15:16:45.787015 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_escola"
[0m15:16:45.787719 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:16:45.788101 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: BEGIN
[0m15:16:45.788451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:45.799199 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m15:16:45.799910 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:16:45.800488 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_escola__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),
escolas_unicas AS (
    SELECT DISTINCT
        codigo_escola,
        nome_escola,
        endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY codigo_escola) - 1 AS id_escola, -- Surrogate Key
        codigo_escola,
        nome_escola,
        endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa
    FROM escolas_unicas
)

SELECT * FROM versao_final
  );
  
[0m15:16:45.934208 [debug] [Thread-1 (]: SQL status: SELECT 433 in 0.133 seconds
[0m15:16:45.937364 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:16:45.937837 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_escola" rename to "dim_escola__dbt_backup"
[0m15:16:45.938962 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:16:45.941494 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:16:45.941948 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_escola__dbt_tmp" rename to "dim_escola"
[0m15:16:45.943056 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:16:45.944725 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: COMMIT
[0m15:16:45.945148 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:16:45.945503 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: COMMIT
[0m15:16:45.947919 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:16:45.950440 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_escola__dbt_backup"
[0m15:16:45.951306 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:16:45.951708 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_escola__dbt_backup" cascade
[0m15:16:45.956323 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m15:16:45.957916 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: Close
[0m15:16:45.958558 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '549fc132-aba7-4655-9e86-21a931d11032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779bf0ffc620>]}
[0m15:16:45.959245 [info ] [Thread-1 (]: 4 of 13 OK created sql table model staging_dimensions.dim_escola ............... [[32mSELECT 433[0m in 0.18s]
[0m15:16:45.959853 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_escola
[0m15:16:45.960275 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_localizacao
[0m15:16:45.960762 [info ] [Thread-1 (]: 5 of 13 START sql table model staging_dimensions.dim_localizacao ............... [RUN]
[0m15:16:45.961382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_escola, now model.transformacao_matricula.dim_localizacao)
[0m15:16:45.961828 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_localizacao
[0m15:16:45.964410 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_localizacao"
[0m15:16:45.965091 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_localizacao
[0m15:16:45.968339 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_localizacao"
[0m15:16:45.969088 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:16:45.969492 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: BEGIN
[0m15:16:45.969866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:45.980269 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:16:45.980969 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:16:45.981532 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_localizacao__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),
localizacoes_unicas AS (
    SELECT DISTINCT
        rpa,
        endereco_bairro,
        CASE rpa
            WHEN 1 THEN 'RPA 1 (Centro)'
            WHEN 2 THEN 'RPA 2 (Zona Norte)'
            WHEN 3 THEN 'RPA 3 (Zona Oeste)'
            WHEN 4 THEN 'RPA 4 (Zona Sudoeste)'
            WHEN 5 THEN 'RPA 5 (Zona Sul)'
            WHEN 6 THEN 'RPA 6 (Zona Sudeste)'
            ELSE 'RPA Não Identificada'
        END AS desc_rpa
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY rpa, endereco_bairro) - 1 AS id_locali, -- Surrogate Key
        rpa,
        endereco_bairro,
        desc_rpa
    FROM localizacoes_unicas
)

SELECT * FROM versao_final
  );
  
[0m15:16:46.089231 [debug] [Thread-1 (]: SQL status: SELECT 88 in 0.107 seconds
[0m15:16:46.093459 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:16:46.093982 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_localizacao" rename to "dim_localizacao__dbt_backup"
[0m15:16:46.095122 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:16:46.097711 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:16:46.098183 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_localizacao__dbt_tmp" rename to "dim_localizacao"
[0m15:16:46.099222 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:16:46.100938 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: COMMIT
[0m15:16:46.101392 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:16:46.101776 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: COMMIT
[0m15:16:46.108233 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m15:16:46.110760 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_localizacao__dbt_backup"
[0m15:16:46.111623 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:16:46.112011 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_localizacao__dbt_backup" cascade
[0m15:16:46.115678 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:16:46.117037 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: Close
[0m15:16:46.117682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '549fc132-aba7-4655-9e86-21a931d11032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779bf073cda0>]}
[0m15:16:46.118352 [info ] [Thread-1 (]: 5 of 13 OK created sql table model staging_dimensions.dim_localizacao .......... [[32mSELECT 88[0m in 0.16s]
[0m15:16:46.118978 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_localizacao
[0m15:16:46.119396 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_situacao
[0m15:16:46.119870 [info ] [Thread-1 (]: 6 of 13 START sql table model staging_dimensions.dim_situacao .................. [RUN]
[0m15:16:46.120450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_localizacao, now model.transformacao_matricula.dim_situacao)
[0m15:16:46.120912 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_situacao
[0m15:16:46.123484 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_situacao"
[0m15:16:46.124166 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_situacao
[0m15:16:46.127188 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_situacao"
[0m15:16:46.127890 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:16:46.128278 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: BEGIN
[0m15:16:46.128647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:46.139688 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m15:16:46.140359 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:16:46.140981 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_situacao__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),
situacoes_unicas AS (
    SELECT DISTINCT
        situacao_nome,
        CASE 
            WHEN situacao_nome = 'Aprovado' THEN 'APROVADO'
            WHEN situacao_nome = 'Reprovado' THEN 'REPROVADO'
            WHEN situacao_nome = 'Transferido' THEN 'TRANSFERIDO'
            WHEN situacao_nome = 'Desistente' THEN 'DESISTENTE'
            ELSE 'OUTROS'
        END AS categoria,
        CASE 
            WHEN situacao_nome = 'Aprovado' THEN 1
            ELSE 0
        END AS eh_aprovado,
        CASE 
            WHEN situacao_nome = 'Reprovado' THEN 1
            ELSE 0
        END AS eh_reprovado
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY situacao_nome) - 1 AS id_situacao, -- Surrogate Key
        situacao_nome,
        categoria,
        eh_aprovado,
        eh_reprovado
    FROM situacoes_unicas
)

SELECT * FROM versao_final
  );
  
[0m15:16:46.207187 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.065 seconds
[0m15:16:46.210127 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:16:46.210590 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_situacao" rename to "dim_situacao__dbt_backup"
[0m15:16:46.211629 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:16:46.214198 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:16:46.214662 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_situacao__dbt_tmp" rename to "dim_situacao"
[0m15:16:46.215626 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:16:46.217308 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: COMMIT
[0m15:16:46.217767 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:16:46.218150 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: COMMIT
[0m15:16:46.224091 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m15:16:46.226479 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_situacao__dbt_backup"
[0m15:16:46.227359 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:16:46.227761 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_situacao__dbt_backup" cascade
[0m15:16:46.231995 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m15:16:46.233532 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: Close
[0m15:16:46.234173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '549fc132-aba7-4655-9e86-21a931d11032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779bf10c1a60>]}
[0m15:16:46.234852 [info ] [Thread-1 (]: 6 of 13 OK created sql table model staging_dimensions.dim_situacao ............. [[32mSELECT 5[0m in 0.11s]
[0m15:16:46.235445 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_situacao
[0m15:16:46.235890 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_tempo
[0m15:16:46.236538 [info ] [Thread-1 (]: 7 of 13 START sql table model staging_dimensions.dim_tempo ..................... [RUN]
[0m15:16:46.237066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_situacao, now model.transformacao_matricula.dim_tempo)
[0m15:16:46.237471 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_tempo
[0m15:16:46.240007 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_tempo"
[0m15:16:46.240702 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_tempo
[0m15:16:46.243857 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_tempo"
[0m15:16:46.244530 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:16:46.244936 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: BEGIN
[0m15:16:46.245284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:46.255411 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:16:46.256113 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:16:46.256669 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_tempo__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),

anos_unicos AS (
    SELECT DISTINCT
        ano,
        'Registro Anual' AS ano_ensino
    FROM source
),

versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY ano) - 1 AS id_tempo, -- Surrogate Key
        ano,
        ano_ensino
    FROM anos_unicos
)
SELECT * FROM versao_final
  );
  
[0m15:16:46.299272 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.042 seconds
[0m15:16:46.302743 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:16:46.303196 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_tempo" rename to "dim_tempo__dbt_backup"
[0m15:16:46.304349 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:16:46.308242 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:16:46.308742 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_tempo__dbt_tmp" rename to "dim_tempo"
[0m15:16:46.309811 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:16:46.311447 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: COMMIT
[0m15:16:46.311908 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:16:46.312269 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: COMMIT
[0m15:16:46.314181 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:16:46.384066 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_tempo__dbt_backup"
[0m15:16:46.385087 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:16:46.385490 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_tempo__dbt_backup" cascade
[0m15:16:46.389034 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:16:46.390715 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: Close
[0m15:16:46.391334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '549fc132-aba7-4655-9e86-21a931d11032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779bf077ea80>]}
[0m15:16:46.392028 [info ] [Thread-1 (]: 7 of 13 OK created sql table model staging_dimensions.dim_tempo ................ [[32mSELECT 3[0m in 0.15s]
[0m15:16:46.392666 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_tempo
[0m15:16:46.393086 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_turma
[0m15:16:46.393738 [info ] [Thread-1 (]: 8 of 13 START sql table model staging_dimensions.dim_turma ..................... [RUN]
[0m15:16:46.394253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_tempo, now model.transformacao_matricula.dim_turma)
[0m15:16:46.394674 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_turma
[0m15:16:46.397273 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_turma"
[0m15:16:46.397981 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_turma
[0m15:16:46.401058 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_turma"
[0m15:16:46.401753 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:16:46.402135 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: BEGIN
[0m15:16:46.402491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:46.411648 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:16:46.412348 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:16:46.412949 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_turma__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),
turmas_unicas AS (
    SELECT DISTINCT
        turma,
        turno,
        serie,
        mod_ens_codigo,
        modalidade_ens
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY turma, turno, serie) - 1 AS id_turma,
        turma,
        turno,
        NULL AS serie_codigo,
        serie,
        mod_ens_codigo,
        modalidade_ens AS modalidade_ensino
    FROM turmas_unicas
)

SELECT * FROM versao_final
  );
  
[0m15:16:46.560666 [debug] [Thread-1 (]: SQL status: SELECT 335 in 0.147 seconds
[0m15:16:46.563541 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:16:46.563996 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_turma" rename to "dim_turma__dbt_backup"
[0m15:16:46.565031 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:16:46.567632 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:16:46.568094 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_turma__dbt_tmp" rename to "dim_turma"
[0m15:16:46.569105 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:16:46.570912 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: COMMIT
[0m15:16:46.571351 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:16:46.571735 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: COMMIT
[0m15:16:46.573928 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:16:46.575999 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_turma__dbt_backup"
[0m15:16:46.576866 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:16:46.577249 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_turma__dbt_backup" cascade
[0m15:16:46.580883 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:16:46.582245 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: Close
[0m15:16:46.582914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '549fc132-aba7-4655-9e86-21a931d11032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779bf07752b0>]}
[0m15:16:46.583584 [info ] [Thread-1 (]: 8 of 13 OK created sql table model staging_dimensions.dim_turma ................ [[32mSELECT 335[0m in 0.19s]
[0m15:16:46.584214 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_turma
[0m15:16:46.585036 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.fato_matricula
[0m15:16:46.585553 [info ] [Thread-1 (]: 9 of 13 START sql table model staging_facts.fato_matricula ..................... [RUN]
[0m15:16:46.586057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_turma, now model.transformacao_matricula.fato_matricula)
[0m15:16:46.586457 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.fato_matricula
[0m15:16:46.590199 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.fato_matricula"
[0m15:16:46.590961 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.fato_matricula
[0m15:16:46.594509 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.fato_matricula"
[0m15:16:46.595452 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.fato_matricula"
[0m15:16:46.595984 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: BEGIN
[0m15:16:46.596533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:46.606771 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:16:46.607580 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.fato_matricula"
[0m15:16:46.608285 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.fato_matricula"} */

  
    

  create  table "transformacao_matricula"."staging_facts"."fato_matricula__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),

-- Dimensões com seus IDs
dim_aluno AS (
    SELECT id_aluno, matricula, sexo, idade, faixa_etaria 
    FROM "transformacao_matricula"."staging_dimensions"."dim_aluno"
),

dim_escola AS (
    SELECT id_escola, codigo_escola 
    FROM "transformacao_matricula"."staging_dimensions"."dim_escola"
),

dim_turma AS (
    SELECT id_turma, turma, turno, serie, mod_ens_codigo, modalidade_ensino 
    FROM "transformacao_matricula"."staging_dimensions"."dim_turma"
),

dim_situacao AS (
    SELECT id_situacao, situacao_nome 
    FROM "transformacao_matricula"."staging_dimensions"."dim_situacao"
),

dim_localizacao AS (
    SELECT id_locali, rpa, endereco_bairro 
    FROM "transformacao_matricula"."staging_dimensions"."dim_localizacao"
),

dim_tempo AS (
    SELECT id_tempo, ano 
    FROM "transformacao_matricula"."staging_dimensions"."dim_tempo"
),

-- Construindo a tabela fato
fato AS (
    SELECT
        da.id_aluno,
        de.id_escola,
        dt.id_turma,
        dsi.id_situacao,
        dl.id_locali,
        dte.id_tempo,
        s.matricula,
        1 AS qtd_alunos
    FROM source s
    
    LEFT JOIN dim_aluno da 
        ON s.matricula = da.matricula
        AND s.sexo = da.sexo
        AND s.idade = da.idade
    
    LEFT JOIN dim_escola de 
        ON s.codigo_escola = de.codigo_escola
    
    LEFT JOIN dim_turma dt 
        ON s.turma = dt.turma
        AND s.turno = dt.turno
        AND s.serie = dt.serie
        AND s.mod_ens_codigo = dt.mod_ens_codigo
        AND s.modalidade_ens = dt.modalidade_ensino
    
    LEFT JOIN dim_situacao dsi 
        ON s.situacao_nome = dsi.situacao_nome
    
    LEFT JOIN dim_localizacao dl 
        ON s.rpa = dl.rpa
        AND s.endereco_bairro = dl.endereco_bairro
    
    LEFT JOIN dim_tempo dte 
        ON s.ano = dte.ano
)

SELECT * FROM fato
  );
  
[0m15:16:47.627081 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 1.018 seconds
[0m15:16:47.630194 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.fato_matricula"
[0m15:16:47.630703 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.fato_matricula"} */
alter table "transformacao_matricula"."staging_facts"."fato_matricula" rename to "fato_matricula__dbt_backup"
[0m15:16:47.631818 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:16:47.636063 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.fato_matricula"
[0m15:16:47.636631 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.fato_matricula"} */
alter table "transformacao_matricula"."staging_facts"."fato_matricula__dbt_tmp" rename to "fato_matricula"
[0m15:16:47.637707 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:16:47.639431 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: COMMIT
[0m15:16:47.639941 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.fato_matricula"
[0m15:16:47.640338 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: COMMIT
[0m15:16:47.647318 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m15:16:47.650104 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_facts"."fato_matricula__dbt_backup"
[0m15:16:47.651064 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.fato_matricula"
[0m15:16:47.651475 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.fato_matricula"} */
drop table if exists "transformacao_matricula"."staging_facts"."fato_matricula__dbt_backup" cascade
[0m15:16:47.657890 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:16:47.659271 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: Close
[0m15:16:47.659968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '549fc132-aba7-4655-9e86-21a931d11032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779bf8b120c0>]}
[0m15:16:47.660729 [info ] [Thread-1 (]: 9 of 13 OK created sql table model staging_facts.fato_matricula ................ [[32mSELECT 319146[0m in 1.07s]
[0m15:16:47.661381 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.fato_matricula
[0m15:16:47.662565 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_count_aluno_idade
[0m15:16:47.663157 [info ] [Thread-1 (]: 10 of 13 START sql view model staging_marts.view_count_aluno_idade ............. [RUN]
[0m15:16:47.663688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.fato_matricula, now model.transformacao_matricula.view_count_aluno_idade)
[0m15:16:47.664190 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_count_aluno_idade
[0m15:16:47.667632 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_count_aluno_idade"
[0m15:16:47.668406 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_count_aluno_idade
[0m15:16:47.685013 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_count_aluno_idade"
[0m15:16:47.686199 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m15:16:47.686851 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: BEGIN
[0m15:16:47.687411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:47.697633 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:16:47.698305 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m15:16:47.698908 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_count_aluno_idade"} */

  create view "transformacao_matricula"."staging_marts"."view_count_aluno_idade__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dl.desc_rpa,
    da.faixa_etaria,
    COUNT(fm.matricula) AS total_alunos
FROM
    "transformacao_matricula"."staging_facts"."fato_matricula" fm
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_aluno" da ON fm.id_aluno = da.id_aluno
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_localizacao" dl ON fm.id_locali = dl.id_locali
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_tempo" dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
ORDER BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
  );
[0m15:16:47.702861 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m15:16:47.706778 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m15:16:47.707456 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_count_aluno_idade"} */
alter table "transformacao_matricula"."staging_marts"."view_count_aluno_idade__dbt_tmp" rename to "view_count_aluno_idade"
[0m15:16:47.708705 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:16:47.710854 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: COMMIT
[0m15:16:47.711493 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m15:16:47.712059 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: COMMIT
[0m15:16:47.714075 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:16:47.717030 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."view_count_aluno_idade__dbt_backup"
[0m15:16:47.720895 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m15:16:47.721430 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_count_aluno_idade"} */
drop view if exists "transformacao_matricula"."staging_marts"."view_count_aluno_idade__dbt_backup" cascade
[0m15:16:47.722432 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:16:47.723837 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: Close
[0m15:16:47.724574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '549fc132-aba7-4655-9e86-21a931d11032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779bf45cbbc0>]}
[0m15:16:47.725373 [info ] [Thread-1 (]: 10 of 13 OK created sql view model staging_marts.view_count_aluno_idade ........ [[32mCREATE VIEW[0m in 0.06s]
[0m15:16:47.726037 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_count_aluno_idade
[0m15:16:47.726590 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m15:16:47.727485 [info ] [Thread-1 (]: 11 of 13 START sql view model staging_marts.view_frequencia_situacao_escola .... [RUN]
[0m15:16:47.728136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_count_aluno_idade, now model.transformacao_matricula.view_frequencia_situacao_escola)
[0m15:16:47.729029 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_frequencia_situacao_escola
[0m15:16:47.732385 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m15:16:47.733123 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_frequencia_situacao_escola
[0m15:16:47.736376 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m15:16:47.737099 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m15:16:47.737508 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: BEGIN
[0m15:16:47.737898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:47.747276 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:16:47.747953 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m15:16:47.748481 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_frequencia_situacao_escola"} */

  create view "transformacao_matricula"."staging_marts"."view_frequencia_situacao_escola__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    de.nome_escola,
    de.codigo_escola,
    ds.situacao_nome,
    COUNT(fm.matricula) AS contagem_situacao
FROM
    "transformacao_matricula"."staging_facts"."fato_matricula" fm
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_escola" de ON fm.id_escola = de.id_escola
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_situacao" ds ON fm.id_situacao = ds.id_situacao
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_tempo" dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, de.nome_escola, de.codigo_escola, ds.situacao_nome
ORDER BY
    dtemp.ano, de.nome_escola, contagem_situacao DESC
  );
[0m15:16:47.751573 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:16:47.755464 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m15:16:47.756106 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_frequencia_situacao_escola"} */
alter table "transformacao_matricula"."staging_marts"."view_frequencia_situacao_escola__dbt_tmp" rename to "view_frequencia_situacao_escola"
[0m15:16:47.757272 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:16:47.759075 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: COMMIT
[0m15:16:47.759633 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m15:16:47.760099 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: COMMIT
[0m15:16:47.762391 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:16:47.765355 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."view_frequencia_situacao_escola__dbt_backup"
[0m15:16:47.766704 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m15:16:47.767317 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_frequencia_situacao_escola"} */
drop view if exists "transformacao_matricula"."staging_marts"."view_frequencia_situacao_escola__dbt_backup" cascade
[0m15:16:47.768413 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:16:47.770200 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: Close
[0m15:16:47.775069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '549fc132-aba7-4655-9e86-21a931d11032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779bf070bce0>]}
[0m15:16:47.776052 [info ] [Thread-1 (]: 11 of 13 OK created sql view model staging_marts.view_frequencia_situacao_escola  [[32mCREATE VIEW[0m in 0.05s]
[0m15:16:47.776931 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m15:16:47.777568 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_matricula_detalhada
[0m15:16:47.778352 [info ] [Thread-1 (]: 12 of 13 START sql view model staging_marts.view_matricula_detalhada ........... [RUN]
[0m15:16:47.779090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_frequencia_situacao_escola, now model.transformacao_matricula.view_matricula_detalhada)
[0m15:16:47.779738 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_matricula_detalhada
[0m15:16:47.787691 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_matricula_detalhada"
[0m15:16:47.788455 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_matricula_detalhada
[0m15:16:47.792197 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_matricula_detalhada"
[0m15:16:47.793098 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m15:16:47.793531 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: BEGIN
[0m15:16:47.793913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:47.802953 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:16:47.803581 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m15:16:47.804246 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_matricula_detalhada"} */

  create view "transformacao_matricula"."staging_marts"."view_matricula_detalhada__dbt_tmp"
    
    
  as (
    
SELECT
    fm.matricula,
    da.sexo,
    da.idade,
    da.faixa_etaria,
    de.nome_escola,
    de.codigo_escola,
    dt.turma,
    dt.turno,
    dt.serie,
    dt.modalidade_ensino,
    ds.situacao_nome,
    ds.categoria AS categoria_situacao,
    ds.eh_aprovado,
    ds.eh_reprovado,
    dl.desc_rpa,
    dl.endereco_bairro AS bairro_localizacao,
    dtemp.ano AS ano_registro
FROM
    "transformacao_matricula"."staging_facts"."fato_matricula" fm
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_aluno" da ON fm.id_aluno = da.id_aluno
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_escola" de ON fm.id_escola = de.id_escola
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_turma" dt ON fm.id_turma = dt.id_turma
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_situacao" ds ON fm.id_situacao = ds.id_situacao
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_localizacao" dl ON fm.id_locali = dl.id_locali
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_tempo" dtemp ON fm.id_tempo = dtemp.id_tempo
  );
[0m15:16:47.808784 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m15:16:47.813659 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m15:16:47.814326 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_matricula_detalhada"} */
alter table "transformacao_matricula"."staging_marts"."view_matricula_detalhada__dbt_tmp" rename to "view_matricula_detalhada"
[0m15:16:47.815683 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:16:47.817775 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: COMMIT
[0m15:16:47.818374 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m15:16:47.818915 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: COMMIT
[0m15:16:47.820940 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:16:47.824323 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."view_matricula_detalhada__dbt_backup"
[0m15:16:47.825651 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m15:16:47.826232 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_matricula_detalhada"} */
drop view if exists "transformacao_matricula"."staging_marts"."view_matricula_detalhada__dbt_backup" cascade
[0m15:16:47.827256 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:16:47.829454 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: Close
[0m15:16:47.830517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '549fc132-aba7-4655-9e86-21a931d11032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779bf4594560>]}
[0m15:16:47.831528 [info ] [Thread-1 (]: 12 of 13 OK created sql view model staging_marts.view_matricula_detalhada ...... [[32mCREATE VIEW[0m in 0.05s]
[0m15:16:47.832433 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_matricula_detalhada
[0m15:16:47.833070 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_taxa_aprovados
[0m15:16:47.834033 [info ] [Thread-1 (]: 13 of 13 START sql view model staging_marts.view_taxa_aprovados ................ [RUN]
[0m15:16:47.834694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_matricula_detalhada, now model.transformacao_matricula.view_taxa_aprovados)
[0m15:16:47.835175 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_taxa_aprovados
[0m15:16:47.838785 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_taxa_aprovados"
[0m15:16:47.839646 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_taxa_aprovados
[0m15:16:47.845135 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_taxa_aprovados"
[0m15:16:47.846185 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m15:16:47.846964 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: BEGIN
[0m15:16:47.847461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:47.857261 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:16:47.857888 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m15:16:47.858369 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_taxa_aprovados"} */

  create view "transformacao_matricula"."staging_marts"."view_taxa_aprovados__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dt.modalidade_ensino,
    COUNT(fm.matricula) AS total_matriculas,
    SUM(ds.eh_aprovado) AS total_aprovados,
    SUM(ds.eh_reprovado) AS total_reprovados,
    -- Calcula a taxa de aprovação (como porcentagem)
    CAST(SUM(ds.eh_aprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_aprovacao_percentual,
    -- Calcula a taxa de reprovação (como porcentagem)
    CAST(SUM(ds.eh_reprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_reprovacao_percentual
FROM
    "transformacao_matricula"."staging_facts"."fato_matricula" fm
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_situacao" ds ON fm.id_situacao = ds.id_situacao
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_turma" dt ON fm.id_turma = dt.id_turma
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_tempo" dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dt.modalidade_ensino
ORDER BY
    dtemp.ano, dt.modalidade_ensino
  );
[0m15:16:47.861183 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:16:47.863864 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m15:16:47.864342 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_taxa_aprovados"} */
alter table "transformacao_matricula"."staging_marts"."view_taxa_aprovados__dbt_tmp" rename to "view_taxa_aprovados"
[0m15:16:47.865645 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:16:47.867312 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: COMMIT
[0m15:16:47.868021 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m15:16:47.868402 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: COMMIT
[0m15:16:47.870644 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:16:47.874338 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."view_taxa_aprovados__dbt_backup"
[0m15:16:47.875568 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m15:16:47.876161 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_taxa_aprovados"} */
drop view if exists "transformacao_matricula"."staging_marts"."view_taxa_aprovados__dbt_backup" cascade
[0m15:16:47.877235 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:16:47.879042 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: Close
[0m15:16:47.883555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '549fc132-aba7-4655-9e86-21a931d11032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779bf4192a80>]}
[0m15:16:47.884514 [info ] [Thread-1 (]: 13 of 13 OK created sql view model staging_marts.view_taxa_aprovados ........... [[32mCREATE VIEW[0m in 0.05s]
[0m15:16:47.885328 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_taxa_aprovados
[0m15:16:47.886864 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:47.887459 [debug] [MainThread]: On master: BEGIN
[0m15:16:47.887938 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:16:47.901258 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m15:16:47.901906 [debug] [MainThread]: On master: COMMIT
[0m15:16:47.902407 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:47.902892 [debug] [MainThread]: On master: COMMIT
[0m15:16:47.903651 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:16:47.904523 [debug] [MainThread]: On master: Close
[0m15:16:47.905258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:16:47.905844 [debug] [MainThread]: Connection 'model.transformacao_matricula.view_taxa_aprovados' was properly closed.
[0m15:16:47.906508 [info ] [MainThread]: 
[0m15:16:47.907264 [info ] [MainThread]: Finished running 9 table models, 4 view models in 0 hours 0 minutes and 4.51 seconds (4.51s).
[0m15:16:47.911013 [debug] [MainThread]: Command end result
[0m15:16:47.945847 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m15:16:47.948670 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m15:16:47.956270 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m15:16:47.956939 [info ] [MainThread]: 
[0m15:16:47.957870 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:16:47.958651 [info ] [MainThread]: 
[0m15:16:47.959295 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=13
[0m15:16:47.960190 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 6 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:16:47.961660 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.2123117, "process_in_blocks": "0", "process_kernel_time": 0.378526, "process_mem_max_rss": "129124", "process_out_blocks": "4000", "process_user_time": 3.412745}
[0m15:16:47.962420 [debug] [MainThread]: Command `dbt run` succeeded at 15:16:47.962313 after 6.21 seconds
[0m15:16:47.963012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779bf6822570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779bf732b800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779bf6220710>]}
[0m15:16:47.963557 [debug] [MainThread]: Flushing usage events
[0m15:16:49.609891 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:23:17.145567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c114355d8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c11435abd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c11435abd40>]}


============================== 15:23:17.148639 | 765ad5a0-026d-4a21-8a78-e6dce2a7f17e ==============================
[0m15:23:17.148639 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:23:17.149204 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt clean', 'quiet': 'False', 'use_colors': 'True', 'debug': 'False', 'log_cache_events': 'False', 'empty': 'None', 'write_json': 'True', 'log_format': 'default', 'profiles_dir': '/home/murilo/.dbt', 'introspect': 'True', 'static_parser': 'True', 'printer_width': '80', 'version_check': 'True', 'no_print': 'None'}
[0m15:23:17.253928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '765ad5a0-026d-4a21-8a78-e6dce2a7f17e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1142641670>]}
[0m15:23:17.268379 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1673454, "process_in_blocks": "8", "process_kernel_time": 0.225033, "process_mem_max_rss": "101624", "process_out_blocks": "16", "process_user_time": 1.241669}
[0m15:23:17.269104 [debug] [MainThread]: Command `dbt clean` succeeded at 15:23:17.268988 after 0.17 seconds
[0m15:23:17.269653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1142b65760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c11438aeb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1142549fa0>]}
[0m15:23:17.270165 [debug] [MainThread]: Flushing usage events
[0m15:23:18.251668 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:23:24.238858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779b9d664fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779b9d426930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779b9ca03140>]}


============================== 15:23:24.242879 | 1ea0cd31-dd94-4de0-bcd4-bce303ecef07 ==============================
[0m15:23:24.242879 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:23:24.247552 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'profiles_dir': '/home/murilo/.dbt', 'empty': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'write_json': 'True', 'printer_width': '80', 'use_colors': 'True', 'log_format': 'default', 'warn_error': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs'}
[0m15:23:24.386883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ea0cd31-dd94-4de0-bcd4-bce303ecef07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779b9c24c0b0>]}
[0m15:23:24.435731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ea0cd31-dd94-4de0-bcd4-bce303ecef07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779b9ed6a5a0>]}
[0m15:23:24.436555 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:23:24.543240 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:23:24.544369 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:23:24.544799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1ea0cd31-dd94-4de0-bcd4-bce303ecef07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779b9c33e780>]}
[0m15:23:25.495253 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m15:23:25.495833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1ea0cd31-dd94-4de0-bcd4-bce303ecef07', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779b9ab3f020>]}
[0m15:23:25.747443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ea0cd31-dd94-4de0-bcd4-bce303ecef07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779b9a780b00>]}
[0m15:23:25.827080 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m15:23:25.828769 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m15:23:25.842598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ea0cd31-dd94-4de0-bcd4-bce303ecef07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779b9a7b3ec0>]}
[0m15:23:25.843180 [info ] [MainThread]: Found 13 models, 37 data tests, 1 source, 459 macros
[0m15:23:25.843596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ea0cd31-dd94-4de0-bcd4-bce303ecef07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779b9a369700>]}
[0m15:23:25.845893 [info ] [MainThread]: 
[0m15:23:25.846382 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m15:23:25.846769 [info ] [MainThread]: 
[0m15:23:25.847302 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:23:25.851453 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula'
[0m15:23:25.890093 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m15:23:25.890633 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m15:23:25.891048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:25.902729 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.012 seconds
[0m15:23:25.904540 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m15:23:25.907630 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m15:23:25.908309 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m15:23:25.908833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:25.918321 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m15:23:25.919519 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m15:23:25.921555 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m15:23:25.922156 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m15:23:25.922521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:25.932411 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.010 seconds
[0m15:23:25.933651 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m15:23:25.935684 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m15:23:25.936276 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m15:23:25.936668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:25.945405 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m15:23:25.946626 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m15:23:25.949754 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m15:23:25.950330 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m15:23:25.950813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:25.960283 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m15:23:25.961940 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m15:23:25.964017 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula, now list_transformacao_matricula_staging_intermediate)
[0m15:23:25.969307 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_intermediate"
[0m15:23:25.969769 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: BEGIN
[0m15:23:25.970095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:25.978892 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:23:25.979751 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_intermediate"
[0m15:23:25.980457 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_intermediate"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_intermediate'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_intermediate'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_intermediate'
  
[0m15:23:25.983365 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m15:23:25.985695 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: ROLLBACK
[0m15:23:25.986453 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: Close
[0m15:23:25.987133 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_intermediate, now list_transformacao_matricula_staging_dimensions)
[0m15:23:25.989730 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_dimensions"
[0m15:23:25.990297 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: BEGIN
[0m15:23:25.990671 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:25.998851 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m15:23:25.999669 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_dimensions"
[0m15:23:26.000051 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_dimensions"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dimensions'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dimensions'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dimensions'
  
[0m15:23:26.003432 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m15:23:26.005680 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: ROLLBACK
[0m15:23:26.006534 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: Close
[0m15:23:26.007160 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_dimensions, now list_transformacao_matricula_staging_marts)
[0m15:23:26.010293 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m15:23:26.010884 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: BEGIN
[0m15:23:26.011326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:26.021487 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m15:23:26.021969 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m15:23:26.022319 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_marts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m15:23:26.025206 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m15:23:26.026542 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: ROLLBACK
[0m15:23:26.027363 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: Close
[0m15:23:26.027981 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_marts, now list_transformacao_matricula_staging_staging)
[0m15:23:26.031050 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m15:23:26.031520 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: BEGIN
[0m15:23:26.031877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:26.039729 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m15:23:26.040215 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m15:23:26.040571 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_staging"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m15:23:26.043522 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m15:23:26.044783 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: ROLLBACK
[0m15:23:26.045514 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: Close
[0m15:23:26.046184 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_staging, now list_transformacao_matricula_staging_facts)
[0m15:23:26.048863 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_facts"
[0m15:23:26.049380 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: BEGIN
[0m15:23:26.049740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:26.057762 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m15:23:26.058233 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_facts"
[0m15:23:26.058574 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_facts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_facts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_facts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_facts'
  
[0m15:23:26.061466 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m15:23:26.062826 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: ROLLBACK
[0m15:23:26.063728 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: Close
[0m15:23:26.068873 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:26.069382 [debug] [MainThread]: On master: BEGIN
[0m15:23:26.069744 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:23:26.078820 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m15:23:26.079376 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:26.079851 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:23:26.083772 [debug] [MainThread]: SQL status: SELECT 19 in 0.003 seconds
[0m15:23:26.087914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ea0cd31-dd94-4de0-bcd4-bce303ecef07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779b9ab4e8d0>]}
[0m15:23:26.088473 [debug] [MainThread]: On master: ROLLBACK
[0m15:23:26.089385 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:26.089930 [debug] [MainThread]: On master: BEGIN
[0m15:23:26.091040 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:23:26.091532 [debug] [MainThread]: On master: COMMIT
[0m15:23:26.091882 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:26.092193 [debug] [MainThread]: On master: COMMIT
[0m15:23:26.092888 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:23:26.093301 [debug] [MainThread]: On master: Close
[0m15:23:26.095833 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.staging_situacao_alunos
[0m15:23:26.096849 [info ] [Thread-1 (]: 1 of 13 START sql table model staging_staging.staging_situacao_alunos .......... [RUN]
[0m15:23:26.097350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_facts, now model.transformacao_matricula.staging_situacao_alunos)
[0m15:23:26.097746 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.staging_situacao_alunos
[0m15:23:26.103854 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.staging_situacao_alunos"
[0m15:23:26.104712 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.staging_situacao_alunos
[0m15:23:26.141837 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.staging_situacao_alunos"
[0m15:23:26.143047 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:23:26.143658 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: BEGIN
[0m15:23:26.144175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:26.153336 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:23:26.154075 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:23:26.155118 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */

  
    

  create  table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp"
  
  
    as
  
  (
    WITH source AS (
    SELECT * FROM "transformacao_matricula"."staging"."staging_alunos_raw"
),

cleaning_renaming AS (
    SELECT
        ano,
        codigo_escola,
        matricula,
        escola AS nome_escola,
        endereco_logradouro AS endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa,
        modalidade_ensino_codigo AS mod_ens_codigo,
        -- Transformação da SÉRIE
        CASE
            -- Ensino Fundamental (1º ao 9º)
            WHEN serie LIKE '%1 ANO%' OR serie LIKE '%1º ANO%' THEN '1º ANO'
            WHEN serie LIKE '%2 ANO%' OR serie LIKE '%2º ANO%' THEN '2º ANO'
            WHEN serie LIKE '%3 ANO%' OR serie LIKE '%3º ANO%' THEN '3º ANO'
            WHEN serie LIKE '%4 ANO%' OR serie LIKE '%4º ANO%' THEN '4º ANO'
            WHEN serie LIKE '%5 ANO%' OR serie LIKE '%5º ANO%' THEN '5º ANO'
            WHEN serie LIKE '%6 ANO%' OR serie LIKE '%6º ANO%' THEN '6º ANO'
            WHEN serie LIKE '%7 ANO%' OR serie LIKE '%7º ANO%' THEN '7º ANO'
            WHEN serie LIKE '%8 ANO%' OR serie LIKE '%8º ANO%' THEN '8º ANO'
            WHEN serie LIKE '%9 ANO%' OR serie LIKE '%9º ANO%' THEN '9º ANO'
            -- Educação Infantil (Berçário e Grupos)
            WHEN serie LIKE '%BER%' THEN 'BERÇARIO'
            WHEN serie LIKE '%GRUPO I%' OR serie LIKE '%GRUPO 1%' THEN 'GRUPO I'
            WHEN serie LIKE '%GRUPO II%' THEN 'GRUPO II'
            WHEN serie LIKE '%GRUPO III%' THEN 'GRUPO III'
            WHEN serie LIKE '%GRUPO IV%' THEN 'GRUPO IV'
            WHEN serie LIKE '%GRUPO V%' THEN 'GRUPO V'
            -- EJA (Módulos 1 ao 5) 
            WHEN serie LIKE '%1%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 1'
            WHEN serie LIKE '%2%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 2'
            WHEN serie LIKE '%3%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 3'
            WHEN serie LIKE '%4%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 4'
            WHEN serie LIKE '%5%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 5'
            WHEN serie LIKE '%TRAVESSIA%' THEN 'TRAVESSIA RECIFE'
            WHEN serie LIKE '%CORRECAO%1%' THEN 'CORREÇÃO DE FLUXO 1 - ALFABETIZACAO'
            WHEN serie LIKE '%CORRECAO%2%' THEN 'CORREÇÃO DE FLUXO 2 - ACELERACAO'
            ELSE 'OUTROS'
        END AS serie,
        turma,
        turno,
        idade,
        -- transformação do SEXO
        CASE
            WHEN sexo = '1' THEN 'Masculino'
            WHEN sexo = '2' THEN 'Feminino'
            WHEN sexo = '3' THEN 'Outros'
            ELSE 'Não informado'
        END AS sexo,
        -- transformação de situacao
        CASE 
            WHEN situacao_nome LIKE '%APROV%' THEN 'Aprovado'
            WHEN situacao_nome LIKE '%RET%' OR situacao_nome LIKE '%REPRO%' THEN 'Reprovado'
            WHEN situacao_nome LIKE '%TR%' OR situacao_nome LIKE '%REMAN%' THEN 'Transferido'
            WHEN situacao_nome LIKE '%DESIST%' THEN 'Desistente'
            ELSE 'Outros'
        END AS sit_nome,
        -- Transformação da MODALIDADE
        CASE
            WHEN modalidade_ensino LIKE '%EDUCACAO INFANTIL%' THEN 'EDUCAÇÃO INFANTIL'
            WHEN modalidade_ensino LIKE '%ENSINO FUNDAMENTAL%' THEN 'ENSINO FUNDAMENTAL'
            WHEN modalidade_ensino LIKE '%EDUCACAO JOVENS E ADULTOS%' THEN 'EJA'
            WHEN modalidade_ensino LIKE '%CORRE%' THEN 'CORREÇÃO DE FLUXO'
            ELSE 'OUTROS'
        END AS modalidade_ens
    FROM source
)

SELECT * FROM cleaning_renaming
  );
  
[0m15:23:26.880311 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 0.725 seconds
[0m15:23:26.890468 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:23:26.890997 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
alter table "transformacao_matricula"."staging_staging"."staging_situacao_alunos" rename to "staging_situacao_alunos__dbt_backup"
[0m15:23:26.892102 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:23:26.894699 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:23:26.895144 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
alter table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp" rename to "staging_situacao_alunos"
[0m15:23:26.896210 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:23:26.909760 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: COMMIT
[0m15:23:26.910273 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:23:26.910660 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: COMMIT
[0m15:23:26.917471 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m15:23:26.923131 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_backup"
[0m15:23:26.928074 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m15:23:26.928585 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
drop table if exists "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_backup" cascade
[0m15:23:26.934760 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:23:26.937674 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: Close
[0m15:23:26.939369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ea0cd31-dd94-4de0-bcd4-bce303ecef07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779b9ee92960>]}
[0m15:23:26.940134 [info ] [Thread-1 (]: 1 of 13 OK created sql table model staging_staging.staging_situacao_alunos ..... [[32mSELECT 319146[0m in 0.84s]
[0m15:23:26.940797 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.staging_situacao_alunos
[0m15:23:26.941870 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.transform_data
[0m15:23:26.942401 [info ] [Thread-1 (]: 2 of 13 START sql table model staging_intermediate.transform_data .............. [RUN]
[0m15:23:26.942993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.staging_situacao_alunos, now model.transformacao_matricula.transform_data)
[0m15:23:26.943487 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.transform_data
[0m15:23:26.946350 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.transform_data"
[0m15:23:26.947110 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.transform_data
[0m15:23:26.950131 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.transform_data"
[0m15:23:26.950876 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:23:26.951256 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: BEGIN
[0m15:23:26.951626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:26.961167 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:23:26.961954 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:23:26.962569 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */

  
    

  create  table "transformacao_matricula"."staging_intermediate"."transform_data__dbt_tmp"
  
  
    as
  
  (
    

with staged_data AS (
    SELECT * FROM "transformacao_matricula"."staging_staging"."staging_situacao_alunos"
),

transformed_data AS (
    SELECT
        CAST(ano AS INTEGER) AS ano,
        CAST(codigo_escola AS INTEGER) AS codigo_escola,
        CAST(matricula AS INTEGER) AS matricula,
        nome_escola,
        endereco_logra,
        endereco_bairro,
        endereco_numero,
        CAST(rpa AS INTEGER) AS rpa,
        CAST(mod_ens_codigo AS INTEGER) AS mod_ens_codigo,
        serie,
        turma,
        turno,
        CAST(idade AS INTEGER) AS idade,
        sexo,
        sit_nome AS situacao_nome,
        modalidade_ens,
        CASE
            WHEN CAST(idade AS INTEGER) <= 3 THEN '0-3 Anos (Educação Infantil)'
            WHEN CAST(idade AS INTEGER) <= 5 THEN '4-5 Anos (Pré-escola)'
            WHEN CAST(idade AS INTEGER) <= 10 THEN '6-10 Anos (Fundamental I)'
            WHEN CAST(idade AS INTEGER) <= 14 THEN '11-14 Anos (Fundamental II)'
            WHEN CAST(idade AS INTEGER) >= 15 THEN '15+ Anos (EJA e Outros)'
            ELSE 'Não Informado'
        END AS faixa_etaria
    FROM staged_data
)

SELECT * FROM transformed_data
  );
  
[0m15:23:27.486728 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 0.523 seconds
[0m15:23:27.489559 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:23:27.490010 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
alter table "transformacao_matricula"."staging_intermediate"."transform_data" rename to "transform_data__dbt_backup"
[0m15:23:27.491040 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:23:27.493622 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:23:27.494082 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
alter table "transformacao_matricula"."staging_intermediate"."transform_data__dbt_tmp" rename to "transform_data"
[0m15:23:27.495019 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:23:27.496643 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: COMMIT
[0m15:23:27.497061 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:23:27.497413 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: COMMIT
[0m15:23:27.504647 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m15:23:27.506830 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_intermediate"."transform_data__dbt_backup"
[0m15:23:27.507759 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m15:23:27.508154 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
drop table if exists "transformacao_matricula"."staging_intermediate"."transform_data__dbt_backup" cascade
[0m15:23:27.521542 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m15:23:27.523025 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: Close
[0m15:23:27.523809 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ea0cd31-dd94-4de0-bcd4-bce303ecef07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779b93009f10>]}
[0m15:23:27.524600 [info ] [Thread-1 (]: 2 of 13 OK created sql table model staging_intermediate.transform_data ......... [[32mSELECT 319146[0m in 0.58s]
[0m15:23:27.525336 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.transform_data
[0m15:23:27.526584 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_aluno
[0m15:23:27.527163 [info ] [Thread-1 (]: 3 of 13 START sql table model staging_dimensions.dim_aluno ..................... [RUN]
[0m15:23:27.527673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.transform_data, now model.transformacao_matricula.dim_aluno)
[0m15:23:27.528101 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_aluno
[0m15:23:27.530826 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_aluno"
[0m15:23:27.531571 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_aluno
[0m15:23:27.536156 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_aluno"
[0m15:23:27.537050 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m15:23:27.537580 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: BEGIN
[0m15:23:27.538068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:27.547919 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:23:27.548586 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m15:23:27.549158 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_aluno"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_aluno__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),
alunos_unicos AS (
    SELECT DISTINCT
        matricula,
        sexo,
        idade,
        faixa_etaria
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY matricula) - 1 AS id_aluno, -- Surrogate Key
        matricula,
        sexo,
        idade,
        faixa_etaria
    FROM alunos_unicos
)

SELECT * FROM versao_final
  );
  
[0m15:23:28.215374 [debug] [Thread-1 (]: SQL status: SELECT 319143 in 0.666 seconds
[0m15:23:28.218253 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m15:23:28.218729 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_aluno"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_aluno" rename to "dim_aluno__dbt_backup"
[0m15:23:28.219778 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:23:28.222325 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m15:23:28.222801 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_aluno"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_aluno__dbt_tmp" rename to "dim_aluno"
[0m15:23:28.223762 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:23:28.225403 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: COMMIT
[0m15:23:28.225888 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m15:23:28.226258 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: COMMIT
[0m15:23:28.236442 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m15:23:28.238991 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_aluno__dbt_backup"
[0m15:23:28.239839 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m15:23:28.240220 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_aluno"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_aluno__dbt_backup" cascade
[0m15:23:28.246329 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:23:28.248444 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: Close
[0m15:23:28.249106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ea0cd31-dd94-4de0-bcd4-bce303ecef07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779b93096e10>]}
[0m15:23:28.249758 [info ] [Thread-1 (]: 3 of 13 OK created sql table model staging_dimensions.dim_aluno ................ [[32mSELECT 319143[0m in 0.72s]
[0m15:23:28.250401 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_aluno
[0m15:23:28.250889 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_escola
[0m15:23:28.251364 [info ] [Thread-1 (]: 4 of 13 START sql table model staging_dimensions.dim_escola .................... [RUN]
[0m15:23:28.251890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_aluno, now model.transformacao_matricula.dim_escola)
[0m15:23:28.252463 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_escola
[0m15:23:28.255086 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_escola"
[0m15:23:28.255937 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_escola
[0m15:23:28.260702 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_escola"
[0m15:23:28.261631 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:23:28.262187 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: BEGIN
[0m15:23:28.262702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:28.272992 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:23:28.273859 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:23:28.274460 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_escola__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),
escolas_unicas AS (
    SELECT DISTINCT
        codigo_escola,
        nome_escola,
        endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY codigo_escola) - 1 AS id_escola, -- Surrogate Key
        codigo_escola,
        nome_escola,
        endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa
    FROM escolas_unicas
)

SELECT * FROM versao_final
  );
  
[0m15:23:28.428107 [debug] [Thread-1 (]: SQL status: SELECT 433 in 0.153 seconds
[0m15:23:28.431977 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:23:28.432436 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_escola" rename to "dim_escola__dbt_backup"
[0m15:23:28.433601 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:23:28.436116 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:23:28.436576 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_escola__dbt_tmp" rename to "dim_escola"
[0m15:23:28.437646 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:23:28.439292 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: COMMIT
[0m15:23:28.439747 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:23:28.440105 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: COMMIT
[0m15:23:28.446336 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m15:23:28.448509 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_escola__dbt_backup"
[0m15:23:28.449371 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m15:23:28.449775 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_escola__dbt_backup" cascade
[0m15:23:28.453946 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m15:23:28.455923 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: Close
[0m15:23:28.456534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ea0cd31-dd94-4de0-bcd4-bce303ecef07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779b981b7fb0>]}
[0m15:23:28.457177 [info ] [Thread-1 (]: 4 of 13 OK created sql table model staging_dimensions.dim_escola ............... [[32mSELECT 433[0m in 0.20s]
[0m15:23:28.457779 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_escola
[0m15:23:28.458241 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_localizacao
[0m15:23:28.458854 [info ] [Thread-1 (]: 5 of 13 START sql table model staging_dimensions.dim_localizacao ............... [RUN]
[0m15:23:28.459387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_escola, now model.transformacao_matricula.dim_localizacao)
[0m15:23:28.459835 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_localizacao
[0m15:23:28.462476 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_localizacao"
[0m15:23:28.463135 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_localizacao
[0m15:23:28.467324 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_localizacao"
[0m15:23:28.468307 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:23:28.468969 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: BEGIN
[0m15:23:28.469507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:28.480298 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m15:23:28.481003 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:23:28.481697 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_localizacao__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),
localizacoes_unicas AS (
    SELECT DISTINCT
        rpa,
        endereco_bairro,
        CASE rpa
            WHEN 1 THEN 'RPA 1 (Centro)'
            WHEN 2 THEN 'RPA 2 (Zona Norte)'
            WHEN 3 THEN 'RPA 3 (Zona Oeste)'
            WHEN 4 THEN 'RPA 4 (Zona Sudoeste)'
            WHEN 5 THEN 'RPA 5 (Zona Sul)'
            WHEN 6 THEN 'RPA 6 (Zona Sudeste)'
            ELSE 'RPA Não Identificada'
        END AS desc_rpa
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY rpa, endereco_bairro) - 1 AS id_locali, -- Surrogate Key
        rpa,
        endereco_bairro,
        desc_rpa
    FROM localizacoes_unicas
)

SELECT * FROM versao_final
  );
  
[0m15:23:28.585001 [debug] [Thread-1 (]: SQL status: SELECT 88 in 0.103 seconds
[0m15:23:28.589271 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:23:28.589773 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_localizacao" rename to "dim_localizacao__dbt_backup"
[0m15:23:28.590782 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:23:28.593299 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:23:28.593783 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_localizacao__dbt_tmp" rename to "dim_localizacao"
[0m15:23:28.594769 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:23:28.596446 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: COMMIT
[0m15:23:28.596906 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:23:28.597276 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: COMMIT
[0m15:23:28.603637 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m15:23:28.605846 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_localizacao__dbt_backup"
[0m15:23:28.606710 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m15:23:28.607078 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_localizacao__dbt_backup" cascade
[0m15:23:28.610257 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:23:28.612036 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: Close
[0m15:23:28.613033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ea0cd31-dd94-4de0-bcd4-bce303ecef07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779b91769be0>]}
[0m15:23:28.614070 [info ] [Thread-1 (]: 5 of 13 OK created sql table model staging_dimensions.dim_localizacao .......... [[32mSELECT 88[0m in 0.15s]
[0m15:23:28.615137 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_localizacao
[0m15:23:28.615898 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_situacao
[0m15:23:28.616861 [info ] [Thread-1 (]: 6 of 13 START sql table model staging_dimensions.dim_situacao .................. [RUN]
[0m15:23:28.617809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_localizacao, now model.transformacao_matricula.dim_situacao)
[0m15:23:28.618376 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_situacao
[0m15:23:28.621186 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_situacao"
[0m15:23:28.621942 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_situacao
[0m15:23:28.625427 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_situacao"
[0m15:23:28.626192 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:23:28.626680 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: BEGIN
[0m15:23:28.627046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:28.636887 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:23:28.637384 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:23:28.637794 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_situacao__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),
situacoes_unicas AS (
    SELECT DISTINCT
        situacao_nome,
        CASE 
            WHEN situacao_nome = 'Aprovado' THEN 'APROVADO'
            WHEN situacao_nome = 'Reprovado' THEN 'REPROVADO'
            WHEN situacao_nome = 'Transferido' THEN 'TRANSFERIDO'
            WHEN situacao_nome = 'Desistente' THEN 'DESISTENTE'
            ELSE 'OUTROS'
        END AS categoria,
        CASE 
            WHEN situacao_nome = 'Aprovado' THEN 1
            ELSE 0
        END AS eh_aprovado,
        CASE 
            WHEN situacao_nome = 'Reprovado' THEN 1
            ELSE 0
        END AS eh_reprovado
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY situacao_nome) - 1 AS id_situacao, -- Surrogate Key
        situacao_nome,
        categoria,
        eh_aprovado,
        eh_reprovado
    FROM situacoes_unicas
)

SELECT * FROM versao_final
  );
  
[0m15:23:28.705513 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.067 seconds
[0m15:23:28.709023 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:23:28.709480 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_situacao" rename to "dim_situacao__dbt_backup"
[0m15:23:28.710474 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:23:28.713133 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:23:28.713595 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_situacao__dbt_tmp" rename to "dim_situacao"
[0m15:23:28.714673 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:23:28.716486 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: COMMIT
[0m15:23:28.716963 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:23:28.717324 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: COMMIT
[0m15:23:28.719486 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:23:28.721600 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_situacao__dbt_backup"
[0m15:23:28.722494 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m15:23:28.722899 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_situacao__dbt_backup" cascade
[0m15:23:28.726338 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:23:28.727947 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: Close
[0m15:23:28.728574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ea0cd31-dd94-4de0-bcd4-bce303ecef07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779b93184440>]}
[0m15:23:28.729264 [info ] [Thread-1 (]: 6 of 13 OK created sql table model staging_dimensions.dim_situacao ............. [[32mSELECT 5[0m in 0.11s]
[0m15:23:28.729917 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_situacao
[0m15:23:28.730350 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_tempo
[0m15:23:28.730996 [info ] [Thread-1 (]: 7 of 13 START sql table model staging_dimensions.dim_tempo ..................... [RUN]
[0m15:23:28.731521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_situacao, now model.transformacao_matricula.dim_tempo)
[0m15:23:28.731952 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_tempo
[0m15:23:28.734483 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_tempo"
[0m15:23:28.735146 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_tempo
[0m15:23:28.738365 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_tempo"
[0m15:23:28.739129 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:23:28.739549 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: BEGIN
[0m15:23:28.739926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:28.749637 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:23:28.750319 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:23:28.750902 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_tempo__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),

anos_unicos AS (
    SELECT DISTINCT
        ano,
        'Registro Anual' AS ano_ensino
    FROM source
),

versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY ano) - 1 AS id_tempo, -- Surrogate Key
        ano,
        ano_ensino
    FROM anos_unicos
)
SELECT * FROM versao_final
  );
  
[0m15:23:28.787044 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.035 seconds
[0m15:23:28.791439 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:23:28.792099 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_tempo" rename to "dim_tempo__dbt_backup"
[0m15:23:28.793213 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:23:28.797412 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:23:28.798171 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_tempo__dbt_tmp" rename to "dim_tempo"
[0m15:23:28.799529 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:23:28.802083 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: COMMIT
[0m15:23:28.802740 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:23:28.803253 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: COMMIT
[0m15:23:28.805664 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:23:28.808743 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_tempo__dbt_backup"
[0m15:23:28.810014 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m15:23:28.810588 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_tempo__dbt_backup" cascade
[0m15:23:28.813948 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:23:28.815873 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: Close
[0m15:23:28.820076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ea0cd31-dd94-4de0-bcd4-bce303ecef07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779b9171eab0>]}
[0m15:23:28.821018 [info ] [Thread-1 (]: 7 of 13 OK created sql table model staging_dimensions.dim_tempo ................ [[32mSELECT 3[0m in 0.09s]
[0m15:23:28.822306 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_tempo
[0m15:23:28.822998 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_turma
[0m15:23:28.823934 [info ] [Thread-1 (]: 8 of 13 START sql table model staging_dimensions.dim_turma ..................... [RUN]
[0m15:23:28.824646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_tempo, now model.transformacao_matricula.dim_turma)
[0m15:23:28.825155 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_turma
[0m15:23:28.828326 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_turma"
[0m15:23:28.829497 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_turma
[0m15:23:28.832864 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_turma"
[0m15:23:28.833573 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:23:28.834010 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: BEGIN
[0m15:23:28.834373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:28.842924 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:23:28.843426 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:23:28.843820 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_turma__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),
turmas_unicas AS (
    SELECT DISTINCT
        turma,
        turno,
        serie,
        mod_ens_codigo,
        modalidade_ens
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY turma, turno, serie) - 1 AS id_turma,
        turma,
        turno,
        NULL AS serie_codigo,
        serie,
        mod_ens_codigo,
        modalidade_ens AS modalidade_ensino
    FROM turmas_unicas
)

SELECT * FROM versao_final
  );
  
[0m15:23:28.993721 [debug] [Thread-1 (]: SQL status: SELECT 335 in 0.149 seconds
[0m15:23:28.996590 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:23:28.997086 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_turma" rename to "dim_turma__dbt_backup"
[0m15:23:28.998316 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:23:29.002972 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:23:29.004055 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_turma__dbt_tmp" rename to "dim_turma"
[0m15:23:29.005595 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:23:29.008476 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: COMMIT
[0m15:23:29.009304 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:23:29.010173 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: COMMIT
[0m15:23:29.016485 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m15:23:29.020718 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_turma__dbt_backup"
[0m15:23:29.022196 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m15:23:29.022960 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_turma__dbt_backup" cascade
[0m15:23:29.026822 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:23:29.029195 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: Close
[0m15:23:29.030694 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ea0cd31-dd94-4de0-bcd4-bce303ecef07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779b930b5340>]}
[0m15:23:29.032100 [info ] [Thread-1 (]: 8 of 13 OK created sql table model staging_dimensions.dim_turma ................ [[32mSELECT 335[0m in 0.21s]
[0m15:23:29.033323 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_turma
[0m15:23:29.034704 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.fato_matricula
[0m15:23:29.035819 [info ] [Thread-1 (]: 9 of 13 START sql table model staging_facts.fato_matricula ..................... [RUN]
[0m15:23:29.037408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_turma, now model.transformacao_matricula.fato_matricula)
[0m15:23:29.038807 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.fato_matricula
[0m15:23:29.045213 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.fato_matricula"
[0m15:23:29.046352 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.fato_matricula
[0m15:23:29.050982 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.fato_matricula"
[0m15:23:29.052101 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.fato_matricula"
[0m15:23:29.052782 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: BEGIN
[0m15:23:29.053386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:29.063638 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:23:29.064493 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.fato_matricula"
[0m15:23:29.065268 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.fato_matricula"} */

  
    

  create  table "transformacao_matricula"."staging_facts"."fato_matricula__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),

-- Dimensões com seus IDs
dim_aluno AS (
    SELECT id_aluno, matricula, sexo, idade, faixa_etaria 
    FROM "transformacao_matricula"."staging_dimensions"."dim_aluno"
),

dim_escola AS (
    SELECT id_escola, codigo_escola 
    FROM "transformacao_matricula"."staging_dimensions"."dim_escola"
),

dim_turma AS (
    SELECT id_turma, turma, turno, serie, mod_ens_codigo, modalidade_ensino 
    FROM "transformacao_matricula"."staging_dimensions"."dim_turma"
),

dim_situacao AS (
    SELECT id_situacao, situacao_nome 
    FROM "transformacao_matricula"."staging_dimensions"."dim_situacao"
),

dim_localizacao AS (
    SELECT id_locali, rpa, endereco_bairro 
    FROM "transformacao_matricula"."staging_dimensions"."dim_localizacao"
),

dim_tempo AS (
    SELECT id_tempo, ano 
    FROM "transformacao_matricula"."staging_dimensions"."dim_tempo"
),

-- Construindo a tabela fato
fato AS (
    SELECT
        da.id_aluno,
        de.id_escola,
        dt.id_turma,
        dsi.id_situacao,
        dl.id_locali,
        dte.id_tempo,
        s.matricula,
        1 AS qtd_alunos
    FROM source s
    
    LEFT JOIN dim_aluno da 
        ON s.matricula = da.matricula
        AND s.sexo = da.sexo
        AND s.idade = da.idade
    
    LEFT JOIN dim_escola de 
        ON s.codigo_escola = de.codigo_escola
    
    LEFT JOIN dim_turma dt 
        ON s.turma = dt.turma
        AND s.turno = dt.turno
        AND s.serie = dt.serie
        AND s.mod_ens_codigo = dt.mod_ens_codigo
        AND s.modalidade_ens = dt.modalidade_ensino
    
    LEFT JOIN dim_situacao dsi 
        ON s.situacao_nome = dsi.situacao_nome
    
    LEFT JOIN dim_localizacao dl 
        ON s.rpa = dl.rpa
        AND s.endereco_bairro = dl.endereco_bairro
    
    LEFT JOIN dim_tempo dte 
        ON s.ano = dte.ano
)

SELECT * FROM fato
  );
  
[0m15:23:30.068560 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 1.002 seconds
[0m15:23:30.071960 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.fato_matricula"
[0m15:23:30.072430 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.fato_matricula"} */
alter table "transformacao_matricula"."staging_facts"."fato_matricula" rename to "fato_matricula__dbt_backup"
[0m15:23:30.073557 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:23:30.077551 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.fato_matricula"
[0m15:23:30.078071 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.fato_matricula"} */
alter table "transformacao_matricula"."staging_facts"."fato_matricula__dbt_tmp" rename to "fato_matricula"
[0m15:23:30.079229 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:23:30.080934 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: COMMIT
[0m15:23:30.081370 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.fato_matricula"
[0m15:23:30.081750 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: COMMIT
[0m15:23:30.096272 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m15:23:30.161655 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_facts"."fato_matricula__dbt_backup"
[0m15:23:30.162553 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.fato_matricula"
[0m15:23:30.162968 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.fato_matricula"} */
drop table if exists "transformacao_matricula"."staging_facts"."fato_matricula__dbt_backup" cascade
[0m15:23:30.167470 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m15:23:30.168909 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: Close
[0m15:23:30.169534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ea0cd31-dd94-4de0-bcd4-bce303ecef07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779b91789430>]}
[0m15:23:30.170262 [info ] [Thread-1 (]: 9 of 13 OK created sql table model staging_facts.fato_matricula ................ [[32mSELECT 319146[0m in 1.13s]
[0m15:23:30.170916 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.fato_matricula
[0m15:23:30.171912 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_count_aluno_idade
[0m15:23:30.172486 [info ] [Thread-1 (]: 10 of 13 START sql view model staging_marts.view_count_aluno_idade ............. [RUN]
[0m15:23:30.172993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.fato_matricula, now model.transformacao_matricula.view_count_aluno_idade)
[0m15:23:30.173382 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_count_aluno_idade
[0m15:23:30.176488 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_count_aluno_idade"
[0m15:23:30.177294 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_count_aluno_idade
[0m15:23:30.198282 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_count_aluno_idade"
[0m15:23:30.199333 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m15:23:30.199953 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: BEGIN
[0m15:23:30.200494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:30.210911 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:23:30.211643 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m15:23:30.212252 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_count_aluno_idade"} */

  create view "transformacao_matricula"."staging_marts"."view_count_aluno_idade__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dl.desc_rpa,
    da.faixa_etaria,
    COUNT(fm.matricula) AS total_alunos
FROM
    "transformacao_matricula"."staging_facts"."fato_matricula" fm
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_aluno" da ON fm.id_aluno = da.id_aluno
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_localizacao" dl ON fm.id_locali = dl.id_locali
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_tempo" dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
ORDER BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
  );
[0m15:23:30.216243 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m15:23:30.219119 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m15:23:30.219565 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_count_aluno_idade"} */
alter table "transformacao_matricula"."staging_marts"."view_count_aluno_idade__dbt_tmp" rename to "view_count_aluno_idade"
[0m15:23:30.220658 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:23:30.222174 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: COMMIT
[0m15:23:30.222692 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m15:23:30.223205 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: COMMIT
[0m15:23:30.225391 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:23:30.228643 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."view_count_aluno_idade__dbt_backup"
[0m15:23:30.231812 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m15:23:30.232315 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_count_aluno_idade"} */
drop view if exists "transformacao_matricula"."staging_marts"."view_count_aluno_idade__dbt_backup" cascade
[0m15:23:30.233475 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:23:30.234969 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: Close
[0m15:23:30.235650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ea0cd31-dd94-4de0-bcd4-bce303ecef07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779b9d59a390>]}
[0m15:23:30.236339 [info ] [Thread-1 (]: 10 of 13 OK created sql view model staging_marts.view_count_aluno_idade ........ [[32mCREATE VIEW[0m in 0.06s]
[0m15:23:30.236963 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_count_aluno_idade
[0m15:23:30.237388 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m15:23:30.238050 [info ] [Thread-1 (]: 11 of 13 START sql view model staging_marts.view_frequencia_situacao_escola .... [RUN]
[0m15:23:30.238591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_count_aluno_idade, now model.transformacao_matricula.view_frequencia_situacao_escola)
[0m15:23:30.239130 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_frequencia_situacao_escola
[0m15:23:30.242212 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m15:23:30.242902 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_frequencia_situacao_escola
[0m15:23:30.246171 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m15:23:30.246916 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m15:23:30.247307 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: BEGIN
[0m15:23:30.247682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:30.256379 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:23:30.256914 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m15:23:30.257764 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_frequencia_situacao_escola"} */

  create view "transformacao_matricula"."staging_marts"."view_frequencia_situacao_escola__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    de.nome_escola,
    de.codigo_escola,
    ds.situacao_nome,
    COUNT(fm.matricula) AS contagem_situacao
FROM
    "transformacao_matricula"."staging_facts"."fato_matricula" fm
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_escola" de ON fm.id_escola = de.id_escola
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_situacao" ds ON fm.id_situacao = ds.id_situacao
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_tempo" dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, de.nome_escola, de.codigo_escola, ds.situacao_nome
ORDER BY
    dtemp.ano, de.nome_escola, contagem_situacao DESC
  );
[0m15:23:30.260643 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:23:30.263756 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m15:23:30.264341 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_frequencia_situacao_escola"} */
alter table "transformacao_matricula"."staging_marts"."view_frequencia_situacao_escola__dbt_tmp" rename to "view_frequencia_situacao_escola"
[0m15:23:30.265750 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:23:30.267946 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: COMMIT
[0m15:23:30.268666 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m15:23:30.269244 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: COMMIT
[0m15:23:30.271632 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:23:30.274555 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."view_frequencia_situacao_escola__dbt_backup"
[0m15:23:30.275951 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m15:23:30.276621 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_frequencia_situacao_escola"} */
drop view if exists "transformacao_matricula"."staging_marts"."view_frequencia_situacao_escola__dbt_backup" cascade
[0m15:23:30.277726 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:23:30.279521 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: Close
[0m15:23:30.284311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ea0cd31-dd94-4de0-bcd4-bce303ecef07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779b9d49fb30>]}
[0m15:23:30.285371 [info ] [Thread-1 (]: 11 of 13 OK created sql view model staging_marts.view_frequencia_situacao_escola  [[32mCREATE VIEW[0m in 0.05s]
[0m15:23:30.286320 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m15:23:30.287045 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_matricula_detalhada
[0m15:23:30.287889 [info ] [Thread-1 (]: 12 of 13 START sql view model staging_marts.view_matricula_detalhada ........... [RUN]
[0m15:23:30.288686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_frequencia_situacao_escola, now model.transformacao_matricula.view_matricula_detalhada)
[0m15:23:30.289356 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_matricula_detalhada
[0m15:23:30.296507 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_matricula_detalhada"
[0m15:23:30.297528 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_matricula_detalhada
[0m15:23:30.302243 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_matricula_detalhada"
[0m15:23:30.303142 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m15:23:30.303534 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: BEGIN
[0m15:23:30.303900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:30.313302 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:23:30.313834 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m15:23:30.314240 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_matricula_detalhada"} */

  create view "transformacao_matricula"."staging_marts"."view_matricula_detalhada__dbt_tmp"
    
    
  as (
    
SELECT
    fm.matricula,
    da.sexo,
    da.idade,
    da.faixa_etaria,
    de.nome_escola,
    de.codigo_escola,
    dt.turma,
    dt.turno,
    dt.serie,
    dt.modalidade_ensino,
    ds.situacao_nome,
    ds.categoria AS categoria_situacao,
    ds.eh_aprovado,
    ds.eh_reprovado,
    dl.desc_rpa,
    dl.endereco_bairro AS bairro_localizacao,
    dtemp.ano AS ano_registro
FROM
    "transformacao_matricula"."staging_facts"."fato_matricula" fm
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_aluno" da ON fm.id_aluno = da.id_aluno
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_escola" de ON fm.id_escola = de.id_escola
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_turma" dt ON fm.id_turma = dt.id_turma
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_situacao" ds ON fm.id_situacao = ds.id_situacao
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_localizacao" dl ON fm.id_locali = dl.id_locali
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_tempo" dtemp ON fm.id_tempo = dtemp.id_tempo
  );
[0m15:23:30.317456 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m15:23:30.321859 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m15:23:30.322500 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_matricula_detalhada"} */
alter table "transformacao_matricula"."staging_marts"."view_matricula_detalhada__dbt_tmp" rename to "view_matricula_detalhada"
[0m15:23:30.323847 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:23:30.325981 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: COMMIT
[0m15:23:30.326601 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m15:23:30.327135 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: COMMIT
[0m15:23:30.329468 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:23:30.332736 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."view_matricula_detalhada__dbt_backup"
[0m15:23:30.334032 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m15:23:30.334627 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_matricula_detalhada"} */
drop view if exists "transformacao_matricula"."staging_marts"."view_matricula_detalhada__dbt_backup" cascade
[0m15:23:30.335651 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:23:30.337375 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: Close
[0m15:23:30.341989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ea0cd31-dd94-4de0-bcd4-bce303ecef07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779b9ab3fef0>]}
[0m15:23:30.342960 [info ] [Thread-1 (]: 12 of 13 OK created sql view model staging_marts.view_matricula_detalhada ...... [[32mCREATE VIEW[0m in 0.05s]
[0m15:23:30.343811 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_matricula_detalhada
[0m15:23:30.344418 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_taxa_aprovados
[0m15:23:30.345178 [info ] [Thread-1 (]: 13 of 13 START sql view model staging_marts.view_taxa_aprovados ................ [RUN]
[0m15:23:30.345864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_matricula_detalhada, now model.transformacao_matricula.view_taxa_aprovados)
[0m15:23:30.346436 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_taxa_aprovados
[0m15:23:30.350867 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_taxa_aprovados"
[0m15:23:30.351831 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_taxa_aprovados
[0m15:23:30.356292 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_taxa_aprovados"
[0m15:23:30.357300 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m15:23:30.357928 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: BEGIN
[0m15:23:30.358509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:30.368630 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:23:30.369289 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m15:23:30.369740 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_taxa_aprovados"} */

  create view "transformacao_matricula"."staging_marts"."view_taxa_aprovados__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dt.modalidade_ensino,
    COUNT(fm.matricula) AS total_matriculas,
    SUM(ds.eh_aprovado) AS total_aprovados,
    SUM(ds.eh_reprovado) AS total_reprovados,
    -- Calcula a taxa de aprovação (como porcentagem)
    CAST(SUM(ds.eh_aprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_aprovacao_percentual,
    -- Calcula a taxa de reprovação (como porcentagem)
    CAST(SUM(ds.eh_reprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_reprovacao_percentual
FROM
    "transformacao_matricula"."staging_facts"."fato_matricula" fm
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_situacao" ds ON fm.id_situacao = ds.id_situacao
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_turma" dt ON fm.id_turma = dt.id_turma
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_tempo" dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dt.modalidade_ensino
ORDER BY
    dtemp.ano, dt.modalidade_ensino
  );
[0m15:23:30.373757 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m15:23:30.377244 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m15:23:30.377746 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_taxa_aprovados"} */
alter table "transformacao_matricula"."staging_marts"."view_taxa_aprovados__dbt_tmp" rename to "view_taxa_aprovados"
[0m15:23:30.378772 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:23:30.380273 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: COMMIT
[0m15:23:30.380721 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m15:23:30.381082 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: COMMIT
[0m15:23:30.383060 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:23:30.386543 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."view_taxa_aprovados__dbt_backup"
[0m15:23:30.387853 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m15:23:30.388450 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_taxa_aprovados"} */
drop view if exists "transformacao_matricula"."staging_marts"."view_taxa_aprovados__dbt_backup" cascade
[0m15:23:30.389660 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:23:30.391530 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: Close
[0m15:23:30.392385 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ea0cd31-dd94-4de0-bcd4-bce303ecef07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779b9c5d60c0>]}
[0m15:23:30.393576 [info ] [Thread-1 (]: 13 of 13 OK created sql view model staging_marts.view_taxa_aprovados ........... [[32mCREATE VIEW[0m in 0.05s]
[0m15:23:30.394639 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_taxa_aprovados
[0m15:23:30.396774 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:30.397356 [debug] [MainThread]: On master: BEGIN
[0m15:23:30.397862 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:23:30.408309 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m15:23:30.408959 [debug] [MainThread]: On master: COMMIT
[0m15:23:30.409453 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:30.409933 [debug] [MainThread]: On master: COMMIT
[0m15:23:30.410715 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:23:30.411239 [debug] [MainThread]: On master: Close
[0m15:23:30.413185 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:30.413817 [debug] [MainThread]: Connection 'model.transformacao_matricula.view_taxa_aprovados' was properly closed.
[0m15:23:30.414408 [info ] [MainThread]: 
[0m15:23:30.415578 [info ] [MainThread]: Finished running 9 table models, 4 view models in 0 hours 0 minutes and 4.57 seconds (4.57s).
[0m15:23:30.418710 [debug] [MainThread]: Command end result
[0m15:23:30.448897 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m15:23:30.451426 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m15:23:30.458438 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m15:23:30.459213 [info ] [MainThread]: 
[0m15:23:30.460313 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:23:30.461202 [info ] [MainThread]: 
[0m15:23:30.462090 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=13
[0m15:23:30.463279 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 6 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:23:30.466585 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.270973, "process_in_blocks": "0", "process_kernel_time": 0.381876, "process_mem_max_rss": "129272", "process_out_blocks": "4000", "process_user_time": 3.361908}
[0m15:23:30.467409 [debug] [MainThread]: Command `dbt run` succeeded at 15:23:30.467299 after 6.27 seconds
[0m15:23:30.468018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779b9d1238c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779b9a7c9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779b9a7c9f10>]}
[0m15:23:30.468632 [debug] [MainThread]: Flushing usage events
[0m15:23:31.666779 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:23:39.409860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edf3b266360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edf3a0cffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edf397feff0>]}


============================== 15:23:39.413252 | a7c3f87f-23bc-44f3-84a3-c8958b13da73 ==============================
[0m15:23:39.413252 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:23:39.413814 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'debug': 'False', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'introspect': 'True', 'printer_width': '80', 'target_path': 'None', 'use_experimental_parser': 'False', 'profiles_dir': '/home/murilo/.dbt', 'warn_error': 'None', 'log_format': 'default', 'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'empty': 'None', 'partial_parse': 'True', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'quiet': 'False', 'send_anonymous_usage_stats': 'True'}
[0m15:23:39.563438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7c3f87f-23bc-44f3-84a3-c8958b13da73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edf383098b0>]}
[0m15:23:39.616857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7c3f87f-23bc-44f3-84a3-c8958b13da73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edf39be8b00>]}
[0m15:23:39.617683 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:23:39.727328 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:23:39.821036 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:23:39.821491 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:23:39.857182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7c3f87f-23bc-44f3-84a3-c8958b13da73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edf391bf230>]}
[0m15:23:39.930657 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m15:23:39.932414 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m15:23:39.954043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7c3f87f-23bc-44f3-84a3-c8958b13da73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edf36b08620>]}
[0m15:23:39.955079 [info ] [MainThread]: Found 13 models, 37 data tests, 1 source, 459 macros
[0m15:23:39.955961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7c3f87f-23bc-44f3-84a3-c8958b13da73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edf39633ad0>]}
[0m15:23:39.959100 [info ] [MainThread]: 
[0m15:23:39.959582 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m15:23:39.959956 [info ] [MainThread]: 
[0m15:23:39.960497 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:23:39.964288 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula_staging_marts'
[0m15:23:40.005286 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m15:23:40.005794 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: BEGIN
[0m15:23:40.006141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:40.018845 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m15:23:40.019428 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m15:23:40.019785 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_marts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m15:23:40.023193 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m15:23:40.025023 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: ROLLBACK
[0m15:23:40.025765 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: Close
[0m15:23:40.026428 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_marts, now list_transformacao_matricula_staging_intermediate)
[0m15:23:40.031122 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_intermediate"
[0m15:23:40.031564 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: BEGIN
[0m15:23:40.031893 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:40.041022 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:23:40.041530 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_intermediate"
[0m15:23:40.041876 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_intermediate"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_intermediate'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_intermediate'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_intermediate'
  
[0m15:23:40.045250 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m15:23:40.046504 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: ROLLBACK
[0m15:23:40.047244 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: Close
[0m15:23:40.047874 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_intermediate, now list_transformacao_matricula_staging_facts)
[0m15:23:40.049867 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_facts"
[0m15:23:40.050321 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: BEGIN
[0m15:23:40.050653 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:40.060731 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m15:23:40.061242 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_facts"
[0m15:23:40.061998 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_facts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_facts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_facts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_facts'
  
[0m15:23:40.065327 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m15:23:40.067468 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: ROLLBACK
[0m15:23:40.068282 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: Close
[0m15:23:40.068933 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_facts, now list_transformacao_matricula_staging_staging)
[0m15:23:40.071219 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m15:23:40.071739 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: BEGIN
[0m15:23:40.072095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:40.081618 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:23:40.082094 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m15:23:40.082731 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_staging"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m15:23:40.086178 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m15:23:40.088338 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: ROLLBACK
[0m15:23:40.089106 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: Close
[0m15:23:40.089741 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_staging, now list_transformacao_matricula_staging_dimensions)
[0m15:23:40.092038 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_dimensions"
[0m15:23:40.092506 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: BEGIN
[0m15:23:40.092941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:40.101399 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m15:23:40.101883 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_dimensions"
[0m15:23:40.102218 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_dimensions"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dimensions'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dimensions'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dimensions'
  
[0m15:23:40.105068 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.002 seconds
[0m15:23:40.107264 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: ROLLBACK
[0m15:23:40.108042 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: Close
[0m15:23:40.113162 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:40.113634 [debug] [MainThread]: On master: BEGIN
[0m15:23:40.113960 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:23:40.122005 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:23:40.122841 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:40.123451 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:23:40.128135 [debug] [MainThread]: SQL status: SELECT 19 in 0.004 seconds
[0m15:23:40.133045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7c3f87f-23bc-44f3-84a3-c8958b13da73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edf36fa4200>]}
[0m15:23:40.133557 [debug] [MainThread]: On master: ROLLBACK
[0m15:23:40.134425 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:40.134846 [debug] [MainThread]: On master: BEGIN
[0m15:23:40.135913 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:23:40.136507 [debug] [MainThread]: On master: COMMIT
[0m15:23:40.136879 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:40.137207 [debug] [MainThread]: On master: COMMIT
[0m15:23:40.137884 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:23:40.138277 [debug] [MainThread]: On master: Close
[0m15:23:40.141621 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f
[0m15:23:40.142563 [info ] [Thread-1 (]: 1 of 37 START test not_null_dim_aluno_id_aluno ................................. [RUN]
[0m15:23:40.143151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_dimensions, now test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f)
[0m15:23:40.143650 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f
[0m15:23:40.158730 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f"
[0m15:23:40.159796 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f
[0m15:23:40.180314 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f"
[0m15:23:40.181210 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f"
[0m15:23:40.181671 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f: BEGIN
[0m15:23:40.182100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:40.190412 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:23:40.190928 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f"
[0m15:23:40.191298 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_aluno
from "transformacao_matricula"."staging_dimensions"."dim_aluno"
where id_aluno is null



  
  
      
    ) dbt_internal_test
[0m15:23:40.209826 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.018 seconds
[0m15:23:40.215197 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f: ROLLBACK
[0m15:23:40.216105 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f: Close
[0m15:23:40.216905 [info ] [Thread-1 (]: 1 of 37 PASS not_null_dim_aluno_id_aluno ....................................... [[32mPASS[0m in 0.07s]
[0m15:23:40.217745 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f
[0m15:23:40.218305 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432
[0m15:23:40.218943 [info ] [Thread-1 (]: 2 of 37 START test not_null_dim_aluno_matricula ................................ [RUN]
[0m15:23:40.219522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f, now test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432)
[0m15:23:40.220010 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432
[0m15:23:40.223858 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432"
[0m15:23:40.224573 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432
[0m15:23:40.226853 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432"
[0m15:23:40.227631 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432"
[0m15:23:40.228121 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432: BEGIN
[0m15:23:40.228544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:40.238175 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:23:40.238936 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432"
[0m15:23:40.239557 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select matricula
from "transformacao_matricula"."staging_dimensions"."dim_aluno"
where matricula is null



  
  
      
    ) dbt_internal_test
[0m15:23:40.261010 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.021 seconds
[0m15:23:40.263302 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432: ROLLBACK
[0m15:23:40.264450 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432: Close
[0m15:23:40.265390 [info ] [Thread-1 (]: 2 of 37 PASS not_null_dim_aluno_matricula ...................................... [[32mPASS[0m in 0.05s]
[0m15:23:40.266142 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432
[0m15:23:40.266634 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0
[0m15:23:40.267323 [info ] [Thread-1 (]: 3 of 37 START test not_null_dim_escola_codigo_escola ........................... [RUN]
[0m15:23:40.268047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432, now test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0)
[0m15:23:40.268459 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0
[0m15:23:40.272700 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0"
[0m15:23:40.273361 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0
[0m15:23:40.275707 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0"
[0m15:23:40.276378 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0"
[0m15:23:40.276778 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0: BEGIN
[0m15:23:40.277167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:40.287050 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:23:40.287721 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0"
[0m15:23:40.288259 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select codigo_escola
from "transformacao_matricula"."staging_dimensions"."dim_escola"
where codigo_escola is null



  
  
      
    ) dbt_internal_test
[0m15:23:40.289976 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:23:40.291821 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0: ROLLBACK
[0m15:23:40.292745 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0: Close
[0m15:23:40.293633 [info ] [Thread-1 (]: 3 of 37 PASS not_null_dim_escola_codigo_escola ................................. [[32mPASS[0m in 0.03s]
[0m15:23:40.294450 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0
[0m15:23:40.295258 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651
[0m15:23:40.296014 [info ] [Thread-1 (]: 4 of 37 START test not_null_dim_escola_id_escola ............................... [RUN]
[0m15:23:40.296838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0, now test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651)
[0m15:23:40.297462 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651
[0m15:23:40.302287 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651"
[0m15:23:40.303029 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651
[0m15:23:40.305226 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651"
[0m15:23:40.305924 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651"
[0m15:23:40.306305 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651: BEGIN
[0m15:23:40.306670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:40.314637 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:23:40.315255 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651"
[0m15:23:40.315775 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_escola
from "transformacao_matricula"."staging_dimensions"."dim_escola"
where id_escola is null



  
  
      
    ) dbt_internal_test
[0m15:23:40.317255 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:23:40.318668 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651: ROLLBACK
[0m15:23:40.319539 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651: Close
[0m15:23:40.323124 [info ] [Thread-1 (]: 4 of 37 PASS not_null_dim_escola_id_escola ..................................... [[32mPASS[0m in 0.03s]
[0m15:23:40.324188 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651
[0m15:23:40.325521 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6
[0m15:23:40.326270 [info ] [Thread-1 (]: 5 of 37 START test not_null_dim_localizacao_id_locali .......................... [RUN]
[0m15:23:40.326956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651, now test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6)
[0m15:23:40.327515 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6
[0m15:23:40.332490 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6"
[0m15:23:40.333390 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6
[0m15:23:40.336509 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6"
[0m15:23:40.337433 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6"
[0m15:23:40.338078 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6: BEGIN
[0m15:23:40.338624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:40.347242 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:23:40.348198 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6"
[0m15:23:40.348868 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_locali
from "transformacao_matricula"."staging_dimensions"."dim_localizacao"
where id_locali is null



  
  
      
    ) dbt_internal_test
[0m15:23:40.350361 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:23:40.351925 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6: ROLLBACK
[0m15:23:40.352839 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6: Close
[0m15:23:40.353535 [info ] [Thread-1 (]: 5 of 37 PASS not_null_dim_localizacao_id_locali ................................ [[32mPASS[0m in 0.03s]
[0m15:23:40.354197 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6
[0m15:23:40.354765 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0
[0m15:23:40.355365 [info ] [Thread-1 (]: 6 of 37 START test not_null_dim_situacao_id_situacao ........................... [RUN]
[0m15:23:40.355941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6, now test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0)
[0m15:23:40.356414 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0
[0m15:23:40.360139 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0"
[0m15:23:40.360957 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0
[0m15:23:40.363866 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0"
[0m15:23:40.364777 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0"
[0m15:23:40.365337 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0: BEGIN
[0m15:23:40.365854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:40.379080 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m15:23:40.380693 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0"
[0m15:23:40.381982 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_situacao
from "transformacao_matricula"."staging_dimensions"."dim_situacao"
where id_situacao is null



  
  
      
    ) dbt_internal_test
[0m15:23:40.384920 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:23:40.386588 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0: ROLLBACK
[0m15:23:40.387671 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0: Close
[0m15:23:40.388663 [info ] [Thread-1 (]: 6 of 37 PASS not_null_dim_situacao_id_situacao ................................. [[32mPASS[0m in 0.03s]
[0m15:23:40.389371 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0
[0m15:23:40.389893 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82
[0m15:23:40.390467 [info ] [Thread-1 (]: 7 of 37 START test not_null_dim_situacao_situacao_nome ......................... [RUN]
[0m15:23:40.391299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0, now test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82)
[0m15:23:40.392033 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82
[0m15:23:40.398098 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82"
[0m15:23:40.398868 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82
[0m15:23:40.469044 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82"
[0m15:23:40.470003 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82"
[0m15:23:40.470556 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82: BEGIN
[0m15:23:40.471072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:40.481189 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:23:40.481893 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82"
[0m15:23:40.482467 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select situacao_nome
from "transformacao_matricula"."staging_dimensions"."dim_situacao"
where situacao_nome is null



  
  
      
    ) dbt_internal_test
[0m15:23:40.484171 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:23:40.486473 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82: ROLLBACK
[0m15:23:40.487703 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82: Close
[0m15:23:40.488937 [info ] [Thread-1 (]: 7 of 37 PASS not_null_dim_situacao_situacao_nome ............................... [[32mPASS[0m in 0.10s]
[0m15:23:40.490096 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82
[0m15:23:40.490831 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6
[0m15:23:40.491521 [info ] [Thread-1 (]: 8 of 37 START test not_null_dim_tempo_ano ...................................... [RUN]
[0m15:23:40.492268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82, now test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6)
[0m15:23:40.492821 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6
[0m15:23:40.497015 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6"
[0m15:23:40.497702 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6
[0m15:23:40.500104 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6"
[0m15:23:40.501039 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6"
[0m15:23:40.501495 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6: BEGIN
[0m15:23:40.501913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:40.511198 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:23:40.511918 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6"
[0m15:23:40.512489 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ano
from "transformacao_matricula"."staging_dimensions"."dim_tempo"
where ano is null



  
  
      
    ) dbt_internal_test
[0m15:23:40.514190 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:23:40.516181 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6: ROLLBACK
[0m15:23:40.517195 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6: Close
[0m15:23:40.518078 [info ] [Thread-1 (]: 8 of 37 PASS not_null_dim_tempo_ano ............................................ [[32mPASS[0m in 0.03s]
[0m15:23:40.519051 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6
[0m15:23:40.519748 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3
[0m15:23:40.520527 [info ] [Thread-1 (]: 9 of 37 START test not_null_dim_tempo_id_tempo ................................. [RUN]
[0m15:23:40.521444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6, now test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3)
[0m15:23:40.522036 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3
[0m15:23:40.526473 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3"
[0m15:23:40.527234 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3
[0m15:23:40.529514 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3"
[0m15:23:40.530341 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3"
[0m15:23:40.530805 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3: BEGIN
[0m15:23:40.531217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:40.541330 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:23:40.541901 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3"
[0m15:23:40.542435 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_tempo
from "transformacao_matricula"."staging_dimensions"."dim_tempo"
where id_tempo is null



  
  
      
    ) dbt_internal_test
[0m15:23:40.544242 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:23:40.545748 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3: ROLLBACK
[0m15:23:40.547132 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3: Close
[0m15:23:40.548420 [info ] [Thread-1 (]: 9 of 37 PASS not_null_dim_tempo_id_tempo ....................................... [[32mPASS[0m in 0.03s]
[0m15:23:40.549333 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3
[0m15:23:40.549867 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20
[0m15:23:40.550448 [info ] [Thread-1 (]: 10 of 37 START test not_null_dim_turma_id_turma ................................ [RUN]
[0m15:23:40.551117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3, now test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20)
[0m15:23:40.551636 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20
[0m15:23:40.555501 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20"
[0m15:23:40.556253 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20
[0m15:23:40.558397 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20"
[0m15:23:40.559208 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20"
[0m15:23:40.559657 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20: BEGIN
[0m15:23:40.560045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:40.570330 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:23:40.571026 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20"
[0m15:23:40.571571 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_turma
from "transformacao_matricula"."staging_dimensions"."dim_turma"
where id_turma is null



  
  
      
    ) dbt_internal_test
[0m15:23:40.573215 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:23:40.575036 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20: ROLLBACK
[0m15:23:40.575906 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20: Close
[0m15:23:40.578012 [info ] [Thread-1 (]: 10 of 37 PASS not_null_dim_turma_id_turma ...................................... [[32mPASS[0m in 0.03s]
[0m15:23:40.578961 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20
[0m15:23:40.579636 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164
[0m15:23:40.580491 [info ] [Thread-1 (]: 11 of 37 START test not_null_fato_matricula_id_aluno ........................... [RUN]
[0m15:23:40.581219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20, now test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164)
[0m15:23:40.581803 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164
[0m15:23:40.586693 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164"
[0m15:23:40.587552 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164
[0m15:23:40.590506 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164"
[0m15:23:40.591441 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164"
[0m15:23:40.592029 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164: BEGIN
[0m15:23:40.592551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:40.602550 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:23:40.603141 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164"
[0m15:23:40.603558 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_aluno
from "transformacao_matricula"."staging_facts"."fato_matricula"
where id_aluno is null



  
  
      
    ) dbt_internal_test
[0m15:23:40.619427 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.015 seconds
[0m15:23:40.621823 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164: ROLLBACK
[0m15:23:40.622778 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164: Close
[0m15:23:40.623620 [info ] [Thread-1 (]: 11 of 37 PASS not_null_fato_matricula_id_aluno ................................. [[32mPASS[0m in 0.04s]
[0m15:23:40.624326 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164
[0m15:23:40.624864 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66
[0m15:23:40.625424 [info ] [Thread-1 (]: 12 of 37 START test not_null_fato_matricula_id_escola .......................... [RUN]
[0m15:23:40.625983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164, now test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66)
[0m15:23:40.626449 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66
[0m15:23:40.630326 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66"
[0m15:23:40.631046 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66
[0m15:23:40.634845 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66"
[0m15:23:40.635597 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66"
[0m15:23:40.636017 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66: BEGIN
[0m15:23:40.636390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:40.646014 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:23:40.646732 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66"
[0m15:23:40.647285 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_escola
from "transformacao_matricula"."staging_facts"."fato_matricula"
where id_escola is null



  
  
      
    ) dbt_internal_test
[0m15:23:40.666930 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.019 seconds
[0m15:23:40.668851 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66: ROLLBACK
[0m15:23:40.669876 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66: Close
[0m15:23:40.670792 [info ] [Thread-1 (]: 12 of 37 PASS not_null_fato_matricula_id_escola ................................ [[32mPASS[0m in 0.04s]
[0m15:23:40.671735 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66
[0m15:23:40.672400 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e
[0m15:23:40.673096 [info ] [Thread-1 (]: 13 of 37 START test not_null_fato_matricula_id_locali .......................... [RUN]
[0m15:23:40.673847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66, now test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e)
[0m15:23:40.674598 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e
[0m15:23:40.679802 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e"
[0m15:23:40.680699 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e
[0m15:23:40.683591 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e"
[0m15:23:40.684623 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e"
[0m15:23:40.685195 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e: BEGIN
[0m15:23:40.685727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:40.694073 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:23:40.694665 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e"
[0m15:23:40.695267 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_locali
from "transformacao_matricula"."staging_facts"."fato_matricula"
where id_locali is null



  
  
      
    ) dbt_internal_test
[0m15:23:40.712217 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.016 seconds
[0m15:23:40.714140 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e: ROLLBACK
[0m15:23:40.715179 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e: Close
[0m15:23:40.716138 [info ] [Thread-1 (]: 13 of 37 PASS not_null_fato_matricula_id_locali ................................ [[32mPASS[0m in 0.04s]
[0m15:23:40.717103 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e
[0m15:23:40.717719 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86
[0m15:23:40.718375 [info ] [Thread-1 (]: 14 of 37 START test not_null_fato_matricula_id_situacao ........................ [RUN]
[0m15:23:40.719100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e, now test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86)
[0m15:23:40.719710 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86
[0m15:23:40.724977 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86"
[0m15:23:40.725893 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86
[0m15:23:40.728965 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86"
[0m15:23:40.729892 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86"
[0m15:23:40.730441 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86: BEGIN
[0m15:23:40.730983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:40.741017 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:23:40.741715 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86"
[0m15:23:40.742267 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_situacao
from "transformacao_matricula"."staging_facts"."fato_matricula"
where id_situacao is null



  
  
      
    ) dbt_internal_test
[0m15:23:40.757692 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.015 seconds
[0m15:23:40.759788 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86: ROLLBACK
[0m15:23:40.760759 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86: Close
[0m15:23:40.761823 [info ] [Thread-1 (]: 14 of 37 PASS not_null_fato_matricula_id_situacao .............................. [[32mPASS[0m in 0.04s]
[0m15:23:40.762862 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86
[0m15:23:40.763666 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3
[0m15:23:40.764472 [info ] [Thread-1 (]: 15 of 37 START test not_null_fato_matricula_id_tempo ........................... [RUN]
[0m15:23:40.765289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86, now test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3)
[0m15:23:40.765996 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3
[0m15:23:40.771405 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3"
[0m15:23:40.772293 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3
[0m15:23:40.775224 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3"
[0m15:23:40.776124 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3"
[0m15:23:40.776864 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3: BEGIN
[0m15:23:40.777382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:40.787438 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:23:40.788133 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3"
[0m15:23:40.788701 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_tempo
from "transformacao_matricula"."staging_facts"."fato_matricula"
where id_tempo is null



  
  
      
    ) dbt_internal_test
[0m15:23:40.809707 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.020 seconds
[0m15:23:40.811797 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3: ROLLBACK
[0m15:23:40.812897 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3: Close
[0m15:23:40.814140 [info ] [Thread-1 (]: 15 of 37 PASS not_null_fato_matricula_id_tempo ................................. [[32mPASS[0m in 0.05s]
[0m15:23:40.815191 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3
[0m15:23:40.815863 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0
[0m15:23:40.816500 [info ] [Thread-1 (]: 16 of 37 START test not_null_fato_matricula_id_turma ........................... [RUN]
[0m15:23:40.817189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3, now test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0)
[0m15:23:40.817762 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0
[0m15:23:40.822751 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0"
[0m15:23:40.823503 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0
[0m15:23:40.826669 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0"
[0m15:23:40.827648 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0"
[0m15:23:40.828253 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0: BEGIN
[0m15:23:40.828817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:40.838639 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:23:40.839376 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0"
[0m15:23:40.839991 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_turma
from "transformacao_matricula"."staging_facts"."fato_matricula"
where id_turma is null



  
  
      
    ) dbt_internal_test
[0m15:23:40.859744 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.019 seconds
[0m15:23:40.861804 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0: ROLLBACK
[0m15:23:40.862851 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0: Close
[0m15:23:40.866279 [info ] [Thread-1 (]: 16 of 37 PASS not_null_fato_matricula_id_turma ................................. [[32mPASS[0m in 0.05s]
[0m15:23:40.867452 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0
[0m15:23:40.868132 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439
[0m15:23:40.868992 [info ] [Thread-1 (]: 17 of 37 START test not_null_fato_matricula_matricula .......................... [RUN]
[0m15:23:40.869794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0, now test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439)
[0m15:23:40.870562 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439
[0m15:23:40.876344 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439"
[0m15:23:40.877304 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439
[0m15:23:40.880227 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439"
[0m15:23:40.881108 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439"
[0m15:23:40.881705 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439: BEGIN
[0m15:23:40.882350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:40.892551 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:23:40.893255 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439"
[0m15:23:40.893822 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select matricula
from "transformacao_matricula"."staging_facts"."fato_matricula"
where matricula is null



  
  
      
    ) dbt_internal_test
[0m15:23:40.915349 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.021 seconds
[0m15:23:40.917307 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439: ROLLBACK
[0m15:23:40.918297 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439: Close
[0m15:23:40.919718 [info ] [Thread-1 (]: 17 of 37 PASS not_null_fato_matricula_matricula ................................ [[32mPASS[0m in 0.05s]
[0m15:23:40.920413 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439
[0m15:23:40.920840 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf
[0m15:23:40.921226 [info ] [Thread-1 (]: 18 of 37 START test not_null_staging_situacao_alunos_ano ....................... [RUN]
[0m15:23:40.921692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439, now test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf)
[0m15:23:40.922176 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf
[0m15:23:40.930015 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf"
[0m15:23:40.930969 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf
[0m15:23:40.933981 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf"
[0m15:23:40.934964 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf"
[0m15:23:40.935578 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf: BEGIN
[0m15:23:40.936153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:40.946089 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:23:40.946857 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf"
[0m15:23:40.947488 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ano
from "transformacao_matricula"."staging_staging"."staging_situacao_alunos"
where ano is null



  
  
      
    ) dbt_internal_test
[0m15:23:40.969927 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.022 seconds
[0m15:23:40.971944 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf: ROLLBACK
[0m15:23:40.972956 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf: Close
[0m15:23:40.975012 [info ] [Thread-1 (]: 18 of 37 PASS not_null_staging_situacao_alunos_ano ............................. [[32mPASS[0m in 0.05s]
[0m15:23:40.975985 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf
[0m15:23:40.977029 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d
[0m15:23:40.978068 [info ] [Thread-1 (]: 19 of 37 START test not_null_staging_situacao_alunos_matricula ................. [RUN]
[0m15:23:40.978825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf, now test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d)
[0m15:23:40.979344 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d
[0m15:23:40.983017 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d"
[0m15:23:40.983914 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d
[0m15:23:40.986455 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d"
[0m15:23:40.987334 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d"
[0m15:23:40.987889 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d: BEGIN
[0m15:23:40.988504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:40.998963 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:23:40.999751 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d"
[0m15:23:41.000444 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select matricula
from "transformacao_matricula"."staging_staging"."staging_situacao_alunos"
where matricula is null



  
  
      
    ) dbt_internal_test
[0m15:23:41.022653 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.021 seconds
[0m15:23:41.024761 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d: ROLLBACK
[0m15:23:41.026041 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d: Close
[0m15:23:41.027431 [info ] [Thread-1 (]: 19 of 37 PASS not_null_staging_situacao_alunos_matricula ....................... [[32mPASS[0m in 0.05s]
[0m15:23:41.028309 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d
[0m15:23:41.028823 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_transform_data_ano.10ed340507
[0m15:23:41.029287 [info ] [Thread-1 (]: 20 of 37 START test not_null_transform_data_ano ................................ [RUN]
[0m15:23:41.029893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d, now test.transformacao_matricula.not_null_transform_data_ano.10ed340507)
[0m15:23:41.030364 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_transform_data_ano.10ed340507
[0m15:23:41.034202 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_transform_data_ano.10ed340507"
[0m15:23:41.035134 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_transform_data_ano.10ed340507
[0m15:23:41.037546 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_transform_data_ano.10ed340507"
[0m15:23:41.038320 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_transform_data_ano.10ed340507"
[0m15:23:41.038808 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_transform_data_ano.10ed340507: BEGIN
[0m15:23:41.039202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:41.047420 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:23:41.047985 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_transform_data_ano.10ed340507"
[0m15:23:41.048391 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_transform_data_ano.10ed340507: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_transform_data_ano.10ed340507"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ano
from "transformacao_matricula"."staging_intermediate"."transform_data"
where ano is null



  
  
      
    ) dbt_internal_test
[0m15:23:41.069713 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.021 seconds
[0m15:23:41.071670 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_transform_data_ano.10ed340507: ROLLBACK
[0m15:23:41.072632 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_transform_data_ano.10ed340507: Close
[0m15:23:41.073704 [info ] [Thread-1 (]: 20 of 37 PASS not_null_transform_data_ano ...................................... [[32mPASS[0m in 0.04s]
[0m15:23:41.074637 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_transform_data_ano.10ed340507
[0m15:23:41.075283 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8
[0m15:23:41.076147 [info ] [Thread-1 (]: 21 of 37 START test not_null_transform_data_matricula .......................... [RUN]
[0m15:23:41.076952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_transform_data_ano.10ed340507, now test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8)
[0m15:23:41.077741 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8
[0m15:23:41.083163 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8"
[0m15:23:41.084099 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8
[0m15:23:41.087130 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8"
[0m15:23:41.088203 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8"
[0m15:23:41.088808 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8: BEGIN
[0m15:23:41.089314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:41.098916 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:23:41.099589 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8"
[0m15:23:41.100000 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select matricula
from "transformacao_matricula"."staging_intermediate"."transform_data"
where matricula is null



  
  
      
    ) dbt_internal_test
[0m15:23:41.123447 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.023 seconds
[0m15:23:41.125681 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8: ROLLBACK
[0m15:23:41.126699 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8: Close
[0m15:23:41.127980 [info ] [Thread-1 (]: 21 of 37 PASS not_null_transform_data_matricula ................................ [[32mPASS[0m in 0.05s]
[0m15:23:41.129042 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8
[0m15:23:41.129701 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee
[0m15:23:41.130394 [info ] [Thread-1 (]: 22 of 37 START test relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_  [RUN]
[0m15:23:41.131425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8, now test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee)
[0m15:23:41.132223 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee
[0m15:23:41.142392 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee"
[0m15:23:41.143316 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee
[0m15:23:41.146419 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee"
[0m15:23:41.147380 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee"
[0m15:23:41.148013 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee: BEGIN
[0m15:23:41.148576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:41.157971 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:23:41.159190 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee"
[0m15:23:41.160117 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select id_aluno as from_field
    from "transformacao_matricula"."staging_facts"."fato_matricula"
    where id_aluno is not null
),

parent as (
    select id_aluno as to_field
    from "transformacao_matricula"."staging_dimensions"."dim_aluno"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:23:41.253405 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.092 seconds
[0m15:23:41.255546 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee: ROLLBACK
[0m15:23:41.256695 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee: Close
[0m15:23:41.257753 [info ] [Thread-1 (]: 22 of 37 PASS relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_ .. [[32mPASS[0m in 0.13s]
[0m15:23:41.258788 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee
[0m15:23:41.259492 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb
[0m15:23:41.260319 [info ] [Thread-1 (]: 23 of 37 START test relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_  [RUN]
[0m15:23:41.261169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee, now test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb)
[0m15:23:41.262157 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb
[0m15:23:41.269521 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb"
[0m15:23:41.270433 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb
[0m15:23:41.275792 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb"
[0m15:23:41.276771 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb"
[0m15:23:41.277360 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb: BEGIN
[0m15:23:41.277937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:41.289689 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m15:23:41.290438 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb"
[0m15:23:41.291143 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select id_escola as from_field
    from "transformacao_matricula"."staging_facts"."fato_matricula"
    where id_escola is not null
),

parent as (
    select id_escola as to_field
    from "transformacao_matricula"."staging_dimensions"."dim_escola"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:23:41.329071 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.037 seconds
[0m15:23:41.331679 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb: ROLLBACK
[0m15:23:41.332925 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb: Close
[0m15:23:41.334126 [info ] [Thread-1 (]: 23 of 37 PASS relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_  [[32mPASS[0m in 0.07s]
[0m15:23:41.335221 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb
[0m15:23:41.335969 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a
[0m15:23:41.336727 [info ] [Thread-1 (]: 24 of 37 START test relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_  [RUN]
[0m15:23:41.337536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb, now test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a)
[0m15:23:41.338230 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a
[0m15:23:41.345714 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a"
[0m15:23:41.346723 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a
[0m15:23:41.349254 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a"
[0m15:23:41.350100 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a"
[0m15:23:41.350653 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a: BEGIN
[0m15:23:41.351104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:41.359535 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:23:41.360149 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a"
[0m15:23:41.360692 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select id_locali as from_field
    from "transformacao_matricula"."staging_facts"."fato_matricula"
    where id_locali is not null
),

parent as (
    select id_locali as to_field
    from "transformacao_matricula"."staging_dimensions"."dim_localizacao"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:23:41.387344 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.026 seconds
[0m15:23:41.389502 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a: ROLLBACK
[0m15:23:41.390813 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a: Close
[0m15:23:41.392162 [info ] [Thread-1 (]: 24 of 37 PASS relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_  [[32mPASS[0m in 0.05s]
[0m15:23:41.393359 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a
[0m15:23:41.394297 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315
[0m15:23:41.395100 [info ] [Thread-1 (]: 25 of 37 START test relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_  [RUN]
[0m15:23:41.395888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a, now test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315)
[0m15:23:41.396582 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315
[0m15:23:41.403911 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315"
[0m15:23:41.404894 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315
[0m15:23:41.408243 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315"
[0m15:23:41.409279 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315"
[0m15:23:41.409951 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315: BEGIN
[0m15:23:41.410565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:41.421504 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m15:23:41.422260 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315"
[0m15:23:41.422919 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select id_situacao as from_field
    from "transformacao_matricula"."staging_facts"."fato_matricula"
    where id_situacao is not null
),

parent as (
    select id_situacao as to_field
    from "transformacao_matricula"."staging_dimensions"."dim_situacao"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:23:41.456770 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.033 seconds
[0m15:23:41.458553 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315: ROLLBACK
[0m15:23:41.459721 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315: Close
[0m15:23:41.460939 [info ] [Thread-1 (]: 25 of 37 PASS relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_  [[32mPASS[0m in 0.06s]
[0m15:23:41.462100 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315
[0m15:23:41.462989 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c
[0m15:23:41.463937 [info ] [Thread-1 (]: 26 of 37 START test relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_  [RUN]
[0m15:23:41.465048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315, now test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c)
[0m15:23:41.465982 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c
[0m15:23:41.475269 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c"
[0m15:23:41.476400 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c
[0m15:23:41.480049 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c"
[0m15:23:41.481214 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c"
[0m15:23:41.482078 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c: BEGIN
[0m15:23:41.482931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:41.494397 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m15:23:41.495089 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c"
[0m15:23:41.495669 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select id_tempo as from_field
    from "transformacao_matricula"."staging_facts"."fato_matricula"
    where id_tempo is not null
),

parent as (
    select id_tempo as to_field
    from "transformacao_matricula"."staging_dimensions"."dim_tempo"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:23:41.528000 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.031 seconds
[0m15:23:41.530865 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c: ROLLBACK
[0m15:23:41.531874 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c: Close
[0m15:23:41.532920 [info ] [Thread-1 (]: 26 of 37 PASS relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_ .. [[32mPASS[0m in 0.07s]
[0m15:23:41.534001 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c
[0m15:23:41.534662 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a
[0m15:23:41.535355 [info ] [Thread-1 (]: 27 of 37 START test relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_  [RUN]
[0m15:23:41.536073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c, now test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a)
[0m15:23:41.536719 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a
[0m15:23:41.543601 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a"
[0m15:23:41.544553 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a
[0m15:23:41.547634 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a"
[0m15:23:41.548562 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a"
[0m15:23:41.549154 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a: BEGIN
[0m15:23:41.549681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:41.561865 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m15:23:41.562546 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a"
[0m15:23:41.563102 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select id_turma as from_field
    from "transformacao_matricula"."staging_facts"."fato_matricula"
    where id_turma is not null
),

parent as (
    select id_turma as to_field
    from "transformacao_matricula"."staging_dimensions"."dim_turma"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:23:41.595761 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.032 seconds
[0m15:23:41.597341 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a: ROLLBACK
[0m15:23:41.599221 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a: Close
[0m15:23:41.600654 [info ] [Thread-1 (]: 27 of 37 PASS relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_ .. [[32mPASS[0m in 0.06s]
[0m15:23:41.601626 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a
[0m15:23:41.602265 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400
[0m15:23:41.603059 [info ] [Thread-1 (]: 28 of 37 START test source_not_null_transformacao_matricula_staging_alunos_raw_ano  [RUN]
[0m15:23:41.603779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a, now test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400)
[0m15:23:41.604365 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400
[0m15:23:41.609762 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400"
[0m15:23:41.610763 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400
[0m15:23:41.613812 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400"
[0m15:23:41.614839 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400"
[0m15:23:41.615507 [debug] [Thread-1 (]: On test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400: BEGIN
[0m15:23:41.616117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:41.626399 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:23:41.627205 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400"
[0m15:23:41.627861 [debug] [Thread-1 (]: On test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ano
from "transformacao_matricula"."staging"."staging_alunos_raw"
where ano is null



  
  
      
    ) dbt_internal_test
[0m15:23:41.647122 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.019 seconds
[0m15:23:41.648851 [debug] [Thread-1 (]: On test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400: ROLLBACK
[0m15:23:41.649911 [debug] [Thread-1 (]: On test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400: Close
[0m15:23:41.650860 [info ] [Thread-1 (]: 28 of 37 PASS source_not_null_transformacao_matricula_staging_alunos_raw_ano ... [[32mPASS[0m in 0.05s]
[0m15:23:41.651651 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400
[0m15:23:41.652305 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd
[0m15:23:41.653066 [info ] [Thread-1 (]: 29 of 37 START test source_not_null_transformacao_matricula_staging_alunos_raw_matricula  [RUN]
[0m15:23:41.654002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400, now test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd)
[0m15:23:41.654763 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd
[0m15:23:41.662291 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd"
[0m15:23:41.663232 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd
[0m15:23:41.666389 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd"
[0m15:23:41.667354 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd"
[0m15:23:41.667976 [debug] [Thread-1 (]: On test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd: BEGIN
[0m15:23:41.668492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:41.678703 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:23:41.679382 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd"
[0m15:23:41.679945 [debug] [Thread-1 (]: On test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select matricula
from "transformacao_matricula"."staging"."staging_alunos_raw"
where matricula is null



  
  
      
    ) dbt_internal_test
[0m15:23:41.707470 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.027 seconds
[0m15:23:41.709408 [debug] [Thread-1 (]: On test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd: ROLLBACK
[0m15:23:41.710364 [debug] [Thread-1 (]: On test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd: Close
[0m15:23:41.711372 [info ] [Thread-1 (]: 29 of 37 PASS source_not_null_transformacao_matricula_staging_alunos_raw_matricula  [[32mPASS[0m in 0.06s]
[0m15:23:41.712328 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd
[0m15:23:41.712943 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74
[0m15:23:41.713545 [info ] [Thread-1 (]: 30 of 37 START test unique_dim_aluno_id_aluno .................................. [RUN]
[0m15:23:41.714299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd, now test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74)
[0m15:23:41.714927 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74
[0m15:23:41.720743 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74"
[0m15:23:41.721500 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74
[0m15:23:41.724530 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74"
[0m15:23:41.725473 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74"
[0m15:23:41.726032 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74: BEGIN
[0m15:23:41.726529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:41.736582 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:23:41.737255 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74"
[0m15:23:41.737796 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_aluno as unique_field,
    count(*) as n_records

from "transformacao_matricula"."staging_dimensions"."dim_aluno"
where id_aluno is not null
group by id_aluno
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:23:41.948579 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.210 seconds
[0m15:23:41.950001 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74: ROLLBACK
[0m15:23:41.950851 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74: Close
[0m15:23:41.951520 [info ] [Thread-1 (]: 30 of 37 PASS unique_dim_aluno_id_aluno ........................................ [[32mPASS[0m in 0.24s]
[0m15:23:41.952135 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74
[0m15:23:41.952544 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae
[0m15:23:41.952935 [info ] [Thread-1 (]: 31 of 37 START test unique_dim_escola_id_escola ................................ [RUN]
[0m15:23:41.953476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74, now test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae)
[0m15:23:41.953876 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae
[0m15:23:41.957464 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae"
[0m15:23:41.958136 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae
[0m15:23:41.960373 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae"
[0m15:23:41.961178 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae"
[0m15:23:41.961670 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae: BEGIN
[0m15:23:41.962187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:41.971228 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:23:41.971797 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae"
[0m15:23:41.972231 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_escola as unique_field,
    count(*) as n_records

from "transformacao_matricula"."staging_dimensions"."dim_escola"
where id_escola is not null
group by id_escola
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:23:41.974091 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:23:41.975572 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae: ROLLBACK
[0m15:23:41.976416 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae: Close
[0m15:23:41.977324 [info ] [Thread-1 (]: 31 of 37 PASS unique_dim_escola_id_escola ...................................... [[32mPASS[0m in 0.02s]
[0m15:23:41.978329 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae
[0m15:23:41.979046 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d
[0m15:23:41.979787 [info ] [Thread-1 (]: 32 of 37 START test unique_dim_localizacao_id_locali ........................... [RUN]
[0m15:23:41.981190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae, now test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d)
[0m15:23:41.982101 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d
[0m15:23:41.986972 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d"
[0m15:23:41.987859 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d
[0m15:23:41.990837 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d"
[0m15:23:41.991739 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d"
[0m15:23:41.992291 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d: BEGIN
[0m15:23:41.992802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:42.003064 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:23:42.003749 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d"
[0m15:23:42.004289 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_locali as unique_field,
    count(*) as n_records

from "transformacao_matricula"."staging_dimensions"."dim_localizacao"
where id_locali is not null
group by id_locali
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:23:42.006659 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:23:42.008655 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d: ROLLBACK
[0m15:23:42.009767 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d: Close
[0m15:23:42.010865 [info ] [Thread-1 (]: 32 of 37 PASS unique_dim_localizacao_id_locali ................................. [[32mPASS[0m in 0.03s]
[0m15:23:42.011703 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d
[0m15:23:42.012230 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3
[0m15:23:42.012832 [info ] [Thread-1 (]: 33 of 37 START test unique_dim_situacao_id_situacao ............................ [RUN]
[0m15:23:42.013502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d, now test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3)
[0m15:23:42.014281 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3
[0m15:23:42.018201 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3"
[0m15:23:42.018903 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3
[0m15:23:42.020977 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3"
[0m15:23:42.021650 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3"
[0m15:23:42.022071 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3: BEGIN
[0m15:23:42.022473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:42.032312 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:23:42.032988 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3"
[0m15:23:42.033541 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_situacao as unique_field,
    count(*) as n_records

from "transformacao_matricula"."staging_dimensions"."dim_situacao"
where id_situacao is not null
group by id_situacao
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:23:42.035469 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:23:42.037306 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3: ROLLBACK
[0m15:23:42.038208 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3: Close
[0m15:23:42.039202 [info ] [Thread-1 (]: 33 of 37 PASS unique_dim_situacao_id_situacao .................................. [[32mPASS[0m in 0.03s]
[0m15:23:42.040029 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3
[0m15:23:42.040598 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063
[0m15:23:42.041258 [info ] [Thread-1 (]: 34 of 37 START test unique_dim_tempo_id_tempo .................................. [RUN]
[0m15:23:42.041925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3, now test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063)
[0m15:23:42.042685 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063
[0m15:23:42.047422 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063"
[0m15:23:42.048336 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063
[0m15:23:42.053673 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063"
[0m15:23:42.054571 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063"
[0m15:23:42.055148 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063: BEGIN
[0m15:23:42.055665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:42.065970 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:23:42.066674 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063"
[0m15:23:42.067529 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_tempo as unique_field,
    count(*) as n_records

from "transformacao_matricula"."staging_dimensions"."dim_tempo"
where id_tempo is not null
group by id_tempo
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:23:42.069858 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:23:42.071628 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063: ROLLBACK
[0m15:23:42.072536 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063: Close
[0m15:23:42.073404 [info ] [Thread-1 (]: 34 of 37 PASS unique_dim_tempo_id_tempo ........................................ [[32mPASS[0m in 0.03s]
[0m15:23:42.074373 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063
[0m15:23:42.074907 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa
[0m15:23:42.075576 [info ] [Thread-1 (]: 35 of 37 START test unique_dim_turma_id_turma .................................. [RUN]
[0m15:23:42.076338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063, now test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa)
[0m15:23:42.076975 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa
[0m15:23:42.081455 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa"
[0m15:23:42.082350 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa
[0m15:23:42.085403 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa"
[0m15:23:42.086420 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa"
[0m15:23:42.086966 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa: BEGIN
[0m15:23:42.087463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:42.097444 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:23:42.098152 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa"
[0m15:23:42.098712 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_turma as unique_field,
    count(*) as n_records

from "transformacao_matricula"."staging_dimensions"."dim_turma"
where id_turma is not null
group by id_turma
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:23:42.100872 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:23:42.102886 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa: ROLLBACK
[0m15:23:42.103879 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa: Close
[0m15:23:42.108365 [info ] [Thread-1 (]: 35 of 37 PASS unique_dim_turma_id_turma ........................................ [[32mPASS[0m in 0.03s]
[0m15:23:42.109286 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa
[0m15:23:42.109869 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.unique_fato_matricula_matricula.484f264991
[0m15:23:42.110495 [info ] [Thread-1 (]: 36 of 37 START test unique_fato_matricula_matricula ............................ [RUN]
[0m15:23:42.111153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa, now test.transformacao_matricula.unique_fato_matricula_matricula.484f264991)
[0m15:23:42.111713 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.unique_fato_matricula_matricula.484f264991
[0m15:23:42.116563 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.unique_fato_matricula_matricula.484f264991"
[0m15:23:42.117435 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.unique_fato_matricula_matricula.484f264991
[0m15:23:42.120429 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.unique_fato_matricula_matricula.484f264991"
[0m15:23:42.121332 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_fato_matricula_matricula.484f264991"
[0m15:23:42.121893 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_fato_matricula_matricula.484f264991: BEGIN
[0m15:23:42.122395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:42.133618 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m15:23:42.134256 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_fato_matricula_matricula.484f264991"
[0m15:23:42.134773 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_fato_matricula_matricula.484f264991: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.unique_fato_matricula_matricula.484f264991"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    matricula as unique_field,
    count(*) as n_records

from "transformacao_matricula"."staging_facts"."fato_matricula"
where matricula is not null
group by matricula
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:23:42.288862 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.153 seconds
[0m15:23:42.290640 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_fato_matricula_matricula.484f264991: ROLLBACK
[0m15:23:42.291435 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_fato_matricula_matricula.484f264991: Close
[0m15:23:42.292185 [error] [Thread-1 (]: 36 of 37 FAIL 102118 unique_fato_matricula_matricula ........................... [[31mFAIL 102118[0m in 0.18s]
[0m15:23:42.292865 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.unique_fato_matricula_matricula.484f264991
[0m15:23:42.293385 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05
[0m15:23:42.293958 [info ] [Thread-1 (]: 37 of 37 START test unique_transform_data_matricula ............................ [RUN]
[0m15:23:42.294499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.unique_fato_matricula_matricula.484f264991, now test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05)
[0m15:23:42.295084 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05
[0m15:23:42.298730 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05"
[0m15:23:42.299493 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05
[0m15:23:42.301911 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05"
[0m15:23:42.302761 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05"
[0m15:23:42.303324 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05: BEGIN
[0m15:23:42.303809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:42.315132 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m15:23:42.315840 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05"
[0m15:23:42.316433 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    matricula as unique_field,
    count(*) as n_records

from "transformacao_matricula"."staging_intermediate"."transform_data"
where matricula is not null
group by matricula
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:23:42.475187 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.158 seconds
[0m15:23:42.477110 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05: ROLLBACK
[0m15:23:42.478185 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05: Close
[0m15:23:42.479077 [error] [Thread-1 (]: 37 of 37 FAIL 102118 unique_transform_data_matricula ........................... [[31mFAIL 102118[0m in 0.18s]
[0m15:23:42.479869 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05
[0m15:23:42.481565 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:42.482020 [debug] [MainThread]: On master: BEGIN
[0m15:23:42.482344 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:23:42.492038 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m15:23:42.492685 [debug] [MainThread]: On master: COMMIT
[0m15:23:42.493173 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:42.493658 [debug] [MainThread]: On master: COMMIT
[0m15:23:42.494450 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:23:42.495019 [debug] [MainThread]: On master: Close
[0m15:23:42.495829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:42.496329 [debug] [MainThread]: Connection 'test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05' was properly closed.
[0m15:23:42.496876 [info ] [MainThread]: 
[0m15:23:42.497464 [info ] [MainThread]: Finished running 37 data tests in 0 hours 0 minutes and 2.54 seconds (2.54s).
[0m15:23:42.504348 [debug] [MainThread]: Command end result
[0m15:23:42.538176 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m15:23:42.541028 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m15:23:42.549790 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m15:23:42.550344 [info ] [MainThread]: 
[0m15:23:42.550885 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m15:23:42.551408 [info ] [MainThread]: 
[0m15:23:42.552024 [error] [MainThread]: [31mFailure in test unique_fato_matricula_matricula (transformacao_aprovados/models/staging/schema.yml)[0m
[0m15:23:42.552848 [error] [MainThread]:   Got 102118 results, configured to fail if != 0
[0m15:23:42.553409 [info ] [MainThread]: 
[0m15:23:42.554013 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_fato_matricula_matricula.sql
[0m15:23:42.554514 [info ] [MainThread]: 
[0m15:23:42.555075 [error] [MainThread]: [31mFailure in test unique_transform_data_matricula (transformacao_aprovados/models/staging/schema.yml)[0m
[0m15:23:42.555667 [error] [MainThread]:   Got 102118 results, configured to fail if != 0
[0m15:23:42.556194 [info ] [MainThread]: 
[0m15:23:42.556813 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_transform_data_matricula.sql
[0m15:23:42.557398 [info ] [MainThread]: 
[0m15:23:42.557965 [info ] [MainThread]: Done. PASS=35 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=37
[0m15:23:42.559266 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 3.1943014, "process_in_blocks": "1128", "process_kernel_time": 0.390677, "process_mem_max_rss": "124676", "process_out_blocks": "3424", "process_user_time": 2.642815}
[0m15:23:42.559958 [debug] [MainThread]: Command `dbt test` failed at 15:23:42.559853 after 3.20 seconds
[0m15:23:42.560514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edf391f0440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edf36fb33e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edf38ccffe0>]}
[0m15:23:42.561062 [debug] [MainThread]: Flushing usage events
[0m15:23:43.751330 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:25:07.008122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e8c0790d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e8b78cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e8b78fbf0>]}


============================== 15:25:07.011212 | 95bc50e7-43d4-463f-ae97-985e704a4e81 ==============================
[0m15:25:07.011212 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:25:07.011787 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'warn_error': 'None', 'write_json': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/home/murilo/.dbt', 'log_format': 'default', 'log_cache_events': 'False', 'version_check': 'True', 'no_print': 'None', 'printer_width': '80', 'debug': 'False', 'target_path': 'None', 'introspect': 'True', 'static_parser': 'True', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt test', 'use_colors': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True'}
[0m15:25:07.163636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95bc50e7-43d4-463f-ae97-985e704a4e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e8acb2f90>]}
[0m15:25:07.223907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95bc50e7-43d4-463f-ae97-985e704a4e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e8b78cfb0>]}
[0m15:25:07.224851 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:25:07.352250 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:25:07.449444 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:25:07.450012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '95bc50e7-43d4-463f-ae97-985e704a4e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e8b757800>]}
[0m15:25:08.411898 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m15:25:08.412462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '95bc50e7-43d4-463f-ae97-985e704a4e81', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e8b939d00>]}
[0m15:25:08.660963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95bc50e7-43d4-463f-ae97-985e704a4e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e891f69f0>]}
[0m15:25:08.734813 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m15:25:08.736940 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m15:25:08.759299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95bc50e7-43d4-463f-ae97-985e704a4e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e895fa990>]}
[0m15:25:08.759908 [info ] [MainThread]: Found 13 models, 37 data tests, 1 source, 459 macros
[0m15:25:08.760388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95bc50e7-43d4-463f-ae97-985e704a4e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e891ca5d0>]}
[0m15:25:08.763690 [info ] [MainThread]: 
[0m15:25:08.764170 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m15:25:08.764540 [info ] [MainThread]: 
[0m15:25:08.765153 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:25:08.769672 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula_staging_marts'
[0m15:25:08.811596 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m15:25:08.812185 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: BEGIN
[0m15:25:08.812624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:08.826361 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m15:25:08.827190 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m15:25:08.827913 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_marts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m15:25:08.831351 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m15:25:08.833395 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: ROLLBACK
[0m15:25:08.834790 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: Close
[0m15:25:08.836309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_marts, now list_transformacao_matricula_staging_staging)
[0m15:25:08.841629 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m15:25:08.843878 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: BEGIN
[0m15:25:08.844415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:08.855177 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m15:25:08.856106 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m15:25:08.856716 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_staging"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m15:25:08.860585 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m15:25:08.862387 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: ROLLBACK
[0m15:25:08.863589 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: Close
[0m15:25:08.864661 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_staging, now list_transformacao_matricula_staging_dimensions)
[0m15:25:08.867272 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_dimensions"
[0m15:25:08.867866 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: BEGIN
[0m15:25:08.868309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:08.877790 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:25:08.878357 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_dimensions"
[0m15:25:08.878760 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_dimensions"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dimensions'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dimensions'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dimensions'
  
[0m15:25:08.882098 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m15:25:08.884361 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: ROLLBACK
[0m15:25:08.885297 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: Close
[0m15:25:08.886075 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_dimensions, now list_transformacao_matricula_staging_intermediate)
[0m15:25:08.889448 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_intermediate"
[0m15:25:08.889931 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: BEGIN
[0m15:25:08.890255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:08.899358 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:25:08.900000 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_intermediate"
[0m15:25:08.900458 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_intermediate"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_intermediate'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_intermediate'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_intermediate'
  
[0m15:25:08.903741 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m15:25:08.905172 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: ROLLBACK
[0m15:25:08.906045 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: Close
[0m15:25:08.906771 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_intermediate, now list_transformacao_matricula_staging_facts)
[0m15:25:08.908986 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_facts"
[0m15:25:08.909593 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: BEGIN
[0m15:25:08.909995 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:08.918526 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m15:25:08.919042 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_facts"
[0m15:25:08.919397 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_facts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_facts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_facts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_facts'
  
[0m15:25:08.922353 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m15:25:08.923960 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: ROLLBACK
[0m15:25:08.924755 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: Close
[0m15:25:08.929134 [debug] [MainThread]: Using postgres connection "master"
[0m15:25:08.929591 [debug] [MainThread]: On master: BEGIN
[0m15:25:08.929911 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:25:08.937685 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:25:08.938178 [debug] [MainThread]: Using postgres connection "master"
[0m15:25:08.938548 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:25:08.942109 [debug] [MainThread]: SQL status: SELECT 19 in 0.003 seconds
[0m15:25:08.945914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95bc50e7-43d4-463f-ae97-985e704a4e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e89dc03b0>]}
[0m15:25:08.946402 [debug] [MainThread]: On master: ROLLBACK
[0m15:25:08.947189 [debug] [MainThread]: Using postgres connection "master"
[0m15:25:08.947570 [debug] [MainThread]: On master: BEGIN
[0m15:25:08.948458 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:25:08.948873 [debug] [MainThread]: On master: COMMIT
[0m15:25:08.949227 [debug] [MainThread]: Using postgres connection "master"
[0m15:25:08.949557 [debug] [MainThread]: On master: COMMIT
[0m15:25:08.950194 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:25:08.950559 [debug] [MainThread]: On master: Close
[0m15:25:08.953881 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f
[0m15:25:08.954506 [info ] [Thread-1 (]: 1 of 37 START test not_null_dim_aluno_id_aluno ................................. [RUN]
[0m15:25:08.955001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_facts, now test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f)
[0m15:25:08.955374 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f
[0m15:25:08.966598 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f"
[0m15:25:08.967414 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f
[0m15:25:08.988725 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f"
[0m15:25:08.989771 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f"
[0m15:25:08.990358 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f: BEGIN
[0m15:25:08.990894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:08.999740 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:25:09.000292 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f"
[0m15:25:09.001152 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_aluno
from "transformacao_matricula"."staging_dimensions"."dim_aluno"
where id_aluno is null



  
  
      
    ) dbt_internal_test
[0m15:25:09.015124 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m15:25:09.018941 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f: ROLLBACK
[0m15:25:09.019811 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f: Close
[0m15:25:09.020651 [info ] [Thread-1 (]: 1 of 37 PASS not_null_dim_aluno_id_aluno ....................................... [[32mPASS[0m in 0.07s]
[0m15:25:09.021381 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f
[0m15:25:09.021879 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432
[0m15:25:09.022285 [info ] [Thread-1 (]: 2 of 37 START test not_null_dim_aluno_matricula ................................ [RUN]
[0m15:25:09.022843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f, now test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432)
[0m15:25:09.023425 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432
[0m15:25:09.027222 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432"
[0m15:25:09.027970 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432
[0m15:25:09.030104 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432"
[0m15:25:09.030835 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432"
[0m15:25:09.031227 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432: BEGIN
[0m15:25:09.031599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:09.040891 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:25:09.041512 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432"
[0m15:25:09.042337 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select matricula
from "transformacao_matricula"."staging_dimensions"."dim_aluno"
where matricula is null



  
  
      
    ) dbt_internal_test
[0m15:25:09.061902 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.019 seconds
[0m15:25:09.063975 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432: ROLLBACK
[0m15:25:09.065120 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432: Close
[0m15:25:09.066315 [info ] [Thread-1 (]: 2 of 37 PASS not_null_dim_aluno_matricula ...................................... [[32mPASS[0m in 0.04s]
[0m15:25:09.067489 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432
[0m15:25:09.068282 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0
[0m15:25:09.069098 [info ] [Thread-1 (]: 3 of 37 START test not_null_dim_escola_codigo_escola ........................... [RUN]
[0m15:25:09.069824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432, now test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0)
[0m15:25:09.070443 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0
[0m15:25:09.077337 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0"
[0m15:25:09.078196 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0
[0m15:25:09.081130 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0"
[0m15:25:09.082064 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0"
[0m15:25:09.082628 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0: BEGIN
[0m15:25:09.083095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:09.093537 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:25:09.094227 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0"
[0m15:25:09.094849 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select codigo_escola
from "transformacao_matricula"."staging_dimensions"."dim_escola"
where codigo_escola is null



  
  
      
    ) dbt_internal_test
[0m15:25:09.096543 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:25:09.098466 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0: ROLLBACK
[0m15:25:09.099384 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0: Close
[0m15:25:09.100451 [info ] [Thread-1 (]: 3 of 37 PASS not_null_dim_escola_codigo_escola ................................. [[32mPASS[0m in 0.03s]
[0m15:25:09.101421 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0
[0m15:25:09.102116 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651
[0m15:25:09.102812 [info ] [Thread-1 (]: 4 of 37 START test not_null_dim_escola_id_escola ............................... [RUN]
[0m15:25:09.103775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0, now test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651)
[0m15:25:09.104380 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651
[0m15:25:09.109193 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651"
[0m15:25:09.110118 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651
[0m15:25:09.113101 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651"
[0m15:25:09.114030 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651"
[0m15:25:09.114578 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651: BEGIN
[0m15:25:09.115075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:09.123782 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:25:09.124323 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651"
[0m15:25:09.124716 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_escola
from "transformacao_matricula"."staging_dimensions"."dim_escola"
where id_escola is null



  
  
      
    ) dbt_internal_test
[0m15:25:09.126775 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:25:09.128266 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651: ROLLBACK
[0m15:25:09.129259 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651: Close
[0m15:25:09.130171 [info ] [Thread-1 (]: 4 of 37 PASS not_null_dim_escola_id_escola ..................................... [[32mPASS[0m in 0.03s]
[0m15:25:09.130874 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651
[0m15:25:09.131314 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6
[0m15:25:09.131867 [info ] [Thread-1 (]: 5 of 37 START test not_null_dim_localizacao_id_locali .......................... [RUN]
[0m15:25:09.132398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651, now test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6)
[0m15:25:09.132882 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6
[0m15:25:09.136255 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6"
[0m15:25:09.137084 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6
[0m15:25:09.139172 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6"
[0m15:25:09.139891 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6"
[0m15:25:09.140281 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6: BEGIN
[0m15:25:09.140649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:09.149457 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:25:09.150002 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6"
[0m15:25:09.150378 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_locali
from "transformacao_matricula"."staging_dimensions"."dim_localizacao"
where id_locali is null



  
  
      
    ) dbt_internal_test
[0m15:25:09.152040 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:25:09.153810 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6: ROLLBACK
[0m15:25:09.154946 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6: Close
[0m15:25:09.156127 [info ] [Thread-1 (]: 5 of 37 PASS not_null_dim_localizacao_id_locali ................................ [[32mPASS[0m in 0.02s]
[0m15:25:09.157248 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6
[0m15:25:09.157988 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0
[0m15:25:09.158817 [info ] [Thread-1 (]: 6 of 37 START test not_null_dim_situacao_id_situacao ........................... [RUN]
[0m15:25:09.159626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6, now test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0)
[0m15:25:09.160125 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0
[0m15:25:09.164299 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0"
[0m15:25:09.165152 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0
[0m15:25:09.167531 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0"
[0m15:25:09.168378 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0"
[0m15:25:09.168890 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0: BEGIN
[0m15:25:09.169292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:09.178992 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:25:09.179508 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0"
[0m15:25:09.180354 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_situacao
from "transformacao_matricula"."staging_dimensions"."dim_situacao"
where id_situacao is null



  
  
      
    ) dbt_internal_test
[0m15:25:09.182116 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:25:09.183518 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0: ROLLBACK
[0m15:25:09.184354 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0: Close
[0m15:25:09.185071 [info ] [Thread-1 (]: 6 of 37 PASS not_null_dim_situacao_id_situacao ................................. [[32mPASS[0m in 0.03s]
[0m15:25:09.185757 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0
[0m15:25:09.186211 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82
[0m15:25:09.186640 [info ] [Thread-1 (]: 7 of 37 START test not_null_dim_situacao_situacao_nome ......................... [RUN]
[0m15:25:09.187283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0, now test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82)
[0m15:25:09.187862 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82
[0m15:25:09.192042 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82"
[0m15:25:09.192822 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82
[0m15:25:09.195024 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82"
[0m15:25:09.195823 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82"
[0m15:25:09.196218 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82: BEGIN
[0m15:25:09.196564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:09.206068 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:25:09.206906 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82"
[0m15:25:09.207291 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select situacao_nome
from "transformacao_matricula"."staging_dimensions"."dim_situacao"
where situacao_nome is null



  
  
      
    ) dbt_internal_test
[0m15:25:09.208640 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:25:09.210053 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82: ROLLBACK
[0m15:25:09.211123 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82: Close
[0m15:25:09.212002 [info ] [Thread-1 (]: 7 of 37 PASS not_null_dim_situacao_situacao_nome ............................... [[32mPASS[0m in 0.02s]
[0m15:25:09.212638 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82
[0m15:25:09.213095 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6
[0m15:25:09.213655 [info ] [Thread-1 (]: 8 of 37 START test not_null_dim_tempo_ano ...................................... [RUN]
[0m15:25:09.214192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82, now test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6)
[0m15:25:09.214620 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6
[0m15:25:09.218162 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6"
[0m15:25:09.218939 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6
[0m15:25:09.222597 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6"
[0m15:25:09.223504 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6"
[0m15:25:09.223958 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6: BEGIN
[0m15:25:09.224329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:09.234040 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:25:09.234771 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6"
[0m15:25:09.235338 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ano
from "transformacao_matricula"."staging_dimensions"."dim_tempo"
where ano is null



  
  
      
    ) dbt_internal_test
[0m15:25:09.237355 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:25:09.239069 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6: ROLLBACK
[0m15:25:09.239913 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6: Close
[0m15:25:09.240846 [info ] [Thread-1 (]: 8 of 37 PASS not_null_dim_tempo_ano ............................................ [[32mPASS[0m in 0.03s]
[0m15:25:09.241858 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6
[0m15:25:09.242513 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3
[0m15:25:09.243274 [info ] [Thread-1 (]: 9 of 37 START test not_null_dim_tempo_id_tempo ................................. [RUN]
[0m15:25:09.244343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6, now test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3)
[0m15:25:09.244921 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3
[0m15:25:09.249223 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3"
[0m15:25:09.250239 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3
[0m15:25:09.253187 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3"
[0m15:25:09.254096 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3"
[0m15:25:09.254623 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3: BEGIN
[0m15:25:09.255068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:09.264004 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:25:09.264573 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3"
[0m15:25:09.264969 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_tempo
from "transformacao_matricula"."staging_dimensions"."dim_tempo"
where id_tempo is null



  
  
      
    ) dbt_internal_test
[0m15:25:09.266382 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:25:09.267833 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3: ROLLBACK
[0m15:25:09.268814 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3: Close
[0m15:25:09.269686 [info ] [Thread-1 (]: 9 of 37 PASS not_null_dim_tempo_id_tempo ....................................... [[32mPASS[0m in 0.03s]
[0m15:25:09.270449 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3
[0m15:25:09.270952 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20
[0m15:25:09.271701 [info ] [Thread-1 (]: 10 of 37 START test not_null_dim_turma_id_turma ................................ [RUN]
[0m15:25:09.272519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3, now test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20)
[0m15:25:09.273040 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20
[0m15:25:09.276982 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20"
[0m15:25:09.277720 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20
[0m15:25:09.279775 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20"
[0m15:25:09.280442 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20"
[0m15:25:09.280848 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20: BEGIN
[0m15:25:09.281194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:09.291635 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:25:09.292383 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20"
[0m15:25:09.292991 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_turma
from "transformacao_matricula"."staging_dimensions"."dim_turma"
where id_turma is null



  
  
      
    ) dbt_internal_test
[0m15:25:09.294687 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:25:09.296562 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20: ROLLBACK
[0m15:25:09.297514 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20: Close
[0m15:25:09.298641 [info ] [Thread-1 (]: 10 of 37 PASS not_null_dim_turma_id_turma ...................................... [[32mPASS[0m in 0.03s]
[0m15:25:09.299561 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20
[0m15:25:09.300226 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164
[0m15:25:09.300946 [info ] [Thread-1 (]: 11 of 37 START test not_null_fato_matricula_id_aluno ........................... [RUN]
[0m15:25:09.302305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20, now test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164)
[0m15:25:09.303022 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164
[0m15:25:09.308530 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164"
[0m15:25:09.309485 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164
[0m15:25:09.312656 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164"
[0m15:25:09.313483 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164"
[0m15:25:09.313930 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164: BEGIN
[0m15:25:09.314296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:09.323369 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:25:09.324233 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164"
[0m15:25:09.324993 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_aluno
from "transformacao_matricula"."staging_facts"."fato_matricula"
where id_aluno is null



  
  
      
    ) dbt_internal_test
[0m15:25:09.343322 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.018 seconds
[0m15:25:09.344993 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164: ROLLBACK
[0m15:25:09.345895 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164: Close
[0m15:25:09.346789 [info ] [Thread-1 (]: 11 of 37 PASS not_null_fato_matricula_id_aluno ................................. [[32mPASS[0m in 0.04s]
[0m15:25:09.347798 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164
[0m15:25:09.348487 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66
[0m15:25:09.349237 [info ] [Thread-1 (]: 12 of 37 START test not_null_fato_matricula_id_escola .......................... [RUN]
[0m15:25:09.349990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164, now test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66)
[0m15:25:09.350643 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66
[0m15:25:09.355757 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66"
[0m15:25:09.356519 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66
[0m15:25:09.358754 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66"
[0m15:25:09.359480 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66"
[0m15:25:09.359906 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66: BEGIN
[0m15:25:09.360260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:09.369602 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:25:09.370456 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66"
[0m15:25:09.371019 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_escola
from "transformacao_matricula"."staging_facts"."fato_matricula"
where id_escola is null



  
  
      
    ) dbt_internal_test
[0m15:25:09.396889 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.025 seconds
[0m15:25:09.398883 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66: ROLLBACK
[0m15:25:09.399830 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66: Close
[0m15:25:09.400877 [info ] [Thread-1 (]: 12 of 37 PASS not_null_fato_matricula_id_escola ................................ [[32mPASS[0m in 0.05s]
[0m15:25:09.401756 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66
[0m15:25:09.402405 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e
[0m15:25:09.403086 [info ] [Thread-1 (]: 13 of 37 START test not_null_fato_matricula_id_locali .......................... [RUN]
[0m15:25:09.403782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66, now test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e)
[0m15:25:09.404371 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e
[0m15:25:09.409525 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e"
[0m15:25:09.410502 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e
[0m15:25:09.413404 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e"
[0m15:25:09.414434 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e"
[0m15:25:09.415124 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e: BEGIN
[0m15:25:09.415716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:09.425994 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:25:09.426676 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e"
[0m15:25:09.427191 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_locali
from "transformacao_matricula"."staging_facts"."fato_matricula"
where id_locali is null



  
  
      
    ) dbt_internal_test
[0m15:25:09.446889 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.019 seconds
[0m15:25:09.448903 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e: ROLLBACK
[0m15:25:09.449971 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e: Close
[0m15:25:09.450967 [info ] [Thread-1 (]: 13 of 37 PASS not_null_fato_matricula_id_locali ................................ [[32mPASS[0m in 0.05s]
[0m15:25:09.451870 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e
[0m15:25:09.452775 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86
[0m15:25:09.453600 [info ] [Thread-1 (]: 14 of 37 START test not_null_fato_matricula_id_situacao ........................ [RUN]
[0m15:25:09.454601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e, now test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86)
[0m15:25:09.455269 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86
[0m15:25:09.463081 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86"
[0m15:25:09.464316 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86
[0m15:25:09.557718 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86"
[0m15:25:09.558806 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86"
[0m15:25:09.559469 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86: BEGIN
[0m15:25:09.560007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:09.570448 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:25:09.571368 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86"
[0m15:25:09.572028 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_situacao
from "transformacao_matricula"."staging_facts"."fato_matricula"
where id_situacao is null



  
  
      
    ) dbt_internal_test
[0m15:25:09.590000 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m15:25:09.591789 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86: ROLLBACK
[0m15:25:09.592713 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86: Close
[0m15:25:09.593476 [info ] [Thread-1 (]: 14 of 37 PASS not_null_fato_matricula_id_situacao .............................. [[32mPASS[0m in 0.14s]
[0m15:25:09.594164 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86
[0m15:25:09.594701 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3
[0m15:25:09.595264 [info ] [Thread-1 (]: 15 of 37 START test not_null_fato_matricula_id_tempo ........................... [RUN]
[0m15:25:09.595889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86, now test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3)
[0m15:25:09.596427 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3
[0m15:25:09.600567 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3"
[0m15:25:09.601389 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3
[0m15:25:09.603692 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3"
[0m15:25:09.604529 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3"
[0m15:25:09.605101 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3: BEGIN
[0m15:25:09.605521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:09.614657 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:25:09.615225 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3"
[0m15:25:09.615829 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_tempo
from "transformacao_matricula"."staging_facts"."fato_matricula"
where id_tempo is null



  
  
      
    ) dbt_internal_test
[0m15:25:09.631663 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.015 seconds
[0m15:25:09.633673 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3: ROLLBACK
[0m15:25:09.634585 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3: Close
[0m15:25:09.635718 [info ] [Thread-1 (]: 15 of 37 PASS not_null_fato_matricula_id_tempo ................................. [[32mPASS[0m in 0.04s]
[0m15:25:09.636587 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3
[0m15:25:09.637187 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0
[0m15:25:09.637860 [info ] [Thread-1 (]: 16 of 37 START test not_null_fato_matricula_id_turma ........................... [RUN]
[0m15:25:09.638538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3, now test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0)
[0m15:25:09.639046 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0
[0m15:25:09.643240 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0"
[0m15:25:09.644243 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0
[0m15:25:09.647590 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0"
[0m15:25:09.648667 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0"
[0m15:25:09.649247 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0: BEGIN
[0m15:25:09.649760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:09.660180 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:25:09.660915 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0"
[0m15:25:09.661490 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_turma
from "transformacao_matricula"."staging_facts"."fato_matricula"
where id_turma is null



  
  
      
    ) dbt_internal_test
[0m15:25:09.681305 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.019 seconds
[0m15:25:09.683470 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0: ROLLBACK
[0m15:25:09.684756 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0: Close
[0m15:25:09.686167 [info ] [Thread-1 (]: 16 of 37 PASS not_null_fato_matricula_id_turma ................................. [[32mPASS[0m in 0.05s]
[0m15:25:09.687123 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0
[0m15:25:09.687769 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439
[0m15:25:09.688432 [info ] [Thread-1 (]: 17 of 37 START test not_null_fato_matricula_matricula .......................... [RUN]
[0m15:25:09.689289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0, now test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439)
[0m15:25:09.689983 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439
[0m15:25:09.694204 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439"
[0m15:25:09.695099 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439
[0m15:25:09.697775 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439"
[0m15:25:09.698917 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439"
[0m15:25:09.699863 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439: BEGIN
[0m15:25:09.700586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:09.713790 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m15:25:09.714745 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439"
[0m15:25:09.715414 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select matricula
from "transformacao_matricula"."staging_facts"."fato_matricula"
where matricula is null



  
  
      
    ) dbt_internal_test
[0m15:25:09.736593 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.020 seconds
[0m15:25:09.738645 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439: ROLLBACK
[0m15:25:09.739674 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439: Close
[0m15:25:09.740860 [info ] [Thread-1 (]: 17 of 37 PASS not_null_fato_matricula_matricula ................................ [[32mPASS[0m in 0.05s]
[0m15:25:09.741932 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439
[0m15:25:09.742691 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf
[0m15:25:09.743444 [info ] [Thread-1 (]: 18 of 37 START test not_null_staging_situacao_alunos_ano ....................... [RUN]
[0m15:25:09.744403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439, now test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf)
[0m15:25:09.745128 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf
[0m15:25:09.750749 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf"
[0m15:25:09.751828 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf
[0m15:25:09.755286 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf"
[0m15:25:09.756448 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf"
[0m15:25:09.756940 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf: BEGIN
[0m15:25:09.757308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:09.765424 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:25:09.766049 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf"
[0m15:25:09.766708 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ano
from "transformacao_matricula"."staging_staging"."staging_situacao_alunos"
where ano is null



  
  
      
    ) dbt_internal_test
[0m15:25:09.789079 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.022 seconds
[0m15:25:09.791070 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf: ROLLBACK
[0m15:25:09.792080 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf: Close
[0m15:25:09.793115 [info ] [Thread-1 (]: 18 of 37 PASS not_null_staging_situacao_alunos_ano ............................. [[32mPASS[0m in 0.05s]
[0m15:25:09.794147 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf
[0m15:25:09.794885 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d
[0m15:25:09.795626 [info ] [Thread-1 (]: 19 of 37 START test not_null_staging_situacao_alunos_matricula ................. [RUN]
[0m15:25:09.796433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf, now test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d)
[0m15:25:09.797055 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d
[0m15:25:09.802618 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d"
[0m15:25:09.803948 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d
[0m15:25:09.809067 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d"
[0m15:25:09.810269 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d"
[0m15:25:09.810990 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d: BEGIN
[0m15:25:09.811548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:09.820669 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:25:09.821277 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d"
[0m15:25:09.821670 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select matricula
from "transformacao_matricula"."staging_staging"."staging_situacao_alunos"
where matricula is null



  
  
      
    ) dbt_internal_test
[0m15:25:09.839324 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m15:25:09.840910 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d: ROLLBACK
[0m15:25:09.841761 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d: Close
[0m15:25:09.842992 [info ] [Thread-1 (]: 19 of 37 PASS not_null_staging_situacao_alunos_matricula ....................... [[32mPASS[0m in 0.05s]
[0m15:25:09.844221 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d
[0m15:25:09.844775 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_transform_data_ano.10ed340507
[0m15:25:09.845318 [info ] [Thread-1 (]: 20 of 37 START test not_null_transform_data_ano ................................ [RUN]
[0m15:25:09.845916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d, now test.transformacao_matricula.not_null_transform_data_ano.10ed340507)
[0m15:25:09.846377 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_transform_data_ano.10ed340507
[0m15:25:09.854004 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_transform_data_ano.10ed340507"
[0m15:25:09.855049 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_transform_data_ano.10ed340507
[0m15:25:09.859525 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_transform_data_ano.10ed340507"
[0m15:25:09.860861 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_transform_data_ano.10ed340507"
[0m15:25:09.861575 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_transform_data_ano.10ed340507: BEGIN
[0m15:25:09.862301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:09.875068 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m15:25:09.875898 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_transform_data_ano.10ed340507"
[0m15:25:09.876653 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_transform_data_ano.10ed340507: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_transform_data_ano.10ed340507"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ano
from "transformacao_matricula"."staging_intermediate"."transform_data"
where ano is null



  
  
      
    ) dbt_internal_test
[0m15:25:09.902179 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.025 seconds
[0m15:25:09.904735 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_transform_data_ano.10ed340507: ROLLBACK
[0m15:25:09.908241 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_transform_data_ano.10ed340507: Close
[0m15:25:09.912179 [info ] [Thread-1 (]: 20 of 37 PASS not_null_transform_data_ano ...................................... [[32mPASS[0m in 0.07s]
[0m15:25:09.913310 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_transform_data_ano.10ed340507
[0m15:25:09.917573 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8
[0m15:25:09.918471 [info ] [Thread-1 (]: 21 of 37 START test not_null_transform_data_matricula .......................... [RUN]
[0m15:25:09.919746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_transform_data_ano.10ed340507, now test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8)
[0m15:25:09.920544 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8
[0m15:25:09.926497 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8"
[0m15:25:09.927569 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8
[0m15:25:09.931008 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8"
[0m15:25:09.932415 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8"
[0m15:25:09.933085 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8: BEGIN
[0m15:25:09.933478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:09.942484 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:25:09.943103 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8"
[0m15:25:09.943950 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select matricula
from "transformacao_matricula"."staging_intermediate"."transform_data"
where matricula is null



  
  
      
    ) dbt_internal_test
[0m15:25:09.969647 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.025 seconds
[0m15:25:09.971789 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8: ROLLBACK
[0m15:25:09.972833 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8: Close
[0m15:25:09.973956 [info ] [Thread-1 (]: 21 of 37 PASS not_null_transform_data_matricula ................................ [[32mPASS[0m in 0.05s]
[0m15:25:09.975331 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8
[0m15:25:09.976152 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee
[0m15:25:09.977009 [info ] [Thread-1 (]: 22 of 37 START test relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_  [RUN]
[0m15:25:09.978836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8, now test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee)
[0m15:25:09.979447 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee
[0m15:25:09.985177 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee"
[0m15:25:09.986235 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee
[0m15:25:09.989382 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee"
[0m15:25:09.990386 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee"
[0m15:25:09.991191 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee: BEGIN
[0m15:25:09.991826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:10.002617 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m15:25:10.004050 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee"
[0m15:25:10.004751 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select id_aluno as from_field
    from "transformacao_matricula"."staging_facts"."fato_matricula"
    where id_aluno is not null
),

parent as (
    select id_aluno as to_field
    from "transformacao_matricula"."staging_dimensions"."dim_aluno"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:25:10.104994 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.099 seconds
[0m15:25:10.106931 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee: ROLLBACK
[0m15:25:10.107990 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee: Close
[0m15:25:10.108910 [info ] [Thread-1 (]: 22 of 37 PASS relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_ .. [[32mPASS[0m in 0.13s]
[0m15:25:10.109731 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee
[0m15:25:10.110310 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb
[0m15:25:10.110966 [info ] [Thread-1 (]: 23 of 37 START test relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_  [RUN]
[0m15:25:10.111839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee, now test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb)
[0m15:25:10.112506 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb
[0m15:25:10.119062 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb"
[0m15:25:10.120103 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb
[0m15:25:10.123205 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb"
[0m15:25:10.124187 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb"
[0m15:25:10.124783 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb: BEGIN
[0m15:25:10.125310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:10.136157 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m15:25:10.136754 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb"
[0m15:25:10.137201 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select id_escola as from_field
    from "transformacao_matricula"."staging_facts"."fato_matricula"
    where id_escola is not null
),

parent as (
    select id_escola as to_field
    from "transformacao_matricula"."staging_dimensions"."dim_escola"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:25:10.167000 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.029 seconds
[0m15:25:10.168958 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb: ROLLBACK
[0m15:25:10.169926 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb: Close
[0m15:25:10.176129 [info ] [Thread-1 (]: 23 of 37 PASS relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_  [[32mPASS[0m in 0.06s]
[0m15:25:10.177098 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb
[0m15:25:10.177748 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a
[0m15:25:10.178411 [info ] [Thread-1 (]: 24 of 37 START test relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_  [RUN]
[0m15:25:10.179213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb, now test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a)
[0m15:25:10.179810 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a
[0m15:25:10.186330 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a"
[0m15:25:10.187313 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a
[0m15:25:10.190313 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a"
[0m15:25:10.191536 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a"
[0m15:25:10.192186 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a: BEGIN
[0m15:25:10.192791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:10.207162 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m15:25:10.207847 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a"
[0m15:25:10.208416 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select id_locali as from_field
    from "transformacao_matricula"."staging_facts"."fato_matricula"
    where id_locali is not null
),

parent as (
    select id_locali as to_field
    from "transformacao_matricula"."staging_dimensions"."dim_localizacao"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:25:10.243721 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.035 seconds
[0m15:25:10.245333 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a: ROLLBACK
[0m15:25:10.246701 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a: Close
[0m15:25:10.247670 [info ] [Thread-1 (]: 24 of 37 PASS relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_  [[32mPASS[0m in 0.07s]
[0m15:25:10.248310 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a
[0m15:25:10.248796 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315
[0m15:25:10.249302 [info ] [Thread-1 (]: 25 of 37 START test relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_  [RUN]
[0m15:25:10.249876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a, now test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315)
[0m15:25:10.250433 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315
[0m15:25:10.257559 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315"
[0m15:25:10.258492 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315
[0m15:25:10.261505 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315"
[0m15:25:10.262451 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315"
[0m15:25:10.263036 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315: BEGIN
[0m15:25:10.263536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:10.273771 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:25:10.274444 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315"
[0m15:25:10.275014 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select id_situacao as from_field
    from "transformacao_matricula"."staging_facts"."fato_matricula"
    where id_situacao is not null
),

parent as (
    select id_situacao as to_field
    from "transformacao_matricula"."staging_dimensions"."dim_situacao"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:25:10.307325 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.032 seconds
[0m15:25:10.309486 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315: ROLLBACK
[0m15:25:10.310548 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315: Close
[0m15:25:10.311563 [info ] [Thread-1 (]: 25 of 37 PASS relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_  [[32mPASS[0m in 0.06s]
[0m15:25:10.312410 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315
[0m15:25:10.313000 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c
[0m15:25:10.313618 [info ] [Thread-1 (]: 26 of 37 START test relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_  [RUN]
[0m15:25:10.314246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315, now test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c)
[0m15:25:10.314789 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c
[0m15:25:10.320150 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c"
[0m15:25:10.320918 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c
[0m15:25:10.323094 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c"
[0m15:25:10.323896 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c"
[0m15:25:10.324349 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c: BEGIN
[0m15:25:10.324744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:10.333540 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:25:10.334495 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c"
[0m15:25:10.335046 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select id_tempo as from_field
    from "transformacao_matricula"."staging_facts"."fato_matricula"
    where id_tempo is not null
),

parent as (
    select id_tempo as to_field
    from "transformacao_matricula"."staging_dimensions"."dim_tempo"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:25:10.359258 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.024 seconds
[0m15:25:10.361473 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c: ROLLBACK
[0m15:25:10.362423 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c: Close
[0m15:25:10.363171 [info ] [Thread-1 (]: 26 of 37 PASS relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_ .. [[32mPASS[0m in 0.05s]
[0m15:25:10.363934 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c
[0m15:25:10.364482 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a
[0m15:25:10.365092 [info ] [Thread-1 (]: 27 of 37 START test relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_  [RUN]
[0m15:25:10.365833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c, now test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a)
[0m15:25:10.366336 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a
[0m15:25:10.371349 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a"
[0m15:25:10.372133 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a
[0m15:25:10.375379 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a"
[0m15:25:10.376493 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a"
[0m15:25:10.377085 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a: BEGIN
[0m15:25:10.377616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:10.388082 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:25:10.388788 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a"
[0m15:25:10.389353 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select id_turma as from_field
    from "transformacao_matricula"."staging_facts"."fato_matricula"
    where id_turma is not null
),

parent as (
    select id_turma as to_field
    from "transformacao_matricula"."staging_dimensions"."dim_turma"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:25:10.421510 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.032 seconds
[0m15:25:10.423542 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a: ROLLBACK
[0m15:25:10.424418 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a: Close
[0m15:25:10.425145 [info ] [Thread-1 (]: 27 of 37 PASS relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_ .. [[32mPASS[0m in 0.06s]
[0m15:25:10.425881 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a
[0m15:25:10.426365 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400
[0m15:25:10.426883 [info ] [Thread-1 (]: 28 of 37 START test source_not_null_transformacao_matricula_staging_alunos_raw_ano  [RUN]
[0m15:25:10.427444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a, now test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400)
[0m15:25:10.427930 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400
[0m15:25:10.432411 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400"
[0m15:25:10.433181 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400
[0m15:25:10.435326 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400"
[0m15:25:10.436085 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400"
[0m15:25:10.436496 [debug] [Thread-1 (]: On test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400: BEGIN
[0m15:25:10.436999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:10.447259 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:25:10.447989 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400"
[0m15:25:10.448671 [debug] [Thread-1 (]: On test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ano
from "transformacao_matricula"."staging"."staging_alunos_raw"
where ano is null



  
  
      
    ) dbt_internal_test
[0m15:25:10.468123 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.019 seconds
[0m15:25:10.470137 [debug] [Thread-1 (]: On test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400: ROLLBACK
[0m15:25:10.471191 [debug] [Thread-1 (]: On test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400: Close
[0m15:25:10.475881 [info ] [Thread-1 (]: 28 of 37 PASS source_not_null_transformacao_matricula_staging_alunos_raw_ano ... [[32mPASS[0m in 0.05s]
[0m15:25:10.476826 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400
[0m15:25:10.477450 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd
[0m15:25:10.478181 [info ] [Thread-1 (]: 29 of 37 START test source_not_null_transformacao_matricula_staging_alunos_raw_matricula  [RUN]
[0m15:25:10.479307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400, now test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd)
[0m15:25:10.480060 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd
[0m15:25:10.485544 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd"
[0m15:25:10.486474 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd
[0m15:25:10.489927 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd"
[0m15:25:10.491051 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd"
[0m15:25:10.491579 [debug] [Thread-1 (]: On test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd: BEGIN
[0m15:25:10.492013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:10.501233 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:25:10.502019 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd"
[0m15:25:10.502650 [debug] [Thread-1 (]: On test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select matricula
from "transformacao_matricula"."staging"."staging_alunos_raw"
where matricula is null



  
  
      
    ) dbt_internal_test
[0m15:25:10.530754 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.027 seconds
[0m15:25:10.532344 [debug] [Thread-1 (]: On test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd: ROLLBACK
[0m15:25:10.533213 [debug] [Thread-1 (]: On test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd: Close
[0m15:25:10.534085 [info ] [Thread-1 (]: 29 of 37 PASS source_not_null_transformacao_matricula_staging_alunos_raw_matricula  [[32mPASS[0m in 0.05s]
[0m15:25:10.534919 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd
[0m15:25:10.535437 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74
[0m15:25:10.536071 [info ] [Thread-1 (]: 30 of 37 START test unique_dim_aluno_id_aluno .................................. [RUN]
[0m15:25:10.536750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd, now test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74)
[0m15:25:10.537370 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74
[0m15:25:10.546095 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74"
[0m15:25:10.546962 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74
[0m15:25:10.549449 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74"
[0m15:25:10.550575 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74"
[0m15:25:10.551256 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74: BEGIN
[0m15:25:10.551759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:10.562420 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:25:10.563285 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74"
[0m15:25:10.564169 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_aluno as unique_field,
    count(*) as n_records

from "transformacao_matricula"."staging_dimensions"."dim_aluno"
where id_aluno is not null
group by id_aluno
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:25:10.797026 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.232 seconds
[0m15:25:10.798860 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74: ROLLBACK
[0m15:25:10.799758 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74: Close
[0m15:25:10.800636 [info ] [Thread-1 (]: 30 of 37 PASS unique_dim_aluno_id_aluno ........................................ [[32mPASS[0m in 0.26s]
[0m15:25:10.801486 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74
[0m15:25:10.802095 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae
[0m15:25:10.802522 [info ] [Thread-1 (]: 31 of 37 START test unique_dim_escola_id_escola ................................ [RUN]
[0m15:25:10.803040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74, now test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae)
[0m15:25:10.803646 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae
[0m15:25:10.807457 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae"
[0m15:25:10.808247 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae
[0m15:25:10.810557 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae"
[0m15:25:10.811316 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae"
[0m15:25:10.811739 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae: BEGIN
[0m15:25:10.812253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:10.821919 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:25:10.822574 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae"
[0m15:25:10.823148 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_escola as unique_field,
    count(*) as n_records

from "transformacao_matricula"."staging_dimensions"."dim_escola"
where id_escola is not null
group by id_escola
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:25:10.825213 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:25:10.826974 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae: ROLLBACK
[0m15:25:10.827942 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae: Close
[0m15:25:10.829123 [info ] [Thread-1 (]: 31 of 37 PASS unique_dim_escola_id_escola ...................................... [[32mPASS[0m in 0.03s]
[0m15:25:10.829921 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae
[0m15:25:10.830417 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d
[0m15:25:10.831044 [info ] [Thread-1 (]: 32 of 37 START test unique_dim_localizacao_id_locali ........................... [RUN]
[0m15:25:10.831681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae, now test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d)
[0m15:25:10.832303 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d
[0m15:25:10.837542 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d"
[0m15:25:10.838671 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d
[0m15:25:10.842212 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d"
[0m15:25:10.843220 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d"
[0m15:25:10.843825 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d: BEGIN
[0m15:25:10.844529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:10.854877 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:25:10.855581 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d"
[0m15:25:10.856158 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_locali as unique_field,
    count(*) as n_records

from "transformacao_matricula"."staging_dimensions"."dim_localizacao"
where id_locali is not null
group by id_locali
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:25:10.858183 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:25:10.860136 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d: ROLLBACK
[0m15:25:10.861058 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d: Close
[0m15:25:10.862030 [info ] [Thread-1 (]: 32 of 37 PASS unique_dim_localizacao_id_locali ................................. [[32mPASS[0m in 0.03s]
[0m15:25:10.863249 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d
[0m15:25:10.864004 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3
[0m15:25:10.864698 [info ] [Thread-1 (]: 33 of 37 START test unique_dim_situacao_id_situacao ............................ [RUN]
[0m15:25:10.865561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d, now test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3)
[0m15:25:10.866226 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3
[0m15:25:10.871145 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3"
[0m15:25:10.871997 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3
[0m15:25:10.874799 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3"
[0m15:25:10.875999 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3"
[0m15:25:10.876659 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3: BEGIN
[0m15:25:10.877180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:10.887369 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:25:10.888060 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3"
[0m15:25:10.888597 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_situacao as unique_field,
    count(*) as n_records

from "transformacao_matricula"."staging_dimensions"."dim_situacao"
where id_situacao is not null
group by id_situacao
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:25:10.890592 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:25:10.892748 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3: ROLLBACK
[0m15:25:10.893732 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3: Close
[0m15:25:10.894646 [info ] [Thread-1 (]: 33 of 37 PASS unique_dim_situacao_id_situacao .................................. [[32mPASS[0m in 0.03s]
[0m15:25:10.895559 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3
[0m15:25:10.896232 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063
[0m15:25:10.896946 [info ] [Thread-1 (]: 34 of 37 START test unique_dim_tempo_id_tempo .................................. [RUN]
[0m15:25:10.897762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3, now test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063)
[0m15:25:10.898430 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063
[0m15:25:10.903674 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063"
[0m15:25:10.904704 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063
[0m15:25:10.907815 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063"
[0m15:25:10.908788 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063"
[0m15:25:10.909372 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063: BEGIN
[0m15:25:10.909897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:10.920143 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:25:10.920821 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063"
[0m15:25:10.921393 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_tempo as unique_field,
    count(*) as n_records

from "transformacao_matricula"."staging_dimensions"."dim_tempo"
where id_tempo is not null
group by id_tempo
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:25:10.923427 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:25:10.925320 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063: ROLLBACK
[0m15:25:10.926266 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063: Close
[0m15:25:10.930973 [info ] [Thread-1 (]: 34 of 37 PASS unique_dim_tempo_id_tempo ........................................ [[32mPASS[0m in 0.03s]
[0m15:25:10.932008 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063
[0m15:25:10.932551 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa
[0m15:25:10.933201 [info ] [Thread-1 (]: 35 of 37 START test unique_dim_turma_id_turma .................................. [RUN]
[0m15:25:10.933986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063, now test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa)
[0m15:25:10.934638 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa
[0m15:25:10.939190 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa"
[0m15:25:10.940062 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa
[0m15:25:10.944250 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa"
[0m15:25:10.945019 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa"
[0m15:25:10.945422 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa: BEGIN
[0m15:25:10.945802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:10.955836 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:25:10.956520 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa"
[0m15:25:10.957075 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_turma as unique_field,
    count(*) as n_records

from "transformacao_matricula"."staging_dimensions"."dim_turma"
where id_turma is not null
group by id_turma
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:25:10.959203 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:25:10.961173 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa: ROLLBACK
[0m15:25:10.962126 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa: Close
[0m15:25:10.963210 [info ] [Thread-1 (]: 35 of 37 PASS unique_dim_turma_id_turma ........................................ [[32mPASS[0m in 0.03s]
[0m15:25:10.964144 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa
[0m15:25:10.964782 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.unique_fato_matricula_matricula.484f264991
[0m15:25:10.965480 [info ] [Thread-1 (]: 36 of 37 START test unique_fato_matricula_matricula ............................ [RUN]
[0m15:25:10.966491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa, now test.transformacao_matricula.unique_fato_matricula_matricula.484f264991)
[0m15:25:10.967133 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.unique_fato_matricula_matricula.484f264991
[0m15:25:10.972361 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.unique_fato_matricula_matricula.484f264991"
[0m15:25:10.973335 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.unique_fato_matricula_matricula.484f264991
[0m15:25:10.976411 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.unique_fato_matricula_matricula.484f264991"
[0m15:25:10.977383 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_fato_matricula_matricula.484f264991"
[0m15:25:10.977982 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_fato_matricula_matricula.484f264991: BEGIN
[0m15:25:10.978516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:10.989011 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:25:10.989688 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_fato_matricula_matricula.484f264991"
[0m15:25:10.990233 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_fato_matricula_matricula.484f264991: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.unique_fato_matricula_matricula.484f264991"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    matricula as unique_field,
    count(*) as n_records

from "transformacao_matricula"."staging_facts"."fato_matricula"
where matricula is not null
group by matricula
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:25:11.162009 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.171 seconds
[0m15:25:11.163932 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_fato_matricula_matricula.484f264991: ROLLBACK
[0m15:25:11.165236 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_fato_matricula_matricula.484f264991: Close
[0m15:25:11.166498 [error] [Thread-1 (]: 36 of 37 FAIL 102118 unique_fato_matricula_matricula ........................... [[31mFAIL 102118[0m in 0.20s]
[0m15:25:11.167453 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.unique_fato_matricula_matricula.484f264991
[0m15:25:11.168237 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05
[0m15:25:11.169035 [info ] [Thread-1 (]: 37 of 37 START test unique_transform_data_matricula ............................ [RUN]
[0m15:25:11.169763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.unique_fato_matricula_matricula.484f264991, now test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05)
[0m15:25:11.170372 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05
[0m15:25:11.174633 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05"
[0m15:25:11.175663 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05
[0m15:25:11.178642 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05"
[0m15:25:11.179599 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05"
[0m15:25:11.180275 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05: BEGIN
[0m15:25:11.180739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:25:11.191685 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m15:25:11.192300 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05"
[0m15:25:11.192783 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    matricula as unique_field,
    count(*) as n_records

from "transformacao_matricula"."staging_intermediate"."transform_data"
where matricula is not null
group by matricula
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:25:11.361122 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.168 seconds
[0m15:25:11.362632 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05: ROLLBACK
[0m15:25:11.363488 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05: Close
[0m15:25:11.364237 [error] [Thread-1 (]: 37 of 37 FAIL 102118 unique_transform_data_matricula ........................... [[31mFAIL 102118[0m in 0.19s]
[0m15:25:11.364893 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05
[0m15:25:11.366805 [debug] [MainThread]: Using postgres connection "master"
[0m15:25:11.367315 [debug] [MainThread]: On master: BEGIN
[0m15:25:11.367664 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:25:11.377258 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m15:25:11.377992 [debug] [MainThread]: On master: COMMIT
[0m15:25:11.378497 [debug] [MainThread]: Using postgres connection "master"
[0m15:25:11.379002 [debug] [MainThread]: On master: COMMIT
[0m15:25:11.379783 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:25:11.380383 [debug] [MainThread]: On master: Close
[0m15:25:11.381116 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:11.381720 [debug] [MainThread]: Connection 'test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05' was properly closed.
[0m15:25:11.382316 [info ] [MainThread]: 
[0m15:25:11.383245 [info ] [MainThread]: Finished running 37 data tests in 0 hours 0 minutes and 2.62 seconds (2.62s).
[0m15:25:11.389994 [debug] [MainThread]: Command end result
[0m15:25:11.423591 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m15:25:11.425760 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m15:25:11.432330 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m15:25:11.432918 [info ] [MainThread]: 
[0m15:25:11.433474 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m15:25:11.434103 [info ] [MainThread]: 
[0m15:25:11.434916 [error] [MainThread]: [31mFailure in test unique_fato_matricula_matricula (transformacao_aprovados/models/staging/schema.yml)[0m
[0m15:25:11.435600 [error] [MainThread]:   Got 102118 results, configured to fail if != 0
[0m15:25:11.436219 [info ] [MainThread]: 
[0m15:25:11.436910 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_fato_matricula_matricula.sql
[0m15:25:11.437513 [info ] [MainThread]: 
[0m15:25:11.438212 [error] [MainThread]: [31mFailure in test unique_transform_data_matricula (transformacao_aprovados/models/staging/schema.yml)[0m
[0m15:25:11.438946 [error] [MainThread]:   Got 102118 results, configured to fail if != 0
[0m15:25:11.439480 [info ] [MainThread]: 
[0m15:25:11.440078 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_transform_data_matricula.sql
[0m15:25:11.440632 [info ] [MainThread]: 
[0m15:25:11.441167 [info ] [MainThread]: Done. PASS=35 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=37
[0m15:25:11.442127 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 6 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:25:11.443453 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 4.48523, "process_in_blocks": "0", "process_kernel_time": 0.423476, "process_mem_max_rss": "130120", "process_out_blocks": "4496", "process_user_time": 3.93843}
[0m15:25:11.444268 [debug] [MainThread]: Command `dbt test` failed at 15:25:11.444134 after 4.49 seconds
[0m15:25:11.444924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e8b7f87a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e891d2930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7e895fb710>]}
[0m15:25:11.445557 [debug] [MainThread]: Flushing usage events
[0m15:25:12.639771 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:30:03.999537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736a9a740ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736a9a5c3b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736a9a4f7b30>]}


============================== 17:30:04.003061 | e9a32756-127c-49e5-a88c-e035ba144c40 ==============================
[0m17:30:04.003061 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:30:04.003700 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'invocation_command': 'dbt clean', 'profiles_dir': '/home/murilo/.dbt', 'write_json': 'True', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'warn_error': 'None', 'no_print': 'None', 'partial_parse': 'True', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'indirect_selection': 'eager', 'introspect': 'True', 'empty': 'None'}
[0m17:30:04.119440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9a32756-127c-49e5-a88c-e035ba144c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736a9a5f4440>]}
[0m17:30:04.140399 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18948358, "process_in_blocks": "39152", "process_kernel_time": 0.248344, "process_mem_max_rss": "101776", "process_out_blocks": "8", "process_user_time": 1.205526}
[0m17:30:04.140992 [debug] [MainThread]: Command `dbt clean` succeeded at 17:30:04.140895 after 0.19 seconds
[0m17:30:04.141405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736a9a571a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736a995cfdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736a9a5f4440>]}
[0m17:30:04.141878 [debug] [MainThread]: Flushing usage events
[0m17:30:04.826423 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:30:15.892527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed38f1b24b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed38f0a1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed39141ab10>]}


============================== 17:30:15.896016 | 870530bf-f763-46d6-b490-f89090aef597 ==============================
[0m17:30:15.896016 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:30:15.896624 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_format': 'default', 'partial_parse': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'debug': 'False', 'empty': 'False', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'use_colors': 'True', 'profiles_dir': '/home/murilo/.dbt', 'warn_error': 'None', 'target_path': 'None', 'quiet': 'False', 'version_check': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'write_json': 'True'}
[0m17:30:16.042911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '870530bf-f763-46d6-b490-f89090aef597', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed38deaba70>]}
[0m17:30:16.100223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '870530bf-f763-46d6-b490-f89090aef597', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed38e7da360>]}
[0m17:30:16.101475 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:30:16.220309 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m17:30:16.220996 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:30:16.221510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '870530bf-f763-46d6-b490-f89090aef597', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed38debc2c0>]}
[0m17:30:17.206361 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m17:30:17.206948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '870530bf-f763-46d6-b490-f89090aef597', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed38cb5c500>]}
[0m17:30:17.432258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '870530bf-f763-46d6-b490-f89090aef597', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed38cb2f140>]}
[0m17:30:17.505962 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m17:30:17.508282 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m17:30:17.526324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '870530bf-f763-46d6-b490-f89090aef597', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed38c36bce0>]}
[0m17:30:17.526933 [info ] [MainThread]: Found 13 models, 37 data tests, 1 source, 459 macros
[0m17:30:17.527350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '870530bf-f763-46d6-b490-f89090aef597', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed38cb71340>]}
[0m17:30:17.529838 [info ] [MainThread]: 
[0m17:30:17.530440 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m17:30:17.530858 [info ] [MainThread]: 
[0m17:30:17.531363 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:30:17.535450 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula'
[0m17:30:17.587705 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m17:30:17.588296 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m17:30:17.588734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:19.063484 [debug] [ThreadPool]: SQL status: SELECT 4 in 1.475 seconds
[0m17:30:19.065989 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m17:30:19.071592 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m17:30:19.072391 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m17:30:19.072957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:19.968403 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.895 seconds
[0m17:30:19.970120 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m17:30:19.972388 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m17:30:19.972962 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m17:30:19.973338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:20.854427 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.881 seconds
[0m17:30:20.855657 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m17:30:20.857908 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m17:30:20.858433 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m17:30:20.858809 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:21.736829 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.878 seconds
[0m17:30:21.738137 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m17:30:21.741802 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m17:30:21.742382 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m17:30:21.742773 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:22.581576 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.839 seconds
[0m17:30:22.582842 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m17:30:22.583804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula, now create_transformacao_matricula_staging_staging)
[0m17:30:22.584312 [debug] [ThreadPool]: Creating schema "database: "transformacao_matricula"
schema: "staging_staging"
"
[0m17:30:22.588539 [debug] [ThreadPool]: Using postgres connection "create_transformacao_matricula_staging_staging"
[0m17:30:22.588997 [debug] [ThreadPool]: On create_transformacao_matricula_staging_staging: BEGIN
[0m17:30:22.589302 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:23.429963 [debug] [ThreadPool]: SQL status: BEGIN in 0.841 seconds
[0m17:30:23.430522 [debug] [ThreadPool]: Using postgres connection "create_transformacao_matricula_staging_staging"
[0m17:30:23.430860 [debug] [ThreadPool]: On create_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "create_transformacao_matricula_staging_staging"} */
create schema if not exists "staging_staging"
[0m17:30:23.542825 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.112 seconds
[0m17:30:23.544038 [debug] [ThreadPool]: On create_transformacao_matricula_staging_staging: COMMIT
[0m17:30:23.544388 [debug] [ThreadPool]: Using postgres connection "create_transformacao_matricula_staging_staging"
[0m17:30:23.544713 [debug] [ThreadPool]: On create_transformacao_matricula_staging_staging: COMMIT
[0m17:30:23.649392 [debug] [ThreadPool]: SQL status: COMMIT in 0.104 seconds
[0m17:30:23.649973 [debug] [ThreadPool]: On create_transformacao_matricula_staging_staging: Close
[0m17:30:23.650648 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_transformacao_matricula_staging_staging, now create_transformacao_matricula_staging_facts)
[0m17:30:23.651150 [debug] [ThreadPool]: Creating schema "database: "transformacao_matricula"
schema: "staging_facts"
"
[0m17:30:23.652924 [debug] [ThreadPool]: Using postgres connection "create_transformacao_matricula_staging_facts"
[0m17:30:23.653327 [debug] [ThreadPool]: On create_transformacao_matricula_staging_facts: BEGIN
[0m17:30:23.653645 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:24.518289 [debug] [ThreadPool]: SQL status: BEGIN in 0.865 seconds
[0m17:30:24.519190 [debug] [ThreadPool]: Using postgres connection "create_transformacao_matricula_staging_facts"
[0m17:30:24.519614 [debug] [ThreadPool]: On create_transformacao_matricula_staging_facts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "create_transformacao_matricula_staging_facts"} */
create schema if not exists "staging_facts"
[0m17:30:24.624579 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.105 seconds
[0m17:30:24.625901 [debug] [ThreadPool]: On create_transformacao_matricula_staging_facts: COMMIT
[0m17:30:24.626269 [debug] [ThreadPool]: Using postgres connection "create_transformacao_matricula_staging_facts"
[0m17:30:24.626579 [debug] [ThreadPool]: On create_transformacao_matricula_staging_facts: COMMIT
[0m17:30:24.733464 [debug] [ThreadPool]: SQL status: COMMIT in 0.106 seconds
[0m17:30:24.734011 [debug] [ThreadPool]: On create_transformacao_matricula_staging_facts: Close
[0m17:30:24.734681 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_transformacao_matricula_staging_facts, now create_transformacao_matricula_staging_dimensions)
[0m17:30:24.735183 [debug] [ThreadPool]: Creating schema "database: "transformacao_matricula"
schema: "staging_dimensions"
"
[0m17:30:24.736954 [debug] [ThreadPool]: Using postgres connection "create_transformacao_matricula_staging_dimensions"
[0m17:30:24.737356 [debug] [ThreadPool]: On create_transformacao_matricula_staging_dimensions: BEGIN
[0m17:30:24.737676 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:25.587076 [debug] [ThreadPool]: SQL status: BEGIN in 0.849 seconds
[0m17:30:25.587960 [debug] [ThreadPool]: Using postgres connection "create_transformacao_matricula_staging_dimensions"
[0m17:30:25.588422 [debug] [ThreadPool]: On create_transformacao_matricula_staging_dimensions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "create_transformacao_matricula_staging_dimensions"} */
create schema if not exists "staging_dimensions"
[0m17:30:25.692937 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.104 seconds
[0m17:30:25.694516 [debug] [ThreadPool]: On create_transformacao_matricula_staging_dimensions: COMMIT
[0m17:30:25.694905 [debug] [ThreadPool]: Using postgres connection "create_transformacao_matricula_staging_dimensions"
[0m17:30:25.695245 [debug] [ThreadPool]: On create_transformacao_matricula_staging_dimensions: COMMIT
[0m17:30:25.800880 [debug] [ThreadPool]: SQL status: COMMIT in 0.105 seconds
[0m17:30:25.801761 [debug] [ThreadPool]: On create_transformacao_matricula_staging_dimensions: Close
[0m17:30:25.803033 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_transformacao_matricula_staging_dimensions, now create_transformacao_matricula_staging_marts)
[0m17:30:25.803852 [debug] [ThreadPool]: Creating schema "database: "transformacao_matricula"
schema: "staging_marts"
"
[0m17:30:25.806381 [debug] [ThreadPool]: Using postgres connection "create_transformacao_matricula_staging_marts"
[0m17:30:25.807017 [debug] [ThreadPool]: On create_transformacao_matricula_staging_marts: BEGIN
[0m17:30:25.807404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:26.699966 [debug] [ThreadPool]: SQL status: BEGIN in 0.892 seconds
[0m17:30:26.700494 [debug] [ThreadPool]: Using postgres connection "create_transformacao_matricula_staging_marts"
[0m17:30:26.700848 [debug] [ThreadPool]: On create_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "create_transformacao_matricula_staging_marts"} */
create schema if not exists "staging_marts"
[0m17:30:26.809859 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.109 seconds
[0m17:30:26.810924 [debug] [ThreadPool]: On create_transformacao_matricula_staging_marts: COMMIT
[0m17:30:26.811426 [debug] [ThreadPool]: Using postgres connection "create_transformacao_matricula_staging_marts"
[0m17:30:26.811803 [debug] [ThreadPool]: On create_transformacao_matricula_staging_marts: COMMIT
[0m17:30:26.977296 [debug] [ThreadPool]: SQL status: COMMIT in 0.165 seconds
[0m17:30:26.978058 [debug] [ThreadPool]: On create_transformacao_matricula_staging_marts: Close
[0m17:30:26.979716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_transformacao_matricula_staging_marts, now create_transformacao_matricula_staging_intermediate)
[0m17:30:26.980307 [debug] [ThreadPool]: Creating schema "database: "transformacao_matricula"
schema: "staging_intermediate"
"
[0m17:30:26.982028 [debug] [ThreadPool]: Using postgres connection "create_transformacao_matricula_staging_intermediate"
[0m17:30:26.982424 [debug] [ThreadPool]: On create_transformacao_matricula_staging_intermediate: BEGIN
[0m17:30:26.982757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:28.107676 [debug] [ThreadPool]: SQL status: BEGIN in 1.125 seconds
[0m17:30:28.108196 [debug] [ThreadPool]: Using postgres connection "create_transformacao_matricula_staging_intermediate"
[0m17:30:28.108575 [debug] [ThreadPool]: On create_transformacao_matricula_staging_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "create_transformacao_matricula_staging_intermediate"} */
create schema if not exists "staging_intermediate"
[0m17:30:28.222289 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.113 seconds
[0m17:30:28.223284 [debug] [ThreadPool]: On create_transformacao_matricula_staging_intermediate: COMMIT
[0m17:30:28.223667 [debug] [ThreadPool]: Using postgres connection "create_transformacao_matricula_staging_intermediate"
[0m17:30:28.223991 [debug] [ThreadPool]: On create_transformacao_matricula_staging_intermediate: COMMIT
[0m17:30:28.410283 [debug] [ThreadPool]: SQL status: COMMIT in 0.186 seconds
[0m17:30:28.410774 [debug] [ThreadPool]: On create_transformacao_matricula_staging_intermediate: Close
[0m17:30:28.413072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_transformacao_matricula_staging_intermediate, now list_transformacao_matricula_staging_staging)
[0m17:30:28.418914 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m17:30:28.419523 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: BEGIN
[0m17:30:28.419855 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:29.463261 [debug] [ThreadPool]: SQL status: BEGIN in 1.043 seconds
[0m17:30:29.464242 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m17:30:29.464642 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_staging"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m17:30:29.573974 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.109 seconds
[0m17:30:29.575969 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: ROLLBACK
[0m17:30:29.680904 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: Close
[0m17:30:29.681775 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_staging, now list_transformacao_matricula_staging_facts)
[0m17:30:29.683835 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_facts"
[0m17:30:29.684342 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: BEGIN
[0m17:30:29.684691 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:30.536704 [debug] [ThreadPool]: SQL status: BEGIN in 0.852 seconds
[0m17:30:30.537537 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_facts"
[0m17:30:30.538306 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_facts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_facts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_facts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_facts'
  
[0m17:30:30.645658 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.107 seconds
[0m17:30:30.646836 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: ROLLBACK
[0m17:30:30.750719 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: Close
[0m17:30:30.751860 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_facts, now list_transformacao_matricula_staging_dimensions)
[0m17:30:30.754250 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_dimensions"
[0m17:30:30.754714 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: BEGIN
[0m17:30:30.755045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:31.606138 [debug] [ThreadPool]: SQL status: BEGIN in 0.851 seconds
[0m17:30:31.606633 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_dimensions"
[0m17:30:31.607018 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_dimensions"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dimensions'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dimensions'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dimensions'
  
[0m17:30:31.712392 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.105 seconds
[0m17:30:31.713945 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: ROLLBACK
[0m17:30:31.817655 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: Close
[0m17:30:31.818447 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_dimensions, now list_transformacao_matricula_staging_marts)
[0m17:30:31.820183 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m17:30:31.820642 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: BEGIN
[0m17:30:31.820967 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:32.691654 [debug] [ThreadPool]: SQL status: BEGIN in 0.871 seconds
[0m17:30:32.692570 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m17:30:32.693333 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_marts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m17:30:32.796839 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.103 seconds
[0m17:30:32.798699 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: ROLLBACK
[0m17:30:32.901507 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: Close
[0m17:30:32.902935 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_marts, now list_transformacao_matricula_staging_intermediate)
[0m17:30:32.905017 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_intermediate"
[0m17:30:32.905489 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: BEGIN
[0m17:30:32.905848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:34.660915 [debug] [ThreadPool]: SQL status: BEGIN in 1.755 seconds
[0m17:30:34.661382 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_intermediate"
[0m17:30:34.661804 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_intermediate"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_intermediate'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_intermediate'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_intermediate'
  
[0m17:30:34.814914 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.152 seconds
[0m17:30:34.816518 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: ROLLBACK
[0m17:30:34.963552 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: Close
[0m17:30:34.970351 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:34.970823 [debug] [MainThread]: On master: BEGIN
[0m17:30:34.971138 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:30:36.086900 [debug] [MainThread]: SQL status: BEGIN in 1.116 seconds
[0m17:30:36.087639 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:36.088070 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:30:36.295212 [debug] [MainThread]: SQL status: SELECT 0 in 0.207 seconds
[0m17:30:36.296591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '870530bf-f763-46d6-b490-f89090aef597', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed38cb1a900>]}
[0m17:30:36.297174 [debug] [MainThread]: On master: ROLLBACK
[0m17:30:36.499475 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:36.499992 [debug] [MainThread]: On master: BEGIN
[0m17:30:36.806890 [debug] [MainThread]: SQL status: BEGIN in 0.306 seconds
[0m17:30:36.807361 [debug] [MainThread]: On master: COMMIT
[0m17:30:36.807712 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:36.808047 [debug] [MainThread]: On master: COMMIT
[0m17:30:36.916469 [debug] [MainThread]: SQL status: COMMIT in 0.108 seconds
[0m17:30:36.917170 [debug] [MainThread]: On master: Close
[0m17:30:36.925340 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.staging_situacao_alunos
[0m17:30:36.925983 [info ] [Thread-1 (]: 1 of 13 START sql table model staging_staging.staging_situacao_alunos .......... [RUN]
[0m17:30:36.926514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_intermediate, now model.transformacao_matricula.staging_situacao_alunos)
[0m17:30:36.926940 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.staging_situacao_alunos
[0m17:30:36.933421 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.staging_situacao_alunos"
[0m17:30:36.934349 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.staging_situacao_alunos
[0m17:30:36.976714 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.staging_situacao_alunos"
[0m17:30:36.978073 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m17:30:36.978582 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: BEGIN
[0m17:30:36.978973 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:38.141130 [debug] [Thread-1 (]: SQL status: BEGIN in 1.162 seconds
[0m17:30:38.142075 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m17:30:38.143050 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */

  
    

  create  table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp"
  
  
    as
  
  (
    WITH source AS (
    SELECT * FROM "transformacao_matricula"."staging"."staging_alunos_raw"
),

cleaning_renaming AS (
    SELECT
        ano,
        codigo_escola,
        matricula,
        escola AS nome_escola,
        endereco_logradouro AS endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa,
        modalidade_ensino_codigo AS mod_ens_codigo,
        -- Transformação da SÉRIE
        CASE
            -- Ensino Fundamental (1º ao 9º)
            WHEN serie LIKE '%1 ANO%' OR serie LIKE '%1º ANO%' THEN '1º ANO'
            WHEN serie LIKE '%2 ANO%' OR serie LIKE '%2º ANO%' THEN '2º ANO'
            WHEN serie LIKE '%3 ANO%' OR serie LIKE '%3º ANO%' THEN '3º ANO'
            WHEN serie LIKE '%4 ANO%' OR serie LIKE '%4º ANO%' THEN '4º ANO'
            WHEN serie LIKE '%5 ANO%' OR serie LIKE '%5º ANO%' THEN '5º ANO'
            WHEN serie LIKE '%6 ANO%' OR serie LIKE '%6º ANO%' THEN '6º ANO'
            WHEN serie LIKE '%7 ANO%' OR serie LIKE '%7º ANO%' THEN '7º ANO'
            WHEN serie LIKE '%8 ANO%' OR serie LIKE '%8º ANO%' THEN '8º ANO'
            WHEN serie LIKE '%9 ANO%' OR serie LIKE '%9º ANO%' THEN '9º ANO'
            -- Educação Infantil (Berçário e Grupos)
            WHEN serie LIKE '%BER%' THEN 'BERÇARIO'
            WHEN serie LIKE '%GRUPO I%' OR serie LIKE '%GRUPO 1%' THEN 'GRUPO I'
            WHEN serie LIKE '%GRUPO II%' THEN 'GRUPO II'
            WHEN serie LIKE '%GRUPO III%' THEN 'GRUPO III'
            WHEN serie LIKE '%GRUPO IV%' THEN 'GRUPO IV'
            WHEN serie LIKE '%GRUPO V%' THEN 'GRUPO V'
            -- EJA (Módulos 1 ao 5) 
            WHEN serie LIKE '%1%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 1'
            WHEN serie LIKE '%2%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 2'
            WHEN serie LIKE '%3%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 3'
            WHEN serie LIKE '%4%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 4'
            WHEN serie LIKE '%5%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 5'
            WHEN serie LIKE '%TRAVESSIA%' THEN 'TRAVESSIA RECIFE'
            WHEN serie LIKE '%CORRECAO%1%' THEN 'CORREÇÃO DE FLUXO 1 - ALFABETIZACAO'
            WHEN serie LIKE '%CORRECAO%2%' THEN 'CORREÇÃO DE FLUXO 2 - ACELERACAO'
            ELSE 'OUTROS'
        END AS serie,
        turma,
        turno,
        idade,
        -- transformação do SEXO
        CASE
            WHEN sexo = '1' THEN 'Masculino'
            WHEN sexo = '2' THEN 'Feminino'
            WHEN sexo = '3' THEN 'Outros'
            ELSE 'Não informado'
        END AS sexo,
        -- transformação de situacao
        CASE 
            WHEN situacao_nome LIKE '%APROV%' THEN 'Aprovado'
            WHEN situacao_nome LIKE '%RET%' OR situacao_nome LIKE '%REPRO%' THEN 'Reprovado'
            WHEN situacao_nome LIKE '%TR%' OR situacao_nome LIKE '%REMAN%' THEN 'Transferido'
            WHEN situacao_nome LIKE '%DESIST%' THEN 'Desistente'
            ELSE 'Outros'
        END AS sit_nome,
        -- Transformação da MODALIDADE
        CASE
            WHEN modalidade_ensino LIKE '%EDUCACAO INFANTIL%' THEN 'EDUCAÇÃO INFANTIL'
            WHEN modalidade_ensino LIKE '%ENSINO FUNDAMENTAL%' THEN 'ENSINO FUNDAMENTAL'
            WHEN modalidade_ensino LIKE '%EDUCACAO JOVENS E ADULTOS%' THEN 'EJA'
            WHEN modalidade_ensino LIKE '%CORRE%' THEN 'CORREÇÃO DE FLUXO'
            ELSE 'OUTROS'
        END AS modalidade_ens
    FROM source
)

SELECT * FROM cleaning_renaming
  );
  
[0m17:30:38.249640 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging.staging_alunos_raw" does not exist
LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."stagi...
                           ^

[0m17:30:38.250157 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: ROLLBACK
[0m17:30:38.356109 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: Close
[0m17:30:38.366077 [debug] [Thread-1 (]: Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  relation "staging.staging_alunos_raw" does not exist
  LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."stagi...
                             ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m17:30:38.367777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '870530bf-f763-46d6-b490-f89090aef597', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed38f7a8b30>]}
[0m17:30:38.368470 [error] [Thread-1 (]: 1 of 13 ERROR creating sql table model staging_staging.staging_situacao_alunos . [[31mERROR[0m in 1.44s]
[0m17:30:38.369092 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.staging_situacao_alunos
[0m17:30:38.370252 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.staging_situacao_alunos' to be skipped because of status 'error'.  Reason: Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  relation "staging.staging_alunos_raw" does not exist
  LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."stagi...
                             ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql.
[0m17:30:38.372589 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.transform_data
[0m17:30:38.373168 [info ] [Thread-1 (]: 2 of 13 SKIP relation staging_intermediate.transform_data ...................... [[33mSKIP[0m]
[0m17:30:38.373627 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.transform_data
[0m17:30:38.374434 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_aluno
[0m17:30:38.374885 [info ] [Thread-1 (]: 3 of 13 SKIP relation staging_dimensions.dim_aluno ............................. [[33mSKIP[0m]
[0m17:30:38.375398 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_aluno
[0m17:30:38.375847 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_escola
[0m17:30:38.376363 [info ] [Thread-1 (]: 4 of 13 SKIP relation staging_dimensions.dim_escola ............................ [[33mSKIP[0m]
[0m17:30:38.377024 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_escola
[0m17:30:38.377453 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_localizacao
[0m17:30:38.377962 [info ] [Thread-1 (]: 5 of 13 SKIP relation staging_dimensions.dim_localizacao ....................... [[33mSKIP[0m]
[0m17:30:38.378430 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_localizacao
[0m17:30:38.378848 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_situacao
[0m17:30:38.379325 [info ] [Thread-1 (]: 6 of 13 SKIP relation staging_dimensions.dim_situacao .......................... [[33mSKIP[0m]
[0m17:30:38.379833 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_situacao
[0m17:30:38.380336 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_tempo
[0m17:30:38.380744 [info ] [Thread-1 (]: 7 of 13 SKIP relation staging_dimensions.dim_tempo ............................. [[33mSKIP[0m]
[0m17:30:38.381332 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_tempo
[0m17:30:38.381823 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_turma
[0m17:30:38.382397 [info ] [Thread-1 (]: 8 of 13 SKIP relation staging_dimensions.dim_turma ............................. [[33mSKIP[0m]
[0m17:30:38.382942 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_turma
[0m17:30:38.383639 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.fato_matricula
[0m17:30:38.384271 [info ] [Thread-1 (]: 9 of 13 SKIP relation staging_facts.fato_matricula ............................. [[33mSKIP[0m]
[0m17:30:38.384991 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.fato_matricula
[0m17:30:38.386977 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_count_aluno_idade
[0m17:30:38.387709 [info ] [Thread-1 (]: 10 of 13 SKIP relation staging_marts.view_count_aluno_idade .................... [[33mSKIP[0m]
[0m17:30:38.388402 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_count_aluno_idade
[0m17:30:38.388971 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m17:30:38.389617 [info ] [Thread-1 (]: 11 of 13 SKIP relation staging_marts.view_frequencia_situacao_escola ........... [[33mSKIP[0m]
[0m17:30:38.390249 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m17:30:38.390833 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_matricula_detalhada
[0m17:30:38.391431 [info ] [Thread-1 (]: 12 of 13 SKIP relation staging_marts.view_matricula_detalhada .................. [[33mSKIP[0m]
[0m17:30:38.392060 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_matricula_detalhada
[0m17:30:38.392810 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_taxa_aprovados
[0m17:30:38.393827 [info ] [Thread-1 (]: 13 of 13 SKIP relation staging_marts.view_taxa_aprovados ....................... [[33mSKIP[0m]
[0m17:30:38.394689 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_taxa_aprovados
[0m17:30:38.396338 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:38.396972 [debug] [MainThread]: On master: BEGIN
[0m17:30:38.397439 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:30:39.396280 [debug] [MainThread]: SQL status: BEGIN in 0.999 seconds
[0m17:30:39.397209 [debug] [MainThread]: On master: COMMIT
[0m17:30:39.398010 [debug] [MainThread]: Using postgres connection "master"
[0m17:30:39.398512 [debug] [MainThread]: On master: COMMIT
[0m17:30:39.501951 [debug] [MainThread]: SQL status: COMMIT in 0.103 seconds
[0m17:30:39.503095 [debug] [MainThread]: On master: Close
[0m17:30:39.504384 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:30:39.504871 [debug] [MainThread]: Connection 'model.transformacao_matricula.staging_situacao_alunos' was properly closed.
[0m17:30:39.505282 [info ] [MainThread]: 
[0m17:30:39.505665 [info ] [MainThread]: Finished running 9 table models, 4 view models in 0 hours 0 minutes and 21.97 seconds (21.97s).
[0m17:30:39.506557 [debug] [MainThread]: Command end result
[0m17:30:39.534940 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m17:30:39.537626 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m17:30:39.545340 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m17:30:39.546048 [info ] [MainThread]: 
[0m17:30:39.546745 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:30:39.547588 [info ] [MainThread]: 
[0m17:30:39.548421 [error] [MainThread]: [31mFailure in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)[0m
[0m17:30:39.549331 [error] [MainThread]:   Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  relation "staging.staging_alunos_raw" does not exist
  LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."stagi...
                             ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m17:30:39.550226 [info ] [MainThread]: 
[0m17:30:39.551013 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m17:30:39.551992 [info ] [MainThread]: 
[0m17:30:39.553406 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=12 NO-OP=0 TOTAL=13
[0m17:30:39.555187 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 6 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:30:39.558882 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 23.712675, "process_in_blocks": "36728", "process_kernel_time": 0.403154, "process_mem_max_rss": "130128", "process_out_blocks": "3656", "process_user_time": 3.011026}
[0m17:30:39.560445 [debug] [MainThread]: Command `dbt run` failed at 17:30:39.560152 after 23.71 seconds
[0m17:30:39.561214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed38ed93140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed38f1f6b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed38cba8110>]}
[0m17:30:39.561979 [debug] [MainThread]: Flushing usage events
[0m17:30:40.185093 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:33:52.825281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639fe079100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639fdb723f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639fdb73470>]}


============================== 17:33:52.828884 | 8320ea1b-2203-4e8c-ba0d-88226888cfff ==============================
[0m17:33:52.828884 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:33:52.829436 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'empty': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'debug': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'version_check': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'use_colors': 'True', 'profiles_dir': '/home/murilo/.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'target_path': 'None', 'static_parser': 'True', 'quiet': 'False', 'log_format': 'default', 'partial_parse': 'True', 'introspect': 'True'}
[0m17:33:52.962775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8320ea1b-2203-4e8c-ba0d-88226888cfff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639fcc8f770>]}
[0m17:33:53.012723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8320ea1b-2203-4e8c-ba0d-88226888cfff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639fdd38530>]}
[0m17:33:53.013546 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:33:53.121730 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m17:33:53.230077 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:33:53.230637 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:33:53.269947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8320ea1b-2203-4e8c-ba0d-88226888cfff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639fc52f260>]}
[0m17:33:53.347376 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m17:33:53.350377 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m17:33:53.367117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8320ea1b-2203-4e8c-ba0d-88226888cfff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639fbd1cf20>]}
[0m17:33:53.367695 [info ] [MainThread]: Found 13 models, 37 data tests, 1 source, 459 macros
[0m17:33:53.368182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8320ea1b-2203-4e8c-ba0d-88226888cfff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639fb9c9bb0>]}
[0m17:33:53.370783 [info ] [MainThread]: 
[0m17:33:53.371285 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m17:33:53.371646 [info ] [MainThread]: 
[0m17:33:53.372158 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:33:53.376148 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula'
[0m17:33:53.414908 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m17:33:53.415399 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m17:33:53.415762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:54.944754 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.529 seconds
[0m17:33:54.946513 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m17:33:54.951335 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m17:33:54.952032 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m17:33:54.952545 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:33:55.829463 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.877 seconds
[0m17:33:55.831050 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m17:33:55.833253 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m17:33:55.833789 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m17:33:55.834103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:33:56.682261 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.848 seconds
[0m17:33:56.683621 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m17:33:56.686178 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m17:33:56.686730 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m17:33:56.687068 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:33:57.529219 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.842 seconds
[0m17:33:57.530548 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m17:33:57.533546 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m17:33:57.534138 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m17:33:57.534490 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:33:58.424030 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.889 seconds
[0m17:33:58.426211 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m17:33:58.428571 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula, now list_transformacao_matricula_staging_marts)
[0m17:33:58.434446 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m17:33:58.434969 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: BEGIN
[0m17:33:58.435372 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:33:59.267903 [debug] [ThreadPool]: SQL status: BEGIN in 0.832 seconds
[0m17:33:59.268749 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m17:33:59.269097 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_marts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m17:33:59.373999 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.104 seconds
[0m17:33:59.376219 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: ROLLBACK
[0m17:33:59.478112 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: Close
[0m17:33:59.479505 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_marts, now list_transformacao_matricula_staging_facts)
[0m17:33:59.481774 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_facts"
[0m17:33:59.482210 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: BEGIN
[0m17:33:59.482516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:34:00.317346 [debug] [ThreadPool]: SQL status: BEGIN in 0.835 seconds
[0m17:34:00.317899 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_facts"
[0m17:34:00.318704 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_facts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_facts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_facts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_facts'
  
[0m17:34:00.422237 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.103 seconds
[0m17:34:00.423847 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: ROLLBACK
[0m17:34:00.526265 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: Close
[0m17:34:00.527721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_facts, now list_transformacao_matricula_staging_intermediate)
[0m17:34:00.529730 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_intermediate"
[0m17:34:00.530150 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: BEGIN
[0m17:34:00.530454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:34:01.367966 [debug] [ThreadPool]: SQL status: BEGIN in 0.837 seconds
[0m17:34:01.368896 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_intermediate"
[0m17:34:01.369722 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_intermediate"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_intermediate'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_intermediate'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_intermediate'
  
[0m17:34:01.473429 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.103 seconds
[0m17:34:01.474910 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: ROLLBACK
[0m17:34:01.577875 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: Close
[0m17:34:01.579164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_intermediate, now list_transformacao_matricula_staging_dimensions)
[0m17:34:01.580917 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_dimensions"
[0m17:34:01.581328 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: BEGIN
[0m17:34:01.581694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:34:02.461329 [debug] [ThreadPool]: SQL status: BEGIN in 0.880 seconds
[0m17:34:02.461960 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_dimensions"
[0m17:34:02.462299 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_dimensions"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dimensions'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dimensions'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dimensions'
  
[0m17:34:02.571212 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.108 seconds
[0m17:34:02.573302 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: ROLLBACK
[0m17:34:02.681375 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: Close
[0m17:34:02.682256 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_dimensions, now list_transformacao_matricula_staging_staging)
[0m17:34:02.684332 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m17:34:02.684745 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: BEGIN
[0m17:34:02.685073 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:34:03.850960 [debug] [ThreadPool]: SQL status: BEGIN in 1.166 seconds
[0m17:34:03.851600 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m17:34:03.852344 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_staging"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m17:34:04.152644 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.300 seconds
[0m17:34:04.154335 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: ROLLBACK
[0m17:34:04.262159 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: Close
[0m17:34:04.266742 [debug] [MainThread]: Using postgres connection "master"
[0m17:34:04.267179 [debug] [MainThread]: On master: BEGIN
[0m17:34:04.267481 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:34:05.433195 [debug] [MainThread]: SQL status: BEGIN in 1.166 seconds
[0m17:34:05.434017 [debug] [MainThread]: Using postgres connection "master"
[0m17:34:05.434797 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:34:05.574380 [debug] [MainThread]: SQL status: SELECT 0 in 0.139 seconds
[0m17:34:05.576501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8320ea1b-2203-4e8c-ba0d-88226888cfff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639fa9e7260>]}
[0m17:34:05.577018 [debug] [MainThread]: On master: ROLLBACK
[0m17:34:05.686589 [debug] [MainThread]: Using postgres connection "master"
[0m17:34:05.687367 [debug] [MainThread]: On master: BEGIN
[0m17:34:05.902145 [debug] [MainThread]: SQL status: BEGIN in 0.214 seconds
[0m17:34:05.902669 [debug] [MainThread]: On master: COMMIT
[0m17:34:05.903053 [debug] [MainThread]: Using postgres connection "master"
[0m17:34:05.903716 [debug] [MainThread]: On master: COMMIT
[0m17:34:06.011341 [debug] [MainThread]: SQL status: COMMIT in 0.107 seconds
[0m17:34:06.012302 [debug] [MainThread]: On master: Close
[0m17:34:06.015064 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.staging_situacao_alunos
[0m17:34:06.015738 [info ] [Thread-1 (]: 1 of 13 START sql table model staging_staging.staging_situacao_alunos .......... [RUN]
[0m17:34:06.016208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_staging, now model.transformacao_matricula.staging_situacao_alunos)
[0m17:34:06.016577 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.staging_situacao_alunos
[0m17:34:06.022861 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.staging_situacao_alunos"
[0m17:34:06.023592 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.staging_situacao_alunos
[0m17:34:06.060693 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.staging_situacao_alunos"
[0m17:34:06.061564 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m17:34:06.062066 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: BEGIN
[0m17:34:06.062430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:07.019015 [debug] [Thread-1 (]: SQL status: BEGIN in 0.956 seconds
[0m17:34:07.019978 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m17:34:07.020537 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */

  
    

  create  table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp"
  
  
    as
  
  (
    WITH source AS (
    SELECT * FROM "transformacao_matricula"."staging"."staging_alunos_raw"
),

cleaning_renaming AS (
    SELECT
        ano,
        codigo_escola,
        matricula,
        escola AS nome_escola,
        endereco_logradouro AS endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa,
        modalidade_ensino_codigo AS mod_ens_codigo,
        -- Transformação da SÉRIE
        CASE
            -- Ensino Fundamental (1º ao 9º)
            WHEN serie LIKE '%1 ANO%' OR serie LIKE '%1º ANO%' THEN '1º ANO'
            WHEN serie LIKE '%2 ANO%' OR serie LIKE '%2º ANO%' THEN '2º ANO'
            WHEN serie LIKE '%3 ANO%' OR serie LIKE '%3º ANO%' THEN '3º ANO'
            WHEN serie LIKE '%4 ANO%' OR serie LIKE '%4º ANO%' THEN '4º ANO'
            WHEN serie LIKE '%5 ANO%' OR serie LIKE '%5º ANO%' THEN '5º ANO'
            WHEN serie LIKE '%6 ANO%' OR serie LIKE '%6º ANO%' THEN '6º ANO'
            WHEN serie LIKE '%7 ANO%' OR serie LIKE '%7º ANO%' THEN '7º ANO'
            WHEN serie LIKE '%8 ANO%' OR serie LIKE '%8º ANO%' THEN '8º ANO'
            WHEN serie LIKE '%9 ANO%' OR serie LIKE '%9º ANO%' THEN '9º ANO'
            -- Educação Infantil (Berçário e Grupos)
            WHEN serie LIKE '%BER%' THEN 'BERÇARIO'
            WHEN serie LIKE '%GRUPO I%' OR serie LIKE '%GRUPO 1%' THEN 'GRUPO I'
            WHEN serie LIKE '%GRUPO II%' THEN 'GRUPO II'
            WHEN serie LIKE '%GRUPO III%' THEN 'GRUPO III'
            WHEN serie LIKE '%GRUPO IV%' THEN 'GRUPO IV'
            WHEN serie LIKE '%GRUPO V%' THEN 'GRUPO V'
            -- EJA (Módulos 1 ao 5) 
            WHEN serie LIKE '%1%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 1'
            WHEN serie LIKE '%2%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 2'
            WHEN serie LIKE '%3%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 3'
            WHEN serie LIKE '%4%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 4'
            WHEN serie LIKE '%5%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 5'
            WHEN serie LIKE '%TRAVESSIA%' THEN 'TRAVESSIA RECIFE'
            WHEN serie LIKE '%CORRECAO%1%' THEN 'CORREÇÃO DE FLUXO 1 - ALFABETIZACAO'
            WHEN serie LIKE '%CORRECAO%2%' THEN 'CORREÇÃO DE FLUXO 2 - ACELERACAO'
            ELSE 'OUTROS'
        END AS serie,
        turma,
        turno,
        idade,
        -- transformação do SEXO
        CASE
            WHEN sexo = '1' THEN 'Masculino'
            WHEN sexo = '2' THEN 'Feminino'
            WHEN sexo = '3' THEN 'Outros'
            ELSE 'Não informado'
        END AS sexo,
        -- transformação de situacao
        CASE 
            WHEN situacao_nome LIKE '%APROV%' THEN 'Aprovado'
            WHEN situacao_nome LIKE '%RET%' OR situacao_nome LIKE '%REPRO%' THEN 'Reprovado'
            WHEN situacao_nome LIKE '%TR%' OR situacao_nome LIKE '%REMAN%' THEN 'Transferido'
            WHEN situacao_nome LIKE '%DESIST%' THEN 'Desistente'
            ELSE 'Outros'
        END AS sit_nome,
        -- Transformação da MODALIDADE
        CASE
            WHEN modalidade_ensino LIKE '%EDUCACAO INFANTIL%' THEN 'EDUCAÇÃO INFANTIL'
            WHEN modalidade_ensino LIKE '%ENSINO FUNDAMENTAL%' THEN 'ENSINO FUNDAMENTAL'
            WHEN modalidade_ensino LIKE '%EDUCACAO JOVENS E ADULTOS%' THEN 'EJA'
            WHEN modalidade_ensino LIKE '%CORRE%' THEN 'CORREÇÃO DE FLUXO'
            ELSE 'OUTROS'
        END AS modalidade_ens
    FROM source
)

SELECT * FROM cleaning_renaming
  );
  
[0m17:34:07.198320 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging.staging_alunos_raw" does not exist
LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."stagi...
                           ^

[0m17:34:07.199241 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: ROLLBACK
[0m17:34:07.326452 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: Close
[0m17:34:07.329992 [debug] [Thread-1 (]: Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  relation "staging.staging_alunos_raw" does not exist
  LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."stagi...
                             ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m17:34:07.331569 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8320ea1b-2203-4e8c-ba0d-88226888cfff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639f9d076b0>]}
[0m17:34:07.332435 [error] [Thread-1 (]: 1 of 13 ERROR creating sql table model staging_staging.staging_situacao_alunos . [[31mERROR[0m in 1.31s]
[0m17:34:07.333103 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.staging_situacao_alunos
[0m17:34:07.333879 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.staging_situacao_alunos' to be skipped because of status 'error'.  Reason: Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  relation "staging.staging_alunos_raw" does not exist
  LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."stagi...
                             ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql.
[0m17:34:07.335522 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.transform_data
[0m17:34:07.336185 [info ] [Thread-1 (]: 2 of 13 SKIP relation staging_intermediate.transform_data ...................... [[33mSKIP[0m]
[0m17:34:07.336663 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.transform_data
[0m17:34:07.337882 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_aluno
[0m17:34:07.338390 [info ] [Thread-1 (]: 3 of 13 SKIP relation staging_dimensions.dim_aluno ............................. [[33mSKIP[0m]
[0m17:34:07.339195 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_aluno
[0m17:34:07.339830 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_escola
[0m17:34:07.340415 [info ] [Thread-1 (]: 4 of 13 SKIP relation staging_dimensions.dim_escola ............................ [[33mSKIP[0m]
[0m17:34:07.340998 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_escola
[0m17:34:07.341464 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_localizacao
[0m17:34:07.342072 [info ] [Thread-1 (]: 5 of 13 SKIP relation staging_dimensions.dim_localizacao ....................... [[33mSKIP[0m]
[0m17:34:07.342777 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_localizacao
[0m17:34:07.343266 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_situacao
[0m17:34:07.343806 [info ] [Thread-1 (]: 6 of 13 SKIP relation staging_dimensions.dim_situacao .......................... [[33mSKIP[0m]
[0m17:34:07.344498 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_situacao
[0m17:34:07.345012 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_tempo
[0m17:34:07.345651 [info ] [Thread-1 (]: 7 of 13 SKIP relation staging_dimensions.dim_tempo ............................. [[33mSKIP[0m]
[0m17:34:07.346264 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_tempo
[0m17:34:07.346722 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_turma
[0m17:34:07.347157 [info ] [Thread-1 (]: 8 of 13 SKIP relation staging_dimensions.dim_turma ............................. [[33mSKIP[0m]
[0m17:34:07.347646 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_turma
[0m17:34:07.348373 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.fato_matricula
[0m17:34:07.349089 [info ] [Thread-1 (]: 9 of 13 SKIP relation staging_facts.fato_matricula ............................. [[33mSKIP[0m]
[0m17:34:07.349692 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.fato_matricula
[0m17:34:07.350763 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_count_aluno_idade
[0m17:34:07.351392 [info ] [Thread-1 (]: 10 of 13 SKIP relation staging_marts.view_count_aluno_idade .................... [[33mSKIP[0m]
[0m17:34:07.351980 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_count_aluno_idade
[0m17:34:07.352535 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m17:34:07.353416 [info ] [Thread-1 (]: 11 of 13 SKIP relation staging_marts.view_frequencia_situacao_escola ........... [[33mSKIP[0m]
[0m17:34:07.354140 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m17:34:07.354718 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_matricula_detalhada
[0m17:34:07.355354 [info ] [Thread-1 (]: 12 of 13 SKIP relation staging_marts.view_matricula_detalhada .................. [[33mSKIP[0m]
[0m17:34:07.356040 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_matricula_detalhada
[0m17:34:07.356592 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_taxa_aprovados
[0m17:34:07.357153 [info ] [Thread-1 (]: 13 of 13 SKIP relation staging_marts.view_taxa_aprovados ....................... [[33mSKIP[0m]
[0m17:34:07.357920 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_taxa_aprovados
[0m17:34:07.359369 [debug] [MainThread]: Using postgres connection "master"
[0m17:34:07.359933 [debug] [MainThread]: On master: BEGIN
[0m17:34:07.360362 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:34:08.466004 [debug] [MainThread]: SQL status: BEGIN in 1.106 seconds
[0m17:34:08.466655 [debug] [MainThread]: On master: COMMIT
[0m17:34:08.467449 [debug] [MainThread]: Using postgres connection "master"
[0m17:34:08.467951 [debug] [MainThread]: On master: COMMIT
[0m17:34:08.585882 [debug] [MainThread]: SQL status: COMMIT in 0.117 seconds
[0m17:34:08.586781 [debug] [MainThread]: On master: Close
[0m17:34:08.587899 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:34:08.588291 [debug] [MainThread]: Connection 'model.transformacao_matricula.staging_situacao_alunos' was properly closed.
[0m17:34:08.588697 [info ] [MainThread]: 
[0m17:34:08.589126 [info ] [MainThread]: Finished running 9 table models, 4 view models in 0 hours 0 minutes and 15.22 seconds (15.22s).
[0m17:34:08.590121 [debug] [MainThread]: Command end result
[0m17:34:08.614201 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m17:34:08.616579 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m17:34:08.623363 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m17:34:08.624134 [info ] [MainThread]: 
[0m17:34:08.624782 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:34:08.625396 [info ] [MainThread]: 
[0m17:34:08.626142 [error] [MainThread]: [31mFailure in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)[0m
[0m17:34:08.626941 [error] [MainThread]:   Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  relation "staging.staging_alunos_raw" does not exist
  LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."stagi...
                             ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m17:34:08.627720 [info ] [MainThread]: 
[0m17:34:08.628378 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m17:34:08.629009 [info ] [MainThread]: 
[0m17:34:08.629725 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=12 NO-OP=0 TOTAL=13
[0m17:34:08.631094 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 15.8531475, "process_in_blocks": "6616", "process_kernel_time": 0.347988, "process_mem_max_rss": "124444", "process_out_blocks": "2568", "process_user_time": 1.809137}
[0m17:34:08.631920 [debug] [MainThread]: Command `dbt run` failed at 17:34:08.631795 after 15.85 seconds
[0m17:34:08.632678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639fdf03f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639fdf03b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7639ffe2b860>]}
[0m17:34:08.633411 [debug] [MainThread]: Flushing usage events
[0m17:34:09.302771 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:39:38.129474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d173e6a73e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d173e4d05f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d173f58e240>]}


============================== 17:39:38.132843 | 748185a1-7989-417a-99f8-aebc56d3a902 ==============================
[0m17:39:38.132843 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:39:38.133400 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'fail_fast': 'False', 'empty': 'False', 'static_parser': 'True', 'no_print': 'None', 'use_colors': 'True', 'profiles_dir': '/home/murilo/.dbt', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'introspect': 'True', 'target_path': 'None', 'version_check': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error': 'None', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'quiet': 'False'}
[0m17:39:38.135682 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'transformacao_matricula' does not have a target named 'transformacao_matricula'. The valid target names for this profile are:
   - transformacao_matricula_db
[0m17:39:38.136751 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.05211723, "process_in_blocks": "1992", "process_kernel_time": 0.174087, "process_mem_max_rss": "98928", "process_out_blocks": "8", "process_user_time": 1.060532}
[0m17:39:38.137357 [debug] [MainThread]: Command `dbt run` failed at 17:39:38.137259 after 0.05 seconds
[0m17:39:38.137777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d173d6938c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d173daae960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d173da53980>]}
[0m17:39:38.138197 [debug] [MainThread]: Flushing usage events
[0m17:39:39.359725 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:40:19.395210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0efcc59580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0efd6add90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0efd6af380>]}


============================== 17:40:19.398231 | 72f9d7a2-d3e6-4afa-a60a-7e2908bc177f ==============================
[0m17:40:19.398231 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:40:19.398819 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'partial_parse': 'True', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'printer_width': '80', 'profiles_dir': '/home/murilo/.dbt', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'quiet': 'False', 'invocation_command': 'dbt clean', 'empty': 'None', 'no_print': 'None', 'static_parser': 'True', 'warn_error': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'introspect': 'True'}
[0m17:40:19.497755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72f9d7a2-d3e6-4afa-a60a-7e2908bc177f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0efc32f560>]}
[0m17:40:19.513420 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.16395354, "process_in_blocks": "808", "process_kernel_time": 0.213166, "process_mem_max_rss": "101620", "process_out_blocks": "16", "process_user_time": 1.144264}
[0m17:40:19.514057 [debug] [MainThread]: Command `dbt clean` succeeded at 17:40:19.513935 after 0.16 seconds
[0m17:40:19.514518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0efc8aed20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0efc396270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0efc99eea0>]}
[0m17:40:19.514960 [debug] [MainThread]: Flushing usage events
[0m17:40:20.254725 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:40:23.453770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6e5dd65250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6e5f756d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6e5d8dc6b0>]}


============================== 17:40:23.456783 | 56700664-6dec-4a29-a869-ee239f176a0b ==============================
[0m17:40:23.456783 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:40:23.457372 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/murilo/.dbt', 'target_path': 'None', 'debug': 'False', 'warn_error': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'partial_parse': 'True', 'empty': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'printer_width': '80', 'no_print': 'None', 'invocation_command': 'dbt run', 'write_json': 'True', 'fail_fast': 'False', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'introspect': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'cache_selected_only': 'False'}
[0m17:40:23.459789 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'transformacao_matricula' does not have a target named 'transformacao_matricula'. The valid target names for this profile are:
   - transformacao_matricula_db
[0m17:40:23.460773 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.053141642, "process_in_blocks": "0", "process_kernel_time": 0.188528, "process_mem_max_rss": "98928", "process_out_blocks": "0", "process_user_time": 1.079299}
[0m17:40:23.461253 [debug] [MainThread]: Command `dbt run` failed at 17:40:23.461165 after 0.05 seconds
[0m17:40:23.461643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6e5d80f260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6e5d1dfb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6e5cd3cbc0>]}
[0m17:40:23.462042 [debug] [MainThread]: Flushing usage events
[0m17:40:25.523352 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:40:49.087276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e0030e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e19e6b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e011a7e0>]}


============================== 17:40:49.090556 | 01b68d15-c0aa-4b8c-b9ab-6fa794c74af3 ==============================
[0m17:40:49.090556 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:40:49.091447 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'printer_width': '80', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'warn_error': 'None', 'debug': 'False', 'invocation_command': 'dbt run', 'static_parser': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'version_check': 'True', 'empty': 'False', 'quiet': 'False', 'target_path': 'None', 'write_json': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'profiles_dir': '/home/murilo/.dbt', 'introspect': 'True'}
[0m17:40:49.224342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01b68d15-c0aa-4b8c-b9ab-6fa794c74af3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5de504260>]}
[0m17:40:49.276159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01b68d15-c0aa-4b8c-b9ab-6fa794c74af3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5e1886270>]}
[0m17:40:49.276998 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:40:49.382515 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m17:40:49.383183 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:40:49.383558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '01b68d15-c0aa-4b8c-b9ab-6fa794c74af3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5dffdf770>]}
[0m17:40:50.388696 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m17:40:50.389964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '01b68d15-c0aa-4b8c-b9ab-6fa794c74af3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5dd5ac500>]}
[0m17:40:50.633697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01b68d15-c0aa-4b8c-b9ab-6fa794c74af3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5dd1f30e0>]}
[0m17:40:50.707586 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m17:40:50.710849 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m17:40:50.725922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01b68d15-c0aa-4b8c-b9ab-6fa794c74af3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5decc6360>]}
[0m17:40:50.726565 [info ] [MainThread]: Found 13 models, 37 data tests, 1 source, 459 macros
[0m17:40:50.727039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01b68d15-c0aa-4b8c-b9ab-6fa794c74af3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5dd1879b0>]}
[0m17:40:50.729263 [info ] [MainThread]: 
[0m17:40:50.729781 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m17:40:50.730147 [info ] [MainThread]: 
[0m17:40:50.730703 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:40:50.735012 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula'
[0m17:40:50.772859 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m17:40:50.773347 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m17:40:50.773694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:53.101352 [debug] [ThreadPool]: SQL status: SELECT 9 in 2.328 seconds
[0m17:40:53.103263 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m17:40:53.106683 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m17:40:53.107364 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m17:40:53.108123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:54.449588 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.341 seconds
[0m17:40:54.451074 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m17:40:54.453092 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m17:40:54.453654 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m17:40:54.454032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:55.509835 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.056 seconds
[0m17:40:55.511211 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m17:40:55.513373 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m17:40:55.513933 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m17:40:55.514266 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:56.372255 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.858 seconds
[0m17:40:56.373709 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m17:40:56.376937 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m17:40:56.377540 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m17:40:56.377915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:57.218410 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.840 seconds
[0m17:40:57.219985 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m17:40:57.225185 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula, now list_transformacao_matricula_staging_marts)
[0m17:40:57.230823 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m17:40:57.231274 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: BEGIN
[0m17:40:57.231585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:58.084940 [debug] [ThreadPool]: SQL status: BEGIN in 0.853 seconds
[0m17:40:58.085918 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m17:40:58.086821 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_marts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m17:40:58.192940 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.106 seconds
[0m17:40:58.194629 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: ROLLBACK
[0m17:40:58.297228 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: Close
[0m17:40:58.298495 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_marts, now list_transformacao_matricula_staging_staging)
[0m17:40:58.300312 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m17:40:58.300752 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: BEGIN
[0m17:40:58.301103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:59.136323 [debug] [ThreadPool]: SQL status: BEGIN in 0.835 seconds
[0m17:40:59.137144 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m17:40:59.137527 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_staging"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m17:40:59.246262 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.108 seconds
[0m17:40:59.247805 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: ROLLBACK
[0m17:40:59.350535 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: Close
[0m17:40:59.351340 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_staging, now list_transformacao_matricula_staging_intermediate)
[0m17:40:59.353238 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_intermediate"
[0m17:40:59.353721 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: BEGIN
[0m17:40:59.354032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:41:00.241417 [debug] [ThreadPool]: SQL status: BEGIN in 0.887 seconds
[0m17:41:00.242259 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_intermediate"
[0m17:41:00.242598 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_intermediate"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_intermediate'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_intermediate'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_intermediate'
  
[0m17:41:00.351880 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.109 seconds
[0m17:41:00.353729 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: ROLLBACK
[0m17:41:00.461828 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: Close
[0m17:41:00.463030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_intermediate, now list_transformacao_matricula_staging_facts)
[0m17:41:00.465811 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_facts"
[0m17:41:00.466487 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: BEGIN
[0m17:41:00.467152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:41:01.318448 [debug] [ThreadPool]: SQL status: BEGIN in 0.851 seconds
[0m17:41:01.319444 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_facts"
[0m17:41:01.320062 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_facts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_facts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_facts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_facts'
  
[0m17:41:01.431384 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.111 seconds
[0m17:41:01.433017 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: ROLLBACK
[0m17:41:01.535522 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: Close
[0m17:41:01.537021 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_facts, now list_transformacao_matricula_staging_dimensions)
[0m17:41:01.539388 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_dimensions"
[0m17:41:01.539899 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: BEGIN
[0m17:41:01.540203 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:41:02.438539 [debug] [ThreadPool]: SQL status: BEGIN in 0.898 seconds
[0m17:41:02.439379 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_dimensions"
[0m17:41:02.439946 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_dimensions"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dimensions'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dimensions'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dimensions'
  
[0m17:41:02.555365 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.115 seconds
[0m17:41:02.556904 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: ROLLBACK
[0m17:41:02.666505 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: Close
[0m17:41:02.671183 [debug] [MainThread]: Using postgres connection "master"
[0m17:41:02.671663 [debug] [MainThread]: On master: BEGIN
[0m17:41:02.672015 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:41:03.520449 [debug] [MainThread]: SQL status: BEGIN in 0.848 seconds
[0m17:41:03.521382 [debug] [MainThread]: Using postgres connection "master"
[0m17:41:03.522122 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:41:03.632989 [debug] [MainThread]: SQL status: SELECT 0 in 0.110 seconds
[0m17:41:03.634239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01b68d15-c0aa-4b8c-b9ab-6fa794c74af3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5dc971280>]}
[0m17:41:03.634755 [debug] [MainThread]: On master: ROLLBACK
[0m17:41:03.737578 [debug] [MainThread]: Using postgres connection "master"
[0m17:41:03.738074 [debug] [MainThread]: On master: BEGIN
[0m17:41:03.942735 [debug] [MainThread]: SQL status: BEGIN in 0.204 seconds
[0m17:41:03.943252 [debug] [MainThread]: On master: COMMIT
[0m17:41:03.943576 [debug] [MainThread]: Using postgres connection "master"
[0m17:41:03.943907 [debug] [MainThread]: On master: COMMIT
[0m17:41:04.046564 [debug] [MainThread]: SQL status: COMMIT in 0.102 seconds
[0m17:41:04.047138 [debug] [MainThread]: On master: Close
[0m17:41:04.049815 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.staging_situacao_alunos
[0m17:41:04.050949 [info ] [Thread-1 (]: 1 of 13 START sql table model staging_staging.staging_situacao_alunos .......... [RUN]
[0m17:41:04.051506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_dimensions, now model.transformacao_matricula.staging_situacao_alunos)
[0m17:41:04.051947 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.staging_situacao_alunos
[0m17:41:04.058928 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.staging_situacao_alunos"
[0m17:41:04.059774 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.staging_situacao_alunos
[0m17:41:04.097741 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.staging_situacao_alunos"
[0m17:41:04.099109 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m17:41:04.099681 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: BEGIN
[0m17:41:04.100075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:41:04.986668 [debug] [Thread-1 (]: SQL status: BEGIN in 0.886 seconds
[0m17:41:04.987554 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m17:41:04.988171 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */

  
    

  create  table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp"
  
  
    as
  
  (
    WITH source AS (
    SELECT * FROM "transformacao_matricula"."staging"."staging_alunos_raw"
),

cleaning_renaming AS (
    SELECT
        ano,
        codigo_escola,
        matricula,
        escola AS nome_escola,
        endereco_logradouro AS endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa,
        modalidade_ensino_codigo AS mod_ens_codigo,
        -- Transformação da SÉRIE
        CASE
            -- Ensino Fundamental (1º ao 9º)
            WHEN serie LIKE '%1 ANO%' OR serie LIKE '%1º ANO%' THEN '1º ANO'
            WHEN serie LIKE '%2 ANO%' OR serie LIKE '%2º ANO%' THEN '2º ANO'
            WHEN serie LIKE '%3 ANO%' OR serie LIKE '%3º ANO%' THEN '3º ANO'
            WHEN serie LIKE '%4 ANO%' OR serie LIKE '%4º ANO%' THEN '4º ANO'
            WHEN serie LIKE '%5 ANO%' OR serie LIKE '%5º ANO%' THEN '5º ANO'
            WHEN serie LIKE '%6 ANO%' OR serie LIKE '%6º ANO%' THEN '6º ANO'
            WHEN serie LIKE '%7 ANO%' OR serie LIKE '%7º ANO%' THEN '7º ANO'
            WHEN serie LIKE '%8 ANO%' OR serie LIKE '%8º ANO%' THEN '8º ANO'
            WHEN serie LIKE '%9 ANO%' OR serie LIKE '%9º ANO%' THEN '9º ANO'
            -- Educação Infantil (Berçário e Grupos)
            WHEN serie LIKE '%BER%' THEN 'BERÇARIO'
            WHEN serie LIKE '%GRUPO I%' OR serie LIKE '%GRUPO 1%' THEN 'GRUPO I'
            WHEN serie LIKE '%GRUPO II%' THEN 'GRUPO II'
            WHEN serie LIKE '%GRUPO III%' THEN 'GRUPO III'
            WHEN serie LIKE '%GRUPO IV%' THEN 'GRUPO IV'
            WHEN serie LIKE '%GRUPO V%' THEN 'GRUPO V'
            -- EJA (Módulos 1 ao 5) 
            WHEN serie LIKE '%1%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 1'
            WHEN serie LIKE '%2%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 2'
            WHEN serie LIKE '%3%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 3'
            WHEN serie LIKE '%4%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 4'
            WHEN serie LIKE '%5%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 5'
            WHEN serie LIKE '%TRAVESSIA%' THEN 'TRAVESSIA RECIFE'
            WHEN serie LIKE '%CORRECAO%1%' THEN 'CORREÇÃO DE FLUXO 1 - ALFABETIZACAO'
            WHEN serie LIKE '%CORRECAO%2%' THEN 'CORREÇÃO DE FLUXO 2 - ACELERACAO'
            ELSE 'OUTROS'
        END AS serie,
        turma,
        turno,
        idade,
        -- transformação do SEXO
        CASE
            WHEN sexo = '1' THEN 'Masculino'
            WHEN sexo = '2' THEN 'Feminino'
            WHEN sexo = '3' THEN 'Outros'
            ELSE 'Não informado'
        END AS sexo,
        -- transformação de situacao
        CASE 
            WHEN situacao_nome LIKE '%APROV%' THEN 'Aprovado'
            WHEN situacao_nome LIKE '%RET%' OR situacao_nome LIKE '%REPRO%' THEN 'Reprovado'
            WHEN situacao_nome LIKE '%TR%' OR situacao_nome LIKE '%REMAN%' THEN 'Transferido'
            WHEN situacao_nome LIKE '%DESIST%' THEN 'Desistente'
            ELSE 'Outros'
        END AS sit_nome,
        -- Transformação da MODALIDADE
        CASE
            WHEN modalidade_ensino LIKE '%EDUCACAO INFANTIL%' THEN 'EDUCAÇÃO INFANTIL'
            WHEN modalidade_ensino LIKE '%ENSINO FUNDAMENTAL%' THEN 'ENSINO FUNDAMENTAL'
            WHEN modalidade_ensino LIKE '%EDUCACAO JOVENS E ADULTOS%' THEN 'EJA'
            WHEN modalidade_ensino LIKE '%CORRE%' THEN 'CORREÇÃO DE FLUXO'
            ELSE 'OUTROS'
        END AS modalidade_ens
    FROM source
)

SELECT * FROM cleaning_renaming
  );
  
[0m17:41:05.100088 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging.staging_alunos_raw" does not exist
LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."stagi...
                           ^

[0m17:41:05.100619 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: ROLLBACK
[0m17:41:05.208734 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: Close
[0m17:41:05.212034 [debug] [Thread-1 (]: Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  relation "staging.staging_alunos_raw" does not exist
  LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."stagi...
                             ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m17:41:05.213567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01b68d15-c0aa-4b8c-b9ab-6fa794c74af3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5d9bb9370>]}
[0m17:41:05.214270 [error] [Thread-1 (]: 1 of 13 ERROR creating sql table model staging_staging.staging_situacao_alunos . [[31mERROR[0m in 1.16s]
[0m17:41:05.214874 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.staging_situacao_alunos
[0m17:41:05.215779 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.staging_situacao_alunos' to be skipped because of status 'error'.  Reason: Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  relation "staging.staging_alunos_raw" does not exist
  LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."stagi...
                             ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql.
[0m17:41:05.217294 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.transform_data
[0m17:41:05.217989 [info ] [Thread-1 (]: 2 of 13 SKIP relation staging_intermediate.transform_data ...................... [[33mSKIP[0m]
[0m17:41:05.218472 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.transform_data
[0m17:41:05.219464 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_aluno
[0m17:41:05.219906 [info ] [Thread-1 (]: 3 of 13 SKIP relation staging_dimensions.dim_aluno ............................. [[33mSKIP[0m]
[0m17:41:05.220328 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_aluno
[0m17:41:05.220744 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_escola
[0m17:41:05.221354 [info ] [Thread-1 (]: 4 of 13 SKIP relation staging_dimensions.dim_escola ............................ [[33mSKIP[0m]
[0m17:41:05.221974 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_escola
[0m17:41:05.222436 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_localizacao
[0m17:41:05.223020 [info ] [Thread-1 (]: 5 of 13 SKIP relation staging_dimensions.dim_localizacao ....................... [[33mSKIP[0m]
[0m17:41:05.223498 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_localizacao
[0m17:41:05.223944 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_situacao
[0m17:41:05.224421 [info ] [Thread-1 (]: 6 of 13 SKIP relation staging_dimensions.dim_situacao .......................... [[33mSKIP[0m]
[0m17:41:05.224916 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_situacao
[0m17:41:05.225346 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_tempo
[0m17:41:05.225866 [info ] [Thread-1 (]: 7 of 13 SKIP relation staging_dimensions.dim_tempo ............................. [[33mSKIP[0m]
[0m17:41:05.226434 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_tempo
[0m17:41:05.226979 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_turma
[0m17:41:05.227569 [info ] [Thread-1 (]: 8 of 13 SKIP relation staging_dimensions.dim_turma ............................. [[33mSKIP[0m]
[0m17:41:05.228110 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_turma
[0m17:41:05.228969 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.fato_matricula
[0m17:41:05.229496 [info ] [Thread-1 (]: 9 of 13 SKIP relation staging_facts.fato_matricula ............................. [[33mSKIP[0m]
[0m17:41:05.230038 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.fato_matricula
[0m17:41:05.230942 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_count_aluno_idade
[0m17:41:05.231384 [info ] [Thread-1 (]: 10 of 13 SKIP relation staging_marts.view_count_aluno_idade .................... [[33mSKIP[0m]
[0m17:41:05.232055 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_count_aluno_idade
[0m17:41:05.232576 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m17:41:05.233239 [info ] [Thread-1 (]: 11 of 13 SKIP relation staging_marts.view_frequencia_situacao_escola ........... [[33mSKIP[0m]
[0m17:41:05.233827 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m17:41:05.234388 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_matricula_detalhada
[0m17:41:05.235050 [info ] [Thread-1 (]: 12 of 13 SKIP relation staging_marts.view_matricula_detalhada .................. [[33mSKIP[0m]
[0m17:41:05.235727 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_matricula_detalhada
[0m17:41:05.236339 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_taxa_aprovados
[0m17:41:05.236989 [info ] [Thread-1 (]: 13 of 13 SKIP relation staging_marts.view_taxa_aprovados ....................... [[33mSKIP[0m]
[0m17:41:05.237997 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_taxa_aprovados
[0m17:41:05.239838 [debug] [MainThread]: Using postgres connection "master"
[0m17:41:05.240455 [debug] [MainThread]: On master: BEGIN
[0m17:41:05.240938 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:41:06.083584 [debug] [MainThread]: SQL status: BEGIN in 0.843 seconds
[0m17:41:06.084310 [debug] [MainThread]: On master: COMMIT
[0m17:41:06.084680 [debug] [MainThread]: Using postgres connection "master"
[0m17:41:06.085234 [debug] [MainThread]: On master: COMMIT
[0m17:41:06.188003 [debug] [MainThread]: SQL status: COMMIT in 0.102 seconds
[0m17:41:06.188546 [debug] [MainThread]: On master: Close
[0m17:41:06.189280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:41:06.190034 [debug] [MainThread]: Connection 'model.transformacao_matricula.staging_situacao_alunos' was properly closed.
[0m17:41:06.190510 [info ] [MainThread]: 
[0m17:41:06.190929 [info ] [MainThread]: Finished running 9 table models, 4 view models in 0 hours 0 minutes and 15.46 seconds (15.46s).
[0m17:41:06.191840 [debug] [MainThread]: Command end result
[0m17:41:06.220150 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m17:41:06.222671 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m17:41:06.228893 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m17:41:06.229420 [info ] [MainThread]: 
[0m17:41:06.229908 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:41:06.230283 [info ] [MainThread]: 
[0m17:41:06.230717 [error] [MainThread]: [31mFailure in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)[0m
[0m17:41:06.231159 [error] [MainThread]:   Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  relation "staging.staging_alunos_raw" does not exist
  LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."stagi...
                             ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m17:41:06.231513 [info ] [MainThread]: 
[0m17:41:06.231923 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m17:41:06.232290 [info ] [MainThread]: 
[0m17:41:06.232720 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=12 NO-OP=0 TOTAL=13
[0m17:41:06.233314 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 6 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:41:06.234363 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 17.193167, "process_in_blocks": "776", "process_kernel_time": 0.390858, "process_mem_max_rss": "130092", "process_out_blocks": "3640", "process_user_time": 2.866293}
[0m17:41:06.234900 [debug] [MainThread]: Command `dbt run` failed at 17:41:06.234804 after 17.19 seconds
[0m17:41:06.235362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5df569bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5dd132d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5df999f10>]}
[0m17:41:06.235852 [debug] [MainThread]: Flushing usage events
[0m17:41:06.729245 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:48:21.957137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d2ef9ac530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d2edfa6fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d2ee33f800>]}


============================== 17:48:21.960209 | 9e814310-0c06-45f9-a384-e0ad3689afbb ==============================
[0m17:48:21.960209 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:48:21.960779 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'warn_error': 'None', 'debug': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'fail_fast': 'False', 'write_json': 'True', 'log_format': 'default', 'quiet': 'False', 'partial_parse': 'True', 'profiles_dir': '/home/murilo/.dbt', 'introspect': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True'}
[0m17:48:22.106381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e814310-0c06-45f9-a384-e0ad3689afbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d2ed555e80>]}
[0m17:48:22.155303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e814310-0c06-45f9-a384-e0ad3689afbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d2ed2d22d0>]}
[0m17:48:22.156166 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:48:22.262578 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m17:48:22.357377 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:48:22.357829 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:48:22.393458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e814310-0c06-45f9-a384-e0ad3689afbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d2ebb67d10>]}
[0m17:48:22.463099 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m17:48:22.464884 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m17:48:22.478817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e814310-0c06-45f9-a384-e0ad3689afbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d2ebf34440>]}
[0m17:48:22.479394 [info ] [MainThread]: Found 13 models, 37 data tests, 1 source, 459 macros
[0m17:48:22.479809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e814310-0c06-45f9-a384-e0ad3689afbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d2ebb67b90>]}
[0m17:48:22.482020 [info ] [MainThread]: 
[0m17:48:22.482496 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m17:48:22.482867 [info ] [MainThread]: 
[0m17:48:22.483389 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:48:22.487555 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula'
[0m17:48:22.531826 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m17:48:22.532416 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m17:48:22.532917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:23.999207 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.466 seconds
[0m17:48:24.000481 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m17:48:24.002688 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m17:48:24.003252 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m17:48:24.003623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:25.917045 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.913 seconds
[0m17:48:25.918621 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m17:48:25.920663 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m17:48:25.921153 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m17:48:25.921483 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:27.073005 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.151 seconds
[0m17:48:27.074184 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m17:48:27.076222 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m17:48:27.076725 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m17:48:27.077057 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:30.525713 [debug] [ThreadPool]: SQL status: SELECT 9 in 3.449 seconds
[0m17:48:30.526944 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m17:48:30.530085 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m17:48:30.530658 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m17:48:30.531061 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:31.960204 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.429 seconds
[0m17:48:31.961836 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m17:48:31.963832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula, now list_transformacao_matricula_staging_facts)
[0m17:48:31.969396 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_facts"
[0m17:48:31.969878 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: BEGIN
[0m17:48:31.970204 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:33.084750 [debug] [ThreadPool]: SQL status: BEGIN in 1.114 seconds
[0m17:48:33.085710 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_facts"
[0m17:48:33.086418 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_facts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_facts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_facts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_facts'
  
[0m17:48:33.191771 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.105 seconds
[0m17:48:33.193708 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: ROLLBACK
[0m17:48:33.297955 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: Close
[0m17:48:33.299023 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_facts, now list_transformacao_matricula_staging_marts)
[0m17:48:33.300917 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m17:48:33.301355 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: BEGIN
[0m17:48:33.301711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:34.143262 [debug] [ThreadPool]: SQL status: BEGIN in 0.841 seconds
[0m17:48:34.144183 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m17:48:34.145138 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_marts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m17:48:34.254892 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.109 seconds
[0m17:48:34.256660 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: ROLLBACK
[0m17:48:34.362522 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: Close
[0m17:48:34.363762 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_marts, now list_transformacao_matricula_staging_staging)
[0m17:48:34.365551 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m17:48:34.365997 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: BEGIN
[0m17:48:34.366354 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:35.198374 [debug] [ThreadPool]: SQL status: BEGIN in 0.832 seconds
[0m17:48:35.199101 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m17:48:35.199585 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_staging"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m17:48:35.306565 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.106 seconds
[0m17:48:35.307745 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: ROLLBACK
[0m17:48:35.410411 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: Close
[0m17:48:35.411759 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_staging, now list_transformacao_matricula_staging_dimensions)
[0m17:48:35.413535 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_dimensions"
[0m17:48:35.413976 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: BEGIN
[0m17:48:35.414284 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:36.253044 [debug] [ThreadPool]: SQL status: BEGIN in 0.839 seconds
[0m17:48:36.253583 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_dimensions"
[0m17:48:36.253963 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_dimensions"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dimensions'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dimensions'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dimensions'
  
[0m17:48:36.360194 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.106 seconds
[0m17:48:36.361972 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: ROLLBACK
[0m17:48:36.463746 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: Close
[0m17:48:36.465204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_dimensions, now list_transformacao_matricula_staging_intermediate)
[0m17:48:36.467160 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_intermediate"
[0m17:48:36.467574 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: BEGIN
[0m17:48:36.467897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:37.319743 [debug] [ThreadPool]: SQL status: BEGIN in 0.852 seconds
[0m17:48:37.320455 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_intermediate"
[0m17:48:37.320812 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_intermediate"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_intermediate'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_intermediate'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_intermediate'
  
[0m17:48:37.425157 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.104 seconds
[0m17:48:37.427344 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: ROLLBACK
[0m17:48:37.530225 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: Close
[0m17:48:37.534663 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:37.535129 [debug] [MainThread]: On master: BEGIN
[0m17:48:37.535465 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:48:38.370305 [debug] [MainThread]: SQL status: BEGIN in 0.835 seconds
[0m17:48:38.370845 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:38.371273 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:48:38.476425 [debug] [MainThread]: SQL status: SELECT 0 in 0.105 seconds
[0m17:48:38.477654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e814310-0c06-45f9-a384-e0ad3689afbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d2ea3abc20>]}
[0m17:48:38.478159 [debug] [MainThread]: On master: ROLLBACK
[0m17:48:38.580705 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:38.581227 [debug] [MainThread]: On master: BEGIN
[0m17:48:38.785913 [debug] [MainThread]: SQL status: BEGIN in 0.204 seconds
[0m17:48:38.786884 [debug] [MainThread]: On master: COMMIT
[0m17:48:38.787303 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:38.787635 [debug] [MainThread]: On master: COMMIT
[0m17:48:38.889689 [debug] [MainThread]: SQL status: COMMIT in 0.102 seconds
[0m17:48:38.890352 [debug] [MainThread]: On master: Close
[0m17:48:38.893022 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.staging_situacao_alunos
[0m17:48:38.894345 [info ] [Thread-1 (]: 1 of 13 START sql table model staging_staging.staging_situacao_alunos .......... [RUN]
[0m17:48:38.894970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_intermediate, now model.transformacao_matricula.staging_situacao_alunos)
[0m17:48:38.895402 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.staging_situacao_alunos
[0m17:48:38.901645 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.staging_situacao_alunos"
[0m17:48:38.902342 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.staging_situacao_alunos
[0m17:48:38.942518 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.staging_situacao_alunos"
[0m17:48:38.943739 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m17:48:38.944151 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: BEGIN
[0m17:48:38.944506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:39.787077 [debug] [Thread-1 (]: SQL status: BEGIN in 0.842 seconds
[0m17:48:39.787987 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m17:48:39.788496 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */

  
    

  create  table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp"
  
  
    as
  
  (
    WITH source AS (
    SELECT * FROM "transformacao_matricula"."staging"."staging_alunos_raw"
),

cleaning_renaming AS (
    SELECT
        ano,
        codigo_escola,
        matricula,
        escola AS nome_escola,
        endereco_logradouro AS endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa,
        modalidade_ensino_codigo AS mod_ens_codigo,
        -- Transformação da SÉRIE
        CASE
            -- Ensino Fundamental (1º ao 9º)
            WHEN serie LIKE '%1 ANO%' OR serie LIKE '%1º ANO%' THEN '1º ANO'
            WHEN serie LIKE '%2 ANO%' OR serie LIKE '%2º ANO%' THEN '2º ANO'
            WHEN serie LIKE '%3 ANO%' OR serie LIKE '%3º ANO%' THEN '3º ANO'
            WHEN serie LIKE '%4 ANO%' OR serie LIKE '%4º ANO%' THEN '4º ANO'
            WHEN serie LIKE '%5 ANO%' OR serie LIKE '%5º ANO%' THEN '5º ANO'
            WHEN serie LIKE '%6 ANO%' OR serie LIKE '%6º ANO%' THEN '6º ANO'
            WHEN serie LIKE '%7 ANO%' OR serie LIKE '%7º ANO%' THEN '7º ANO'
            WHEN serie LIKE '%8 ANO%' OR serie LIKE '%8º ANO%' THEN '8º ANO'
            WHEN serie LIKE '%9 ANO%' OR serie LIKE '%9º ANO%' THEN '9º ANO'
            -- Educação Infantil (Berçário e Grupos)
            WHEN serie LIKE '%BER%' THEN 'BERÇARIO'
            WHEN serie LIKE '%GRUPO I%' OR serie LIKE '%GRUPO 1%' THEN 'GRUPO I'
            WHEN serie LIKE '%GRUPO II%' THEN 'GRUPO II'
            WHEN serie LIKE '%GRUPO III%' THEN 'GRUPO III'
            WHEN serie LIKE '%GRUPO IV%' THEN 'GRUPO IV'
            WHEN serie LIKE '%GRUPO V%' THEN 'GRUPO V'
            -- EJA (Módulos 1 ao 5) 
            WHEN serie LIKE '%1%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 1'
            WHEN serie LIKE '%2%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 2'
            WHEN serie LIKE '%3%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 3'
            WHEN serie LIKE '%4%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 4'
            WHEN serie LIKE '%5%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 5'
            WHEN serie LIKE '%TRAVESSIA%' THEN 'TRAVESSIA RECIFE'
            WHEN serie LIKE '%CORRECAO%1%' THEN 'CORREÇÃO DE FLUXO 1 - ALFABETIZACAO'
            WHEN serie LIKE '%CORRECAO%2%' THEN 'CORREÇÃO DE FLUXO 2 - ACELERACAO'
            ELSE 'OUTROS'
        END AS serie,
        turma,
        turno,
        idade,
        -- transformação do SEXO
        CASE
            WHEN sexo = '1' THEN 'Masculino'
            WHEN sexo = '2' THEN 'Feminino'
            WHEN sexo = '3' THEN 'Outros'
            ELSE 'Não informado'
        END AS sexo,
        -- transformação de situacao
        CASE 
            WHEN situacao_nome LIKE '%APROV%' THEN 'Aprovado'
            WHEN situacao_nome LIKE '%RET%' OR situacao_nome LIKE '%REPRO%' THEN 'Reprovado'
            WHEN situacao_nome LIKE '%TR%' OR situacao_nome LIKE '%REMAN%' THEN 'Transferido'
            WHEN situacao_nome LIKE '%DESIST%' THEN 'Desistente'
            ELSE 'Outros'
        END AS sit_nome,
        -- Transformação da MODALIDADE
        CASE
            WHEN modalidade_ensino LIKE '%EDUCACAO INFANTIL%' THEN 'EDUCAÇÃO INFANTIL'
            WHEN modalidade_ensino LIKE '%ENSINO FUNDAMENTAL%' THEN 'ENSINO FUNDAMENTAL'
            WHEN modalidade_ensino LIKE '%EDUCACAO JOVENS E ADULTOS%' THEN 'EJA'
            WHEN modalidade_ensino LIKE '%CORRE%' THEN 'CORREÇÃO DE FLUXO'
            ELSE 'OUTROS'
        END AS modalidade_ens
    FROM source
)

SELECT * FROM cleaning_renaming
  );
  
[0m17:48:39.892383 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging.staging_alunos_raw" does not exist
LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."stagi...
                           ^

[0m17:48:39.893149 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: ROLLBACK
[0m17:48:39.997276 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: Close
[0m17:48:40.000589 [debug] [Thread-1 (]: Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  relation "staging.staging_alunos_raw" does not exist
  LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."stagi...
                             ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m17:48:40.002085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e814310-0c06-45f9-a384-e0ad3689afbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d2eb3e23c0>]}
[0m17:48:40.002756 [error] [Thread-1 (]: 1 of 13 ERROR creating sql table model staging_staging.staging_situacao_alunos . [[31mERROR[0m in 1.11s]
[0m17:48:40.003386 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.staging_situacao_alunos
[0m17:48:40.004182 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.staging_situacao_alunos' to be skipped because of status 'error'.  Reason: Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  relation "staging.staging_alunos_raw" does not exist
  LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."stagi...
                             ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql.
[0m17:48:40.005498 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.transform_data
[0m17:48:40.006519 [info ] [Thread-1 (]: 2 of 13 SKIP relation staging_intermediate.transform_data ...................... [[33mSKIP[0m]
[0m17:48:40.007011 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.transform_data
[0m17:48:40.007981 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_aluno
[0m17:48:40.008399 [info ] [Thread-1 (]: 3 of 13 SKIP relation staging_dimensions.dim_aluno ............................. [[33mSKIP[0m]
[0m17:48:40.008941 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_aluno
[0m17:48:40.009411 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_escola
[0m17:48:40.009958 [info ] [Thread-1 (]: 4 of 13 SKIP relation staging_dimensions.dim_escola ............................ [[33mSKIP[0m]
[0m17:48:40.010464 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_escola
[0m17:48:40.011006 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_localizacao
[0m17:48:40.011549 [info ] [Thread-1 (]: 5 of 13 SKIP relation staging_dimensions.dim_localizacao ....................... [[33mSKIP[0m]
[0m17:48:40.012117 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_localizacao
[0m17:48:40.012568 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_situacao
[0m17:48:40.013140 [info ] [Thread-1 (]: 6 of 13 SKIP relation staging_dimensions.dim_situacao .......................... [[33mSKIP[0m]
[0m17:48:40.013782 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_situacao
[0m17:48:40.014396 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_tempo
[0m17:48:40.015087 [info ] [Thread-1 (]: 7 of 13 SKIP relation staging_dimensions.dim_tempo ............................. [[33mSKIP[0m]
[0m17:48:40.015652 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_tempo
[0m17:48:40.016123 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_turma
[0m17:48:40.016637 [info ] [Thread-1 (]: 8 of 13 SKIP relation staging_dimensions.dim_turma ............................. [[33mSKIP[0m]
[0m17:48:40.017120 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_turma
[0m17:48:40.017905 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.fato_matricula
[0m17:48:40.018380 [info ] [Thread-1 (]: 9 of 13 SKIP relation staging_facts.fato_matricula ............................. [[33mSKIP[0m]
[0m17:48:40.018866 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.fato_matricula
[0m17:48:40.019922 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_count_aluno_idade
[0m17:48:40.021084 [info ] [Thread-1 (]: 10 of 13 SKIP relation staging_marts.view_count_aluno_idade .................... [[33mSKIP[0m]
[0m17:48:40.021816 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_count_aluno_idade
[0m17:48:40.022397 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m17:48:40.023154 [info ] [Thread-1 (]: 11 of 13 SKIP relation staging_marts.view_frequencia_situacao_escola ........... [[33mSKIP[0m]
[0m17:48:40.023796 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m17:48:40.024488 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_matricula_detalhada
[0m17:48:40.025437 [info ] [Thread-1 (]: 12 of 13 SKIP relation staging_marts.view_matricula_detalhada .................. [[33mSKIP[0m]
[0m17:48:40.026358 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_matricula_detalhada
[0m17:48:40.027133 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_taxa_aprovados
[0m17:48:40.027825 [info ] [Thread-1 (]: 13 of 13 SKIP relation staging_marts.view_taxa_aprovados ....................... [[33mSKIP[0m]
[0m17:48:40.028506 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_taxa_aprovados
[0m17:48:40.030116 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:40.030689 [debug] [MainThread]: On master: BEGIN
[0m17:48:40.031127 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:48:40.882066 [debug] [MainThread]: SQL status: BEGIN in 0.851 seconds
[0m17:48:40.883012 [debug] [MainThread]: On master: COMMIT
[0m17:48:40.883717 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:40.884063 [debug] [MainThread]: On master: COMMIT
[0m17:48:40.987831 [debug] [MainThread]: SQL status: COMMIT in 0.103 seconds
[0m17:48:40.988827 [debug] [MainThread]: On master: Close
[0m17:48:40.989964 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:48:40.990357 [debug] [MainThread]: Connection 'model.transformacao_matricula.staging_situacao_alunos' was properly closed.
[0m17:48:40.990772 [info ] [MainThread]: 
[0m17:48:40.991134 [info ] [MainThread]: Finished running 9 table models, 4 view models in 0 hours 0 minutes and 18.51 seconds (18.51s).
[0m17:48:40.992001 [debug] [MainThread]: Command end result
[0m17:48:41.018287 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m17:48:41.020790 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m17:48:41.027585 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m17:48:41.028325 [info ] [MainThread]: 
[0m17:48:41.029000 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:48:41.029589 [info ] [MainThread]: 
[0m17:48:41.030270 [error] [MainThread]: [31mFailure in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)[0m
[0m17:48:41.030946 [error] [MainThread]:   Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  relation "staging.staging_alunos_raw" does not exist
  LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."stagi...
                             ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m17:48:41.031576 [info ] [MainThread]: 
[0m17:48:41.032222 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m17:48:41.032806 [info ] [MainThread]: 
[0m17:48:41.033397 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=12 NO-OP=0 TOTAL=13
[0m17:48:41.035032 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 19.1223, "process_in_blocks": "14520", "process_kernel_time": 0.373399, "process_mem_max_rss": "124464", "process_out_blocks": "2576", "process_user_time": 1.776901}
[0m17:48:41.035815 [debug] [MainThread]: Command `dbt run` failed at 17:48:41.035716 after 19.12 seconds
[0m17:48:41.036474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d2f198c230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d2ef270260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d2ecb688c0>]}
[0m17:48:41.037138 [debug] [MainThread]: Flushing usage events
[0m17:48:41.584455 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:48:49.283337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3bc5dc0860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3bc5c00aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3bc5d2a810>]}


============================== 17:48:49.286473 | e0c852bf-a03a-4637-b258-4a4c67b7d461 ==============================
[0m17:48:49.286473 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:48:49.287048 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_experimental_parser': 'False', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'write_json': 'True', 'quiet': 'False', 'profiles_dir': '/home/murilo/.dbt', 'version_check': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'invocation_command': 'dbt test', 'debug': 'False', 'partial_parse': 'True', 'log_format': 'default', 'empty': 'None', 'printer_width': '80', 'no_print': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m17:48:49.426148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0c852bf-a03a-4637-b258-4a4c67b7d461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3bc49473e0>]}
[0m17:48:49.475595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0c852bf-a03a-4637-b258-4a4c67b7d461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3bc61403b0>]}
[0m17:48:49.476551 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:48:49.586036 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m17:48:49.682464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:48:49.682992 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:48:49.719809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0c852bf-a03a-4637-b258-4a4c67b7d461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3bc4973e60>]}
[0m17:48:49.792513 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m17:48:49.794265 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m17:48:49.817013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0c852bf-a03a-4637-b258-4a4c67b7d461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3bc3104290>]}
[0m17:48:49.817570 [info ] [MainThread]: Found 13 models, 37 data tests, 1 source, 459 macros
[0m17:48:49.817977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0c852bf-a03a-4637-b258-4a4c67b7d461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3bc4537e90>]}
[0m17:48:49.821047 [info ] [MainThread]: 
[0m17:48:49.821622 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m17:48:49.821987 [info ] [MainThread]: 
[0m17:48:49.822487 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:48:49.826418 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula_staging_marts'
[0m17:48:49.869381 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m17:48:49.869930 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: BEGIN
[0m17:48:49.870376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:51.231721 [debug] [ThreadPool]: SQL status: BEGIN in 1.361 seconds
[0m17:48:51.232530 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m17:48:51.232877 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_marts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m17:48:51.340126 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.107 seconds
[0m17:48:51.342135 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: ROLLBACK
[0m17:48:51.447808 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: Close
[0m17:48:51.449213 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_marts, now list_transformacao_matricula_staging_intermediate)
[0m17:48:51.451211 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_intermediate"
[0m17:48:51.451644 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: BEGIN
[0m17:48:51.451956 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:52.285400 [debug] [ThreadPool]: SQL status: BEGIN in 0.833 seconds
[0m17:48:52.286245 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_intermediate"
[0m17:48:52.286591 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_intermediate"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_intermediate'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_intermediate'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_intermediate'
  
[0m17:48:52.389011 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.102 seconds
[0m17:48:52.390174 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: ROLLBACK
[0m17:48:52.492072 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: Close
[0m17:48:52.493121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_intermediate, now list_transformacao_matricula_staging_facts)
[0m17:48:52.495303 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_facts"
[0m17:48:52.495754 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: BEGIN
[0m17:48:52.496058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:53.335085 [debug] [ThreadPool]: SQL status: BEGIN in 0.839 seconds
[0m17:48:53.336088 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_facts"
[0m17:48:53.336986 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_facts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_facts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_facts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_facts'
  
[0m17:48:53.440748 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.103 seconds
[0m17:48:53.443329 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: ROLLBACK
[0m17:48:53.545963 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: Close
[0m17:48:53.547149 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_facts, now list_transformacao_matricula_staging_dimensions)
[0m17:48:53.549745 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_dimensions"
[0m17:48:53.550707 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: BEGIN
[0m17:48:53.551308 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:54.386885 [debug] [ThreadPool]: SQL status: BEGIN in 0.835 seconds
[0m17:48:54.387629 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_dimensions"
[0m17:48:54.388063 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_dimensions"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dimensions'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dimensions'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dimensions'
  
[0m17:48:54.491138 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.103 seconds
[0m17:48:54.492465 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: ROLLBACK
[0m17:48:54.594327 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: Close
[0m17:48:54.595439 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_dimensions, now list_transformacao_matricula_staging_staging)
[0m17:48:54.597564 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m17:48:54.598015 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: BEGIN
[0m17:48:54.598322 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:55.436139 [debug] [ThreadPool]: SQL status: BEGIN in 0.838 seconds
[0m17:48:55.437026 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m17:48:55.437559 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_staging"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m17:48:55.541956 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.104 seconds
[0m17:48:55.543697 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: ROLLBACK
[0m17:48:55.646071 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: Close
[0m17:48:55.651223 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:55.651826 [debug] [MainThread]: On master: BEGIN
[0m17:48:55.652258 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:48:56.506059 [debug] [MainThread]: SQL status: BEGIN in 0.854 seconds
[0m17:48:56.506567 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:56.507000 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:48:56.613123 [debug] [MainThread]: SQL status: SELECT 0 in 0.106 seconds
[0m17:48:56.614847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0c852bf-a03a-4637-b258-4a4c67b7d461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3bc20381d0>]}
[0m17:48:56.615351 [debug] [MainThread]: On master: ROLLBACK
[0m17:48:56.719973 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:56.720851 [debug] [MainThread]: On master: BEGIN
[0m17:48:56.929964 [debug] [MainThread]: SQL status: BEGIN in 0.208 seconds
[0m17:48:56.930589 [debug] [MainThread]: On master: COMMIT
[0m17:48:56.930999 [debug] [MainThread]: Using postgres connection "master"
[0m17:48:56.931791 [debug] [MainThread]: On master: COMMIT
[0m17:48:57.036658 [debug] [MainThread]: SQL status: COMMIT in 0.104 seconds
[0m17:48:57.037402 [debug] [MainThread]: On master: Close
[0m17:48:57.040816 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f
[0m17:48:57.041501 [info ] [Thread-1 (]: 1 of 37 START test not_null_dim_aluno_id_aluno ................................. [RUN]
[0m17:48:57.041990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_staging, now test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f)
[0m17:48:57.042395 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f
[0m17:48:57.056920 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f"
[0m17:48:57.057671 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f
[0m17:48:57.078388 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f"
[0m17:48:57.079410 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f"
[0m17:48:57.080065 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f: BEGIN
[0m17:48:57.080718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:57.919968 [debug] [Thread-1 (]: SQL status: BEGIN in 0.839 seconds
[0m17:48:57.920460 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f"
[0m17:48:57.920846 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_aluno
from "transformacao_matricula"."staging_dimensions"."dim_aluno"
where id_aluno is null



  
  
      
    ) dbt_internal_test
[0m17:48:58.024212 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_dimensions.dim_aluno" does not exist
LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_alu...
              ^

[0m17:48:58.024786 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f: ROLLBACK
[0m17:48:58.127654 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f: Close
[0m17:48:58.136819 [debug] [Thread-1 (]: Database Error in test not_null_dim_aluno_id_aluno (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_aluno" does not exist
  LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_alu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_aluno_id_aluno.sql
[0m17:48:58.137540 [error] [Thread-1 (]: 1 of 37 ERROR not_null_dim_aluno_id_aluno ...................................... [[31mERROR[0m in 1.10s]
[0m17:48:58.138183 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f
[0m17:48:58.138591 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432
[0m17:48:58.138987 [info ] [Thread-1 (]: 2 of 37 START test not_null_dim_aluno_matricula ................................ [RUN]
[0m17:48:58.139439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f, now test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432)
[0m17:48:58.139825 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432
[0m17:48:58.140487 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.not_null_dim_aluno_id_aluno.2069a9964f' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_aluno_id_aluno (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_aluno" does not exist
  LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_alu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_aluno_id_aluno.sql.
[0m17:48:58.145265 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432"
[0m17:48:58.146888 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432
[0m17:48:58.149432 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432"
[0m17:48:58.150210 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432"
[0m17:48:58.150662 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432: BEGIN
[0m17:48:58.151094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:59.008354 [debug] [Thread-1 (]: SQL status: BEGIN in 0.857 seconds
[0m17:48:59.009103 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432"
[0m17:48:59.009468 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select matricula
from "transformacao_matricula"."staging_dimensions"."dim_aluno"
where matricula is null



  
  
      
    ) dbt_internal_test
[0m17:48:59.117236 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_dimensions.dim_aluno" does not exist
LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_alu...
              ^

[0m17:48:59.117931 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432: ROLLBACK
[0m17:48:59.222665 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432: Close
[0m17:48:59.225225 [debug] [Thread-1 (]: Database Error in test not_null_dim_aluno_matricula (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_aluno" does not exist
  LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_alu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_aluno_matricula.sql
[0m17:48:59.225924 [error] [Thread-1 (]: 2 of 37 ERROR not_null_dim_aluno_matricula ..................................... [[31mERROR[0m in 1.09s]
[0m17:48:59.226552 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432
[0m17:48:59.226999 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0
[0m17:48:59.227766 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_aluno_matricula (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_aluno" does not exist
  LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_alu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_aluno_matricula.sql.
[0m17:48:59.228458 [info ] [Thread-1 (]: 3 of 37 START test not_null_dim_escola_codigo_escola ........................... [RUN]
[0m17:48:59.229153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_dim_aluno_matricula.4c060de432, now test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0)
[0m17:48:59.229568 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0
[0m17:48:59.233088 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0"
[0m17:48:59.233849 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0
[0m17:48:59.236354 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0"
[0m17:48:59.237081 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0"
[0m17:48:59.237465 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0: BEGIN
[0m17:48:59.237835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:00.075908 [debug] [Thread-1 (]: SQL status: BEGIN in 0.838 seconds
[0m17:49:00.076602 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0"
[0m17:49:00.078567 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select codigo_escola
from "transformacao_matricula"."staging_dimensions"."dim_escola"
where codigo_escola is null



  
  
      
    ) dbt_internal_test
[0m17:49:00.181464 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_dimensions.dim_escola" does not exist
LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_esc...
              ^

[0m17:49:00.181984 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0: ROLLBACK
[0m17:49:00.284820 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0: Close
[0m17:49:00.287291 [debug] [Thread-1 (]: Database Error in test not_null_dim_escola_codigo_escola (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_escola" does not exist
  LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_esc...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_escola_codigo_escola.sql
[0m17:49:00.287877 [error] [Thread-1 (]: 3 of 37 ERROR not_null_dim_escola_codigo_escola ................................ [[31mERROR[0m in 1.06s]
[0m17:49:00.288411 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0
[0m17:49:00.288807 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651
[0m17:49:00.289171 [info ] [Thread-1 (]: 4 of 37 START test not_null_dim_escola_id_escola ............................... [RUN]
[0m17:49:00.289622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0, now test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651)
[0m17:49:00.290312 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.not_null_dim_escola_codigo_escola.8024fd11c0' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_escola_codigo_escola (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_escola" does not exist
  LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_esc...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_escola_codigo_escola.sql.
[0m17:49:00.290736 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651
[0m17:49:00.295178 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651"
[0m17:49:00.296028 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651
[0m17:49:00.298743 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651"
[0m17:49:00.299456 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651"
[0m17:49:00.299937 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651: BEGIN
[0m17:49:00.300307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:01.154093 [debug] [Thread-1 (]: SQL status: BEGIN in 0.854 seconds
[0m17:49:01.154941 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651"
[0m17:49:01.155583 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_escola
from "transformacao_matricula"."staging_dimensions"."dim_escola"
where id_escola is null



  
  
      
    ) dbt_internal_test
[0m17:49:01.260492 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_dimensions.dim_escola" does not exist
LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_esc...
              ^

[0m17:49:01.261321 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651: ROLLBACK
[0m17:49:01.365752 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651: Close
[0m17:49:01.368255 [debug] [Thread-1 (]: Database Error in test not_null_dim_escola_id_escola (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_escola" does not exist
  LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_esc...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_escola_id_escola.sql
[0m17:49:01.368883 [error] [Thread-1 (]: 4 of 37 ERROR not_null_dim_escola_id_escola .................................... [[31mERROR[0m in 1.08s]
[0m17:49:01.369452 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651
[0m17:49:01.369879 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6
[0m17:49:01.370347 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_escola_id_escola (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_escola" does not exist
  LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_esc...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_escola_id_escola.sql.
[0m17:49:01.370734 [info ] [Thread-1 (]: 5 of 37 START test not_null_dim_localizacao_id_locali .......................... [RUN]
[0m17:49:01.371328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_dim_escola_id_escola.f7fc302651, now test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6)
[0m17:49:01.371720 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6
[0m17:49:01.375127 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6"
[0m17:49:01.375801 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6
[0m17:49:01.377919 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6"
[0m17:49:01.378633 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6"
[0m17:49:01.379014 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6: BEGIN
[0m17:49:01.379359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:02.220331 [debug] [Thread-1 (]: SQL status: BEGIN in 0.841 seconds
[0m17:49:02.220905 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6"
[0m17:49:02.221381 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_locali
from "transformacao_matricula"."staging_dimensions"."dim_localizacao"
where id_locali is null



  
  
      
    ) dbt_internal_test
[0m17:49:02.324204 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_dimensions.dim_localizacao" does not exist
LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_loc...
              ^

[0m17:49:02.325146 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6: ROLLBACK
[0m17:49:02.427787 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6: Close
[0m17:49:02.430387 [debug] [Thread-1 (]: Database Error in test not_null_dim_localizacao_id_locali (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_localizacao" does not exist
  LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_loc...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_localizacao_id_locali.sql
[0m17:49:02.430981 [error] [Thread-1 (]: 5 of 37 ERROR not_null_dim_localizacao_id_locali ............................... [[31mERROR[0m in 1.06s]
[0m17:49:02.431506 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6
[0m17:49:02.431906 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0
[0m17:49:02.432270 [info ] [Thread-1 (]: 6 of 37 START test not_null_dim_situacao_id_situacao ........................... [RUN]
[0m17:49:02.432718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6, now test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0)
[0m17:49:02.433084 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0
[0m17:49:02.433548 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.not_null_dim_localizacao_id_locali.1efabdfaa6' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_localizacao_id_locali (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_localizacao" does not exist
  LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_loc...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_localizacao_id_locali.sql.
[0m17:49:02.437547 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0"
[0m17:49:02.438431 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0
[0m17:49:02.440771 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0"
[0m17:49:02.441438 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0"
[0m17:49:02.441862 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0: BEGIN
[0m17:49:02.442242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:03.294699 [debug] [Thread-1 (]: SQL status: BEGIN in 0.852 seconds
[0m17:49:03.295430 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0"
[0m17:49:03.295961 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_situacao
from "transformacao_matricula"."staging_dimensions"."dim_situacao"
where id_situacao is null



  
  
      
    ) dbt_internal_test
[0m17:49:03.400290 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_dimensions.dim_situacao" does not exist
LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_sit...
              ^

[0m17:49:03.400872 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0: ROLLBACK
[0m17:49:03.504929 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0: Close
[0m17:49:03.507359 [debug] [Thread-1 (]: Database Error in test not_null_dim_situacao_id_situacao (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_situacao" does not exist
  LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_sit...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_situacao_id_situacao.sql
[0m17:49:03.507982 [error] [Thread-1 (]: 6 of 37 ERROR not_null_dim_situacao_id_situacao ................................ [[31mERROR[0m in 1.08s]
[0m17:49:03.508531 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0
[0m17:49:03.508959 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82
[0m17:49:03.509429 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_situacao_id_situacao (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_situacao" does not exist
  LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_sit...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_situacao_id_situacao.sql.
[0m17:49:03.509830 [info ] [Thread-1 (]: 7 of 37 START test not_null_dim_situacao_situacao_nome ......................... [RUN]
[0m17:49:03.510456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_dim_situacao_id_situacao.c8830046e0, now test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82)
[0m17:49:03.510857 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82
[0m17:49:03.517226 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82"
[0m17:49:03.517916 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82
[0m17:49:03.604344 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82"
[0m17:49:03.605168 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82"
[0m17:49:03.605586 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82: BEGIN
[0m17:49:03.605977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:04.451284 [debug] [Thread-1 (]: SQL status: BEGIN in 0.845 seconds
[0m17:49:04.451893 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82"
[0m17:49:04.452439 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select situacao_nome
from "transformacao_matricula"."staging_dimensions"."dim_situacao"
where situacao_nome is null



  
  
      
    ) dbt_internal_test
[0m17:49:04.554489 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_dimensions.dim_situacao" does not exist
LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_sit...
              ^

[0m17:49:04.555006 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82: ROLLBACK
[0m17:49:04.657109 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82: Close
[0m17:49:04.659906 [debug] [Thread-1 (]: Database Error in test not_null_dim_situacao_situacao_nome (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_situacao" does not exist
  LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_sit...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_situacao_situacao_nome.sql
[0m17:49:04.660468 [error] [Thread-1 (]: 7 of 37 ERROR not_null_dim_situacao_situacao_nome .............................. [[31mERROR[0m in 1.15s]
[0m17:49:04.661032 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82
[0m17:49:04.661433 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6
[0m17:49:04.661908 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_situacao_situacao_nome (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_situacao" does not exist
  LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_sit...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_situacao_situacao_nome.sql.
[0m17:49:04.662281 [info ] [Thread-1 (]: 8 of 37 START test not_null_dim_tempo_ano ...................................... [RUN]
[0m17:49:04.662905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_dim_situacao_situacao_nome.945ae49f82, now test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6)
[0m17:49:04.663297 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6
[0m17:49:04.666702 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6"
[0m17:49:04.667344 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6
[0m17:49:04.669462 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6"
[0m17:49:04.670114 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6"
[0m17:49:04.670597 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6: BEGIN
[0m17:49:04.671022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:05.566081 [debug] [Thread-1 (]: SQL status: BEGIN in 0.895 seconds
[0m17:49:05.566682 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6"
[0m17:49:05.567066 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ano
from "transformacao_matricula"."staging_dimensions"."dim_tempo"
where ano is null



  
  
      
    ) dbt_internal_test
[0m17:49:05.683112 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_dimensions.dim_tempo" does not exist
LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_tem...
              ^

[0m17:49:05.683888 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6: ROLLBACK
[0m17:49:05.793115 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6: Close
[0m17:49:05.795860 [debug] [Thread-1 (]: Database Error in test not_null_dim_tempo_ano (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_tempo" does not exist
  LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_tem...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_tempo_ano.sql
[0m17:49:05.796527 [error] [Thread-1 (]: 8 of 37 ERROR not_null_dim_tempo_ano ........................................... [[31mERROR[0m in 1.13s]
[0m17:49:05.797105 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6
[0m17:49:05.797509 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3
[0m17:49:05.797994 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_tempo_ano (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_tempo" does not exist
  LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_tem...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_tempo_ano.sql.
[0m17:49:05.798369 [info ] [Thread-1 (]: 9 of 37 START test not_null_dim_tempo_id_tempo ................................. [RUN]
[0m17:49:05.799050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_dim_tempo_ano.3f823cffe6, now test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3)
[0m17:49:05.799440 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3
[0m17:49:05.803053 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3"
[0m17:49:05.803867 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3
[0m17:49:05.806151 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3"
[0m17:49:05.806884 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3"
[0m17:49:05.807264 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3: BEGIN
[0m17:49:05.807599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:06.684300 [debug] [Thread-1 (]: SQL status: BEGIN in 0.877 seconds
[0m17:49:06.685389 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3"
[0m17:49:06.685893 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_tempo
from "transformacao_matricula"."staging_dimensions"."dim_tempo"
where id_tempo is null



  
  
      
    ) dbt_internal_test
[0m17:49:06.795431 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_dimensions.dim_tempo" does not exist
LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_tem...
              ^

[0m17:49:06.796010 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3: ROLLBACK
[0m17:49:06.903336 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3: Close
[0m17:49:06.906023 [debug] [Thread-1 (]: Database Error in test not_null_dim_tempo_id_tempo (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_tempo" does not exist
  LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_tem...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_tempo_id_tempo.sql
[0m17:49:06.906681 [error] [Thread-1 (]: 9 of 37 ERROR not_null_dim_tempo_id_tempo ...................................... [[31mERROR[0m in 1.11s]
[0m17:49:06.907263 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3
[0m17:49:06.907684 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20
[0m17:49:06.908171 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_tempo_id_tempo (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_tempo" does not exist
  LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_tem...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_tempo_id_tempo.sql.
[0m17:49:06.908549 [info ] [Thread-1 (]: 10 of 37 START test not_null_dim_turma_id_turma ................................ [RUN]
[0m17:49:06.909193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_dim_tempo_id_tempo.c53e3e87d3, now test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20)
[0m17:49:06.909586 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20
[0m17:49:06.912897 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20"
[0m17:49:06.913576 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20
[0m17:49:06.915945 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20"
[0m17:49:06.916677 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20"
[0m17:49:06.917068 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20: BEGIN
[0m17:49:06.917418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:08.273243 [debug] [Thread-1 (]: SQL status: BEGIN in 1.356 seconds
[0m17:49:08.273996 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20"
[0m17:49:08.274425 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_turma
from "transformacao_matricula"."staging_dimensions"."dim_turma"
where id_turma is null



  
  
      
    ) dbt_internal_test
[0m17:49:08.515392 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_dimensions.dim_turma" does not exist
LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_tur...
              ^

[0m17:49:08.516034 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20: ROLLBACK
[0m17:49:08.720993 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20: Close
[0m17:49:08.723292 [debug] [Thread-1 (]: Database Error in test not_null_dim_turma_id_turma (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_turma" does not exist
  LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_tur...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_turma_id_turma.sql
[0m17:49:08.723862 [error] [Thread-1 (]: 10 of 37 ERROR not_null_dim_turma_id_turma ..................................... [[31mERROR[0m in 1.81s]
[0m17:49:08.724421 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20
[0m17:49:08.724831 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164
[0m17:49:08.725205 [info ] [Thread-1 (]: 11 of 37 START test not_null_fato_matricula_id_aluno ........................... [RUN]
[0m17:49:08.725667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20, now test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164)
[0m17:49:08.726049 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164
[0m17:49:08.726535 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.not_null_dim_turma_id_turma.1fbb16ec20' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_turma_id_turma (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_turma" does not exist
  LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_tur...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_turma_id_turma.sql.
[0m17:49:08.730395 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164"
[0m17:49:08.731379 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164
[0m17:49:08.733420 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164"
[0m17:49:08.734139 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164"
[0m17:49:08.734519 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164: BEGIN
[0m17:49:08.734883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:09.613858 [debug] [Thread-1 (]: SQL status: BEGIN in 0.879 seconds
[0m17:49:09.614903 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164"
[0m17:49:09.615327 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_aluno
from "transformacao_matricula"."staging_facts"."fato_matricula"
where id_aluno is null



  
  
      
    ) dbt_internal_test
[0m17:49:09.717286 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_facts.fato_matricula" does not exist
LINE 17: from "transformacao_matricula"."staging_facts"."fato_matricu...
              ^

[0m17:49:09.717811 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164: ROLLBACK
[0m17:49:10.158401 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164: Close
[0m17:49:10.160616 [debug] [Thread-1 (]: Database Error in test not_null_fato_matricula_id_aluno (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 17: from "transformacao_matricula"."staging_facts"."fato_matricu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_fato_matricula_id_aluno.sql
[0m17:49:10.161160 [error] [Thread-1 (]: 11 of 37 ERROR not_null_fato_matricula_id_aluno ................................ [[31mERROR[0m in 1.44s]
[0m17:49:10.161756 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164
[0m17:49:10.162188 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66
[0m17:49:10.162555 [info ] [Thread-1 (]: 12 of 37 START test not_null_fato_matricula_id_escola .......................... [RUN]
[0m17:49:10.163043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164, now test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66)
[0m17:49:10.163545 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.not_null_fato_matricula_id_aluno.37a4081164' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fato_matricula_id_aluno (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 17: from "transformacao_matricula"."staging_facts"."fato_matricu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_fato_matricula_id_aluno.sql.
[0m17:49:10.163957 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66
[0m17:49:10.167430 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66"
[0m17:49:10.168173 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66
[0m17:49:10.172037 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66"
[0m17:49:10.172764 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66"
[0m17:49:10.173175 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66: BEGIN
[0m17:49:10.173542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:11.013699 [debug] [Thread-1 (]: SQL status: BEGIN in 0.840 seconds
[0m17:49:11.014227 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66"
[0m17:49:11.014692 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_escola
from "transformacao_matricula"."staging_facts"."fato_matricula"
where id_escola is null



  
  
      
    ) dbt_internal_test
[0m17:49:11.119213 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_facts.fato_matricula" does not exist
LINE 17: from "transformacao_matricula"."staging_facts"."fato_matricu...
              ^

[0m17:49:11.119783 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66: ROLLBACK
[0m17:49:11.222040 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66: Close
[0m17:49:11.224383 [debug] [Thread-1 (]: Database Error in test not_null_fato_matricula_id_escola (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 17: from "transformacao_matricula"."staging_facts"."fato_matricu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_fato_matricula_id_escola.sql
[0m17:49:11.225169 [error] [Thread-1 (]: 12 of 37 ERROR not_null_fato_matricula_id_escola ............................... [[31mERROR[0m in 1.06s]
[0m17:49:11.225845 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66
[0m17:49:11.226263 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e
[0m17:49:11.226810 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fato_matricula_id_escola (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 17: from "transformacao_matricula"."staging_facts"."fato_matricu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_fato_matricula_id_escola.sql.
[0m17:49:11.227221 [info ] [Thread-1 (]: 13 of 37 START test not_null_fato_matricula_id_locali .......................... [RUN]
[0m17:49:11.227917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_fato_matricula_id_escola.030a917c66, now test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e)
[0m17:49:11.228345 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e
[0m17:49:11.233010 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e"
[0m17:49:11.234033 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e
[0m17:49:11.236783 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e"
[0m17:49:11.237520 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e"
[0m17:49:11.238040 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e: BEGIN
[0m17:49:11.238439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:12.075829 [debug] [Thread-1 (]: SQL status: BEGIN in 0.837 seconds
[0m17:49:12.076338 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e"
[0m17:49:12.076774 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_locali
from "transformacao_matricula"."staging_facts"."fato_matricula"
where id_locali is null



  
  
      
    ) dbt_internal_test
[0m17:49:12.182466 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_facts.fato_matricula" does not exist
LINE 17: from "transformacao_matricula"."staging_facts"."fato_matricu...
              ^

[0m17:49:12.183476 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e: ROLLBACK
[0m17:49:12.286281 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e: Close
[0m17:49:12.288625 [debug] [Thread-1 (]: Database Error in test not_null_fato_matricula_id_locali (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 17: from "transformacao_matricula"."staging_facts"."fato_matricu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_fato_matricula_id_locali.sql
[0m17:49:12.289235 [error] [Thread-1 (]: 13 of 37 ERROR not_null_fato_matricula_id_locali ............................... [[31mERROR[0m in 1.06s]
[0m17:49:12.289821 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e
[0m17:49:12.290256 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86
[0m17:49:12.290759 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fato_matricula_id_locali (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 17: from "transformacao_matricula"."staging_facts"."fato_matricu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_fato_matricula_id_locali.sql.
[0m17:49:12.291166 [info ] [Thread-1 (]: 14 of 37 START test not_null_fato_matricula_id_situacao ........................ [RUN]
[0m17:49:12.291994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_fato_matricula_id_locali.6e8da3159e, now test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86)
[0m17:49:12.292437 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86
[0m17:49:12.296018 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86"
[0m17:49:12.296765 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86
[0m17:49:12.298999 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86"
[0m17:49:12.299851 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86"
[0m17:49:12.300570 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86: BEGIN
[0m17:49:12.301116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:13.142946 [debug] [Thread-1 (]: SQL status: BEGIN in 0.842 seconds
[0m17:49:13.143967 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86"
[0m17:49:13.144660 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_situacao
from "transformacao_matricula"."staging_facts"."fato_matricula"
where id_situacao is null



  
  
      
    ) dbt_internal_test
[0m17:49:13.247086 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_facts.fato_matricula" does not exist
LINE 17: from "transformacao_matricula"."staging_facts"."fato_matricu...
              ^

[0m17:49:13.248111 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86: ROLLBACK
[0m17:49:13.350965 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86: Close
[0m17:49:13.353129 [debug] [Thread-1 (]: Database Error in test not_null_fato_matricula_id_situacao (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 17: from "transformacao_matricula"."staging_facts"."fato_matricu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_fato_matricula_id_situacao.sql
[0m17:49:13.353698 [error] [Thread-1 (]: 14 of 37 ERROR not_null_fato_matricula_id_situacao ............................. [[31mERROR[0m in 1.06s]
[0m17:49:13.354315 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86
[0m17:49:13.354825 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3
[0m17:49:13.355354 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fato_matricula_id_situacao (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 17: from "transformacao_matricula"."staging_facts"."fato_matricu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_fato_matricula_id_situacao.sql.
[0m17:49:13.355790 [info ] [Thread-1 (]: 15 of 37 START test not_null_fato_matricula_id_tempo ........................... [RUN]
[0m17:49:13.356529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_fato_matricula_id_situacao.8ed34ebf86, now test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3)
[0m17:49:13.357008 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3
[0m17:49:13.360741 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3"
[0m17:49:13.361431 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3
[0m17:49:13.363793 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3"
[0m17:49:13.364586 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3"
[0m17:49:13.365085 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3: BEGIN
[0m17:49:13.365516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:14.214600 [debug] [Thread-1 (]: SQL status: BEGIN in 0.849 seconds
[0m17:49:14.215669 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3"
[0m17:49:14.216618 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_tempo
from "transformacao_matricula"."staging_facts"."fato_matricula"
where id_tempo is null



  
  
      
    ) dbt_internal_test
[0m17:49:14.319902 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_facts.fato_matricula" does not exist
LINE 17: from "transformacao_matricula"."staging_facts"."fato_matricu...
              ^

[0m17:49:14.320748 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3: ROLLBACK
[0m17:49:14.423951 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3: Close
[0m17:49:14.426265 [debug] [Thread-1 (]: Database Error in test not_null_fato_matricula_id_tempo (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 17: from "transformacao_matricula"."staging_facts"."fato_matricu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_fato_matricula_id_tempo.sql
[0m17:49:14.426864 [error] [Thread-1 (]: 15 of 37 ERROR not_null_fato_matricula_id_tempo ................................ [[31mERROR[0m in 1.07s]
[0m17:49:14.427407 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3
[0m17:49:14.427805 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0
[0m17:49:14.428281 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fato_matricula_id_tempo (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 17: from "transformacao_matricula"."staging_facts"."fato_matricu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_fato_matricula_id_tempo.sql.
[0m17:49:14.428675 [info ] [Thread-1 (]: 16 of 37 START test not_null_fato_matricula_id_turma ........................... [RUN]
[0m17:49:14.429291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_fato_matricula_id_tempo.6a69e16ac3, now test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0)
[0m17:49:14.429689 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0
[0m17:49:14.433455 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0"
[0m17:49:14.434172 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0
[0m17:49:14.436694 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0"
[0m17:49:14.437563 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0"
[0m17:49:14.438107 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0: BEGIN
[0m17:49:14.438500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:15.293045 [debug] [Thread-1 (]: SQL status: BEGIN in 0.854 seconds
[0m17:49:15.294146 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0"
[0m17:49:15.294827 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id_turma
from "transformacao_matricula"."staging_facts"."fato_matricula"
where id_turma is null



  
  
      
    ) dbt_internal_test
[0m17:49:15.401974 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_facts.fato_matricula" does not exist
LINE 17: from "transformacao_matricula"."staging_facts"."fato_matricu...
              ^

[0m17:49:15.402912 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0: ROLLBACK
[0m17:49:15.507246 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0: Close
[0m17:49:15.509842 [debug] [Thread-1 (]: Database Error in test not_null_fato_matricula_id_turma (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 17: from "transformacao_matricula"."staging_facts"."fato_matricu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_fato_matricula_id_turma.sql
[0m17:49:15.510394 [error] [Thread-1 (]: 16 of 37 ERROR not_null_fato_matricula_id_turma ................................ [[31mERROR[0m in 1.08s]
[0m17:49:15.510955 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0
[0m17:49:15.511366 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439
[0m17:49:15.512043 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fato_matricula_id_turma (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 17: from "transformacao_matricula"."staging_facts"."fato_matricu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_fato_matricula_id_turma.sql.
[0m17:49:15.512631 [info ] [Thread-1 (]: 17 of 37 START test not_null_fato_matricula_matricula .......................... [RUN]
[0m17:49:15.513696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_fato_matricula_id_turma.0ae0f101e0, now test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439)
[0m17:49:15.514160 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439
[0m17:49:15.517646 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439"
[0m17:49:15.518349 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439
[0m17:49:15.520441 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439"
[0m17:49:15.521182 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439"
[0m17:49:15.521645 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439: BEGIN
[0m17:49:15.522022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:16.357165 [debug] [Thread-1 (]: SQL status: BEGIN in 0.835 seconds
[0m17:49:16.357687 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439"
[0m17:49:16.358081 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select matricula
from "transformacao_matricula"."staging_facts"."fato_matricula"
where matricula is null



  
  
      
    ) dbt_internal_test
[0m17:49:16.464421 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_facts.fato_matricula" does not exist
LINE 17: from "transformacao_matricula"."staging_facts"."fato_matricu...
              ^

[0m17:49:16.465363 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439: ROLLBACK
[0m17:49:16.567409 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439: Close
[0m17:49:16.573399 [debug] [Thread-1 (]: Database Error in test not_null_fato_matricula_matricula (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 17: from "transformacao_matricula"."staging_facts"."fato_matricu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_fato_matricula_matricula.sql
[0m17:49:16.574108 [error] [Thread-1 (]: 17 of 37 ERROR not_null_fato_matricula_matricula ............................... [[31mERROR[0m in 1.06s]
[0m17:49:16.574681 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439
[0m17:49:16.575074 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf
[0m17:49:16.575562 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fato_matricula_matricula (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 17: from "transformacao_matricula"."staging_facts"."fato_matricu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_fato_matricula_matricula.sql.
[0m17:49:16.575978 [info ] [Thread-1 (]: 18 of 37 START test not_null_staging_situacao_alunos_ano ....................... [RUN]
[0m17:49:16.576655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_fato_matricula_matricula.e2de78b439, now test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf)
[0m17:49:16.577090 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf
[0m17:49:16.581278 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf"
[0m17:49:16.581955 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf
[0m17:49:16.584533 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf"
[0m17:49:16.585672 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf"
[0m17:49:16.586337 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf: BEGIN
[0m17:49:16.586916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:17.463499 [debug] [Thread-1 (]: SQL status: BEGIN in 0.877 seconds
[0m17:49:17.464045 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf"
[0m17:49:17.464443 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ano
from "transformacao_matricula"."staging_staging"."staging_situacao_alunos"
where ano is null



  
  
      
    ) dbt_internal_test
[0m17:49:17.572099 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_staging.staging_situacao_alunos" does not exist
LINE 17: from "transformacao_matricula"."staging_staging"."staging_si...
              ^

[0m17:49:17.573088 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf: ROLLBACK
[0m17:49:17.680439 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf: Close
[0m17:49:17.683513 [debug] [Thread-1 (]: Database Error in test not_null_staging_situacao_alunos_ano (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_staging.staging_situacao_alunos" does not exist
  LINE 17: from "transformacao_matricula"."staging_staging"."staging_si...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_staging_situacao_alunos_ano.sql
[0m17:49:17.684109 [error] [Thread-1 (]: 18 of 37 ERROR not_null_staging_situacao_alunos_ano ............................ [[31mERROR[0m in 1.11s]
[0m17:49:17.684658 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf
[0m17:49:17.685049 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d
[0m17:49:17.685422 [info ] [Thread-1 (]: 19 of 37 START test not_null_staging_situacao_alunos_matricula ................. [RUN]
[0m17:49:17.685895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf, now test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d)
[0m17:49:17.686386 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.not_null_staging_situacao_alunos_ano.d04f69b3cf' to be skipped because of status 'error'.  Reason: Database Error in test not_null_staging_situacao_alunos_ano (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_staging.staging_situacao_alunos" does not exist
  LINE 17: from "transformacao_matricula"."staging_staging"."staging_si...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_staging_situacao_alunos_ano.sql.
[0m17:49:17.687022 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d
[0m17:49:17.691797 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d"
[0m17:49:17.692550 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d
[0m17:49:17.694913 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d"
[0m17:49:17.695622 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d"
[0m17:49:17.696044 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d: BEGIN
[0m17:49:17.696412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:18.535905 [debug] [Thread-1 (]: SQL status: BEGIN in 0.839 seconds
[0m17:49:18.536456 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d"
[0m17:49:18.536907 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select matricula
from "transformacao_matricula"."staging_staging"."staging_situacao_alunos"
where matricula is null



  
  
      
    ) dbt_internal_test
[0m17:49:18.639534 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_staging.staging_situacao_alunos" does not exist
LINE 17: from "transformacao_matricula"."staging_staging"."staging_si...
              ^

[0m17:49:18.640875 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d: ROLLBACK
[0m17:49:18.743834 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d: Close
[0m17:49:18.747093 [debug] [Thread-1 (]: Database Error in test not_null_staging_situacao_alunos_matricula (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_staging.staging_situacao_alunos" does not exist
  LINE 17: from "transformacao_matricula"."staging_staging"."staging_si...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_staging_situacao_alunos_matricula.sql
[0m17:49:18.747742 [error] [Thread-1 (]: 19 of 37 ERROR not_null_staging_situacao_alunos_matricula ...................... [[31mERROR[0m in 1.06s]
[0m17:49:18.748290 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d
[0m17:49:18.748794 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_transform_data_ano.10ed340507
[0m17:49:18.749484 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d' to be skipped because of status 'error'.  Reason: Database Error in test not_null_staging_situacao_alunos_matricula (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_staging.staging_situacao_alunos" does not exist
  LINE 17: from "transformacao_matricula"."staging_staging"."staging_si...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_staging_situacao_alunos_matricula.sql.
[0m17:49:18.750192 [info ] [Thread-1 (]: 20 of 37 START test not_null_transform_data_ano ................................ [RUN]
[0m17:49:18.750866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_staging_situacao_alunos_matricula.4fe7be5e7d, now test.transformacao_matricula.not_null_transform_data_ano.10ed340507)
[0m17:49:18.751299 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_transform_data_ano.10ed340507
[0m17:49:18.755373 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_transform_data_ano.10ed340507"
[0m17:49:18.756373 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_transform_data_ano.10ed340507
[0m17:49:18.758883 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_transform_data_ano.10ed340507"
[0m17:49:18.759727 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_transform_data_ano.10ed340507"
[0m17:49:18.760242 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_transform_data_ano.10ed340507: BEGIN
[0m17:49:18.760739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:19.654451 [debug] [Thread-1 (]: SQL status: BEGIN in 0.894 seconds
[0m17:49:19.654980 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_transform_data_ano.10ed340507"
[0m17:49:19.655401 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_transform_data_ano.10ed340507: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_transform_data_ano.10ed340507"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ano
from "transformacao_matricula"."staging_intermediate"."transform_data"
where ano is null



  
  
      
    ) dbt_internal_test
[0m17:49:19.765169 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_intermediate.transform_data" does not exist
LINE 17: from "transformacao_matricula"."staging_intermediate"."trans...
              ^

[0m17:49:19.766092 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_transform_data_ano.10ed340507: ROLLBACK
[0m17:49:19.878177 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_transform_data_ano.10ed340507: Close
[0m17:49:19.881297 [debug] [Thread-1 (]: Database Error in test not_null_transform_data_ano (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_intermediate.transform_data" does not exist
  LINE 17: from "transformacao_matricula"."staging_intermediate"."trans...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_transform_data_ano.sql
[0m17:49:19.881915 [error] [Thread-1 (]: 20 of 37 ERROR not_null_transform_data_ano ..................................... [[31mERROR[0m in 1.13s]
[0m17:49:19.882580 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_transform_data_ano.10ed340507
[0m17:49:19.883068 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8
[0m17:49:19.883535 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.not_null_transform_data_ano.10ed340507' to be skipped because of status 'error'.  Reason: Database Error in test not_null_transform_data_ano (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_intermediate.transform_data" does not exist
  LINE 17: from "transformacao_matricula"."staging_intermediate"."trans...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_transform_data_ano.sql.
[0m17:49:19.883991 [info ] [Thread-1 (]: 21 of 37 START test not_null_transform_data_matricula .......................... [RUN]
[0m17:49:19.884669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_transform_data_ano.10ed340507, now test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8)
[0m17:49:19.885122 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8
[0m17:49:19.889127 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8"
[0m17:49:19.889819 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8
[0m17:49:19.892199 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8"
[0m17:49:19.892966 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8"
[0m17:49:19.893371 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8: BEGIN
[0m17:49:19.893764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:20.764293 [debug] [Thread-1 (]: SQL status: BEGIN in 0.870 seconds
[0m17:49:20.765097 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8"
[0m17:49:20.765576 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select matricula
from "transformacao_matricula"."staging_intermediate"."transform_data"
where matricula is null



  
  
      
    ) dbt_internal_test
[0m17:49:20.873019 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_intermediate.transform_data" does not exist
LINE 17: from "transformacao_matricula"."staging_intermediate"."trans...
              ^

[0m17:49:20.873522 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8: ROLLBACK
[0m17:49:20.980834 [debug] [Thread-1 (]: On test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8: Close
[0m17:49:20.983295 [debug] [Thread-1 (]: Database Error in test not_null_transform_data_matricula (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_intermediate.transform_data" does not exist
  LINE 17: from "transformacao_matricula"."staging_intermediate"."trans...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_transform_data_matricula.sql
[0m17:49:20.983932 [error] [Thread-1 (]: 21 of 37 ERROR not_null_transform_data_matricula ............................... [[31mERROR[0m in 1.10s]
[0m17:49:20.984492 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8
[0m17:49:20.985145 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee
[0m17:49:20.985849 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8' to be skipped because of status 'error'.  Reason: Database Error in test not_null_transform_data_matricula (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_intermediate.transform_data" does not exist
  LINE 17: from "transformacao_matricula"."staging_intermediate"."trans...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_transform_data_matricula.sql.
[0m17:49:20.986281 [info ] [Thread-1 (]: 22 of 37 START test relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_  [RUN]
[0m17:49:20.987127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.not_null_transform_data_matricula.adaea3a8a8, now test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee)
[0m17:49:20.987667 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee
[0m17:49:20.994140 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee"
[0m17:49:20.994880 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee
[0m17:49:20.997103 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee"
[0m17:49:20.997831 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee"
[0m17:49:20.998230 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee: BEGIN
[0m17:49:20.998635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:21.883388 [debug] [Thread-1 (]: SQL status: BEGIN in 0.885 seconds
[0m17:49:21.883907 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee"
[0m17:49:21.884308 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select id_aluno as from_field
    from "transformacao_matricula"."staging_facts"."fato_matricula"
    where id_aluno is not null
),

parent as (
    select id_aluno as to_field
    from "transformacao_matricula"."staging_dimensions"."dim_aluno"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m17:49:21.991511 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_facts.fato_matricula" does not exist
LINE 16:     from "transformacao_matricula"."staging_facts"."fato_mat...
                  ^

[0m17:49:21.992541 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee: ROLLBACK
[0m17:49:22.101540 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee: Close
[0m17:49:22.104151 [debug] [Thread-1 (]: Database Error in test relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_ (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 16:     from "transformacao_matricula"."staging_facts"."fato_mat...
                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.sql
[0m17:49:22.104842 [error] [Thread-1 (]: 22 of 37 ERROR relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_ . [[31mERROR[0m in 1.12s]
[0m17:49:22.105539 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee
[0m17:49:22.106049 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb
[0m17:49:22.106526 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee' to be skipped because of status 'error'.  Reason: Database Error in test relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_ (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 16:     from "transformacao_matricula"."staging_facts"."fato_mat...
                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.sql.
[0m17:49:22.106968 [info ] [Thread-1 (]: 23 of 37 START test relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_  [RUN]
[0m17:49:22.107875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.73cda596ee, now test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb)
[0m17:49:22.108580 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb
[0m17:49:22.115461 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb"
[0m17:49:22.116238 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb
[0m17:49:22.118486 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb"
[0m17:49:22.119186 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb"
[0m17:49:22.119579 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb: BEGIN
[0m17:49:22.119941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:23.078412 [debug] [Thread-1 (]: SQL status: BEGIN in 0.958 seconds
[0m17:49:23.079283 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb"
[0m17:49:23.079713 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select id_escola as from_field
    from "transformacao_matricula"."staging_facts"."fato_matricula"
    where id_escola is not null
),

parent as (
    select id_escola as to_field
    from "transformacao_matricula"."staging_dimensions"."dim_escola"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m17:49:23.185493 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_facts.fato_matricula" does not exist
LINE 16:     from "transformacao_matricula"."staging_facts"."fato_mat...
                  ^

[0m17:49:23.186432 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb: ROLLBACK
[0m17:49:23.290237 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb: Close
[0m17:49:23.292569 [debug] [Thread-1 (]: Database Error in test relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_ (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 16:     from "transformacao_matricula"."staging_facts"."fato_mat...
                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/relationships_fato_matricula_9b2cc79a2ce28a50e4ab76e1ec454169.sql
[0m17:49:23.293186 [error] [Thread-1 (]: 23 of 37 ERROR relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_  [[31mERROR[0m in 1.19s]
[0m17:49:23.293820 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb
[0m17:49:23.294269 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a
[0m17:49:23.294774 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb' to be skipped because of status 'error'.  Reason: Database Error in test relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_ (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 16:     from "transformacao_matricula"."staging_facts"."fato_mat...
                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/relationships_fato_matricula_9b2cc79a2ce28a50e4ab76e1ec454169.sql.
[0m17:49:23.295236 [info ] [Thread-1 (]: 24 of 37 START test relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_  [RUN]
[0m17:49:23.296063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_.de0fa1bccb, now test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a)
[0m17:49:23.296531 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a
[0m17:49:23.301723 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a"
[0m17:49:23.302384 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a
[0m17:49:23.304811 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a"
[0m17:49:23.305503 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a"
[0m17:49:23.306006 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a: BEGIN
[0m17:49:23.306372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:24.158227 [debug] [Thread-1 (]: SQL status: BEGIN in 0.852 seconds
[0m17:49:24.159195 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a"
[0m17:49:24.159639 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select id_locali as from_field
    from "transformacao_matricula"."staging_facts"."fato_matricula"
    where id_locali is not null
),

parent as (
    select id_locali as to_field
    from "transformacao_matricula"."staging_dimensions"."dim_localizacao"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m17:49:24.264353 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_facts.fato_matricula" does not exist
LINE 16:     from "transformacao_matricula"."staging_facts"."fato_mat...
                  ^

[0m17:49:24.265315 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a: ROLLBACK
[0m17:49:24.370098 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a: Close
[0m17:49:24.372800 [debug] [Thread-1 (]: Database Error in test relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_ (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 16:     from "transformacao_matricula"."staging_facts"."fato_mat...
                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/relationships_fato_matricula_ba784d16ba791b8aca7f852415f3ff60.sql
[0m17:49:24.373413 [error] [Thread-1 (]: 24 of 37 ERROR relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_  [[31mERROR[0m in 1.08s]
[0m17:49:24.374041 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a
[0m17:49:24.374477 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315
[0m17:49:24.375382 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a' to be skipped because of status 'error'.  Reason: Database Error in test relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_ (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 16:     from "transformacao_matricula"."staging_facts"."fato_mat...
                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/relationships_fato_matricula_ba784d16ba791b8aca7f852415f3ff60.sql.
[0m17:49:24.375983 [info ] [Thread-1 (]: 25 of 37 START test relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_  [RUN]
[0m17:49:24.376893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_.d4aac1d87a, now test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315)
[0m17:49:24.377401 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315
[0m17:49:24.382228 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315"
[0m17:49:24.382930 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315
[0m17:49:24.385020 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315"
[0m17:49:24.385700 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315"
[0m17:49:24.386419 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315: BEGIN
[0m17:49:24.386978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:25.278682 [debug] [Thread-1 (]: SQL status: BEGIN in 0.891 seconds
[0m17:49:25.279485 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315"
[0m17:49:25.279922 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select id_situacao as from_field
    from "transformacao_matricula"."staging_facts"."fato_matricula"
    where id_situacao is not null
),

parent as (
    select id_situacao as to_field
    from "transformacao_matricula"."staging_dimensions"."dim_situacao"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m17:49:25.391856 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_facts.fato_matricula" does not exist
LINE 16:     from "transformacao_matricula"."staging_facts"."fato_mat...
                  ^

[0m17:49:25.392666 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315: ROLLBACK
[0m17:49:25.501987 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315: Close
[0m17:49:25.504703 [debug] [Thread-1 (]: Database Error in test relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_ (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 16:     from "transformacao_matricula"."staging_facts"."fato_mat...
                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/relationships_fato_matricula_8d96e5d559ecf908dfec477493d81116.sql
[0m17:49:25.505304 [error] [Thread-1 (]: 25 of 37 ERROR relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_  [[31mERROR[0m in 1.13s]
[0m17:49:25.505971 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315
[0m17:49:25.506472 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c
[0m17:49:25.507041 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315' to be skipped because of status 'error'.  Reason: Database Error in test relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_ (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 16:     from "transformacao_matricula"."staging_facts"."fato_mat...
                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/relationships_fato_matricula_8d96e5d559ecf908dfec477493d81116.sql.
[0m17:49:25.507526 [info ] [Thread-1 (]: 26 of 37 START test relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_  [RUN]
[0m17:49:25.508369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_.e64ddc6315, now test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c)
[0m17:49:25.508862 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c
[0m17:49:25.513472 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c"
[0m17:49:25.514164 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c
[0m17:49:25.516232 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c"
[0m17:49:25.516980 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c"
[0m17:49:25.517436 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c: BEGIN
[0m17:49:25.517860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:26.366847 [debug] [Thread-1 (]: SQL status: BEGIN in 0.849 seconds
[0m17:49:26.367392 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c"
[0m17:49:26.367855 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select id_tempo as from_field
    from "transformacao_matricula"."staging_facts"."fato_matricula"
    where id_tempo is not null
),

parent as (
    select id_tempo as to_field
    from "transformacao_matricula"."staging_dimensions"."dim_tempo"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m17:49:26.473324 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_facts.fato_matricula" does not exist
LINE 16:     from "transformacao_matricula"."staging_facts"."fato_mat...
                  ^

[0m17:49:26.474114 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c: ROLLBACK
[0m17:49:26.581071 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c: Close
[0m17:49:26.583672 [debug] [Thread-1 (]: Database Error in test relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_ (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 16:     from "transformacao_matricula"."staging_facts"."fato_mat...
                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.sql
[0m17:49:26.584296 [error] [Thread-1 (]: 26 of 37 ERROR relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_ . [[31mERROR[0m in 1.08s]
[0m17:49:26.585068 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c
[0m17:49:26.585568 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a
[0m17:49:26.586282 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c' to be skipped because of status 'error'.  Reason: Database Error in test relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_ (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 16:     from "transformacao_matricula"."staging_facts"."fato_mat...
                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.sql.
[0m17:49:26.587152 [info ] [Thread-1 (]: 27 of 37 START test relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_  [RUN]
[0m17:49:26.588256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.ffba6d533c, now test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a)
[0m17:49:26.588737 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a
[0m17:49:26.593524 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a"
[0m17:49:26.594287 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a
[0m17:49:26.596652 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a"
[0m17:49:26.597333 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a"
[0m17:49:26.597726 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a: BEGIN
[0m17:49:26.598077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:27.477786 [debug] [Thread-1 (]: SQL status: BEGIN in 0.880 seconds
[0m17:49:27.478288 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a"
[0m17:49:27.478677 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select id_turma as from_field
    from "transformacao_matricula"."staging_facts"."fato_matricula"
    where id_turma is not null
),

parent as (
    select id_turma as to_field
    from "transformacao_matricula"."staging_dimensions"."dim_turma"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m17:49:27.587180 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_facts.fato_matricula" does not exist
LINE 16:     from "transformacao_matricula"."staging_facts"."fato_mat...
                  ^

[0m17:49:27.588182 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a: ROLLBACK
[0m17:49:27.696018 [debug] [Thread-1 (]: On test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a: Close
[0m17:49:27.698975 [debug] [Thread-1 (]: Database Error in test relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_ (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 16:     from "transformacao_matricula"."staging_facts"."fato_mat...
                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.sql
[0m17:49:27.699585 [error] [Thread-1 (]: 27 of 37 ERROR relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_ . [[31mERROR[0m in 1.11s]
[0m17:49:27.700210 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a
[0m17:49:27.700672 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400
[0m17:49:27.701154 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a' to be skipped because of status 'error'.  Reason: Database Error in test relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_ (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 16:     from "transformacao_matricula"."staging_facts"."fato_mat...
                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.sql.
[0m17:49:27.701626 [info ] [Thread-1 (]: 28 of 37 START test source_not_null_transformacao_matricula_staging_alunos_raw_ano  [RUN]
[0m17:49:27.702455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.7a6808b05a, now test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400)
[0m17:49:27.703104 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400
[0m17:49:27.708782 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400"
[0m17:49:27.709450 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400
[0m17:49:27.711491 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400"
[0m17:49:27.712166 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400"
[0m17:49:27.712559 [debug] [Thread-1 (]: On test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400: BEGIN
[0m17:49:27.712954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:28.592597 [debug] [Thread-1 (]: SQL status: BEGIN in 0.880 seconds
[0m17:49:28.593123 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400"
[0m17:49:28.593719 [debug] [Thread-1 (]: On test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ano
from "transformacao_matricula"."staging"."staging_alunos_raw"
where ano is null



  
  
      
    ) dbt_internal_test
[0m17:49:28.701098 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging.staging_alunos_raw" does not exist
LINE 17: from "transformacao_matricula"."staging"."staging_alunos_raw...
              ^

[0m17:49:28.702005 [debug] [Thread-1 (]: On test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400: ROLLBACK
[0m17:49:28.805894 [debug] [Thread-1 (]: On test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400: Close
[0m17:49:28.808845 [debug] [Thread-1 (]: Database Error in test source_not_null_transformacao_matricula_staging_alunos_raw_ano (transformacao_aprovados/models/staging/schema.yml)
  relation "staging.staging_alunos_raw" does not exist
  LINE 17: from "transformacao_matricula"."staging"."staging_alunos_raw...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/source_not_null_transformacao_matricula_staging_alunos_raw_ano.sql
[0m17:49:28.809480 [error] [Thread-1 (]: 28 of 37 ERROR source_not_null_transformacao_matricula_staging_alunos_raw_ano .. [[31mERROR[0m in 1.11s]
[0m17:49:28.810129 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400
[0m17:49:28.810565 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd
[0m17:49:28.811134 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_transformacao_matricula_staging_alunos_raw_ano (transformacao_aprovados/models/staging/schema.yml)
  relation "staging.staging_alunos_raw" does not exist
  LINE 17: from "transformacao_matricula"."staging"."staging_alunos_raw...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/source_not_null_transformacao_matricula_staging_alunos_raw_ano.sql.
[0m17:49:28.811544 [info ] [Thread-1 (]: 29 of 37 START test source_not_null_transformacao_matricula_staging_alunos_raw_matricula  [RUN]
[0m17:49:28.812260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_ano.530e480400, now test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd)
[0m17:49:28.812825 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd
[0m17:49:28.817317 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd"
[0m17:49:28.817983 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd
[0m17:49:28.820081 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd"
[0m17:49:28.820825 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd"
[0m17:49:28.821255 [debug] [Thread-1 (]: On test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd: BEGIN
[0m17:49:28.821618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:29.675254 [debug] [Thread-1 (]: SQL status: BEGIN in 0.853 seconds
[0m17:49:29.676029 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd"
[0m17:49:29.676529 [debug] [Thread-1 (]: On test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select matricula
from "transformacao_matricula"."staging"."staging_alunos_raw"
where matricula is null



  
  
      
    ) dbt_internal_test
[0m17:49:29.781588 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging.staging_alunos_raw" does not exist
LINE 17: from "transformacao_matricula"."staging"."staging_alunos_raw...
              ^

[0m17:49:29.782601 [debug] [Thread-1 (]: On test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd: ROLLBACK
[0m17:49:29.888133 [debug] [Thread-1 (]: On test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd: Close
[0m17:49:29.890619 [debug] [Thread-1 (]: Database Error in test source_not_null_transformacao_matricula_staging_alunos_raw_matricula (transformacao_aprovados/models/staging/schema.yml)
  relation "staging.staging_alunos_raw" does not exist
  LINE 17: from "transformacao_matricula"."staging"."staging_alunos_raw...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/source_not_null_transformacao__9b66b40dd0c72a3543530237e77741c1.sql
[0m17:49:29.891278 [error] [Thread-1 (]: 29 of 37 ERROR source_not_null_transformacao_matricula_staging_alunos_raw_matricula  [[31mERROR[0m in 1.08s]
[0m17:49:29.892132 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd
[0m17:49:29.892630 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74
[0m17:49:29.893184 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_transformacao_matricula_staging_alunos_raw_matricula (transformacao_aprovados/models/staging/schema.yml)
  relation "staging.staging_alunos_raw" does not exist
  LINE 17: from "transformacao_matricula"."staging"."staging_alunos_raw...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/source_not_null_transformacao__9b66b40dd0c72a3543530237e77741c1.sql.
[0m17:49:29.893667 [info ] [Thread-1 (]: 30 of 37 START test unique_dim_aluno_id_aluno .................................. [RUN]
[0m17:49:29.894381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.source_not_null_transformacao_matricula_staging_alunos_raw_matricula.83da8410fd, now test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74)
[0m17:49:29.894857 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74
[0m17:49:29.900972 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74"
[0m17:49:29.901722 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74
[0m17:49:29.904545 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74"
[0m17:49:29.905321 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74"
[0m17:49:29.905989 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74: BEGIN
[0m17:49:29.906521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:30.787676 [debug] [Thread-1 (]: SQL status: BEGIN in 0.881 seconds
[0m17:49:30.788280 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74"
[0m17:49:30.788752 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_aluno as unique_field,
    count(*) as n_records

from "transformacao_matricula"."staging_dimensions"."dim_aluno"
where id_aluno is not null
group by id_aluno
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:49:30.897236 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_dimensions.dim_aluno" does not exist
LINE 18: from "transformacao_matricula"."staging_dimensions"."dim_alu...
              ^

[0m17:49:30.897986 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74: ROLLBACK
[0m17:49:31.012601 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74: Close
[0m17:49:31.015321 [debug] [Thread-1 (]: Database Error in test unique_dim_aluno_id_aluno (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_aluno" does not exist
  LINE 18: from "transformacao_matricula"."staging_dimensions"."dim_alu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_dim_aluno_id_aluno.sql
[0m17:49:31.016126 [error] [Thread-1 (]: 30 of 37 ERROR unique_dim_aluno_id_aluno ....................................... [[31mERROR[0m in 1.12s]
[0m17:49:31.016871 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74
[0m17:49:31.017336 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae
[0m17:49:31.017916 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74' to be skipped because of status 'error'.  Reason: Database Error in test unique_dim_aluno_id_aluno (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_aluno" does not exist
  LINE 18: from "transformacao_matricula"."staging_dimensions"."dim_alu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_dim_aluno_id_aluno.sql.
[0m17:49:31.018529 [info ] [Thread-1 (]: 31 of 37 START test unique_dim_escola_id_escola ................................ [RUN]
[0m17:49:31.019301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.unique_dim_aluno_id_aluno.700a95ec74, now test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae)
[0m17:49:31.019777 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae
[0m17:49:31.023821 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae"
[0m17:49:31.024620 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae
[0m17:49:31.027283 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae"
[0m17:49:31.028006 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae"
[0m17:49:31.028417 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae: BEGIN
[0m17:49:31.028831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:31.879923 [debug] [Thread-1 (]: SQL status: BEGIN in 0.851 seconds
[0m17:49:31.880424 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae"
[0m17:49:31.880846 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_escola as unique_field,
    count(*) as n_records

from "transformacao_matricula"."staging_dimensions"."dim_escola"
where id_escola is not null
group by id_escola
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:49:31.985999 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_dimensions.dim_escola" does not exist
LINE 18: from "transformacao_matricula"."staging_dimensions"."dim_esc...
              ^

[0m17:49:31.986544 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae: ROLLBACK
[0m17:49:32.091156 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae: Close
[0m17:49:32.093398 [debug] [Thread-1 (]: Database Error in test unique_dim_escola_id_escola (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_escola" does not exist
  LINE 18: from "transformacao_matricula"."staging_dimensions"."dim_esc...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_dim_escola_id_escola.sql
[0m17:49:32.093984 [error] [Thread-1 (]: 31 of 37 ERROR unique_dim_escola_id_escola ..................................... [[31mERROR[0m in 1.07s]
[0m17:49:32.094546 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae
[0m17:49:32.094983 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d
[0m17:49:32.095354 [info ] [Thread-1 (]: 32 of 37 START test unique_dim_localizacao_id_locali ........................... [RUN]
[0m17:49:32.096144 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae' to be skipped because of status 'error'.  Reason: Database Error in test unique_dim_escola_id_escola (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_escola" does not exist
  LINE 18: from "transformacao_matricula"."staging_dimensions"."dim_esc...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_dim_escola_id_escola.sql.
[0m17:49:32.096662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.unique_dim_escola_id_escola.179c527fae, now test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d)
[0m17:49:32.097280 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d
[0m17:49:32.101039 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d"
[0m17:49:32.101791 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d
[0m17:49:32.104064 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d"
[0m17:49:32.104855 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d"
[0m17:49:32.105358 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d: BEGIN
[0m17:49:32.105806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:32.994449 [debug] [Thread-1 (]: SQL status: BEGIN in 0.889 seconds
[0m17:49:32.995090 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d"
[0m17:49:32.995875 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_locali as unique_field,
    count(*) as n_records

from "transformacao_matricula"."staging_dimensions"."dim_localizacao"
where id_locali is not null
group by id_locali
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:49:33.109351 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_dimensions.dim_localizacao" does not exist
LINE 18: from "transformacao_matricula"."staging_dimensions"."dim_loc...
              ^

[0m17:49:33.110378 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d: ROLLBACK
[0m17:49:33.222058 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d: Close
[0m17:49:33.224858 [debug] [Thread-1 (]: Database Error in test unique_dim_localizacao_id_locali (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_localizacao" does not exist
  LINE 18: from "transformacao_matricula"."staging_dimensions"."dim_loc...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_dim_localizacao_id_locali.sql
[0m17:49:33.225424 [error] [Thread-1 (]: 32 of 37 ERROR unique_dim_localizacao_id_locali ................................ [[31mERROR[0m in 1.13s]
[0m17:49:33.225994 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d
[0m17:49:33.226389 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3
[0m17:49:33.226873 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d' to be skipped because of status 'error'.  Reason: Database Error in test unique_dim_localizacao_id_locali (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_localizacao" does not exist
  LINE 18: from "transformacao_matricula"."staging_dimensions"."dim_loc...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_dim_localizacao_id_locali.sql.
[0m17:49:33.227271 [info ] [Thread-1 (]: 33 of 37 START test unique_dim_situacao_id_situacao ............................ [RUN]
[0m17:49:33.227931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.unique_dim_localizacao_id_locali.5c56641d4d, now test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3)
[0m17:49:33.228349 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3
[0m17:49:33.231680 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3"
[0m17:49:33.232355 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3
[0m17:49:33.236574 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3"
[0m17:49:33.237573 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3"
[0m17:49:33.238117 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3: BEGIN
[0m17:49:33.238504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:34.124762 [debug] [Thread-1 (]: SQL status: BEGIN in 0.886 seconds
[0m17:49:34.125371 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3"
[0m17:49:34.125762 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_situacao as unique_field,
    count(*) as n_records

from "transformacao_matricula"."staging_dimensions"."dim_situacao"
where id_situacao is not null
group by id_situacao
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:49:34.238377 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_dimensions.dim_situacao" does not exist
LINE 18: from "transformacao_matricula"."staging_dimensions"."dim_sit...
              ^

[0m17:49:34.238905 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3: ROLLBACK
[0m17:49:34.348702 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3: Close
[0m17:49:34.351234 [debug] [Thread-1 (]: Database Error in test unique_dim_situacao_id_situacao (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_situacao" does not exist
  LINE 18: from "transformacao_matricula"."staging_dimensions"."dim_sit...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_dim_situacao_id_situacao.sql
[0m17:49:34.351811 [error] [Thread-1 (]: 33 of 37 ERROR unique_dim_situacao_id_situacao ................................. [[31mERROR[0m in 1.12s]
[0m17:49:34.352361 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3
[0m17:49:34.352775 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063
[0m17:49:34.353147 [info ] [Thread-1 (]: 34 of 37 START test unique_dim_tempo_id_tempo .................................. [RUN]
[0m17:49:34.353911 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3' to be skipped because of status 'error'.  Reason: Database Error in test unique_dim_situacao_id_situacao (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_situacao" does not exist
  LINE 18: from "transformacao_matricula"."staging_dimensions"."dim_sit...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_dim_situacao_id_situacao.sql.
[0m17:49:34.354593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.unique_dim_situacao_id_situacao.354fe4c6a3, now test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063)
[0m17:49:34.355200 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063
[0m17:49:34.358577 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063"
[0m17:49:34.359344 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063
[0m17:49:34.361743 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063"
[0m17:49:34.362499 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063"
[0m17:49:34.362955 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063: BEGIN
[0m17:49:34.363337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:35.203407 [debug] [Thread-1 (]: SQL status: BEGIN in 0.840 seconds
[0m17:49:35.203925 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063"
[0m17:49:35.204339 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_tempo as unique_field,
    count(*) as n_records

from "transformacao_matricula"."staging_dimensions"."dim_tempo"
where id_tempo is not null
group by id_tempo
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:49:35.306892 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_dimensions.dim_tempo" does not exist
LINE 18: from "transformacao_matricula"."staging_dimensions"."dim_tem...
              ^

[0m17:49:35.307410 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063: ROLLBACK
[0m17:49:35.410422 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063: Close
[0m17:49:35.412666 [debug] [Thread-1 (]: Database Error in test unique_dim_tempo_id_tempo (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_tempo" does not exist
  LINE 18: from "transformacao_matricula"."staging_dimensions"."dim_tem...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_dim_tempo_id_tempo.sql
[0m17:49:35.413240 [error] [Thread-1 (]: 34 of 37 ERROR unique_dim_tempo_id_tempo ....................................... [[31mERROR[0m in 1.06s]
[0m17:49:35.413807 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063
[0m17:49:35.414211 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa
[0m17:49:35.414579 [info ] [Thread-1 (]: 35 of 37 START test unique_dim_turma_id_turma .................................. [RUN]
[0m17:49:35.415325 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063' to be skipped because of status 'error'.  Reason: Database Error in test unique_dim_tempo_id_tempo (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_tempo" does not exist
  LINE 18: from "transformacao_matricula"."staging_dimensions"."dim_tem...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_dim_tempo_id_tempo.sql.
[0m17:49:35.415811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.unique_dim_tempo_id_tempo.8e4d996063, now test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa)
[0m17:49:35.416459 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa
[0m17:49:35.419850 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa"
[0m17:49:35.420560 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa
[0m17:49:35.422919 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa"
[0m17:49:35.423694 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa"
[0m17:49:35.424194 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa: BEGIN
[0m17:49:35.424655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:36.285298 [debug] [Thread-1 (]: SQL status: BEGIN in 0.860 seconds
[0m17:49:36.286126 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa"
[0m17:49:36.286538 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id_turma as unique_field,
    count(*) as n_records

from "transformacao_matricula"."staging_dimensions"."dim_turma"
where id_turma is not null
group by id_turma
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:49:36.391820 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_dimensions.dim_turma" does not exist
LINE 18: from "transformacao_matricula"."staging_dimensions"."dim_tur...
              ^

[0m17:49:36.392545 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa: ROLLBACK
[0m17:49:36.497984 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa: Close
[0m17:49:36.500394 [debug] [Thread-1 (]: Database Error in test unique_dim_turma_id_turma (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_turma" does not exist
  LINE 18: from "transformacao_matricula"."staging_dimensions"."dim_tur...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_dim_turma_id_turma.sql
[0m17:49:36.500977 [error] [Thread-1 (]: 35 of 37 ERROR unique_dim_turma_id_turma ....................................... [[31mERROR[0m in 1.09s]
[0m17:49:36.501533 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa
[0m17:49:36.501956 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.unique_fato_matricula_matricula.484f264991
[0m17:49:36.502782 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa' to be skipped because of status 'error'.  Reason: Database Error in test unique_dim_turma_id_turma (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_turma" does not exist
  LINE 18: from "transformacao_matricula"."staging_dimensions"."dim_tur...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_dim_turma_id_turma.sql.
[0m17:49:36.503551 [info ] [Thread-1 (]: 36 of 37 START test unique_fato_matricula_matricula ............................ [RUN]
[0m17:49:36.504336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.unique_dim_turma_id_turma.fe525e12fa, now test.transformacao_matricula.unique_fato_matricula_matricula.484f264991)
[0m17:49:36.504781 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.unique_fato_matricula_matricula.484f264991
[0m17:49:36.508700 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.unique_fato_matricula_matricula.484f264991"
[0m17:49:36.509407 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.unique_fato_matricula_matricula.484f264991
[0m17:49:36.511799 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.unique_fato_matricula_matricula.484f264991"
[0m17:49:36.512546 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_fato_matricula_matricula.484f264991"
[0m17:49:36.513052 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_fato_matricula_matricula.484f264991: BEGIN
[0m17:49:36.513464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:37.400770 [debug] [Thread-1 (]: SQL status: BEGIN in 0.887 seconds
[0m17:49:37.401354 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_fato_matricula_matricula.484f264991"
[0m17:49:37.401947 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_fato_matricula_matricula.484f264991: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.unique_fato_matricula_matricula.484f264991"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    matricula as unique_field,
    count(*) as n_records

from "transformacao_matricula"."staging_facts"."fato_matricula"
where matricula is not null
group by matricula
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:49:37.512432 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_facts.fato_matricula" does not exist
LINE 18: from "transformacao_matricula"."staging_facts"."fato_matricu...
              ^

[0m17:49:37.512997 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_fato_matricula_matricula.484f264991: ROLLBACK
[0m17:49:37.622962 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_fato_matricula_matricula.484f264991: Close
[0m17:49:37.625679 [debug] [Thread-1 (]: Database Error in test unique_fato_matricula_matricula (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 18: from "transformacao_matricula"."staging_facts"."fato_matricu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_fato_matricula_matricula.sql
[0m17:49:37.626228 [error] [Thread-1 (]: 36 of 37 ERROR unique_fato_matricula_matricula ................................. [[31mERROR[0m in 1.12s]
[0m17:49:37.626812 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.unique_fato_matricula_matricula.484f264991
[0m17:49:37.627241 [debug] [Thread-1 (]: Began running node test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05
[0m17:49:37.627732 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.unique_fato_matricula_matricula.484f264991' to be skipped because of status 'error'.  Reason: Database Error in test unique_fato_matricula_matricula (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 18: from "transformacao_matricula"."staging_facts"."fato_matricu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_fato_matricula_matricula.sql.
[0m17:49:37.628159 [info ] [Thread-1 (]: 37 of 37 START test unique_transform_data_matricula ............................ [RUN]
[0m17:49:37.628871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.transformacao_matricula.unique_fato_matricula_matricula.484f264991, now test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05)
[0m17:49:37.629318 [debug] [Thread-1 (]: Began compiling node test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05
[0m17:49:37.632758 [debug] [Thread-1 (]: Writing injected SQL for node "test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05"
[0m17:49:37.633478 [debug] [Thread-1 (]: Began executing node test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05
[0m17:49:37.635861 [debug] [Thread-1 (]: Writing runtime sql for node "test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05"
[0m17:49:37.636667 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05"
[0m17:49:37.637150 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05: BEGIN
[0m17:49:37.637534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:38.507474 [debug] [Thread-1 (]: SQL status: BEGIN in 0.870 seconds
[0m17:49:38.508067 [debug] [Thread-1 (]: Using postgres connection "test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05"
[0m17:49:38.508470 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    matricula as unique_field,
    count(*) as n_records

from "transformacao_matricula"."staging_intermediate"."transform_data"
where matricula is not null
group by matricula
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:49:38.619107 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging_intermediate.transform_data" does not exist
LINE 18: from "transformacao_matricula"."staging_intermediate"."trans...
              ^

[0m17:49:38.620092 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05: ROLLBACK
[0m17:49:38.727766 [debug] [Thread-1 (]: On test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05: Close
[0m17:49:38.730309 [debug] [Thread-1 (]: Database Error in test unique_transform_data_matricula (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_intermediate.transform_data" does not exist
  LINE 18: from "transformacao_matricula"."staging_intermediate"."trans...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_transform_data_matricula.sql
[0m17:49:38.732859 [error] [Thread-1 (]: 37 of 37 ERROR unique_transform_data_matricula ................................. [[31mERROR[0m in 1.10s]
[0m17:49:38.733455 [debug] [Thread-1 (]: Finished running node test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05
[0m17:49:38.734573 [debug] [Thread-4 (]: Marking all children of 'test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05' to be skipped because of status 'error'.  Reason: Database Error in test unique_transform_data_matricula (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_intermediate.transform_data" does not exist
  LINE 18: from "transformacao_matricula"."staging_intermediate"."trans...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_transform_data_matricula.sql.
[0m17:49:38.736015 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:38.736453 [debug] [MainThread]: On master: BEGIN
[0m17:49:38.736779 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:49:39.590877 [debug] [MainThread]: SQL status: BEGIN in 0.854 seconds
[0m17:49:39.591602 [debug] [MainThread]: On master: COMMIT
[0m17:49:39.591946 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:39.592261 [debug] [MainThread]: On master: COMMIT
[0m17:49:39.696339 [debug] [MainThread]: SQL status: COMMIT in 0.104 seconds
[0m17:49:39.697302 [debug] [MainThread]: On master: Close
[0m17:49:39.698054 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:49:39.698403 [debug] [MainThread]: Connection 'test.transformacao_matricula.unique_transform_data_matricula.f0a8a69b05' was properly closed.
[0m17:49:39.698789 [info ] [MainThread]: 
[0m17:49:39.699147 [info ] [MainThread]: Finished running 37 data tests in 0 hours 0 minutes and 49.88 seconds (49.88s).
[0m17:49:39.704036 [debug] [MainThread]: Command end result
[0m17:49:39.732407 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m17:49:39.734911 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m17:49:39.744292 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m17:49:39.744915 [info ] [MainThread]: 
[0m17:49:39.745557 [info ] [MainThread]: [31mCompleted with 37 errors, 0 partial successes, and 0 warnings:[0m
[0m17:49:39.746234 [info ] [MainThread]: 
[0m17:49:39.747027 [error] [MainThread]: [31mFailure in test not_null_dim_aluno_id_aluno (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.747679 [error] [MainThread]:   Database Error in test not_null_dim_aluno_id_aluno (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_aluno" does not exist
  LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_alu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_aluno_id_aluno.sql
[0m17:49:39.748262 [info ] [MainThread]: 
[0m17:49:39.748918 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_aluno_id_aluno.sql
[0m17:49:39.749526 [info ] [MainThread]: 
[0m17:49:39.750188 [error] [MainThread]: [31mFailure in test not_null_dim_aluno_matricula (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.750924 [error] [MainThread]:   Database Error in test not_null_dim_aluno_matricula (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_aluno" does not exist
  LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_alu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_aluno_matricula.sql
[0m17:49:39.751507 [info ] [MainThread]: 
[0m17:49:39.752145 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_aluno_matricula.sql
[0m17:49:39.752745 [info ] [MainThread]: 
[0m17:49:39.753449 [error] [MainThread]: [31mFailure in test not_null_dim_escola_codigo_escola (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.754255 [error] [MainThread]:   Database Error in test not_null_dim_escola_codigo_escola (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_escola" does not exist
  LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_esc...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_escola_codigo_escola.sql
[0m17:49:39.755021 [info ] [MainThread]: 
[0m17:49:39.755789 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_escola_codigo_escola.sql
[0m17:49:39.756460 [info ] [MainThread]: 
[0m17:49:39.757180 [error] [MainThread]: [31mFailure in test not_null_dim_escola_id_escola (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.757846 [error] [MainThread]:   Database Error in test not_null_dim_escola_id_escola (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_escola" does not exist
  LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_esc...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_escola_id_escola.sql
[0m17:49:39.758475 [info ] [MainThread]: 
[0m17:49:39.759191 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_escola_id_escola.sql
[0m17:49:39.759729 [info ] [MainThread]: 
[0m17:49:39.760554 [error] [MainThread]: [31mFailure in test not_null_dim_localizacao_id_locali (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.761368 [error] [MainThread]:   Database Error in test not_null_dim_localizacao_id_locali (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_localizacao" does not exist
  LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_loc...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_localizacao_id_locali.sql
[0m17:49:39.762235 [info ] [MainThread]: 
[0m17:49:39.762975 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_localizacao_id_locali.sql
[0m17:49:39.763645 [info ] [MainThread]: 
[0m17:49:39.764546 [error] [MainThread]: [31mFailure in test not_null_dim_situacao_id_situacao (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.765349 [error] [MainThread]:   Database Error in test not_null_dim_situacao_id_situacao (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_situacao" does not exist
  LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_sit...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_situacao_id_situacao.sql
[0m17:49:39.765969 [info ] [MainThread]: 
[0m17:49:39.766557 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_situacao_id_situacao.sql
[0m17:49:39.767129 [info ] [MainThread]: 
[0m17:49:39.767703 [error] [MainThread]: [31mFailure in test not_null_dim_situacao_situacao_nome (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.768269 [error] [MainThread]:   Database Error in test not_null_dim_situacao_situacao_nome (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_situacao" does not exist
  LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_sit...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_situacao_situacao_nome.sql
[0m17:49:39.768750 [info ] [MainThread]: 
[0m17:49:39.769249 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_situacao_situacao_nome.sql
[0m17:49:39.769852 [info ] [MainThread]: 
[0m17:49:39.770563 [error] [MainThread]: [31mFailure in test not_null_dim_tempo_ano (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.771222 [error] [MainThread]:   Database Error in test not_null_dim_tempo_ano (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_tempo" does not exist
  LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_tem...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_tempo_ano.sql
[0m17:49:39.772005 [info ] [MainThread]: 
[0m17:49:39.772472 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_tempo_ano.sql
[0m17:49:39.772973 [info ] [MainThread]: 
[0m17:49:39.773413 [error] [MainThread]: [31mFailure in test not_null_dim_tempo_id_tempo (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.773831 [error] [MainThread]:   Database Error in test not_null_dim_tempo_id_tempo (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_tempo" does not exist
  LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_tem...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_tempo_id_tempo.sql
[0m17:49:39.774176 [info ] [MainThread]: 
[0m17:49:39.774554 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_tempo_id_tempo.sql
[0m17:49:39.774926 [info ] [MainThread]: 
[0m17:49:39.775313 [error] [MainThread]: [31mFailure in test not_null_dim_turma_id_turma (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.775723 [error] [MainThread]:   Database Error in test not_null_dim_turma_id_turma (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_turma" does not exist
  LINE 17: from "transformacao_matricula"."staging_dimensions"."dim_tur...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_turma_id_turma.sql
[0m17:49:39.776078 [info ] [MainThread]: 
[0m17:49:39.776457 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_dim_turma_id_turma.sql
[0m17:49:39.776842 [info ] [MainThread]: 
[0m17:49:39.777434 [error] [MainThread]: [31mFailure in test not_null_fato_matricula_id_aluno (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.778060 [error] [MainThread]:   Database Error in test not_null_fato_matricula_id_aluno (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 17: from "transformacao_matricula"."staging_facts"."fato_matricu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_fato_matricula_id_aluno.sql
[0m17:49:39.778464 [info ] [MainThread]: 
[0m17:49:39.778906 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_fato_matricula_id_aluno.sql
[0m17:49:39.779283 [info ] [MainThread]: 
[0m17:49:39.779714 [error] [MainThread]: [31mFailure in test not_null_fato_matricula_id_escola (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.780121 [error] [MainThread]:   Database Error in test not_null_fato_matricula_id_escola (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 17: from "transformacao_matricula"."staging_facts"."fato_matricu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_fato_matricula_id_escola.sql
[0m17:49:39.780463 [info ] [MainThread]: 
[0m17:49:39.780884 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_fato_matricula_id_escola.sql
[0m17:49:39.781241 [info ] [MainThread]: 
[0m17:49:39.781726 [error] [MainThread]: [31mFailure in test not_null_fato_matricula_id_locali (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.782181 [error] [MainThread]:   Database Error in test not_null_fato_matricula_id_locali (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 17: from "transformacao_matricula"."staging_facts"."fato_matricu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_fato_matricula_id_locali.sql
[0m17:49:39.782661 [info ] [MainThread]: 
[0m17:49:39.783111 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_fato_matricula_id_locali.sql
[0m17:49:39.783489 [info ] [MainThread]: 
[0m17:49:39.783946 [error] [MainThread]: [31mFailure in test not_null_fato_matricula_id_situacao (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.784356 [error] [MainThread]:   Database Error in test not_null_fato_matricula_id_situacao (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 17: from "transformacao_matricula"."staging_facts"."fato_matricu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_fato_matricula_id_situacao.sql
[0m17:49:39.784736 [info ] [MainThread]: 
[0m17:49:39.785136 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_fato_matricula_id_situacao.sql
[0m17:49:39.785564 [info ] [MainThread]: 
[0m17:49:39.786137 [error] [MainThread]: [31mFailure in test not_null_fato_matricula_id_tempo (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.786648 [error] [MainThread]:   Database Error in test not_null_fato_matricula_id_tempo (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 17: from "transformacao_matricula"."staging_facts"."fato_matricu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_fato_matricula_id_tempo.sql
[0m17:49:39.787226 [info ] [MainThread]: 
[0m17:49:39.787834 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_fato_matricula_id_tempo.sql
[0m17:49:39.788349 [info ] [MainThread]: 
[0m17:49:39.788910 [error] [MainThread]: [31mFailure in test not_null_fato_matricula_id_turma (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.789418 [error] [MainThread]:   Database Error in test not_null_fato_matricula_id_turma (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 17: from "transformacao_matricula"."staging_facts"."fato_matricu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_fato_matricula_id_turma.sql
[0m17:49:39.789959 [info ] [MainThread]: 
[0m17:49:39.790480 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_fato_matricula_id_turma.sql
[0m17:49:39.790939 [info ] [MainThread]: 
[0m17:49:39.791384 [error] [MainThread]: [31mFailure in test not_null_fato_matricula_matricula (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.791828 [error] [MainThread]:   Database Error in test not_null_fato_matricula_matricula (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 17: from "transformacao_matricula"."staging_facts"."fato_matricu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_fato_matricula_matricula.sql
[0m17:49:39.792246 [info ] [MainThread]: 
[0m17:49:39.792656 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_fato_matricula_matricula.sql
[0m17:49:39.793021 [info ] [MainThread]: 
[0m17:49:39.793573 [error] [MainThread]: [31mFailure in test not_null_staging_situacao_alunos_ano (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.794253 [error] [MainThread]:   Database Error in test not_null_staging_situacao_alunos_ano (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_staging.staging_situacao_alunos" does not exist
  LINE 17: from "transformacao_matricula"."staging_staging"."staging_si...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_staging_situacao_alunos_ano.sql
[0m17:49:39.794760 [info ] [MainThread]: 
[0m17:49:39.795354 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_staging_situacao_alunos_ano.sql
[0m17:49:39.795903 [info ] [MainThread]: 
[0m17:49:39.796458 [error] [MainThread]: [31mFailure in test not_null_staging_situacao_alunos_matricula (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.797333 [error] [MainThread]:   Database Error in test not_null_staging_situacao_alunos_matricula (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_staging.staging_situacao_alunos" does not exist
  LINE 17: from "transformacao_matricula"."staging_staging"."staging_si...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_staging_situacao_alunos_matricula.sql
[0m17:49:39.798125 [info ] [MainThread]: 
[0m17:49:39.799006 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_staging_situacao_alunos_matricula.sql
[0m17:49:39.799730 [info ] [MainThread]: 
[0m17:49:39.800740 [error] [MainThread]: [31mFailure in test not_null_transform_data_ano (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.801526 [error] [MainThread]:   Database Error in test not_null_transform_data_ano (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_intermediate.transform_data" does not exist
  LINE 17: from "transformacao_matricula"."staging_intermediate"."trans...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_transform_data_ano.sql
[0m17:49:39.802164 [info ] [MainThread]: 
[0m17:49:39.802759 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_transform_data_ano.sql
[0m17:49:39.803303 [info ] [MainThread]: 
[0m17:49:39.804002 [error] [MainThread]: [31mFailure in test not_null_transform_data_matricula (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.804683 [error] [MainThread]:   Database Error in test not_null_transform_data_matricula (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_intermediate.transform_data" does not exist
  LINE 17: from "transformacao_matricula"."staging_intermediate"."trans...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_transform_data_matricula.sql
[0m17:49:39.805225 [info ] [MainThread]: 
[0m17:49:39.805881 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/not_null_transform_data_matricula.sql
[0m17:49:39.806384 [info ] [MainThread]: 
[0m17:49:39.806936 [error] [MainThread]: [31mFailure in test relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_ (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.807484 [error] [MainThread]:   Database Error in test relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_ (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 16:     from "transformacao_matricula"."staging_facts"."fato_mat...
                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.sql
[0m17:49:39.807970 [info ] [MainThread]: 
[0m17:49:39.808524 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/relationships_fato_matricula_id_aluno__id_aluno__ref_dim_aluno_.sql
[0m17:49:39.809059 [info ] [MainThread]: 
[0m17:49:39.809953 [error] [MainThread]: [31mFailure in test relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_ (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.810779 [error] [MainThread]:   Database Error in test relationships_fato_matricula_id_escola__id_escola__ref_dim_escola_ (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 16:     from "transformacao_matricula"."staging_facts"."fato_mat...
                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/relationships_fato_matricula_9b2cc79a2ce28a50e4ab76e1ec454169.sql
[0m17:49:39.811481 [info ] [MainThread]: 
[0m17:49:39.812145 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/relationships_fato_matricula_9b2cc79a2ce28a50e4ab76e1ec454169.sql
[0m17:49:39.812743 [info ] [MainThread]: 
[0m17:49:39.813338 [error] [MainThread]: [31mFailure in test relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_ (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.813970 [error] [MainThread]:   Database Error in test relationships_fato_matricula_id_locali__id_locali__ref_dim_localizacao_ (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 16:     from "transformacao_matricula"."staging_facts"."fato_mat...
                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/relationships_fato_matricula_ba784d16ba791b8aca7f852415f3ff60.sql
[0m17:49:39.814649 [info ] [MainThread]: 
[0m17:49:39.815302 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/relationships_fato_matricula_ba784d16ba791b8aca7f852415f3ff60.sql
[0m17:49:39.815863 [info ] [MainThread]: 
[0m17:49:39.816454 [error] [MainThread]: [31mFailure in test relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_ (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.817073 [error] [MainThread]:   Database Error in test relationships_fato_matricula_id_situacao__id_situacao__ref_dim_situacao_ (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 16:     from "transformacao_matricula"."staging_facts"."fato_mat...
                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/relationships_fato_matricula_8d96e5d559ecf908dfec477493d81116.sql
[0m17:49:39.817741 [info ] [MainThread]: 
[0m17:49:39.818493 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/relationships_fato_matricula_8d96e5d559ecf908dfec477493d81116.sql
[0m17:49:39.819082 [info ] [MainThread]: 
[0m17:49:39.819964 [error] [MainThread]: [31mFailure in test relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_ (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.820741 [error] [MainThread]:   Database Error in test relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_ (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 16:     from "transformacao_matricula"."staging_facts"."fato_mat...
                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.sql
[0m17:49:39.821358 [info ] [MainThread]: 
[0m17:49:39.822169 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/relationships_fato_matricula_id_tempo__id_tempo__ref_dim_tempo_.sql
[0m17:49:39.822802 [info ] [MainThread]: 
[0m17:49:39.823441 [error] [MainThread]: [31mFailure in test relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_ (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.824127 [error] [MainThread]:   Database Error in test relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_ (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 16:     from "transformacao_matricula"."staging_facts"."fato_mat...
                    ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.sql
[0m17:49:39.824799 [info ] [MainThread]: 
[0m17:49:39.825502 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/relationships_fato_matricula_id_turma__id_turma__ref_dim_turma_.sql
[0m17:49:39.826293 [info ] [MainThread]: 
[0m17:49:39.827008 [error] [MainThread]: [31mFailure in test source_not_null_transformacao_matricula_staging_alunos_raw_ano (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.827721 [error] [MainThread]:   Database Error in test source_not_null_transformacao_matricula_staging_alunos_raw_ano (transformacao_aprovados/models/staging/schema.yml)
  relation "staging.staging_alunos_raw" does not exist
  LINE 17: from "transformacao_matricula"."staging"."staging_alunos_raw...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/source_not_null_transformacao_matricula_staging_alunos_raw_ano.sql
[0m17:49:39.828290 [info ] [MainThread]: 
[0m17:49:39.828989 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/source_not_null_transformacao_matricula_staging_alunos_raw_ano.sql
[0m17:49:39.829675 [info ] [MainThread]: 
[0m17:49:39.830343 [error] [MainThread]: [31mFailure in test source_not_null_transformacao_matricula_staging_alunos_raw_matricula (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.831030 [error] [MainThread]:   Database Error in test source_not_null_transformacao_matricula_staging_alunos_raw_matricula (transformacao_aprovados/models/staging/schema.yml)
  relation "staging.staging_alunos_raw" does not exist
  LINE 17: from "transformacao_matricula"."staging"."staging_alunos_raw...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/source_not_null_transformacao__9b66b40dd0c72a3543530237e77741c1.sql
[0m17:49:39.831623 [info ] [MainThread]: 
[0m17:49:39.832304 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/source_not_null_transformacao__9b66b40dd0c72a3543530237e77741c1.sql
[0m17:49:39.832908 [info ] [MainThread]: 
[0m17:49:39.833464 [error] [MainThread]: [31mFailure in test unique_dim_aluno_id_aluno (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.834248 [error] [MainThread]:   Database Error in test unique_dim_aluno_id_aluno (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_aluno" does not exist
  LINE 18: from "transformacao_matricula"."staging_dimensions"."dim_alu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_dim_aluno_id_aluno.sql
[0m17:49:39.834807 [info ] [MainThread]: 
[0m17:49:39.835289 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_dim_aluno_id_aluno.sql
[0m17:49:39.835686 [info ] [MainThread]: 
[0m17:49:39.836113 [error] [MainThread]: [31mFailure in test unique_dim_escola_id_escola (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.836698 [error] [MainThread]:   Database Error in test unique_dim_escola_id_escola (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_escola" does not exist
  LINE 18: from "transformacao_matricula"."staging_dimensions"."dim_esc...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_dim_escola_id_escola.sql
[0m17:49:39.837111 [info ] [MainThread]: 
[0m17:49:39.837505 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_dim_escola_id_escola.sql
[0m17:49:39.837891 [info ] [MainThread]: 
[0m17:49:39.838342 [error] [MainThread]: [31mFailure in test unique_dim_localizacao_id_locali (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.838809 [error] [MainThread]:   Database Error in test unique_dim_localizacao_id_locali (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_localizacao" does not exist
  LINE 18: from "transformacao_matricula"."staging_dimensions"."dim_loc...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_dim_localizacao_id_locali.sql
[0m17:49:39.839153 [info ] [MainThread]: 
[0m17:49:39.839656 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_dim_localizacao_id_locali.sql
[0m17:49:39.840292 [info ] [MainThread]: 
[0m17:49:39.840919 [error] [MainThread]: [31mFailure in test unique_dim_situacao_id_situacao (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.841455 [error] [MainThread]:   Database Error in test unique_dim_situacao_id_situacao (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_situacao" does not exist
  LINE 18: from "transformacao_matricula"."staging_dimensions"."dim_sit...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_dim_situacao_id_situacao.sql
[0m17:49:39.841905 [info ] [MainThread]: 
[0m17:49:39.842318 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_dim_situacao_id_situacao.sql
[0m17:49:39.842771 [info ] [MainThread]: 
[0m17:49:39.843268 [error] [MainThread]: [31mFailure in test unique_dim_tempo_id_tempo (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.843772 [error] [MainThread]:   Database Error in test unique_dim_tempo_id_tempo (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_tempo" does not exist
  LINE 18: from "transformacao_matricula"."staging_dimensions"."dim_tem...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_dim_tempo_id_tempo.sql
[0m17:49:39.844196 [info ] [MainThread]: 
[0m17:49:39.844666 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_dim_tempo_id_tempo.sql
[0m17:49:39.845095 [info ] [MainThread]: 
[0m17:49:39.845594 [error] [MainThread]: [31mFailure in test unique_dim_turma_id_turma (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.846100 [error] [MainThread]:   Database Error in test unique_dim_turma_id_turma (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_dimensions.dim_turma" does not exist
  LINE 18: from "transformacao_matricula"."staging_dimensions"."dim_tur...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_dim_turma_id_turma.sql
[0m17:49:39.846602 [info ] [MainThread]: 
[0m17:49:39.847291 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_dim_turma_id_turma.sql
[0m17:49:39.847770 [info ] [MainThread]: 
[0m17:49:39.848272 [error] [MainThread]: [31mFailure in test unique_fato_matricula_matricula (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.848783 [error] [MainThread]:   Database Error in test unique_fato_matricula_matricula (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_facts.fato_matricula" does not exist
  LINE 18: from "transformacao_matricula"."staging_facts"."fato_matricu...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_fato_matricula_matricula.sql
[0m17:49:39.849209 [info ] [MainThread]: 
[0m17:49:39.849688 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_fato_matricula_matricula.sql
[0m17:49:39.850116 [info ] [MainThread]: 
[0m17:49:39.850578 [error] [MainThread]: [31mFailure in test unique_transform_data_matricula (transformacao_aprovados/models/staging/schema.yml)[0m
[0m17:49:39.851074 [error] [MainThread]:   Database Error in test unique_transform_data_matricula (transformacao_aprovados/models/staging/schema.yml)
  relation "staging_intermediate.transform_data" does not exist
  LINE 18: from "transformacao_matricula"."staging_intermediate"."trans...
                ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_transform_data_matricula.sql
[0m17:49:39.851483 [info ] [MainThread]: 
[0m17:49:39.852003 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/schema.yml/unique_transform_data_matricula.sql
[0m17:49:39.852603 [info ] [MainThread]: 
[0m17:49:39.853156 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=37 SKIP=0 NO-OP=0 TOTAL=37
[0m17:49:39.854470 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 50.61726, "process_in_blocks": "1168", "process_kernel_time": 0.41098, "process_mem_max_rss": "126176", "process_out_blocks": "3616", "process_user_time": 2.8077}
[0m17:49:39.855123 [debug] [MainThread]: Command `dbt test` failed at 17:49:39.854994 after 50.62 seconds
[0m17:49:39.855659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3bc67ff590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3bc5d426f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3bc53ca540>]}
[0m17:49:39.856179 [debug] [MainThread]: Flushing usage events
[0m17:49:40.355920 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:49:48.347967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbe3a8f7080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbe3a4d54c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbe3bcb6a80>]}


============================== 17:49:48.351613 | ce14c68d-5c05-40c9-a6f0-f4c4b2f888f8 ==============================
[0m17:49:48.351613 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:49:48.352197 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'no_print': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'debug': 'False', 'profiles_dir': '/home/murilo/.dbt', 'quiet': 'False', 'warn_error': 'None', 'log_format': 'default', 'target_path': 'None', 'partial_parse': 'True', 'write_json': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'empty': 'False', 'static_parser': 'True'}
[0m17:49:48.491838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce14c68d-5c05-40c9-a6f0-f4c4b2f888f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbe3c563950>]}
[0m17:49:48.542887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce14c68d-5c05-40c9-a6f0-f4c4b2f888f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbe39bf9a90>]}
[0m17:49:48.543753 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:49:48.649820 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m17:49:48.746613 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:49:48.747664 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/facts/fato_matricula.sql
[0m17:49:48.748664 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/staging/schema.yml
[0m17:49:49.069737 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m17:49:49.070374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ce14c68d-5c05-40c9-a6f0-f4c4b2f888f8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbe37b49970>]}
[0m17:49:49.236459 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.transformacao_matricula.staging_situacao_alunos' (transformacao_aprovados/models/staging/staging_situacao_alunos.sql) depends on a source named 'transformacao_matricula.staging_alunos_raw' which was not found
[0m17:49:49.237168 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 6 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:49:49.238112 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.93646497, "process_in_blocks": "0", "process_kernel_time": 0.308728, "process_mem_max_rss": "119136", "process_out_blocks": "8", "process_user_time": 1.842477}
[0m17:49:49.238621 [debug] [MainThread]: Command `dbt run` failed at 17:49:49.238525 after 0.94 seconds
[0m17:49:49.239042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbe3c1f8da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbe377e41d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbe38f3b9e0>]}
[0m17:49:49.239430 [debug] [MainThread]: Flushing usage events
[0m17:49:52.342332 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:50:01.884443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba81c6202c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba81c77dfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba81e4b4140>]}


============================== 17:50:01.887727 | c4024830-40b0-493d-ac1b-158570be0e14 ==============================
[0m17:50:01.887727 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:50:01.888292 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'debug': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_colors': 'True', 'log_format': 'default', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'use_experimental_parser': 'False', 'empty': 'False', 'static_parser': 'True', 'write_json': 'True', 'introspect': 'True', 'profiles_dir': '/home/murilo/.dbt', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'version_check': 'True', 'target_path': 'None', 'fail_fast': 'False'}
[0m17:50:02.027065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4024830-40b0-493d-ac1b-158570be0e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba81bbe44d0>]}
[0m17:50:02.078183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4024830-40b0-493d-ac1b-158570be0e14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba81bd94350>]}
[0m17:50:02.079048 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:50:02.185394 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m17:50:02.281507 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:50:02.282541 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/facts/fato_matricula.sql
[0m17:50:02.283514 [debug] [MainThread]: Partial parsing: updated file: transformacao_matricula://transformacao_aprovados/models/staging/schema.yml
[0m17:50:02.595890 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m17:50:02.596477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c4024830-40b0-493d-ac1b-158570be0e14', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba819fe0e30>]}
[0m17:50:02.762751 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.transformacao_matricula.staging_situacao_alunos' (transformacao_aprovados/models/staging/staging_situacao_alunos.sql) depends on a source named 'transformacao_matricula.staging_alunos_raw' which was not found
[0m17:50:02.763518 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 6 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:50:02.764622 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.92623764, "process_in_blocks": "0", "process_kernel_time": 0.291332, "process_mem_max_rss": "119004", "process_out_blocks": "16", "process_user_time": 1.849416}
[0m17:50:02.765142 [debug] [MainThread]: Command `dbt run` failed at 17:50:02.765067 after 0.93 seconds
[0m17:50:02.765547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba81bd0f9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba819784d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ba819fd8d70>]}
[0m17:50:02.765996 [debug] [MainThread]: Flushing usage events
[0m17:50:03.298954 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:50:46.988366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d4aa4c7b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d4a9a147a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d4a991da00>]}


============================== 17:50:46.992214 | 8960caae-cedd-4c10-a0d6-7426c159f634 ==============================
[0m17:50:46.992214 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:50:46.992797 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'introspect': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'use_colors': 'True', 'debug': 'False', 'printer_width': '80', 'empty': 'None', 'quiet': 'False', 'profiles_dir': '/home/murilo/.dbt', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'no_print': 'None'}
[0m17:50:47.094301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8960caae-cedd-4c10-a0d6-7426c159f634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d4abe47a70>]}
[0m17:50:47.106861 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.16380563, "process_in_blocks": "0", "process_kernel_time": 0.178693, "process_mem_max_rss": "101636", "process_out_blocks": "8", "process_user_time": 1.185967}
[0m17:50:47.107636 [debug] [MainThread]: Command `dbt clean` succeeded at 17:50:47.107454 after 0.16 seconds
[0m17:50:47.108125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d4ac08eb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d4a991da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d4aafa2240>]}
[0m17:50:47.108537 [debug] [MainThread]: Flushing usage events
[0m17:50:47.962012 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:50:52.035257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f8e1d48ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f8e1d282f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f8e16a7ef0>]}


============================== 17:50:52.038687 | f0cc4f6c-ad07-4318-b87a-2b8002fbd86b ==============================
[0m17:50:52.038687 [info ] [MainThread]: Running with dbt=1.10.15
[0m17:50:52.039226 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'profiles_dir': '/home/murilo/.dbt', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'quiet': 'False', 'static_parser': 'True', 'log_format': 'default', 'printer_width': '80', 'target_path': 'None', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'empty': 'False', 'warn_error': 'None', 'debug': 'False', 'indirect_selection': 'eager'}
[0m17:50:52.171493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0cc4f6c-ad07-4318-b87a-2b8002fbd86b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f8dff3b560>]}
[0m17:50:52.222065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0cc4f6c-ad07-4318-b87a-2b8002fbd86b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f8e11f9d00>]}
[0m17:50:52.222908 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m17:50:52.328744 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m17:50:52.329387 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:50:52.329784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f0cc4f6c-ad07-4318-b87a-2b8002fbd86b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f8e0317e30>]}
[0m17:50:53.301896 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m17:50:53.302438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f0cc4f6c-ad07-4318-b87a-2b8002fbd86b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f8df3791f0>]}
[0m17:50:53.522452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0cc4f6c-ad07-4318-b87a-2b8002fbd86b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f8de7448f0>]}
[0m17:50:53.594021 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m17:50:53.595757 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m17:50:53.609560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0cc4f6c-ad07-4318-b87a-2b8002fbd86b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f8dc507f80>]}
[0m17:50:53.610116 [info ] [MainThread]: Found 13 models, 37 data tests, 1 source, 459 macros
[0m17:50:53.610491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0cc4f6c-ad07-4318-b87a-2b8002fbd86b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f8de7a0110>]}
[0m17:50:53.612627 [info ] [MainThread]: 
[0m17:50:53.613178 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m17:50:53.613521 [info ] [MainThread]: 
[0m17:50:53.614054 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:50:53.618281 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula'
[0m17:50:53.658947 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m17:50:53.659428 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m17:50:53.659771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:55.016811 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.357 seconds
[0m17:50:55.018815 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m17:50:55.021025 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m17:50:55.021628 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m17:50:55.021974 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:56.647416 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.625 seconds
[0m17:50:56.649644 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m17:50:56.651785 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m17:50:56.652322 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m17:50:56.652712 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:58.285449 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.633 seconds
[0m17:50:58.286930 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m17:50:58.289205 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m17:50:58.289788 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m17:50:58.290143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:59.635348 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.345 seconds
[0m17:50:59.637324 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m17:50:59.640462 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m17:50:59.641162 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m17:50:59.641677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:01.255101 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.613 seconds
[0m17:51:01.256669 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m17:51:01.259389 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula, now list_transformacao_matricula_staging_intermediate)
[0m17:51:01.265139 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_intermediate"
[0m17:51:01.265589 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: BEGIN
[0m17:51:01.265954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:04.345295 [debug] [ThreadPool]: SQL status: BEGIN in 3.079 seconds
[0m17:51:04.346197 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_intermediate"
[0m17:51:04.346864 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_intermediate"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_intermediate'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_intermediate'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_intermediate'
  
[0m17:51:04.636107 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.289 seconds
[0m17:51:04.638295 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: ROLLBACK
[0m17:51:04.839637 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: Close
[0m17:51:04.840513 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_intermediate, now list_transformacao_matricula_staging_dimensions)
[0m17:51:04.842314 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_dimensions"
[0m17:51:04.842729 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: BEGIN
[0m17:51:04.843054 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:06.306993 [debug] [ThreadPool]: SQL status: BEGIN in 1.464 seconds
[0m17:51:06.308168 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_dimensions"
[0m17:51:06.308909 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_dimensions"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dimensions'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dimensions'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dimensions'
  
[0m17:51:06.435102 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.126 seconds
[0m17:51:06.437083 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: ROLLBACK
[0m17:51:06.579821 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: Close
[0m17:51:06.581536 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_dimensions, now list_transformacao_matricula_staging_facts)
[0m17:51:06.584177 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_facts"
[0m17:51:06.584752 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: BEGIN
[0m17:51:06.585185 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:07.581290 [debug] [ThreadPool]: SQL status: BEGIN in 0.996 seconds
[0m17:51:07.582015 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_facts"
[0m17:51:07.582419 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_facts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_facts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_facts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_facts'
  
[0m17:51:07.690641 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.108 seconds
[0m17:51:07.692242 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: ROLLBACK
[0m17:51:07.800908 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: Close
[0m17:51:07.801942 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_facts, now list_transformacao_matricula_staging_staging)
[0m17:51:07.803809 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m17:51:07.804220 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: BEGIN
[0m17:51:07.804542 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:08.636373 [debug] [ThreadPool]: SQL status: BEGIN in 0.832 seconds
[0m17:51:08.636905 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m17:51:08.637419 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_staging"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m17:51:08.747091 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.109 seconds
[0m17:51:08.748255 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: ROLLBACK
[0m17:51:08.850227 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: Close
[0m17:51:08.851107 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_staging, now list_transformacao_matricula_staging_marts)
[0m17:51:08.853484 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m17:51:08.854016 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: BEGIN
[0m17:51:08.854374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:09.697376 [debug] [ThreadPool]: SQL status: BEGIN in 0.843 seconds
[0m17:51:09.697955 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m17:51:09.698729 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_marts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m17:51:09.805506 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.106 seconds
[0m17:51:09.807418 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: ROLLBACK
[0m17:51:09.910332 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: Close
[0m17:51:09.915587 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:09.916094 [debug] [MainThread]: On master: BEGIN
[0m17:51:09.916406 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:51:10.750311 [debug] [MainThread]: SQL status: BEGIN in 0.834 seconds
[0m17:51:10.751037 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:10.751471 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m17:51:10.856033 [debug] [MainThread]: SQL status: SELECT 0 in 0.104 seconds
[0m17:51:10.857441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0cc4f6c-ad07-4318-b87a-2b8002fbd86b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f8def4cc80>]}
[0m17:51:10.858272 [debug] [MainThread]: On master: ROLLBACK
[0m17:51:10.960934 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:10.961723 [debug] [MainThread]: On master: BEGIN
[0m17:51:11.169487 [debug] [MainThread]: SQL status: BEGIN in 0.207 seconds
[0m17:51:11.170856 [debug] [MainThread]: On master: COMMIT
[0m17:51:11.171722 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:11.172451 [debug] [MainThread]: On master: COMMIT
[0m17:51:11.275554 [debug] [MainThread]: SQL status: COMMIT in 0.102 seconds
[0m17:51:11.276656 [debug] [MainThread]: On master: Close
[0m17:51:11.279895 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.staging_situacao_alunos
[0m17:51:11.280506 [info ] [Thread-1 (]: 1 of 13 START sql table model staging_staging.staging_situacao_alunos .......... [RUN]
[0m17:51:11.281132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_marts, now model.transformacao_matricula.staging_situacao_alunos)
[0m17:51:11.281898 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.staging_situacao_alunos
[0m17:51:11.288255 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.staging_situacao_alunos"
[0m17:51:11.289327 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.staging_situacao_alunos
[0m17:51:11.330520 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.staging_situacao_alunos"
[0m17:51:11.331711 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m17:51:11.332219 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: BEGIN
[0m17:51:11.332587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:12.193243 [debug] [Thread-1 (]: SQL status: BEGIN in 0.860 seconds
[0m17:51:12.193941 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m17:51:12.194465 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */

  
    

  create  table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp"
  
  
    as
  
  (
    WITH source AS (
    SELECT * FROM "transformacao_matricula"."staging"."staging_alunos_raw"
),

cleaning_renaming AS (
    SELECT
        ano,
        codigo_escola,
        matricula,
        escola AS nome_escola,
        endereco_logradouro AS endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa,
        modalidade_ensino_codigo AS mod_ens_codigo,
        -- Transformação da SÉRIE
        CASE
            -- Ensino Fundamental (1º ao 9º)
            WHEN serie LIKE '%1 ANO%' OR serie LIKE '%1º ANO%' THEN '1º ANO'
            WHEN serie LIKE '%2 ANO%' OR serie LIKE '%2º ANO%' THEN '2º ANO'
            WHEN serie LIKE '%3 ANO%' OR serie LIKE '%3º ANO%' THEN '3º ANO'
            WHEN serie LIKE '%4 ANO%' OR serie LIKE '%4º ANO%' THEN '4º ANO'
            WHEN serie LIKE '%5 ANO%' OR serie LIKE '%5º ANO%' THEN '5º ANO'
            WHEN serie LIKE '%6 ANO%' OR serie LIKE '%6º ANO%' THEN '6º ANO'
            WHEN serie LIKE '%7 ANO%' OR serie LIKE '%7º ANO%' THEN '7º ANO'
            WHEN serie LIKE '%8 ANO%' OR serie LIKE '%8º ANO%' THEN '8º ANO'
            WHEN serie LIKE '%9 ANO%' OR serie LIKE '%9º ANO%' THEN '9º ANO'
            -- Educação Infantil (Berçário e Grupos)
            WHEN serie LIKE '%BER%' THEN 'BERÇARIO'
            WHEN serie LIKE '%GRUPO I%' OR serie LIKE '%GRUPO 1%' THEN 'GRUPO I'
            WHEN serie LIKE '%GRUPO II%' THEN 'GRUPO II'
            WHEN serie LIKE '%GRUPO III%' THEN 'GRUPO III'
            WHEN serie LIKE '%GRUPO IV%' THEN 'GRUPO IV'
            WHEN serie LIKE '%GRUPO V%' THEN 'GRUPO V'
            -- EJA (Módulos 1 ao 5) 
            WHEN serie LIKE '%1%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 1'
            WHEN serie LIKE '%2%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 2'
            WHEN serie LIKE '%3%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 3'
            WHEN serie LIKE '%4%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 4'
            WHEN serie LIKE '%5%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 5'
            WHEN serie LIKE '%TRAVESSIA%' THEN 'TRAVESSIA RECIFE'
            WHEN serie LIKE '%CORRECAO%1%' THEN 'CORREÇÃO DE FLUXO 1 - ALFABETIZACAO'
            WHEN serie LIKE '%CORRECAO%2%' THEN 'CORREÇÃO DE FLUXO 2 - ACELERACAO'
            ELSE 'OUTROS'
        END AS serie,
        turma,
        turno,
        idade,
        -- transformação do SEXO
        CASE
            WHEN sexo = '1' THEN 'Masculino'
            WHEN sexo = '2' THEN 'Feminino'
            WHEN sexo = '3' THEN 'Outros'
            ELSE 'Não informado'
        END AS sexo,
        -- transformação de situacao
        CASE 
            WHEN situacao_nome LIKE '%APROV%' THEN 'Aprovado'
            WHEN situacao_nome LIKE '%RET%' OR situacao_nome LIKE '%REPRO%' THEN 'Reprovado'
            WHEN situacao_nome LIKE '%TR%' OR situacao_nome LIKE '%REMAN%' THEN 'Transferido'
            WHEN situacao_nome LIKE '%DESIST%' THEN 'Desistente'
            ELSE 'Outros'
        END AS sit_nome,
        -- Transformação da MODALIDADE
        CASE
            WHEN modalidade_ensino LIKE '%EDUCACAO INFANTIL%' THEN 'EDUCAÇÃO INFANTIL'
            WHEN modalidade_ensino LIKE '%ENSINO FUNDAMENTAL%' THEN 'ENSINO FUNDAMENTAL'
            WHEN modalidade_ensino LIKE '%EDUCACAO JOVENS E ADULTOS%' THEN 'EJA'
            WHEN modalidade_ensino LIKE '%CORRE%' THEN 'CORREÇÃO DE FLUXO'
            ELSE 'OUTROS'
        END AS modalidade_ens
    FROM source
)

SELECT * FROM cleaning_renaming
  );
  
[0m17:51:12.306325 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging.staging_alunos_raw" does not exist
LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."stagi...
                           ^

[0m17:51:12.307286 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: ROLLBACK
[0m17:51:12.419019 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: Close
[0m17:51:12.422485 [debug] [Thread-1 (]: Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  relation "staging.staging_alunos_raw" does not exist
  LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."stagi...
                             ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m17:51:12.424064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0cc4f6c-ad07-4318-b87a-2b8002fbd86b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f8de745520>]}
[0m17:51:12.424791 [error] [Thread-1 (]: 1 of 13 ERROR creating sql table model staging_staging.staging_situacao_alunos . [[31mERROR[0m in 1.14s]
[0m17:51:12.425398 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.staging_situacao_alunos
[0m17:51:12.426241 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.staging_situacao_alunos' to be skipped because of status 'error'.  Reason: Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  relation "staging.staging_alunos_raw" does not exist
  LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."stagi...
                             ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql.
[0m17:51:12.428392 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.transform_data
[0m17:51:12.429296 [info ] [Thread-1 (]: 2 of 13 SKIP relation staging_intermediate.transform_data ...................... [[33mSKIP[0m]
[0m17:51:12.430256 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.transform_data
[0m17:51:12.431570 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_aluno
[0m17:51:12.432242 [info ] [Thread-1 (]: 3 of 13 SKIP relation staging_dimensions.dim_aluno ............................. [[33mSKIP[0m]
[0m17:51:12.432904 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_aluno
[0m17:51:12.433476 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_escola
[0m17:51:12.434242 [info ] [Thread-1 (]: 4 of 13 SKIP relation staging_dimensions.dim_escola ............................ [[33mSKIP[0m]
[0m17:51:12.434947 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_escola
[0m17:51:12.435559 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_localizacao
[0m17:51:12.436270 [info ] [Thread-1 (]: 5 of 13 SKIP relation staging_dimensions.dim_localizacao ....................... [[33mSKIP[0m]
[0m17:51:12.437024 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_localizacao
[0m17:51:12.437690 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_situacao
[0m17:51:12.438454 [info ] [Thread-1 (]: 6 of 13 SKIP relation staging_dimensions.dim_situacao .......................... [[33mSKIP[0m]
[0m17:51:12.439211 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_situacao
[0m17:51:12.439857 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_tempo
[0m17:51:12.440477 [info ] [Thread-1 (]: 7 of 13 SKIP relation staging_dimensions.dim_tempo ............................. [[33mSKIP[0m]
[0m17:51:12.441103 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_tempo
[0m17:51:12.441681 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_turma
[0m17:51:12.442204 [info ] [Thread-1 (]: 8 of 13 SKIP relation staging_dimensions.dim_turma ............................. [[33mSKIP[0m]
[0m17:51:12.442984 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_turma
[0m17:51:12.443853 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.fato_matricula
[0m17:51:12.444494 [info ] [Thread-1 (]: 9 of 13 SKIP relation staging_facts.fato_matricula ............................. [[33mSKIP[0m]
[0m17:51:12.445224 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.fato_matricula
[0m17:51:12.446186 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_count_aluno_idade
[0m17:51:12.446862 [info ] [Thread-1 (]: 10 of 13 SKIP relation staging_marts.view_count_aluno_idade .................... [[33mSKIP[0m]
[0m17:51:12.447487 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_count_aluno_idade
[0m17:51:12.448078 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m17:51:12.448712 [info ] [Thread-1 (]: 11 of 13 SKIP relation staging_marts.view_frequencia_situacao_escola ........... [[33mSKIP[0m]
[0m17:51:12.449333 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m17:51:12.449949 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_matricula_detalhada
[0m17:51:12.450549 [info ] [Thread-1 (]: 12 of 13 SKIP relation staging_marts.view_matricula_detalhada .................. [[33mSKIP[0m]
[0m17:51:12.451302 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_matricula_detalhada
[0m17:51:12.452098 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_taxa_aprovados
[0m17:51:12.452906 [info ] [Thread-1 (]: 13 of 13 SKIP relation staging_marts.view_taxa_aprovados ....................... [[33mSKIP[0m]
[0m17:51:12.453716 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_taxa_aprovados
[0m17:51:12.455126 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:12.455734 [debug] [MainThread]: On master: BEGIN
[0m17:51:12.456199 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:51:13.298393 [debug] [MainThread]: SQL status: BEGIN in 0.842 seconds
[0m17:51:13.299419 [debug] [MainThread]: On master: COMMIT
[0m17:51:13.300574 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:13.301282 [debug] [MainThread]: On master: COMMIT
[0m17:51:13.403752 [debug] [MainThread]: SQL status: COMMIT in 0.102 seconds
[0m17:51:13.404625 [debug] [MainThread]: On master: Close
[0m17:51:13.405315 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:13.405674 [debug] [MainThread]: Connection 'model.transformacao_matricula.staging_situacao_alunos' was properly closed.
[0m17:51:13.406131 [info ] [MainThread]: 
[0m17:51:13.406549 [info ] [MainThread]: Finished running 9 table models, 4 view models in 0 hours 0 minutes and 19.79 seconds (19.79s).
[0m17:51:13.407539 [debug] [MainThread]: Command end result
[0m17:51:13.438550 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m17:51:13.441015 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m17:51:13.447650 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m17:51:13.448281 [info ] [MainThread]: 
[0m17:51:13.448948 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:51:13.449581 [info ] [MainThread]: 
[0m17:51:13.450757 [error] [MainThread]: [31mFailure in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)[0m
[0m17:51:13.451537 [error] [MainThread]:   Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  relation "staging.staging_alunos_raw" does not exist
  LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."stagi...
                             ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m17:51:13.452318 [info ] [MainThread]: 
[0m17:51:13.453415 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m17:51:13.454284 [info ] [MainThread]: 
[0m17:51:13.455230 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=12 NO-OP=0 TOTAL=13
[0m17:51:13.456394 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 6 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:51:13.457764 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 21.468224, "process_in_blocks": "0", "process_kernel_time": 0.343109, "process_mem_max_rss": "130072", "process_out_blocks": "3624", "process_user_time": 2.911953}
[0m17:51:13.458418 [debug] [MainThread]: Command `dbt run` failed at 17:51:13.458319 after 21.47 seconds
[0m17:51:13.458984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f8e145b200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f8dff8c560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f8deb842c0>]}
[0m17:51:13.459579 [debug] [MainThread]: Flushing usage events
[0m17:51:13.975750 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:00:43.682625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7777b25b97c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7777b250ab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7777b2abffe0>]}


============================== 18:00:43.685631 | 0712b76c-da1b-4ec8-a754-3c2244250ff6 ==============================
[0m18:00:43.685631 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:00:43.686141 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'partial_parse': 'True', 'log_format': 'default', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'profiles_dir': '/home/murilo/.dbt', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'quiet': 'False', 'warn_error': 'None', 'write_json': 'True', 'no_print': 'None', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'target_path': 'None', 'use_colors': 'True'}
[0m18:00:43.784233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0712b76c-da1b-4ec8-a754-3c2244250ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7777b2247a40>]}
[0m18:00:43.794823 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.15801723, "process_in_blocks": "0", "process_kernel_time": 0.206916, "process_mem_max_rss": "101656", "process_out_blocks": "8", "process_user_time": 1.142017}
[0m18:00:43.795401 [debug] [MainThread]: Command `dbt clean` succeeded at 18:00:43.795303 after 0.16 seconds
[0m18:00:43.795804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7777b2b99a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7777b2037dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7777b20379e0>]}
[0m18:00:43.796175 [debug] [MainThread]: Flushing usage events
[0m18:00:44.426321 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:00:47.515530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7566539a3a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7566554dec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756652afda00>]}


============================== 18:00:47.518599 | de98494c-bc05-45de-ab43-548931688652 ==============================
[0m18:00:47.518599 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:00:47.519138 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'static_parser': 'True', 'quiet': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'version_check': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'debug': 'False', 'use_colors': 'True', 'empty': 'False', 'introspect': 'True', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'profiles_dir': '/home/murilo/.dbt'}
[0m18:00:47.669683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de98494c-bc05-45de-ab43-548931688652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7566529bd160>]}
[0m18:00:47.723835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de98494c-bc05-45de-ab43-548931688652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7566531c9640>]}
[0m18:00:47.724756 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:00:47.834238 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m18:00:47.834902 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:00:47.835286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'de98494c-bc05-45de-ab43-548931688652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7566526dd010>]}
[0m18:00:48.817787 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m18:00:48.818413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'de98494c-bc05-45de-ab43-548931688652', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756650f6c5f0>]}
[0m18:00:49.038061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de98494c-bc05-45de-ab43-548931688652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756650f0e3f0>]}
[0m18:00:49.109039 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m18:00:49.111212 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m18:00:49.124816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de98494c-bc05-45de-ab43-548931688652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756650b759a0>]}
[0m18:00:49.125364 [info ] [MainThread]: Found 13 models, 37 data tests, 1 source, 459 macros
[0m18:00:49.125778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de98494c-bc05-45de-ab43-548931688652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756650f59c70>]}
[0m18:00:49.128033 [info ] [MainThread]: 
[0m18:00:49.128505 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m18:00:49.128878 [info ] [MainThread]: 
[0m18:00:49.129388 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:00:49.133598 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula'
[0m18:00:49.173846 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m18:00:49.174577 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m18:00:49.175127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:50.071924 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.897 seconds
[0m18:00:50.073753 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m18:00:50.076227 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m18:00:50.076775 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m18:00:50.077199 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:50.919257 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.842 seconds
[0m18:00:50.920944 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m18:00:50.922956 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m18:00:50.923466 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m18:00:50.923853 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:51.775795 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.852 seconds
[0m18:00:51.776970 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m18:00:51.779127 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m18:00:51.779666 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m18:00:51.779996 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:52.630042 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.850 seconds
[0m18:00:52.631296 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m18:00:52.634487 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m18:00:52.635025 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m18:00:52.635400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:53.478713 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.843 seconds
[0m18:00:53.479919 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m18:00:53.482210 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula, now list_transformacao_matricula_staging_facts)
[0m18:00:53.487955 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_facts"
[0m18:00:53.488398 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: BEGIN
[0m18:00:53.488715 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:54.339889 [debug] [ThreadPool]: SQL status: BEGIN in 0.851 seconds
[0m18:00:54.340362 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_facts"
[0m18:00:54.340783 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_facts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_facts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_facts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_facts'
  
[0m18:00:54.450989 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.109 seconds
[0m18:00:54.453131 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: ROLLBACK
[0m18:00:54.557086 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: Close
[0m18:00:54.558490 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_facts, now list_transformacao_matricula_staging_staging)
[0m18:00:54.560361 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m18:00:54.560820 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: BEGIN
[0m18:00:54.561144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:55.427781 [debug] [ThreadPool]: SQL status: BEGIN in 0.867 seconds
[0m18:00:55.428635 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m18:00:55.429712 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_staging"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m18:00:55.541309 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.111 seconds
[0m18:00:55.542939 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: ROLLBACK
[0m18:00:55.647543 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: Close
[0m18:00:55.648981 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_staging, now list_transformacao_matricula_staging_dimensions)
[0m18:00:55.650832 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_dimensions"
[0m18:00:55.651244 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: BEGIN
[0m18:00:55.651559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:56.536894 [debug] [ThreadPool]: SQL status: BEGIN in 0.885 seconds
[0m18:00:56.537722 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_dimensions"
[0m18:00:56.538505 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_dimensions"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dimensions'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dimensions'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dimensions'
  
[0m18:00:56.654116 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.115 seconds
[0m18:00:56.655261 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: ROLLBACK
[0m18:00:56.763036 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: Close
[0m18:00:56.764740 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_dimensions, now list_transformacao_matricula_staging_intermediate)
[0m18:00:56.766965 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_intermediate"
[0m18:00:56.767396 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: BEGIN
[0m18:00:56.767724 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:57.663758 [debug] [ThreadPool]: SQL status: BEGIN in 0.896 seconds
[0m18:00:57.664239 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_intermediate"
[0m18:00:57.664583 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_intermediate"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_intermediate'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_intermediate'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_intermediate'
  
[0m18:00:57.778074 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.113 seconds
[0m18:00:57.779263 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: ROLLBACK
[0m18:00:57.888229 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: Close
[0m18:00:57.889514 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_intermediate, now list_transformacao_matricula_staging_marts)
[0m18:00:57.892057 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m18:00:57.892513 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: BEGIN
[0m18:00:57.892870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:58.725772 [debug] [ThreadPool]: SQL status: BEGIN in 0.833 seconds
[0m18:00:58.726452 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m18:00:58.727230 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_marts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m18:00:58.834454 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.106 seconds
[0m18:00:58.836133 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: ROLLBACK
[0m18:00:58.940871 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: Close
[0m18:00:58.945680 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:58.946135 [debug] [MainThread]: On master: BEGIN
[0m18:00:58.946448 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:00:59.824996 [debug] [MainThread]: SQL status: BEGIN in 0.878 seconds
[0m18:00:59.825903 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:59.826412 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:00:59.939305 [debug] [MainThread]: SQL status: SELECT 0 in 0.112 seconds
[0m18:00:59.940530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de98494c-bc05-45de-ab43-548931688652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7566526ad460>]}
[0m18:00:59.941017 [debug] [MainThread]: On master: ROLLBACK
[0m18:01:00.049289 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:00.050047 [debug] [MainThread]: On master: BEGIN
[0m18:01:00.268257 [debug] [MainThread]: SQL status: BEGIN in 0.217 seconds
[0m18:01:00.269159 [debug] [MainThread]: On master: COMMIT
[0m18:01:00.269568 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:00.270000 [debug] [MainThread]: On master: COMMIT
[0m18:01:00.377566 [debug] [MainThread]: SQL status: COMMIT in 0.107 seconds
[0m18:01:00.378075 [debug] [MainThread]: On master: Close
[0m18:01:00.381474 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.staging_situacao_alunos
[0m18:01:00.382446 [info ] [Thread-1 (]: 1 of 13 START sql table model staging_staging.staging_situacao_alunos .......... [RUN]
[0m18:01:00.382985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_marts, now model.transformacao_matricula.staging_situacao_alunos)
[0m18:01:00.383429 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.staging_situacao_alunos
[0m18:01:00.390512 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.staging_situacao_alunos"
[0m18:01:00.391390 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.staging_situacao_alunos
[0m18:01:00.432240 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.staging_situacao_alunos"
[0m18:01:00.433155 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m18:01:00.433554 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: BEGIN
[0m18:01:00.433958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:01.270807 [debug] [Thread-1 (]: SQL status: BEGIN in 0.837 seconds
[0m18:01:01.271834 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m18:01:01.272973 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */

  
    

  create  table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp"
  
  
    as
  
  (
    WITH source AS (
    SELECT * FROM "transformacao_matricula"."staging"."staging_alunos_raw"
),

cleaning_renaming AS (
    SELECT
        ano,
        codigo_escola,
        matricula,
        escola AS nome_escola,
        endereco_logradouro AS endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa,
        modalidade_ensino_codigo AS mod_ens_codigo,
        -- Transformação da SÉRIE
        CASE
            -- Ensino Fundamental (1º ao 9º)
            WHEN serie LIKE '%1 ANO%' OR serie LIKE '%1º ANO%' THEN '1º ANO'
            WHEN serie LIKE '%2 ANO%' OR serie LIKE '%2º ANO%' THEN '2º ANO'
            WHEN serie LIKE '%3 ANO%' OR serie LIKE '%3º ANO%' THEN '3º ANO'
            WHEN serie LIKE '%4 ANO%' OR serie LIKE '%4º ANO%' THEN '4º ANO'
            WHEN serie LIKE '%5 ANO%' OR serie LIKE '%5º ANO%' THEN '5º ANO'
            WHEN serie LIKE '%6 ANO%' OR serie LIKE '%6º ANO%' THEN '6º ANO'
            WHEN serie LIKE '%7 ANO%' OR serie LIKE '%7º ANO%' THEN '7º ANO'
            WHEN serie LIKE '%8 ANO%' OR serie LIKE '%8º ANO%' THEN '8º ANO'
            WHEN serie LIKE '%9 ANO%' OR serie LIKE '%9º ANO%' THEN '9º ANO'
            -- Educação Infantil (Berçário e Grupos)
            WHEN serie LIKE '%BER%' THEN 'BERÇARIO'
            WHEN serie LIKE '%GRUPO I%' OR serie LIKE '%GRUPO 1%' THEN 'GRUPO I'
            WHEN serie LIKE '%GRUPO II%' THEN 'GRUPO II'
            WHEN serie LIKE '%GRUPO III%' THEN 'GRUPO III'
            WHEN serie LIKE '%GRUPO IV%' THEN 'GRUPO IV'
            WHEN serie LIKE '%GRUPO V%' THEN 'GRUPO V'
            -- EJA (Módulos 1 ao 5) 
            WHEN serie LIKE '%1%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 1'
            WHEN serie LIKE '%2%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 2'
            WHEN serie LIKE '%3%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 3'
            WHEN serie LIKE '%4%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 4'
            WHEN serie LIKE '%5%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 5'
            WHEN serie LIKE '%TRAVESSIA%' THEN 'TRAVESSIA RECIFE'
            WHEN serie LIKE '%CORRECAO%1%' THEN 'CORREÇÃO DE FLUXO 1 - ALFABETIZACAO'
            WHEN serie LIKE '%CORRECAO%2%' THEN 'CORREÇÃO DE FLUXO 2 - ACELERACAO'
            ELSE 'OUTROS'
        END AS serie,
        turma,
        turno,
        idade,
        -- transformação do SEXO
        CASE
            WHEN sexo = '1' THEN 'Masculino'
            WHEN sexo = '2' THEN 'Feminino'
            WHEN sexo = '3' THEN 'Outros'
            ELSE 'Não informado'
        END AS sexo,
        -- transformação de situacao
        CASE 
            WHEN situacao_nome LIKE '%APROV%' THEN 'Aprovado'
            WHEN situacao_nome LIKE '%RET%' OR situacao_nome LIKE '%REPRO%' THEN 'Reprovado'
            WHEN situacao_nome LIKE '%TR%' OR situacao_nome LIKE '%REMAN%' THEN 'Transferido'
            WHEN situacao_nome LIKE '%DESIST%' THEN 'Desistente'
            ELSE 'Outros'
        END AS sit_nome,
        -- Transformação da MODALIDADE
        CASE
            WHEN modalidade_ensino LIKE '%EDUCACAO INFANTIL%' THEN 'EDUCAÇÃO INFANTIL'
            WHEN modalidade_ensino LIKE '%ENSINO FUNDAMENTAL%' THEN 'ENSINO FUNDAMENTAL'
            WHEN modalidade_ensino LIKE '%EDUCACAO JOVENS E ADULTOS%' THEN 'EJA'
            WHEN modalidade_ensino LIKE '%CORRE%' THEN 'CORREÇÃO DE FLUXO'
            ELSE 'OUTROS'
        END AS modalidade_ens
    FROM source
)

SELECT * FROM cleaning_renaming
  );
  
[0m18:01:01.378050 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "staging.staging_alunos_raw" does not exist
LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."stagi...
                           ^

[0m18:01:01.379024 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: ROLLBACK
[0m18:01:01.481334 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: Close
[0m18:01:01.484928 [debug] [Thread-1 (]: Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  relation "staging.staging_alunos_raw" does not exist
  LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."stagi...
                             ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m18:01:01.486389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de98494c-bc05-45de-ab43-548931688652', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75664d9d4ef0>]}
[0m18:01:01.487084 [error] [Thread-1 (]: 1 of 13 ERROR creating sql table model staging_staging.staging_situacao_alunos . [[31mERROR[0m in 1.10s]
[0m18:01:01.487686 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.staging_situacao_alunos
[0m18:01:01.488558 [debug] [Thread-4 (]: Marking all children of 'model.transformacao_matricula.staging_situacao_alunos' to be skipped because of status 'error'.  Reason: Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  relation "staging.staging_alunos_raw" does not exist
  LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."stagi...
                             ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql.
[0m18:01:01.490202 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.transform_data
[0m18:01:01.490896 [info ] [Thread-1 (]: 2 of 13 SKIP relation staging_intermediate.transform_data ...................... [[33mSKIP[0m]
[0m18:01:01.491516 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.transform_data
[0m18:01:01.492764 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_aluno
[0m18:01:01.493194 [info ] [Thread-1 (]: 3 of 13 SKIP relation staging_dimensions.dim_aluno ............................. [[33mSKIP[0m]
[0m18:01:01.493664 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_aluno
[0m18:01:01.494081 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_escola
[0m18:01:01.494650 [info ] [Thread-1 (]: 4 of 13 SKIP relation staging_dimensions.dim_escola ............................ [[33mSKIP[0m]
[0m18:01:01.495267 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_escola
[0m18:01:01.495742 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_localizacao
[0m18:01:01.496317 [info ] [Thread-1 (]: 5 of 13 SKIP relation staging_dimensions.dim_localizacao ....................... [[33mSKIP[0m]
[0m18:01:01.496866 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_localizacao
[0m18:01:01.497358 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_situacao
[0m18:01:01.497945 [info ] [Thread-1 (]: 6 of 13 SKIP relation staging_dimensions.dim_situacao .......................... [[33mSKIP[0m]
[0m18:01:01.498467 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_situacao
[0m18:01:01.498938 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_tempo
[0m18:01:01.499482 [info ] [Thread-1 (]: 7 of 13 SKIP relation staging_dimensions.dim_tempo ............................. [[33mSKIP[0m]
[0m18:01:01.499950 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_tempo
[0m18:01:01.500417 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_turma
[0m18:01:01.500980 [info ] [Thread-1 (]: 8 of 13 SKIP relation staging_dimensions.dim_turma ............................. [[33mSKIP[0m]
[0m18:01:01.501551 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_turma
[0m18:01:01.502445 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.fato_matricula
[0m18:01:01.503092 [info ] [Thread-1 (]: 9 of 13 SKIP relation staging_facts.fato_matricula ............................. [[33mSKIP[0m]
[0m18:01:01.503701 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.fato_matricula
[0m18:01:01.504916 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_count_aluno_idade
[0m18:01:01.505574 [info ] [Thread-1 (]: 10 of 13 SKIP relation staging_marts.view_count_aluno_idade .................... [[33mSKIP[0m]
[0m18:01:01.506168 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_count_aluno_idade
[0m18:01:01.506746 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m18:01:01.507290 [info ] [Thread-1 (]: 11 of 13 SKIP relation staging_marts.view_frequencia_situacao_escola ........... [[33mSKIP[0m]
[0m18:01:01.508031 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m18:01:01.508645 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_matricula_detalhada
[0m18:01:01.509259 [info ] [Thread-1 (]: 12 of 13 SKIP relation staging_marts.view_matricula_detalhada .................. [[33mSKIP[0m]
[0m18:01:01.509880 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_matricula_detalhada
[0m18:01:01.510458 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_taxa_aprovados
[0m18:01:01.511093 [info ] [Thread-1 (]: 13 of 13 SKIP relation staging_marts.view_taxa_aprovados ....................... [[33mSKIP[0m]
[0m18:01:01.511752 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_taxa_aprovados
[0m18:01:01.513417 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:01.514018 [debug] [MainThread]: On master: BEGIN
[0m18:01:01.514492 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:01:02.354043 [debug] [MainThread]: SQL status: BEGIN in 0.839 seconds
[0m18:01:02.355134 [debug] [MainThread]: On master: COMMIT
[0m18:01:02.356068 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:02.356625 [debug] [MainThread]: On master: COMMIT
[0m18:01:02.460216 [debug] [MainThread]: SQL status: COMMIT in 0.103 seconds
[0m18:01:02.461311 [debug] [MainThread]: On master: Close
[0m18:01:02.462335 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:02.462959 [debug] [MainThread]: Connection 'model.transformacao_matricula.staging_situacao_alunos' was properly closed.
[0m18:01:02.463670 [info ] [MainThread]: 
[0m18:01:02.464340 [info ] [MainThread]: Finished running 9 table models, 4 view models in 0 hours 0 minutes and 13.33 seconds (13.33s).
[0m18:01:02.465514 [debug] [MainThread]: Command end result
[0m18:01:02.502764 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m18:01:02.505583 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m18:01:02.512352 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m18:01:02.512929 [info ] [MainThread]: 
[0m18:01:02.513454 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:01:02.514054 [info ] [MainThread]: 
[0m18:01:02.514578 [error] [MainThread]: [31mFailure in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)[0m
[0m18:01:02.515133 [error] [MainThread]:   Database Error in model staging_situacao_alunos (transformacao_aprovados/models/staging/staging_situacao_alunos.sql)
  relation "staging.staging_alunos_raw" does not exist
  LINE 13:     SELECT * FROM "transformacao_matricula"."staging"."stagi...
                             ^
  compiled code at target/run/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m18:01:02.515694 [info ] [MainThread]: 
[0m18:01:02.516401 [info ] [MainThread]:   compiled code at target/compiled/transformacao_matricula/transformacao_aprovados/models/staging/staging_situacao_alunos.sql
[0m18:01:02.516956 [info ] [MainThread]: 
[0m18:01:02.517444 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=12 NO-OP=0 TOTAL=13
[0m18:01:02.518208 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 6 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:01:02.519440 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 15.048249, "process_in_blocks": "0", "process_kernel_time": 0.339594, "process_mem_max_rss": "130192", "process_out_blocks": "3632", "process_user_time": 2.899494}
[0m18:01:02.520054 [debug] [MainThread]: Command `dbt run` failed at 18:01:02.519950 after 15.05 seconds
[0m18:01:02.520578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756653710b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756652afda00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756650707c20>]}
[0m18:01:02.521076 [debug] [MainThread]: Flushing usage events
[0m18:01:02.978842 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:07:35.413576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2c7cef8e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2c7b33e7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2c7b6f1100>]}


============================== 18:07:35.417011 | b8aa8e0e-b353-48bd-aca9-2c4f5a990f5d ==============================
[0m18:07:35.417011 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:07:35.417725 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'static_parser': 'True', 'warn_error': 'None', 'introspect': 'True', 'fail_fast': 'False', 'no_print': 'None', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'printer_width': '80', 'log_format': 'default', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'write_json': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/murilo/.dbt', 'debug': 'False', 'target_path': 'None', 'quiet': 'False', 'version_check': 'True', 'invocation_command': 'dbt clean', 'partial_parse': 'True'}
[0m18:07:35.518594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8aa8e0e-b353-48bd-aca9-2c4f5a990f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2c7bdd0ad0>]}
[0m18:07:35.529191 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.16195856, "process_in_blocks": "24", "process_kernel_time": 0.184588, "process_mem_max_rss": "101576", "process_out_blocks": "16", "process_user_time": 1.172385}
[0m18:07:35.529833 [debug] [MainThread]: Command `dbt clean` succeeded at 18:07:35.529713 after 0.16 seconds
[0m18:07:35.530234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2c7d9e3140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2c7adb91f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2c7b653e30>]}
[0m18:07:35.530635 [debug] [MainThread]: Flushing usage events
[0m18:07:36.319695 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:07:45.469133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf9ed7a0170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf9ebefa660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf9ec406a80>]}


============================== 18:07:45.472564 | a430b7ff-c6ae-4635-b87b-6f178a068b7c ==============================
[0m18:07:45.472564 [info ] [MainThread]: Running with dbt=1.10.15
[0m18:07:45.473178 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'introspect': 'True', 'profiles_dir': '/home/murilo/.dbt', 'quiet': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'log_path': '/home/murilo/UFPE/BD/Grupo7-BancoDeDados/logs', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'target_path': 'None', 'debug': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run', 'printer_width': '80', 'write_json': 'True', 'indirect_selection': 'eager', 'empty': 'False'}
[0m18:07:45.607486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a430b7ff-c6ae-4635-b87b-6f178a068b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf9eb2c87d0>]}
[0m18:07:45.658475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a430b7ff-c6ae-4635-b87b-6f178a068b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf9edafe660>]}
[0m18:07:45.659385 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m18:07:45.765685 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m18:07:45.766360 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:07:45.766778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a430b7ff-c6ae-4635-b87b-6f178a068b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf9ea50e2a0>]}
[0m18:07:46.721600 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m18:07:46.722296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a430b7ff-c6ae-4635-b87b-6f178a068b7c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf9e9da0710>]}
[0m18:07:46.941826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a430b7ff-c6ae-4635-b87b-6f178a068b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf9e91d94f0>]}
[0m18:07:47.012735 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m18:07:47.014468 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m18:07:47.028242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a430b7ff-c6ae-4635-b87b-6f178a068b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf9e95cb260>]}
[0m18:07:47.028845 [info ] [MainThread]: Found 13 models, 37 data tests, 1 source, 459 macros
[0m18:07:47.029251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a430b7ff-c6ae-4635-b87b-6f178a068b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf9e9506600>]}
[0m18:07:47.031544 [info ] [MainThread]: 
[0m18:07:47.032070 [info ] [MainThread]: Concurrency: 1 threads (target='transformacao_matricula_db')
[0m18:07:47.032483 [info ] [MainThread]: 
[0m18:07:47.033226 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:07:47.037526 [debug] [ThreadPool]: Acquiring new postgres connection 'list_transformacao_matricula'
[0m18:07:47.078748 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m18:07:47.079411 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m18:07:47.079839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:48.711360 [debug] [ThreadPool]: SQL status: SELECT 10 in 1.631 seconds
[0m18:07:48.712670 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m18:07:48.714876 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m18:07:48.715430 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m18:07:48.715810 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:07:50.566901 [debug] [ThreadPool]: SQL status: SELECT 10 in 1.851 seconds
[0m18:07:50.568624 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m18:07:50.570640 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m18:07:50.571134 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m18:07:50.571492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:07:52.116238 [debug] [ThreadPool]: SQL status: SELECT 10 in 1.545 seconds
[0m18:07:52.117820 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m18:07:52.119905 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m18:07:52.120501 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m18:07:52.120984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:07:55.585973 [debug] [ThreadPool]: SQL status: SELECT 10 in 3.465 seconds
[0m18:07:55.587413 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m18:07:55.590629 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula"
[0m18:07:55.591300 [debug] [ThreadPool]: On list_transformacao_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula"} */

    select distinct nspname from pg_namespace
  
[0m18:07:55.592087 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:07:56.889844 [debug] [ThreadPool]: SQL status: SELECT 10 in 1.298 seconds
[0m18:07:56.891491 [debug] [ThreadPool]: On list_transformacao_matricula: Close
[0m18:07:56.894568 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula, now list_transformacao_matricula_staging_intermediate)
[0m18:07:56.900381 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_intermediate"
[0m18:07:56.900843 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: BEGIN
[0m18:07:56.901155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:07:58.953223 [debug] [ThreadPool]: SQL status: BEGIN in 2.052 seconds
[0m18:07:58.954080 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_intermediate"
[0m18:07:58.954430 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_intermediate"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_intermediate'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_intermediate'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_intermediate'
  
[0m18:07:59.070431 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.116 seconds
[0m18:07:59.072046 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: ROLLBACK
[0m18:07:59.262181 [debug] [ThreadPool]: On list_transformacao_matricula_staging_intermediate: Close
[0m18:07:59.263223 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_intermediate, now list_transformacao_matricula_staging_marts)
[0m18:07:59.265033 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m18:07:59.265430 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: BEGIN
[0m18:07:59.265879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:00.296304 [debug] [ThreadPool]: SQL status: BEGIN in 1.030 seconds
[0m18:08:00.296841 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_marts"
[0m18:08:00.297583 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_marts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_marts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_marts'
  
[0m18:08:00.406992 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.109 seconds
[0m18:08:00.408670 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: ROLLBACK
[0m18:08:00.695653 [debug] [ThreadPool]: On list_transformacao_matricula_staging_marts: Close
[0m18:08:00.696513 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_marts, now list_transformacao_matricula_staging_staging)
[0m18:08:00.698433 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m18:08:00.698860 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: BEGIN
[0m18:08:00.699166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:01.556246 [debug] [ThreadPool]: SQL status: BEGIN in 0.857 seconds
[0m18:08:01.557131 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_staging"
[0m18:08:01.557621 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_staging"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m18:08:01.664854 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.107 seconds
[0m18:08:01.666382 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: ROLLBACK
[0m18:08:01.768347 [debug] [ThreadPool]: On list_transformacao_matricula_staging_staging: Close
[0m18:08:01.769324 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_staging, now list_transformacao_matricula_staging_dimensions)
[0m18:08:01.771062 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_dimensions"
[0m18:08:01.771460 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: BEGIN
[0m18:08:01.771781 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:02.631371 [debug] [ThreadPool]: SQL status: BEGIN in 0.859 seconds
[0m18:08:02.632375 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_dimensions"
[0m18:08:02.632849 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_dimensions"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_dimensions'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_dimensions'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_dimensions'
  
[0m18:08:02.746566 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.113 seconds
[0m18:08:02.748275 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: ROLLBACK
[0m18:08:02.853673 [debug] [ThreadPool]: On list_transformacao_matricula_staging_dimensions: Close
[0m18:08:02.854832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_dimensions, now list_transformacao_matricula_staging_facts)
[0m18:08:02.857431 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_facts"
[0m18:08:02.857954 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: BEGIN
[0m18:08:02.858372 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:03.701291 [debug] [ThreadPool]: SQL status: BEGIN in 0.843 seconds
[0m18:08:03.702187 [debug] [ThreadPool]: Using postgres connection "list_transformacao_matricula_staging_facts"
[0m18:08:03.702851 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "list_transformacao_matricula_staging_facts"} */
select
      'transformacao_matricula' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_facts'
    union all
    select
      'transformacao_matricula' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_facts'
    union all
    select
      'transformacao_matricula' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_facts'
  
[0m18:08:03.815345 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.112 seconds
[0m18:08:03.817236 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: ROLLBACK
[0m18:08:03.925208 [debug] [ThreadPool]: On list_transformacao_matricula_staging_facts: Close
[0m18:08:03.930353 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:03.930832 [debug] [MainThread]: On master: BEGIN
[0m18:08:03.931153 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:08:04.822570 [debug] [MainThread]: SQL status: BEGIN in 0.891 seconds
[0m18:08:04.823503 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:04.824208 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m18:08:04.941107 [debug] [MainThread]: SQL status: SELECT 0 in 0.116 seconds
[0m18:08:04.942466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a430b7ff-c6ae-4635-b87b-6f178a068b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf9e9110980>]}
[0m18:08:04.943099 [debug] [MainThread]: On master: ROLLBACK
[0m18:08:05.053419 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:05.053920 [debug] [MainThread]: On master: BEGIN
[0m18:08:05.276707 [debug] [MainThread]: SQL status: BEGIN in 0.222 seconds
[0m18:08:05.277544 [debug] [MainThread]: On master: COMMIT
[0m18:08:05.278112 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:05.278433 [debug] [MainThread]: On master: COMMIT
[0m18:08:05.387961 [debug] [MainThread]: SQL status: COMMIT in 0.109 seconds
[0m18:08:05.388567 [debug] [MainThread]: On master: Close
[0m18:08:05.391334 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.staging_situacao_alunos
[0m18:08:05.392300 [info ] [Thread-1 (]: 1 of 13 START sql table model staging_staging.staging_situacao_alunos .......... [RUN]
[0m18:08:05.392818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_transformacao_matricula_staging_facts, now model.transformacao_matricula.staging_situacao_alunos)
[0m18:08:05.393259 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.staging_situacao_alunos
[0m18:08:05.399545 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.staging_situacao_alunos"
[0m18:08:05.400556 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.staging_situacao_alunos
[0m18:08:05.445337 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.staging_situacao_alunos"
[0m18:08:05.446555 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m18:08:05.447004 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: BEGIN
[0m18:08:05.447375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:06.289113 [debug] [Thread-1 (]: SQL status: BEGIN in 0.842 seconds
[0m18:08:06.289639 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m18:08:06.290398 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */

  
    

  create  table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp"
  
  
    as
  
  (
    WITH source AS (
    SELECT * FROM "transformacao_matricula"."staging"."staging_alunos_raw"
),

cleaning_renaming AS (
    SELECT
        ano,
        codigo_escola,
        matricula,
        escola AS nome_escola,
        endereco_logradouro AS endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa,
        modalidade_ensino_codigo AS mod_ens_codigo,
        -- Transformação da SÉRIE
        CASE
            -- Ensino Fundamental (1º ao 9º)
            WHEN serie LIKE '%1 ANO%' OR serie LIKE '%1º ANO%' THEN '1º ANO'
            WHEN serie LIKE '%2 ANO%' OR serie LIKE '%2º ANO%' THEN '2º ANO'
            WHEN serie LIKE '%3 ANO%' OR serie LIKE '%3º ANO%' THEN '3º ANO'
            WHEN serie LIKE '%4 ANO%' OR serie LIKE '%4º ANO%' THEN '4º ANO'
            WHEN serie LIKE '%5 ANO%' OR serie LIKE '%5º ANO%' THEN '5º ANO'
            WHEN serie LIKE '%6 ANO%' OR serie LIKE '%6º ANO%' THEN '6º ANO'
            WHEN serie LIKE '%7 ANO%' OR serie LIKE '%7º ANO%' THEN '7º ANO'
            WHEN serie LIKE '%8 ANO%' OR serie LIKE '%8º ANO%' THEN '8º ANO'
            WHEN serie LIKE '%9 ANO%' OR serie LIKE '%9º ANO%' THEN '9º ANO'
            -- Educação Infantil (Berçário e Grupos)
            WHEN serie LIKE '%BER%' THEN 'BERÇARIO'
            WHEN serie LIKE '%GRUPO I%' OR serie LIKE '%GRUPO 1%' THEN 'GRUPO I'
            WHEN serie LIKE '%GRUPO II%' THEN 'GRUPO II'
            WHEN serie LIKE '%GRUPO III%' THEN 'GRUPO III'
            WHEN serie LIKE '%GRUPO IV%' THEN 'GRUPO IV'
            WHEN serie LIKE '%GRUPO V%' THEN 'GRUPO V'
            -- EJA (Módulos 1 ao 5) 
            WHEN serie LIKE '%1%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 1'
            WHEN serie LIKE '%2%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 2'
            WHEN serie LIKE '%3%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 3'
            WHEN serie LIKE '%4%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 4'
            WHEN serie LIKE '%5%' AND (serie LIKE '%MÓDULO%' OR serie LIKE '%MDULO%' OR serie LIKE '%MODULO%') THEN 'MÓDULO 5'
            WHEN serie LIKE '%TRAVESSIA%' THEN 'TRAVESSIA RECIFE'
            WHEN serie LIKE '%CORRECAO%1%' THEN 'CORREÇÃO DE FLUXO 1 - ALFABETIZACAO'
            WHEN serie LIKE '%CORRECAO%2%' THEN 'CORREÇÃO DE FLUXO 2 - ACELERACAO'
            ELSE 'OUTROS'
        END AS serie,
        turma,
        turno,
        idade,
        -- transformação do SEXO
        CASE
            WHEN sexo = '1' THEN 'Masculino'
            WHEN sexo = '2' THEN 'Feminino'
            WHEN sexo = '3' THEN 'Outros'
            ELSE 'Não informado'
        END AS sexo,
        -- transformação de situacao
        CASE 
            WHEN situacao_nome LIKE '%APROV%' THEN 'Aprovado'
            WHEN situacao_nome LIKE '%RET%' OR situacao_nome LIKE '%REPRO%' THEN 'Reprovado'
            WHEN situacao_nome LIKE '%TR%' OR situacao_nome LIKE '%REMAN%' THEN 'Transferido'
            WHEN situacao_nome LIKE '%DESIST%' THEN 'Desistente'
            ELSE 'Outros'
        END AS sit_nome,
        -- Transformação da MODALIDADE
        CASE
            WHEN modalidade_ensino LIKE '%EDUCACAO INFANTIL%' THEN 'EDUCAÇÃO INFANTIL'
            WHEN modalidade_ensino LIKE '%ENSINO FUNDAMENTAL%' THEN 'ENSINO FUNDAMENTAL'
            WHEN modalidade_ensino LIKE '%EDUCACAO JOVENS E ADULTOS%' THEN 'EJA'
            WHEN modalidade_ensino LIKE '%CORRE%' THEN 'CORREÇÃO DE FLUXO'
            ELSE 'OUTROS'
        END AS modalidade_ens
    FROM source
)

SELECT * FROM cleaning_renaming
  );
  
[0m18:08:08.374914 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 2.083 seconds
[0m18:08:08.384483 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m18:08:08.384997 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
alter table "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_tmp" rename to "staging_situacao_alunos"
[0m18:08:08.492758 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.107 seconds
[0m18:08:08.506625 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: COMMIT
[0m18:08:08.507144 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m18:08:08.507519 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: COMMIT
[0m18:08:08.612511 [debug] [Thread-1 (]: SQL status: COMMIT in 0.104 seconds
[0m18:08:08.617924 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_backup"
[0m18:08:08.622710 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.staging_situacao_alunos"
[0m18:08:08.623212 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.staging_situacao_alunos"} */
drop table if exists "transformacao_matricula"."staging_staging"."staging_situacao_alunos__dbt_backup" cascade
[0m18:08:08.784891 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.161 seconds
[0m18:08:08.787225 [debug] [Thread-1 (]: On model.transformacao_matricula.staging_situacao_alunos: Close
[0m18:08:08.788925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a430b7ff-c6ae-4635-b87b-6f178a068b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf9ec298aa0>]}
[0m18:08:08.789635 [info ] [Thread-1 (]: 1 of 13 OK created sql table model staging_staging.staging_situacao_alunos ..... [[32mSELECT 319146[0m in 3.40s]
[0m18:08:08.790231 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.staging_situacao_alunos
[0m18:08:08.791404 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.transform_data
[0m18:08:08.791951 [info ] [Thread-1 (]: 2 of 13 START sql table model staging_intermediate.transform_data .............. [RUN]
[0m18:08:08.792481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.staging_situacao_alunos, now model.transformacao_matricula.transform_data)
[0m18:08:08.793008 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.transform_data
[0m18:08:08.795721 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.transform_data"
[0m18:08:08.796557 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.transform_data
[0m18:08:08.799990 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.transform_data"
[0m18:08:08.800851 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m18:08:08.801352 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: BEGIN
[0m18:08:08.801830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:10.428801 [debug] [Thread-1 (]: SQL status: BEGIN in 1.627 seconds
[0m18:08:10.429584 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m18:08:10.430021 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */

  
    

  create  table "transformacao_matricula"."staging_intermediate"."transform_data__dbt_tmp"
  
  
    as
  
  (
    

with staged_data AS (
    SELECT * FROM "transformacao_matricula"."staging_staging"."staging_situacao_alunos"
),

transformed_data AS (
    SELECT
        CAST(ano AS INTEGER) AS ano,
        CAST(codigo_escola AS INTEGER) AS codigo_escola,
        CAST(matricula AS INTEGER) AS matricula,
        nome_escola,
        endereco_logra,
        endereco_bairro,
        endereco_numero,
        CAST(rpa AS INTEGER) AS rpa,
        CAST(mod_ens_codigo AS INTEGER) AS mod_ens_codigo,
        serie,
        turma,
        turno,
        CAST(idade AS INTEGER) AS idade,
        sexo,
        sit_nome AS situacao_nome,
        modalidade_ens,
        CASE
            WHEN CAST(idade AS INTEGER) <= 3 THEN '0-3 Anos (Educação Infantil)'
            WHEN CAST(idade AS INTEGER) <= 5 THEN '4-5 Anos (Pré-escola)'
            WHEN CAST(idade AS INTEGER) <= 10 THEN '6-10 Anos (Fundamental I)'
            WHEN CAST(idade AS INTEGER) <= 14 THEN '11-14 Anos (Fundamental II)'
            WHEN CAST(idade AS INTEGER) >= 15 THEN '15+ Anos (EJA e Outros)'
            ELSE 'Não Informado'
        END AS faixa_etaria
    FROM staged_data
)

SELECT * FROM transformed_data
  );
  
[0m18:08:13.842956 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 3.412 seconds
[0m18:08:13.846064 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m18:08:13.846530 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
alter table "transformacao_matricula"."staging_intermediate"."transform_data__dbt_tmp" rename to "transform_data"
[0m18:08:13.995214 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.148 seconds
[0m18:08:13.997015 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: COMMIT
[0m18:08:13.997458 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m18:08:13.997958 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: COMMIT
[0m18:08:14.111993 [debug] [Thread-1 (]: SQL status: COMMIT in 0.113 seconds
[0m18:08:14.114415 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_intermediate"."transform_data__dbt_backup"
[0m18:08:14.115423 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.transform_data"
[0m18:08:14.115874 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.transform_data"} */
drop table if exists "transformacao_matricula"."staging_intermediate"."transform_data__dbt_backup" cascade
[0m18:08:14.223174 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.107 seconds
[0m18:08:14.224537 [debug] [Thread-1 (]: On model.transformacao_matricula.transform_data: Close
[0m18:08:14.225275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a430b7ff-c6ae-4635-b87b-6f178a068b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf9e91da3f0>]}
[0m18:08:14.225929 [info ] [Thread-1 (]: 2 of 13 OK created sql table model staging_intermediate.transform_data ......... [[32mSELECT 319146[0m in 5.43s]
[0m18:08:14.226500 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.transform_data
[0m18:08:14.227750 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_aluno
[0m18:08:14.228265 [info ] [Thread-1 (]: 3 of 13 START sql table model staging_dimensions.dim_aluno ..................... [RUN]
[0m18:08:14.228751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.transform_data, now model.transformacao_matricula.dim_aluno)
[0m18:08:14.229164 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_aluno
[0m18:08:14.231803 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_aluno"
[0m18:08:14.232777 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_aluno
[0m18:08:14.237139 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_aluno"
[0m18:08:14.238192 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m18:08:14.238877 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: BEGIN
[0m18:08:14.239480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:15.236103 [debug] [Thread-1 (]: SQL status: BEGIN in 0.997 seconds
[0m18:08:15.236631 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m18:08:15.237084 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_aluno"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_aluno__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),
alunos_unicos AS (
    SELECT DISTINCT
        matricula,
        sexo,
        idade,
        faixa_etaria
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY matricula) - 1 AS id_aluno, -- Surrogate Key
        matricula,
        sexo,
        idade,
        faixa_etaria
    FROM alunos_unicos
)

SELECT * FROM versao_final
  );
  
[0m18:08:16.922852 [debug] [Thread-1 (]: SQL status: SELECT 319143 in 1.685 seconds
[0m18:08:16.925773 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m18:08:16.926224 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_aluno"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_aluno__dbt_tmp" rename to "dim_aluno"
[0m18:08:17.182995 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.256 seconds
[0m18:08:17.185102 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: COMMIT
[0m18:08:17.185582 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m18:08:17.185958 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: COMMIT
[0m18:08:17.364130 [debug] [Thread-1 (]: SQL status: COMMIT in 0.178 seconds
[0m18:08:17.366343 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_aluno__dbt_backup"
[0m18:08:17.367201 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_aluno"
[0m18:08:17.367671 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_aluno"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_aluno__dbt_backup" cascade
[0m18:08:17.489409 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.121 seconds
[0m18:08:17.490867 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_aluno: Close
[0m18:08:17.491588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a430b7ff-c6ae-4635-b87b-6f178a068b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf9e44ee120>]}
[0m18:08:17.492238 [info ] [Thread-1 (]: 3 of 13 OK created sql table model staging_dimensions.dim_aluno ................ [[32mSELECT 319143[0m in 3.26s]
[0m18:08:17.492828 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_aluno
[0m18:08:17.493283 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_escola
[0m18:08:17.494009 [info ] [Thread-1 (]: 4 of 13 START sql table model staging_dimensions.dim_escola .................... [RUN]
[0m18:08:17.494632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_aluno, now model.transformacao_matricula.dim_escola)
[0m18:08:17.495085 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_escola
[0m18:08:17.499705 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_escola"
[0m18:08:17.500369 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_escola
[0m18:08:17.503399 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_escola"
[0m18:08:17.504099 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m18:08:17.504490 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: BEGIN
[0m18:08:17.504867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:18.676429 [debug] [Thread-1 (]: SQL status: BEGIN in 1.171 seconds
[0m18:08:18.677260 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m18:08:18.677666 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_escola__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),
escolas_unicas AS (
    SELECT DISTINCT
        codigo_escola,
        nome_escola,
        endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY codigo_escola) - 1 AS id_escola, -- Surrogate Key
        codigo_escola,
        nome_escola,
        endereco_logra,
        endereco_bairro,
        endereco_numero,
        rpa
    FROM escolas_unicas
)

SELECT * FROM versao_final
  );
  
[0m18:08:19.141510 [debug] [Thread-1 (]: SQL status: SELECT 433 in 0.463 seconds
[0m18:08:19.144685 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m18:08:19.145172 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_escola__dbt_tmp" rename to "dim_escola"
[0m18:08:19.263562 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.118 seconds
[0m18:08:19.265532 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: COMMIT
[0m18:08:19.265992 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m18:08:19.266364 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: COMMIT
[0m18:08:19.375122 [debug] [Thread-1 (]: SQL status: COMMIT in 0.108 seconds
[0m18:08:19.377898 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_escola__dbt_backup"
[0m18:08:19.378827 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_escola"
[0m18:08:19.379248 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_escola"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_escola__dbt_backup" cascade
[0m18:08:19.489051 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.109 seconds
[0m18:08:19.490744 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_escola: Close
[0m18:08:19.491663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a430b7ff-c6ae-4635-b87b-6f178a068b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf9e5e202c0>]}
[0m18:08:19.492443 [info ] [Thread-1 (]: 4 of 13 OK created sql table model staging_dimensions.dim_escola ............... [[32mSELECT 433[0m in 2.00s]
[0m18:08:19.493060 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_escola
[0m18:08:19.493491 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_localizacao
[0m18:08:19.494077 [info ] [Thread-1 (]: 5 of 13 START sql table model staging_dimensions.dim_localizacao ............... [RUN]
[0m18:08:19.494571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_escola, now model.transformacao_matricula.dim_localizacao)
[0m18:08:19.495034 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_localizacao
[0m18:08:19.497616 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_localizacao"
[0m18:08:19.498296 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_localizacao
[0m18:08:19.502126 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_localizacao"
[0m18:08:19.503187 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m18:08:19.503855 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: BEGIN
[0m18:08:19.504395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:20.337713 [debug] [Thread-1 (]: SQL status: BEGIN in 0.833 seconds
[0m18:08:20.338214 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m18:08:20.338638 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_localizacao__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),
localizacoes_unicas AS (
    SELECT DISTINCT
        rpa,
        endereco_bairro,
        CASE rpa
            WHEN 1 THEN 'RPA 1 (Centro)'
            WHEN 2 THEN 'RPA 2 (Zona Norte)'
            WHEN 3 THEN 'RPA 3 (Zona Oeste)'
            WHEN 4 THEN 'RPA 4 (Zona Sudoeste)'
            WHEN 5 THEN 'RPA 5 (Zona Sul)'
            WHEN 6 THEN 'RPA 6 (Zona Sudeste)'
            ELSE 'RPA Não Identificada'
        END AS desc_rpa
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY rpa, endereco_bairro) - 1 AS id_locali, -- Surrogate Key
        rpa,
        endereco_bairro,
        desc_rpa
    FROM localizacoes_unicas
)

SELECT * FROM versao_final
  );
  
[0m18:08:20.783499 [debug] [Thread-1 (]: SQL status: SELECT 88 in 0.444 seconds
[0m18:08:20.786295 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m18:08:20.786743 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_localizacao__dbt_tmp" rename to "dim_localizacao"
[0m18:08:20.889850 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.103 seconds
[0m18:08:20.891376 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: COMMIT
[0m18:08:20.891805 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m18:08:20.892160 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: COMMIT
[0m18:08:20.996501 [debug] [Thread-1 (]: SQL status: COMMIT in 0.104 seconds
[0m18:08:20.998621 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_localizacao__dbt_backup"
[0m18:08:20.999458 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_localizacao"
[0m18:08:20.999848 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_localizacao"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_localizacao__dbt_backup" cascade
[0m18:08:21.102963 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.103 seconds
[0m18:08:21.105346 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_localizacao: Close
[0m18:08:21.106071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a430b7ff-c6ae-4635-b87b-6f178a068b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf9e8db6900>]}
[0m18:08:21.106721 [info ] [Thread-1 (]: 5 of 13 OK created sql table model staging_dimensions.dim_localizacao .......... [[32mSELECT 88[0m in 1.61s]
[0m18:08:21.107329 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_localizacao
[0m18:08:21.107780 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_situacao
[0m18:08:21.108428 [info ] [Thread-1 (]: 6 of 13 START sql table model staging_dimensions.dim_situacao .................. [RUN]
[0m18:08:21.108982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_localizacao, now model.transformacao_matricula.dim_situacao)
[0m18:08:21.109407 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_situacao
[0m18:08:21.111890 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_situacao"
[0m18:08:21.112698 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_situacao
[0m18:08:21.116149 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_situacao"
[0m18:08:21.116853 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m18:08:21.117241 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: BEGIN
[0m18:08:21.117601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:21.955424 [debug] [Thread-1 (]: SQL status: BEGIN in 0.838 seconds
[0m18:08:21.955987 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m18:08:21.960382 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_situacao__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),
situacoes_unicas AS (
    SELECT DISTINCT
        situacao_nome,
        CASE 
            WHEN situacao_nome = 'Aprovado' THEN 'APROVADO'
            WHEN situacao_nome = 'Reprovado' THEN 'REPROVADO'
            WHEN situacao_nome = 'Transferido' THEN 'TRANSFERIDO'
            WHEN situacao_nome = 'Desistente' THEN 'DESISTENTE'
            ELSE 'OUTROS'
        END AS categoria,
        CASE 
            WHEN situacao_nome = 'Aprovado' THEN 1
            ELSE 0
        END AS eh_aprovado,
        CASE 
            WHEN situacao_nome = 'Reprovado' THEN 1
            ELSE 0
        END AS eh_reprovado
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY situacao_nome) - 1 AS id_situacao, -- Surrogate Key
        situacao_nome,
        categoria,
        eh_aprovado,
        eh_reprovado
    FROM situacoes_unicas
)

SELECT * FROM versao_final
  );
  
[0m18:08:22.370406 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.409 seconds
[0m18:08:22.374897 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m18:08:22.375376 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_situacao__dbt_tmp" rename to "dim_situacao"
[0m18:08:22.479734 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.104 seconds
[0m18:08:22.481745 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: COMMIT
[0m18:08:22.482197 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m18:08:22.482563 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: COMMIT
[0m18:08:22.586379 [debug] [Thread-1 (]: SQL status: COMMIT in 0.103 seconds
[0m18:08:22.589208 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_situacao__dbt_backup"
[0m18:08:22.590086 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_situacao"
[0m18:08:22.590474 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_situacao"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_situacao__dbt_backup" cascade
[0m18:08:22.695321 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.104 seconds
[0m18:08:22.697709 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_situacao: Close
[0m18:08:22.698516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a430b7ff-c6ae-4635-b87b-6f178a068b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf9e45226f0>]}
[0m18:08:22.699159 [info ] [Thread-1 (]: 6 of 13 OK created sql table model staging_dimensions.dim_situacao ............. [[32mSELECT 5[0m in 1.59s]
[0m18:08:22.699744 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_situacao
[0m18:08:22.700192 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_tempo
[0m18:08:22.700790 [info ] [Thread-1 (]: 7 of 13 START sql table model staging_dimensions.dim_tempo ..................... [RUN]
[0m18:08:22.701295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_situacao, now model.transformacao_matricula.dim_tempo)
[0m18:08:22.701754 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_tempo
[0m18:08:22.704315 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_tempo"
[0m18:08:22.704981 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_tempo
[0m18:08:22.708113 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_tempo"
[0m18:08:22.708909 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m18:08:22.709302 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: BEGIN
[0m18:08:22.709677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:23.606925 [debug] [Thread-1 (]: SQL status: BEGIN in 0.897 seconds
[0m18:08:23.607970 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m18:08:23.608481 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_tempo__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),

anos_unicos AS (
    SELECT DISTINCT
        ano,
        'Registro Anual' AS ano_ensino
    FROM source
),

versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY ano) - 1 AS id_tempo, -- Surrogate Key
        ano,
        ano_ensino
    FROM anos_unicos
)
SELECT * FROM versao_final
  );
  
[0m18:08:23.999466 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.390 seconds
[0m18:08:24.002670 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m18:08:24.003146 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_tempo__dbt_tmp" rename to "dim_tempo"
[0m18:08:24.120681 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.117 seconds
[0m18:08:24.122576 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: COMMIT
[0m18:08:24.123041 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m18:08:24.123397 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: COMMIT
[0m18:08:24.236456 [debug] [Thread-1 (]: SQL status: COMMIT in 0.112 seconds
[0m18:08:24.238686 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_tempo__dbt_backup"
[0m18:08:24.239666 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_tempo"
[0m18:08:24.240057 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_tempo"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_tempo__dbt_backup" cascade
[0m18:08:24.353142 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.113 seconds
[0m18:08:24.354732 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_tempo: Close
[0m18:08:24.355497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a430b7ff-c6ae-4635-b87b-6f178a068b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf9e4523920>]}
[0m18:08:24.356173 [info ] [Thread-1 (]: 7 of 13 OK created sql table model staging_dimensions.dim_tempo ................ [[32mSELECT 3[0m in 1.65s]
[0m18:08:24.356864 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_tempo
[0m18:08:24.357319 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.dim_turma
[0m18:08:24.357904 [info ] [Thread-1 (]: 8 of 13 START sql table model staging_dimensions.dim_turma ..................... [RUN]
[0m18:08:24.358413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_tempo, now model.transformacao_matricula.dim_turma)
[0m18:08:24.358852 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.dim_turma
[0m18:08:24.361273 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.dim_turma"
[0m18:08:24.361975 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.dim_turma
[0m18:08:24.365386 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.dim_turma"
[0m18:08:24.366256 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m18:08:24.366778 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: BEGIN
[0m18:08:24.367298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:25.220199 [debug] [Thread-1 (]: SQL status: BEGIN in 0.853 seconds
[0m18:08:25.220866 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m18:08:25.221374 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */

  
    

  create  table "transformacao_matricula"."staging_dimensions"."dim_turma__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),
turmas_unicas AS (
    SELECT DISTINCT
        turma,
        turno,
        serie,
        mod_ens_codigo,
        modalidade_ens
    FROM source
),
versao_final AS (
    SELECT 
        ROW_NUMBER() OVER (ORDER BY turma, turno, serie) - 1 AS id_turma,
        turma,
        turno,
        NULL AS serie_codigo,
        serie,
        mod_ens_codigo,
        modalidade_ens AS modalidade_ensino
    FROM turmas_unicas
)

SELECT * FROM versao_final
  );
  
[0m18:08:25.677925 [debug] [Thread-1 (]: SQL status: SELECT 335 in 0.456 seconds
[0m18:08:25.681061 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m18:08:25.681516 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */
alter table "transformacao_matricula"."staging_dimensions"."dim_turma__dbt_tmp" rename to "dim_turma"
[0m18:08:25.787161 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.105 seconds
[0m18:08:25.788863 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: COMMIT
[0m18:08:25.789278 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m18:08:25.789647 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: COMMIT
[0m18:08:25.895265 [debug] [Thread-1 (]: SQL status: COMMIT in 0.105 seconds
[0m18:08:25.897621 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_dimensions"."dim_turma__dbt_backup"
[0m18:08:25.898563 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.dim_turma"
[0m18:08:25.898979 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.dim_turma"} */
drop table if exists "transformacao_matricula"."staging_dimensions"."dim_turma__dbt_backup" cascade
[0m18:08:26.004416 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.105 seconds
[0m18:08:26.006104 [debug] [Thread-1 (]: On model.transformacao_matricula.dim_turma: Close
[0m18:08:26.006838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a430b7ff-c6ae-4635-b87b-6f178a068b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf9e4543ec0>]}
[0m18:08:26.007469 [info ] [Thread-1 (]: 8 of 13 OK created sql table model staging_dimensions.dim_turma ................ [[32mSELECT 335[0m in 1.65s]
[0m18:08:26.008051 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.dim_turma
[0m18:08:26.009057 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.fato_matricula
[0m18:08:26.010179 [info ] [Thread-1 (]: 9 of 13 START sql table model staging_facts.fato_matricula ..................... [RUN]
[0m18:08:26.010744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.dim_turma, now model.transformacao_matricula.fato_matricula)
[0m18:08:26.011167 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.fato_matricula
[0m18:08:26.016684 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.fato_matricula"
[0m18:08:26.017499 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.fato_matricula
[0m18:08:26.021477 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.fato_matricula"
[0m18:08:26.022532 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.fato_matricula"
[0m18:08:26.023155 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: BEGIN
[0m18:08:26.023668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:26.870519 [debug] [Thread-1 (]: SQL status: BEGIN in 0.847 seconds
[0m18:08:26.871037 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.fato_matricula"
[0m18:08:26.871504 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.fato_matricula"} */

  
    

  create  table "transformacao_matricula"."staging_facts"."fato_matricula__dbt_tmp"
  
  
    as
  
  (
    

with source AS (
    SELECT * FROM "transformacao_matricula"."staging_intermediate"."transform_data" 
),

-- Dimensões com seus IDs
dim_aluno AS (
    SELECT id_aluno, matricula, sexo, idade, faixa_etaria 
    FROM "transformacao_matricula"."staging_dimensions"."dim_aluno"
),

dim_escola AS (
    SELECT id_escola, codigo_escola 
    FROM "transformacao_matricula"."staging_dimensions"."dim_escola"
),

dim_turma AS (
    SELECT id_turma, turma, turno, serie, mod_ens_codigo, modalidade_ensino 
    FROM "transformacao_matricula"."staging_dimensions"."dim_turma"
),

dim_situacao AS (
    SELECT id_situacao, situacao_nome 
    FROM "transformacao_matricula"."staging_dimensions"."dim_situacao"
),

dim_localizacao AS (
    SELECT id_locali, rpa, endereco_bairro 
    FROM "transformacao_matricula"."staging_dimensions"."dim_localizacao"
),

dim_tempo AS (
    SELECT id_tempo, ano 
    FROM "transformacao_matricula"."staging_dimensions"."dim_tempo"
),

-- Construindo a tabela fato
fato AS (
    SELECT
        da.id_aluno,
        de.id_escola,
        dt.id_turma,
        dsi.id_situacao,
        dl.id_locali,
        dte.id_tempo,
        s.matricula,
        1 AS qtd_alunos
    FROM source s
    
    LEFT JOIN dim_aluno da 
        ON s.matricula = da.matricula
        AND s.sexo = da.sexo
        AND s.idade = da.idade
    
    LEFT JOIN dim_escola de 
        ON s.codigo_escola = de.codigo_escola
    
    LEFT JOIN dim_turma dt 
        ON s.turma = dt.turma
        AND s.turno = dt.turno
        AND s.serie = dt.serie
        AND s.mod_ens_codigo = dt.mod_ens_codigo
        AND s.modalidade_ens = dt.modalidade_ensino
    
    LEFT JOIN dim_situacao dsi 
        ON s.situacao_nome = dsi.situacao_nome
    
    LEFT JOIN dim_localizacao dl 
        ON s.rpa = dl.rpa
        AND s.endereco_bairro = dl.endereco_bairro
    
    LEFT JOIN dim_tempo dte 
        ON s.ano = dte.ano
)

SELECT * FROM fato
  );
  
[0m18:08:29.596022 [debug] [Thread-1 (]: SQL status: SELECT 319146 in 2.724 seconds
[0m18:08:29.598986 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.fato_matricula"
[0m18:08:29.599447 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.fato_matricula"} */
alter table "transformacao_matricula"."staging_facts"."fato_matricula__dbt_tmp" rename to "fato_matricula"
[0m18:08:29.705211 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.105 seconds
[0m18:08:29.706918 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: COMMIT
[0m18:08:29.707341 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.fato_matricula"
[0m18:08:29.707722 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: COMMIT
[0m18:08:29.812783 [debug] [Thread-1 (]: SQL status: COMMIT in 0.104 seconds
[0m18:08:29.815234 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_facts"."fato_matricula__dbt_backup"
[0m18:08:29.816099 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.fato_matricula"
[0m18:08:29.816474 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.fato_matricula"} */
drop table if exists "transformacao_matricula"."staging_facts"."fato_matricula__dbt_backup" cascade
[0m18:08:29.923744 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.107 seconds
[0m18:08:29.925185 [debug] [Thread-1 (]: On model.transformacao_matricula.fato_matricula: Close
[0m18:08:29.925959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a430b7ff-c6ae-4635-b87b-6f178a068b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf9e45449e0>]}
[0m18:08:29.926588 [info ] [Thread-1 (]: 9 of 13 OK created sql table model staging_facts.fato_matricula ................ [[32mSELECT 319146[0m in 3.92s]
[0m18:08:29.927233 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.fato_matricula
[0m18:08:29.928116 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_count_aluno_idade
[0m18:08:29.928747 [info ] [Thread-1 (]: 10 of 13 START sql view model staging_marts.view_count_aluno_idade ............. [RUN]
[0m18:08:29.929248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.fato_matricula, now model.transformacao_matricula.view_count_aluno_idade)
[0m18:08:29.929676 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_count_aluno_idade
[0m18:08:29.932699 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_count_aluno_idade"
[0m18:08:29.933504 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_count_aluno_idade
[0m18:08:29.953850 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_count_aluno_idade"
[0m18:08:29.954894 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m18:08:29.955491 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: BEGIN
[0m18:08:29.956049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:30.786185 [debug] [Thread-1 (]: SQL status: BEGIN in 0.830 seconds
[0m18:08:30.786936 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m18:08:30.787315 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_count_aluno_idade"} */

  create view "transformacao_matricula"."staging_marts"."view_count_aluno_idade__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dl.desc_rpa,
    da.faixa_etaria,
    COUNT(fm.matricula) AS total_alunos
FROM
    "transformacao_matricula"."staging_facts"."fato_matricula" fm
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_aluno" da ON fm.id_aluno = da.id_aluno
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_localizacao" dl ON fm.id_locali = dl.id_locali
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_tempo" dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
ORDER BY
    dtemp.ano, dl.desc_rpa, da.faixa_etaria
  );
[0m18:08:30.904239 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.116 seconds
[0m18:08:30.906930 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m18:08:30.907384 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_count_aluno_idade"} */
alter table "transformacao_matricula"."staging_marts"."view_count_aluno_idade__dbt_tmp" rename to "view_count_aluno_idade"
[0m18:08:31.011704 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.104 seconds
[0m18:08:31.013235 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: COMMIT
[0m18:08:31.013693 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m18:08:31.014066 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: COMMIT
[0m18:08:31.119353 [debug] [Thread-1 (]: SQL status: COMMIT in 0.105 seconds
[0m18:08:31.121520 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."view_count_aluno_idade__dbt_backup"
[0m18:08:31.124464 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_count_aluno_idade"
[0m18:08:31.124972 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_count_aluno_idade"} */
drop view if exists "transformacao_matricula"."staging_marts"."view_count_aluno_idade__dbt_backup" cascade
[0m18:08:31.230676 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.105 seconds
[0m18:08:31.232481 [debug] [Thread-1 (]: On model.transformacao_matricula.view_count_aluno_idade: Close
[0m18:08:31.233239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a430b7ff-c6ae-4635-b87b-6f178a068b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf9e5e1bc50>]}
[0m18:08:31.233881 [info ] [Thread-1 (]: 10 of 13 OK created sql view model staging_marts.view_count_aluno_idade ........ [[32mCREATE VIEW[0m in 1.30s]
[0m18:08:31.234437 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_count_aluno_idade
[0m18:08:31.234899 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m18:08:31.235474 [info ] [Thread-1 (]: 11 of 13 START sql view model staging_marts.view_frequencia_situacao_escola .... [RUN]
[0m18:08:31.236085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_count_aluno_idade, now model.transformacao_matricula.view_frequencia_situacao_escola)
[0m18:08:31.236521 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_frequencia_situacao_escola
[0m18:08:31.239540 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m18:08:31.240354 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_frequencia_situacao_escola
[0m18:08:31.243749 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m18:08:31.244498 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m18:08:31.244997 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: BEGIN
[0m18:08:31.245457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:32.085649 [debug] [Thread-1 (]: SQL status: BEGIN in 0.840 seconds
[0m18:08:32.086432 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m18:08:32.086826 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_frequencia_situacao_escola"} */

  create view "transformacao_matricula"."staging_marts"."view_frequencia_situacao_escola__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    de.nome_escola,
    de.codigo_escola,
    ds.situacao_nome,
    COUNT(fm.matricula) AS contagem_situacao
FROM
    "transformacao_matricula"."staging_facts"."fato_matricula" fm
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_escola" de ON fm.id_escola = de.id_escola
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_situacao" ds ON fm.id_situacao = ds.id_situacao
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_tempo" dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, de.nome_escola, de.codigo_escola, ds.situacao_nome
ORDER BY
    dtemp.ano, de.nome_escola, contagem_situacao DESC
  );
[0m18:08:32.191579 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.104 seconds
[0m18:08:32.196182 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m18:08:32.196685 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_frequencia_situacao_escola"} */
alter table "transformacao_matricula"."staging_marts"."view_frequencia_situacao_escola__dbt_tmp" rename to "view_frequencia_situacao_escola"
[0m18:08:32.299882 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.103 seconds
[0m18:08:32.301801 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: COMMIT
[0m18:08:32.302232 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m18:08:32.302587 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: COMMIT
[0m18:08:32.405941 [debug] [Thread-1 (]: SQL status: COMMIT in 0.103 seconds
[0m18:08:32.408465 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."view_frequencia_situacao_escola__dbt_backup"
[0m18:08:32.409372 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_frequencia_situacao_escola"
[0m18:08:32.409815 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_frequencia_situacao_escola"} */
drop view if exists "transformacao_matricula"."staging_marts"."view_frequencia_situacao_escola__dbt_backup" cascade
[0m18:08:32.512890 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.102 seconds
[0m18:08:32.514880 [debug] [Thread-1 (]: On model.transformacao_matricula.view_frequencia_situacao_escola: Close
[0m18:08:32.515749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a430b7ff-c6ae-4635-b87b-6f178a068b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf9e459b890>]}
[0m18:08:32.516458 [info ] [Thread-1 (]: 11 of 13 OK created sql view model staging_marts.view_frequencia_situacao_escola  [[32mCREATE VIEW[0m in 1.28s]
[0m18:08:32.517134 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_frequencia_situacao_escola
[0m18:08:32.517662 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_matricula_detalhada
[0m18:08:32.518209 [info ] [Thread-1 (]: 12 of 13 START sql view model staging_marts.view_matricula_detalhada ........... [RUN]
[0m18:08:32.518731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_frequencia_situacao_escola, now model.transformacao_matricula.view_matricula_detalhada)
[0m18:08:32.519179 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_matricula_detalhada
[0m18:08:32.522904 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_matricula_detalhada"
[0m18:08:32.523726 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_matricula_detalhada
[0m18:08:32.527200 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_matricula_detalhada"
[0m18:08:32.528076 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m18:08:32.528728 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: BEGIN
[0m18:08:32.529244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:33.368847 [debug] [Thread-1 (]: SQL status: BEGIN in 0.839 seconds
[0m18:08:33.369851 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m18:08:33.370343 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_matricula_detalhada"} */

  create view "transformacao_matricula"."staging_marts"."view_matricula_detalhada__dbt_tmp"
    
    
  as (
    
SELECT
    fm.matricula,
    da.sexo,
    da.idade,
    da.faixa_etaria,
    de.nome_escola,
    de.codigo_escola,
    dt.turma,
    dt.turno,
    dt.serie,
    dt.modalidade_ensino,
    ds.situacao_nome,
    ds.categoria AS categoria_situacao,
    ds.eh_aprovado,
    ds.eh_reprovado,
    dl.desc_rpa,
    dl.endereco_bairro AS bairro_localizacao,
    dtemp.ano AS ano_registro
FROM
    "transformacao_matricula"."staging_facts"."fato_matricula" fm
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_aluno" da ON fm.id_aluno = da.id_aluno
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_escola" de ON fm.id_escola = de.id_escola
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_turma" dt ON fm.id_turma = dt.id_turma
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_situacao" ds ON fm.id_situacao = ds.id_situacao
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_localizacao" dl ON fm.id_locali = dl.id_locali
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_tempo" dtemp ON fm.id_tempo = dtemp.id_tempo
  );
[0m18:08:33.478944 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.108 seconds
[0m18:08:33.483467 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m18:08:33.484156 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_matricula_detalhada"} */
alter table "transformacao_matricula"."staging_marts"."view_matricula_detalhada__dbt_tmp" rename to "view_matricula_detalhada"
[0m18:08:33.587677 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.103 seconds
[0m18:08:33.589581 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: COMMIT
[0m18:08:33.590018 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m18:08:33.590403 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: COMMIT
[0m18:08:33.694451 [debug] [Thread-1 (]: SQL status: COMMIT in 0.103 seconds
[0m18:08:33.697035 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."view_matricula_detalhada__dbt_backup"
[0m18:08:33.697911 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_matricula_detalhada"
[0m18:08:33.698291 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_matricula_detalhada"} */
drop view if exists "transformacao_matricula"."staging_marts"."view_matricula_detalhada__dbt_backup" cascade
[0m18:08:33.801637 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.103 seconds
[0m18:08:33.803493 [debug] [Thread-1 (]: On model.transformacao_matricula.view_matricula_detalhada: Close
[0m18:08:33.804315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a430b7ff-c6ae-4635-b87b-6f178a068b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf9e5eb6fc0>]}
[0m18:08:33.804976 [info ] [Thread-1 (]: 12 of 13 OK created sql view model staging_marts.view_matricula_detalhada ...... [[32mCREATE VIEW[0m in 1.29s]
[0m18:08:33.805538 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_matricula_detalhada
[0m18:08:33.806019 [debug] [Thread-1 (]: Began running node model.transformacao_matricula.view_taxa_aprovados
[0m18:08:33.806575 [info ] [Thread-1 (]: 13 of 13 START sql view model staging_marts.view_taxa_aprovados ................ [RUN]
[0m18:08:33.807118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.transformacao_matricula.view_matricula_detalhada, now model.transformacao_matricula.view_taxa_aprovados)
[0m18:08:33.807538 [debug] [Thread-1 (]: Began compiling node model.transformacao_matricula.view_taxa_aprovados
[0m18:08:33.810536 [debug] [Thread-1 (]: Writing injected SQL for node "model.transformacao_matricula.view_taxa_aprovados"
[0m18:08:33.811338 [debug] [Thread-1 (]: Began executing node model.transformacao_matricula.view_taxa_aprovados
[0m18:08:33.814404 [debug] [Thread-1 (]: Writing runtime sql for node "model.transformacao_matricula.view_taxa_aprovados"
[0m18:08:33.815146 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m18:08:33.815591 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: BEGIN
[0m18:08:33.816031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:34.668540 [debug] [Thread-1 (]: SQL status: BEGIN in 0.852 seconds
[0m18:08:34.669081 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m18:08:34.669584 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_taxa_aprovados"} */

  create view "transformacao_matricula"."staging_marts"."view_taxa_aprovados__dbt_tmp"
    
    
  as (
    
SELECT
    dtemp.ano AS ano_registro,
    dt.modalidade_ensino,
    COUNT(fm.matricula) AS total_matriculas,
    SUM(ds.eh_aprovado) AS total_aprovados,
    SUM(ds.eh_reprovado) AS total_reprovados,
    -- Calcula a taxa de aprovação (como porcentagem)
    CAST(SUM(ds.eh_aprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_aprovacao_percentual,
    -- Calcula a taxa de reprovação (como porcentagem)
    CAST(SUM(ds.eh_reprovado) AS DECIMAL) * 100 / COUNT(fm.matricula) AS taxa_reprovacao_percentual
FROM
    "transformacao_matricula"."staging_facts"."fato_matricula" fm
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_situacao" ds ON fm.id_situacao = ds.id_situacao
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_turma" dt ON fm.id_turma = dt.id_turma
JOIN
    "transformacao_matricula"."staging_dimensions"."dim_tempo" dtemp ON fm.id_tempo = dtemp.id_tempo
GROUP BY
    dtemp.ano, dt.modalidade_ensino
ORDER BY
    dtemp.ano, dt.modalidade_ensino
  );
[0m18:08:34.787186 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.117 seconds
[0m18:08:34.789851 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m18:08:34.790424 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_taxa_aprovados"} */
alter table "transformacao_matricula"."staging_marts"."view_taxa_aprovados__dbt_tmp" rename to "view_taxa_aprovados"
[0m18:08:34.897640 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.106 seconds
[0m18:08:34.899832 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: COMMIT
[0m18:08:34.900266 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m18:08:34.900640 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: COMMIT
[0m18:08:35.009243 [debug] [Thread-1 (]: SQL status: COMMIT in 0.108 seconds
[0m18:08:35.012337 [debug] [Thread-1 (]: Applying DROP to: "transformacao_matricula"."staging_marts"."view_taxa_aprovados__dbt_backup"
[0m18:08:35.013394 [debug] [Thread-1 (]: Using postgres connection "model.transformacao_matricula.view_taxa_aprovados"
[0m18:08:35.013888 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "transformacao_matricula", "target_name": "transformacao_matricula_db", "node_id": "model.transformacao_matricula.view_taxa_aprovados"} */
drop view if exists "transformacao_matricula"."staging_marts"."view_taxa_aprovados__dbt_backup" cascade
[0m18:08:35.122371 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.108 seconds
[0m18:08:35.123999 [debug] [Thread-1 (]: On model.transformacao_matricula.view_taxa_aprovados: Close
[0m18:08:35.125069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a430b7ff-c6ae-4635-b87b-6f178a068b7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf9e45aa9f0>]}
[0m18:08:35.125739 [info ] [Thread-1 (]: 13 of 13 OK created sql view model staging_marts.view_taxa_aprovados ........... [[32mCREATE VIEW[0m in 1.32s]
[0m18:08:35.126350 [debug] [Thread-1 (]: Finished running node model.transformacao_matricula.view_taxa_aprovados
[0m18:08:35.128134 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:35.128757 [debug] [MainThread]: On master: BEGIN
[0m18:08:35.129077 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:08:35.970555 [debug] [MainThread]: SQL status: BEGIN in 0.841 seconds
[0m18:08:35.971208 [debug] [MainThread]: On master: COMMIT
[0m18:08:35.971815 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:35.972363 [debug] [MainThread]: On master: COMMIT
[0m18:08:36.075134 [debug] [MainThread]: SQL status: COMMIT in 0.102 seconds
[0m18:08:36.076074 [debug] [MainThread]: On master: Close
[0m18:08:36.076838 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:08:36.077177 [debug] [MainThread]: Connection 'model.transformacao_matricula.view_taxa_aprovados' was properly closed.
[0m18:08:36.077589 [info ] [MainThread]: 
[0m18:08:36.077995 [info ] [MainThread]: Finished running 9 table models, 4 view models in 0 hours 0 minutes and 49.04 seconds (49.04s).
[0m18:08:36.079963 [debug] [MainThread]: Command end result
[0m18:08:36.185273 [debug] [MainThread]: Wrote artifact WritableManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/manifest.json
[0m18:08:36.187129 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/semantic_manifest.json
[0m18:08:36.191933 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/murilo/UFPE/BD/Grupo7-BancoDeDados/target/run_results.json
[0m18:08:36.192348 [info ] [MainThread]: 
[0m18:08:36.192740 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:08:36.193112 [info ] [MainThread]: 
[0m18:08:36.193506 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=13
[0m18:08:36.194102 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 6 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:08:36.195091 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 50.772316, "process_in_blocks": "0", "process_kernel_time": 0.390576, "process_mem_max_rss": "130168", "process_out_blocks": "4000", "process_user_time": 3.366972}
[0m18:08:36.195629 [debug] [MainThread]: Command `dbt run` succeeded at 18:08:36.195535 after 50.77 seconds
[0m18:08:36.196014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf9ec3b5880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf9ec3b5850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cf9e9187440>]}
[0m18:08:36.196381 [debug] [MainThread]: Flushing usage events
[0m18:08:36.814331 [debug] [MainThread]: An error was encountered while trying to flush usage events
